---
title: "Descriptives"
author: "Helena Davies"
date: "19/12/21"
output: word_document
---

This script derives variables ready for regression analyses.
Configure global options for all chunks
```{r Setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,
  comment = '',
  prompt = FALSE,
  cache = FALSE
  ) 
```

Clear global environment prior to initiation
```{r Clear global environment}
remove(list = ls())
```

Add the add_numeric function - used to convert character variables into numeric variables
Add the remove_duplicates function - used to deduplicate and remove NAs from IDs
Add the sumscores function - used to generate sumscores
Add the package_check function - used to install and load dependencies
Add the imp_check function - used to check variables for implausible values
```{r Read in functions}
source(file = "/Users/helenadavies/werk/ilovedata/scripts/functions/add_numeric.R")
source(file = "/Users/helenadavies/werk/ilovedata/scripts/functions/remove_duplicates.R")
source(file = "/Users/helenadavies/werk/ilovedata/scripts/functions/package_check.R")
source("./functions.R")
```

Use package_check to install and load dependencies
Load tidyverse last
```{r Install load dependencies}
packages <- c("summarytools", "sjlabelled", "Amelia", "gtsummary", "naniar",
              "tidyverse")
package_check(packages)
```

Retrieve recent date
We are using the recent date to save files with paste0() as an extension to not overwrite old versions
```{r Recent date}
date <- Sys.Date()
date
```

# Read in data
## Final cleaned data
```{r Read in data}
dat <- readRDS(file = "../data_cleaned/final_dat_merged_2022-02-21.rds")

# Check
dim(dat)
colnames(dat)

# Check cohort
dat %>%
  freq(sample)
```


## BMI data
### BMI (at time of assessment) 
Merged: GLAD sign-up, EDGI sign-up, NBR COPING (not assessed in RAMP)
Read in data
```{r Read in data bmi}
# GLAD & EDGI
bmi_edgi_glad_signup <- readRDS(file ="/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data/latest_freeze/glad_edgi/demographics/signup_bmi_height_weight_glad_edgi_clean.rds")

bmi_edgi_glad_signup %>%
  colnames()

bmi_edgi_glad_signup %>%
  dim()

bmi_edgi_glad_signup <- bmi_edgi_glad_signup %>%
  select(ID,
         sample, 
         dem.bmi_signup
         )

# GLAD COPING, EDGI COPING, & NBR
bmi_coping <- readRDS(file ="/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data/latest_freeze/coping_glad_edgi_nbr/demographics/signup_bmi_height_weight_coping_glad_edgi_nbr_clean.rds")

bmi_coping %>%
  colnames()

bmi_coping %>%
  dim()

bmi_coping <- bmi_coping %>%
  select(ID,
         sample, 
         dem.bmi_signup_cop
         )

# Merge GLAD COPING, EDGI COPING, & NBR with GLAD & EDGI
bmi_at_assessment <- dplyr::full_join(bmi_coping,
                          bmi_edgi_glad_signup,
                          by = c("ID",
                                  "sample"
                                  )
)

# Check
bmi_at_assessment %>%
  dim()

# Check
bmi_at_assessment %>%
  nrow()

# Set BMIs of less than 0 (e.g., -666) to NA
bmi_at_assessment <- bmi_at_assessment %>%
  mutate(dem.bmi_signup_cop =
           case_when(dem.bmi_signup_cop < 0 ~ NA_real_,
                     TRUE ~ as.numeric(dem.bmi_signup_cop)
                     )
         )
```

### Lowest BMI
Merged: GLAD, GLAD COPING, EDGI, EDGI COPING, NBR (AN lowest BMI not assessed in EDGI COPING or RAMP)
Read in data
```{r Read in data bmi}
# GLAD & EDGI
lowest_bmi_edgi_glad_signup <- readRDS(file ="/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data/latest_freeze/glad_edgi/demographics/lowest_bmi_height_weight_glad_edgi_clean.rds")

lowest_bmi_edgi_glad_signup %>%
  colnames()

lowest_bmi_edgi_glad_signup %>%
  dim()

lowest_bmi_edgi_glad_signup <- lowest_bmi_edgi_glad_signup %>%
  select(ID,
         sample, 
         dem.bmi_lowest,
         an.bmi_lowest
         )

# GLAD COPING, EDGI COPING, & NBR
lowest_bmi_coping <- readRDS(file ="/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data/latest_freeze/coping_glad_edgi_nbr/demographics/lowest_bmi_height_weight_coping_glad_edgi_nbr_clean.rds")

lowest_bmi_coping %>%
  colnames()

lowest_bmi_coping %>%
  dim()

lowest_bmi_coping <- lowest_bmi_coping %>%
  select(ID,
         sample, 
         dem.bmi_lowest_cop,
         an.bmi_lowest_cop
         )

# Merge GLAD COPING, EDGI COPING, & NBR with GLAD & EDGI
bmi_lowest <- dplyr::full_join(lowest_bmi_coping,
                          lowest_bmi_edgi_glad_signup,
                          by = c("ID",
                                  "sample"
                                  )
)

# Check
bmi_lowest %>%
  dim()

# Check
bmi_lowest %>%
  nrow()

# If someone reported BMI during AN module (at any height), we want to have this variable rather than their lowest BMI at adult height
bmi_lowest <- bmi_lowest %>%
  mutate(lowest_bmi_final =
           case_when(
             !is.na(an.bmi_lowest_cop) ~ an.bmi_lowest_cop,
             TRUE ~ dem.bmi_lowest_cop
           ))


# Set BMIs of less than 0 (e.g., -666) to NA
bmi_lowest <- bmi_lowest %>%
  mutate(lowest_bmi_final =
           case_when(lowest_bmi_final < 0 ~ NA_real_,
                     TRUE ~ as.numeric(lowest_bmi_final)
                     )
         )
```

### Highest BMI 
Merged: GLAD, GLAD COPING, EDGI, EDGI COPING, NBR  [not in RAMP]
Read in data
```{r Read in data bmi}
# GLAD & EDGI
highest_bmi_edgi_glad_signup <- readRDS(file ="/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data/latest_freeze/glad_edgi/demographics/highest_bmi_height_weight_glad_edgi_clean.rds")

highest_bmi_edgi_glad_signup %>%
  colnames()

highest_bmi_edgi_glad_signup %>%
  dim()

highest_bmi_edgi_glad_signup <- highest_bmi_edgi_glad_signup %>%
  select(ID,
         sample, 
         dem.bmi_highest
         )

# GLAD COPING, EDGI COPING, & NBR
highest_bmi_coping <- readRDS(file ="/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data/latest_freeze/coping_glad_edgi_nbr/demographics/highest_bmi_weight_coping_glad_edgi_nbr_clean.rds")

highest_bmi_coping %>%
  colnames()

highest_bmi_coping %>%
  dim()

highest_bmi_coping <- highest_bmi_coping %>%
  select(ID,
         sample, 
         dem.bmi_highest_cop
         )

# Merge GLAD COPING, EDGI COPING, & NBR with GLAD & EDGI
bmi_highest <- dplyr::full_join(highest_bmi_coping,
                          highest_bmi_edgi_glad_signup,
                          by = c("ID",
                                  "sample"
                                  )
)

# Check
bmi_highest %>%
  dim()

# Check
bmi_highest %>%
  nrow()

# Set BMIs of less than 0 (e.g., -666) to NA
bmi_highest <- bmi_highest %>%
  mutate(dem.bmi_highest_cop =
           case_when(dem.bmi_highest_cop < 0 ~ NA_real_,
                     TRUE ~ as.numeric(dem.bmi_highest_cop)
                     )
         )
```

# Merge cleaned data and BMI data
```{r merge cleaned data and BMI data}
bmi1 <- dplyr::full_join(bmi_highest,
                         bmi_lowest,
                         by = c("ID",
                                "sample")
)


bmi <- dplyr::full_join(bmi1,
                         bmi_at_assessment,
                        by = c("ID",
                                "sample")
)

dat_final <- dplyr::left_join(dat,
                        bmi,
                        by = c("ID",
                                "sample")
)
```


# Freq of descriptives within each regression model

## First, create groups 
```{r create groups}
binge_eating_group <- dat_final %>%
   filter( !is.na(NEW_binge_eating_pandemic) &
             !is.na(age_category_COVID_baseline) & 
             !is.na(gender_cleaned) &
             !is.na(race_categories) & 
             !is.na(highest_education) &
             !is.na(mental_health_diagnosis) &
             !is.na(paid_employment_key_worker) & 
             !is.na(vulnerable_group_member) &
             !is.na(panworry_total_score) & 
             !is.na(positive_covid_test_before_BE_final) &
             !is.na(increased_loneliness_during_pandemic) &
             !is.na(main_eco_change_before_BE_final)  &
             !is.na(lost_someone_before_BE_final) &
             !is.na(living_situation_change_before_BE_final)
          ) 


low_weight_group <- dat_final %>%
   filter( !is.na(NEW_low_weight_pandemic) &
             !is.na(age_category_COVID_baseline) & 
             !is.na(gender_cleaned) &
             !is.na(race_categories) & 
             !is.na(highest_education) &
             !is.na(mental_health_diagnosis) &
             !is.na(paid_employment_key_worker) & 
             !is.na(vulnerable_group_member) &
             !is.na(panworry_total_score) & 
             !is.na(positive_covid_test_before_LW_final) &
             !is.na(increased_loneliness_during_pandemic) &
             !is.na(main_eco_change_before_LW_final)  &
             !is.na(lost_someone_before_LW_final) &
             !is.na(living_situation_change_before_LW_final) &
             !is.na(ocd.repetitive_unpleasant_thoughts_binary) &
             !is.na(ocd.compulsive_beh_mental_act_binary)
           )

harmful_ideation_group <- dat_final %>%
   filter( !is.na(NEW_harmful_ideation_pandemic) &
             !is.na(age_category_COVID_baseline) & 
             !is.na(gender_cleaned) &
             !is.na(race_categories) & 
             !is.na(highest_education) &
             !is.na(mental_health_diagnosis) &
             !is.na(paid_employment_key_worker) & 
             !is.na(vulnerable_group_member) &
             !is.na(panworry_total_score) & 
             !is.na(positive_covid_test_before_HI_final) &
             !is.na(increased_loneliness_during_pandemic) &
             !is.na(main_eco_change_before_HI_final)  &
             !is.na(lost_someone_before_HI_final) &
             !is.na(living_situation_change_before_HI_final)
          ) 

selfharm_group <- dat_final %>%
   filter( !is.na(NEW_selfharm_pandemic) &
             !is.na(age_category_COVID_baseline) & 
             !is.na(gender_cleaned) &
             !is.na(race_categories) & 
             !is.na(highest_education) &
             !is.na(mental_health_diagnosis) &
             !is.na(paid_employment_key_worker) & 
             !is.na(vulnerable_group_member) &
             !is.na(panworry_total_score) & 
             !is.na(positive_covid_test_before_SH_final) &
             !is.na(increased_loneliness_during_pandemic) &
             !is.na(main_eco_change_before_SH_final)  &
             !is.na(lost_someone_before_SH_final) &
             !is.na(living_situation_change_before_SH_final)
          ) 
```

```{r histogram of BMIs}
# Histogram of BMIs
hist(dat_final$lowest_bmi_final)
hist(dat_final$dem.bmi_highest_cop)
hist(dat_final$dem.bmi_signup_cop)
```
# Percentage new onset
```{r percentage new onset binge eating}
dat %>%
  filter(!is.na(NEW_binge_eating_pandemic)) %>%
  freq(NEW_binge_eating_pandemic)

(5187/24513)*100

dat %>%
   filter( !is.na(age_category_COVID_baseline) & 
             !is.na(gender_cleaned) &
             !is.na(race_binary) & 
             !is.na(NEW_binge_eating_pandemic) &
             !is.na(highest_education) &
             !is.na(mental_health_diagnosis) &
             !is.na(paid_employment_key_worker) & 
             !is.na(vulnerable_group_member) &
             !is.na(panworry_total_score) & 
             !is.na(positive_covid_test_before_BE_final) &
             !is.na(lost_someone_before_BE_final) &
             !is.na(increased_loneliness_during_pandemic) &
             !is.na(main_eco_change_before_BE_final)  &
             !is.na(increased_loneliness_during_pandemic) &
             !is.na(living_situation_change_before_BE_final)
          ) %>%
   freq(NEW_binge_eating_pandemic)

(1282/6313)*100
```

```{r percentage new onset low weight}
dat %>%
  filter(!is.na(NEW_low_weight_pandemic)) %>%
  freq(NEW_low_weight_pandemic)

(2780/25488)*100

dat %>%
   filter( !is.na(age_category_COVID_baseline) & 
             !is.na(gender_cleaned) &
             !is.na(race_binary) & 
             !is.na(NEW_low_weight_pandemic) &
             !is.na(highest_education) &
             !is.na(mental_health_diagnosis) &
             !is.na(paid_employment_key_worker) & 
             !is.na(vulnerable_group_member) &
             !is.na(panworry_total_score) & 
             !is.na(lost_someone_before_LW_final) &
             !is.na(positive_covid_test_before_LW_final) &
             !is.na(increased_loneliness_during_pandemic) &
             !is.na(main_eco_change_before_LW_final)  &
             !is.na(increased_loneliness_during_pandemic) &
             !is.na(living_situation_change_before_LW_final) &
             !is.na(ocd.compulsive_beh_mental_act_binary) &
             !is.na(ocd.repetitive_unpleasant_thoughts_binary)
           ) %>%
   freq(NEW_low_weight_pandemic)

(595/6060)*100
```

```{r percentage new onset harmful ideation}
dat %>%
  filter(!is.na(NEW_harmful_ideation_pandemic)) %>%
  freq(NEW_harmful_ideation_pandemic)

(6823/20753)*100

dat %>%
   filter( !is.na(age_category_COVID_baseline) & 
             !is.na(gender_cleaned) &
             !is.na(race_binary) & 
             !is.na(NEW_harmful_ideation_pandemic) &
             !is.na(highest_education) &
             !is.na(mental_health_diagnosis) &
             !is.na(paid_employment_key_worker) & 
             !is.na(vulnerable_group_member) &
             !is.na(panworry_total_score) & 
             !is.na(lost_someone_before_HI_final) &
             !is.na(positive_covid_test_before_HI_final) &
             !is.na(increased_loneliness_during_pandemic) &
             !is.na(main_eco_change_before_HI_final)  &
             !is.na(increased_loneliness_during_pandemic) &
             !is.na(living_situation_change_before_HI_final) 
           ) %>%
   freq(NEW_harmful_ideation_pandemic)

(1482/3888)*100
```


```{r percentage new onset self-harm}
dat %>%
  filter(!is.na(NEW_selfharm_pandemic)) %>%
  freq(NEW_selfharm_pandemic)

(1056/30309)*100

dat %>%
   filter( !is.na(age_category_COVID_baseline) & 
             !is.na(gender_cleaned) &
             !is.na(race_binary) & 
             !is.na(NEW_selfharm_pandemic) &
             !is.na(highest_education) &
             !is.na(mental_health_diagnosis) &
             !is.na(paid_employment_key_worker) & 
             !is.na(vulnerable_group_member) &
             !is.na(panworry_total_score) & 
             !is.na(lost_someone_before_SH_final) &
             !is.na(positive_covid_test_before_SH_final) &
             !is.na(increased_loneliness_during_pandemic) &
             !is.na(main_eco_change_before_SH_final)  &
             !is.na(increased_loneliness_during_pandemic) &
             !is.na(living_situation_change_before_SH_final) 
           ) %>%
   freq(NEW_selfharm_pandemic)

(328/7066)*100
```

## Percentage new onset - NBR only
```{r percentage new onset binge eating NBR only}
dat %>%
  filter(sample == "NBR") %>%
  filter(!is.na(NEW_binge_eating_pandemic)) %>%
  freq(NEW_binge_eating_pandemic)

(1610/11473)*100

dat %>%
  filter(sample == "NBR") %>%
  filter(!is.na(NEW_binge_eating_pandemic)) %>%
   filter( !is.na(age_category_COVID_baseline) & 
             !is.na(gender_cleaned) &
             !is.na(race_binary) & 
             !is.na(NEW_binge_eating_pandemic) &
             !is.na(highest_education) &
             !is.na(mental_health_diagnosis) &
             !is.na(paid_employment_key_worker) & 
             !is.na(vulnerable_group_member) &
             !is.na(panworry_total_score) & 
             !is.na(positive_covid_test_before_BE_final) &
             !is.na(lost_someone_before_BE_final) &
             !is.na(increased_loneliness_during_pandemic) &
             !is.na(main_eco_change_before_BE_final)  &
             !is.na(increased_loneliness_during_pandemic) &
             !is.na(living_situation_change_before_BE_final)
          ) %>%
   freq(NEW_binge_eating_pandemic)

(323/2335)*100
```

```{r percentage new onset low weight NBR only}
dat %>%
  filter(sample == "NBR") %>%
  filter(!is.na(NEW_low_weight_pandemic)) %>%
  freq(NEW_low_weight_pandemic)

(904/10757)*100

dat %>%
  filter(sample == "NBR") %>%
   filter( !is.na(age_category_COVID_baseline) & 
             !is.na(gender_cleaned) &
             !is.na(race_binary) & 
             !is.na(NEW_low_weight_pandemic) &
             !is.na(highest_education) &
             !is.na(mental_health_diagnosis) &
             !is.na(paid_employment_key_worker) & 
             !is.na(vulnerable_group_member) &
             !is.na(panworry_total_score) & 
             !is.na(lost_someone_before_LW_final) &
             !is.na(positive_covid_test_before_LW_final) &
             !is.na(increased_loneliness_during_pandemic) &
             !is.na(main_eco_change_before_LW_final)  &
             !is.na(increased_loneliness_during_pandemic) &
             !is.na(living_situation_change_before_LW_final) &
             !is.na(ocd.compulsive_beh_mental_act_binary) &
             !is.na(ocd.repetitive_unpleasant_thoughts_binary)
           ) %>%
   freq(NEW_low_weight_pandemic)

(115/1788)*100
```

```{r percentage new onset harmful ideation}
dat %>%
  filter(sample == "NBR") %>%
  filter(!is.na(NEW_harmful_ideation_pandemic)) %>%
  freq(NEW_harmful_ideation_pandemic)

(1922/11505)*100

dat %>%
  filter(sample == "NBR") %>%
   filter( !is.na(age_category_COVID_baseline) & 
             !is.na(gender_cleaned) &
             !is.na(race_binary) & 
             !is.na(NEW_harmful_ideation_pandemic) &
             !is.na(highest_education) &
             !is.na(mental_health_diagnosis) &
             !is.na(paid_employment_key_worker) & 
             !is.na(vulnerable_group_member) &
             !is.na(panworry_total_score) & 
             !is.na(lost_someone_before_HI_final) &
             !is.na(positive_covid_test_before_HI_final) &
             !is.na(increased_loneliness_during_pandemic) &
             !is.na(main_eco_change_before_HI_final)  &
             !is.na(increased_loneliness_during_pandemic) &
             !is.na(living_situation_change_before_HI_final) 
           ) %>%
   freq(NEW_harmful_ideation_pandemic)

(347/1816)*100
```

```{r percentage new onset self harm NBR only}
dat %>%
  filter(sample == "NBR") %>%
  filter(!is.na(NEW_selfharm_pandemic)) %>%
  freq(NEW_selfharm_pandemic)

(274/14494)*100

dat %>%
  filter(sample == "NBR") %>%
   filter( !is.na(age_category_COVID_baseline) & 
             !is.na(gender_cleaned) &
             !is.na(race_binary) & 
             !is.na(NEW_selfharm_pandemic) &
             !is.na(highest_education) &
             !is.na(mental_health_diagnosis) &
             !is.na(paid_employment_key_worker) & 
             !is.na(vulnerable_group_member) &
             !is.na(panworry_total_score) & 
             !is.na(lost_someone_before_SH_final) &
             !is.na(positive_covid_test_before_SH_final) &
             !is.na(increased_loneliness_during_pandemic) &
             !is.na(main_eco_change_before_SH_final)  &
             !is.na(increased_loneliness_during_pandemic) &
             !is.na(living_situation_change_before_SH_final) 
           ) %>%
   freq(NEW_selfharm_pandemic)

(62/2650)*100
```


# Freq tables
## Whole sample
```{r table summaries whole sample}
# Number of participants
dat_final %>%
  nrow()

# Median of BMIs
mean(na.omit(dat_final$lowest_bmi_final))
sd(na.omit(dat_final$lowest_bmi_final))
mean(na.omit(dat_final$dem.bmi_highest_cop))
sd(na.omit(dat_final$dem.bmi_highest_cop))
mean(na.omit(dat_final$dem.bmi_signup_cop))
sd(na.omit(dat_final$dem.bmi_signup_cop))

dat_final %>%
  select(age_category_COVID_baseline,
         gender_cleaned,
         race_categories,
         highest_education,
         sex_binary_numeric
         ) %>%
  tbl_summary(missing_text = "Missing")


dat_final %>%
  filter(is.na(gender_cleaned)) %>%
  freq(sample)
```

## Binge eating
```{r table summaries binge eating}
# Number of participants
binge_eating_group %>%
  nrow()

# Mean of BMIs
mean(na.omit(binge_eating_group$lowest_bmi_final))
sd(na.omit(binge_eating_group$lowest_bmi_final))
mean(na.omit(binge_eating_group$dem.bmi_highest_cop))
sd(na.omit(binge_eating_group$dem.bmi_highest_cop))
mean(na.omit(binge_eating_group$dem.bmi_signup_cop))
sd(na.omit(binge_eating_group$dem.bmi_signup_cop))

binge_eating_group %>%
  select(age_category_COVID_baseline,
         gender_cleaned,
         race_categories,
         highest_education
         ) %>%
  tbl_summary(missing_text = "Missing")

binge_eating_group %>%
  freq(sex_binary_numeric)
```

## Low weight
```{r table summaries low weight}
# Number of participants
low_weight_group %>%
  nrow()

# Median of BMIs
mean(na.omit(low_weight_group$lowest_bmi_final))
sd(na.omit(low_weight_group$lowest_bmi_final))
mean(na.omit(low_weight_group$dem.bmi_highest_cop))
sd(na.omit(low_weight_group$dem.bmi_highest_cop))
mean(na.omit(low_weight_group$dem.bmi_signup_cop))
sd(na.omit(low_weight_group$dem.bmi_signup_cop))

low_weight_group %>%
  select(age_category_COVID_baseline,
         gender_cleaned,
         race_categories,
         highest_education
         ) %>%
  tbl_summary(missing_text = "Missing")

low_weight_group %>%
  freq(sex_binary_numeric)

```

## Harmful ideation
```{r table summaries harmful ideation}
# Number of participants
harmful_ideation_group %>%
  nrow()

# Median of BMIs
mean(na.omit(harmful_ideation_group$lowest_bmi_final))
sd(na.omit(harmful_ideation_group$lowest_bmi_final))
mean(na.omit(harmful_ideation_group$dem.bmi_highest_cop))
sd(na.omit(harmful_ideation_group$dem.bmi_highest_cop))
mean(na.omit(harmful_ideation_group$dem.bmi_signup_cop))
sd(na.omit(harmful_ideation_group$dem.bmi_signup_cop))

harmful_ideation_group %>%
  select(age_category_COVID_baseline,
         gender_cleaned,
         race_categories,
         highest_education
         ) %>%
  tbl_summary(missing_text = "Missing")

harmful_ideation_group %>%
  freq(sex_binary_numeric)
```

## Self-harm 
```{r table summaries self-harm }
# Number of participants
selfharm_group %>%
  nrow()

# Median of BMIs
mean(na.omit(selfharm_group$lowest_bmi_final))
sd(na.omit(selfharm_group$lowest_bmi_final))
mean(na.omit(selfharm_group$dem.bmi_highest_cop))
sd(na.omit(selfharm_group$dem.bmi_highest_cop))
mean(na.omit(selfharm_group$dem.bmi_signup_cop))
sd(na.omit(selfharm_group$dem.bmi_signup_cop))

selfharm_group %>%
  select(age_category_COVID_baseline,
         gender_cleaned,
         race_categories,
         highest_education
         ) %>%
  tbl_summary(missing_text = "Missing")

selfharm_group %>%
  freq(sex_binary_numeric)
```

# Additional info
Of the NBR sample, which cohort are they from?
```{r NBR which cohrt}
nbr_info <- read.csv("/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data_raw/nbr_additional_info/coping_participants_export_20200730_hashed.csv")

nbr_info <- nbr_info %>%
  select(ID = NBR.ID,
         cohort)

# Merge
dat_filtered_merged <- dplyr::left_join(dat_final,
                        nbr_info,
                        by ="ID"
                        )

dat_filtered_merged %>%
  filter(sample == "NBR") %>%
  freq(cohort)
```

# Freq tables of exposures split by outcome
## Binge eating 
```{r binge eating exposures split by outcome}
# Age
binge_eating_group %>% 
  group_by(age_category_COVID_baseline) %>%
  freq(NEW_binge_eating_pandemic)

# Gender
binge_eating_group %>% 
  group_by(gender_cleaned) %>%
  freq(NEW_binge_eating_pandemic)

# Race
binge_eating_group %>% 
  group_by(race_binary) %>%
  freq(NEW_binge_eating_pandemic)

# education
binge_eating_group %>% 
  group_by(highest_education) %>%
  freq(NEW_binge_eating_pandemic)

# Mental health diagnosis
binge_eating_group %>% 
  group_by(mental_health_diagnosis) %>%
  freq(NEW_binge_eating_pandemic)

# Paid employment / key worker
binge_eating_group %>% 
  group_by(paid_employment_key_worker) %>%
  freq(NEW_binge_eating_pandemic)

# Vulnerable group member
binge_eating_group %>% 
  group_by(vulnerable_group_member) %>%
  freq(NEW_binge_eating_pandemic)

# Pan worry total score
binge_eating_group %>% 
  group_by(panworry_total_score) %>%
  freq(NEW_binge_eating_pandemic)

# COVID infection
binge_eating_group %>% 
  group_by(positive_covid_test_before_BE_final) %>%
  freq(NEW_binge_eating_pandemic)

# Loss of loved due to COVID
binge_eating_group %>% 
  group_by(lost_someone_before_BE_final) %>%
  freq(NEW_binge_eating_pandemic)

# Loneliness
binge_eating_group %>% 
  group_by(increased_loneliness_during_pandemic) %>%
  freq(NEW_binge_eating_pandemic)

# Main eco change
binge_eating_group %>% 
  group_by(main_eco_change_before_BE_final) %>%
  freq(NEW_binge_eating_pandemic)

# Living situation change
binge_eating_group %>% 
  group_by(living_situation_change_before_BE_final) %>%
  freq(NEW_binge_eating_pandemic)
```

## Low weight
```{r low weight exposures split by outcome}
# Age
low_weight_group %>% 
  group_by(age_category_COVID_baseline) %>%
  freq(NEW_low_weight_pandemic)

# Gender
low_weight_group %>% 
  group_by(gender_cleaned) %>%
  freq(NEW_low_weight_pandemic)

# Race
low_weight_group %>% 
  group_by(race_binary) %>%
  freq(NEW_low_weight_pandemic)

# education
low_weight_group %>% 
  group_by(highest_education) %>%
  freq(NEW_low_weight_pandemic)

# Mental health diagnosis
low_weight_group %>% 
  group_by(mental_health_diagnosis) %>%
  freq(NEW_low_weight_pandemic)

# Paid employment / key worker
low_weight_group %>% 
  group_by(paid_employment_key_worker) %>%
  freq(NEW_low_weight_pandemic)

# Vulnerable group member
low_weight_group %>% 
  group_by(vulnerable_group_member) %>%
  freq(NEW_low_weight_pandemic)

# Pan worry total score
low_weight_group %>% 
  group_by(panworry_total_score) %>%
  freq(NEW_low_weight_pandemic)

# COVID infection
low_weight_group %>% 
  group_by(positive_covid_test_before_LW_final) %>%
  freq(NEW_low_weight_pandemic)

# Loss of loved due to COVID
low_weight_group %>% 
  group_by(lost_someone_before_LW_final) %>%
  freq(NEW_low_weight_pandemic)

# Loneliness
low_weight_group %>% 
  group_by(increased_loneliness_during_pandemic) %>%
  freq(NEW_low_weight_pandemic)

# Main eco change
low_weight_group %>% 
  group_by(main_eco_change_before_LW_final) %>%
  freq(NEW_low_weight_pandemic)

# Living situation change
low_weight_group %>% 
  group_by(living_situation_change_before_LW_final) %>%
  freq(NEW_low_weight_pandemic)


# Compulsive beh/ mental act
low_weight_group %>% 
  group_by(ocd.compulsive_beh_mental_act_binary) %>%
  freq(NEW_low_weight_pandemic)


# repetitive unpleasant thoughts
low_weight_group %>% 
  group_by(ocd.repetitive_unpleasant_thoughts_binary) %>%
  freq(NEW_low_weight_pandemic)
```

## Harmful ideation
```{r harmful ideation exposures split by outcome}
# Age
harmful_ideation_group %>% 
  group_by(age_category_COVID_baseline) %>%
  freq(NEW_harmful_ideation_pandemic)

# Gender
harmful_ideation_group %>% 
  group_by(gender_cleaned) %>%
  freq(NEW_harmful_ideation_pandemic)

# Race
harmful_ideation_group %>% 
  group_by(race_binary) %>%
  freq(NEW_harmful_ideation_pandemic)

# Education
harmful_ideation_group %>% 
  group_by(highest_education) %>%
  freq(NEW_harmful_ideation_pandemic)

# Mental health diagnosis
harmful_ideation_group %>% 
  group_by(mental_health_diagnosis) %>%
  freq(NEW_harmful_ideation_pandemic)

# Paid employment / key worker
harmful_ideation_group %>% 
  group_by(paid_employment_key_worker) %>%
  freq(NEW_harmful_ideation_pandemic)

# Vulnerable group member
harmful_ideation_group %>% 
  group_by(vulnerable_group_member) %>%
  freq(NEW_harmful_ideation_pandemic)

# Pan worry total score
harmful_ideation_group %>% 
  group_by(panworry_total_score) %>%
  freq(NEW_harmful_ideation_pandemic)

# COVID infection
harmful_ideation_group %>% 
  group_by(positive_covid_test_before_HI_final) %>%
  freq(NEW_harmful_ideation_pandemic)

# Loss of loved due to COVID
harmful_ideation_group %>% 
  group_by(lost_someone_before_HI_final) %>%
  freq(NEW_harmful_ideation_pandemic)

# Loneliness
harmful_ideation_group %>% 
  group_by(increased_loneliness_during_pandemic) %>%
  freq(NEW_harmful_ideation_pandemic)

# Main eco change
harmful_ideation_group %>% 
  group_by(main_eco_change_before_HI_final) %>%
  freq(NEW_harmful_ideation_pandemic)

# Living situation change
harmful_ideation_group %>% 
  group_by(living_situation_change_before_HI_final) %>%
  freq(NEW_harmful_ideation_pandemic)

```
   
## Harmful ideation
```{r self-harm exposures split by outcome}
# Age
selfharm_group %>% 
  group_by(age_category_COVID_baseline) %>%
  freq(NEW_selfharm_pandemic)

# Gender
selfharm_group %>% 
  group_by(gender_cleaned) %>%
  freq(NEW_selfharm_pandemic)

# Race
selfharm_group %>% 
  group_by(race_binary) %>%
  freq(NEW_selfharm_pandemic)

# Education
selfharm_group %>% 
  group_by(highest_education) %>%
  freq(NEW_selfharm_pandemic)

# Mental health diagnosis
selfharm_group %>% 
  group_by(mental_health_diagnosis) %>%
  freq(NEW_selfharm_pandemic)

# Paid employment / key worker
selfharm_group %>% 
  group_by(paid_employment_key_worker) %>%
  freq(NEW_selfharm_pandemic)

# Vulnerable group member
selfharm_group %>% 
  group_by(vulnerable_group_member) %>%
  freq(NEW_selfharm_pandemic)

# Pan worry total score
selfharm_group %>% 
  group_by(panworry_total_score) %>%
  freq(NEW_selfharm_pandemic)

# COVID infection
selfharm_group %>% 
  group_by(positive_covid_test_before_SH_final) %>%
  freq(NEW_selfharm_pandemic)

# Loss of loved due to COVID
selfharm_group %>% 
  group_by(lost_someone_before_SH_final) %>%
  freq(NEW_selfharm_pandemic)

# Loneliness
selfharm_group %>% 
  group_by(increased_loneliness_during_pandemic) %>%
  freq(NEW_selfharm_pandemic)

# Main eco change
selfharm_group %>% 
  group_by(main_eco_change_before_SH_final) %>%
  freq(NEW_selfharm_pandemic)

# Living situation change
selfharm_group %>% 
  group_by(living_situation_change_before_SH_final) %>%
  freq(NEW_selfharm_pandemic)
```         

```{r age COPING data to check IDs}
age_dat_edgi_coping <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data/latest_freeze/coping_edgi/demographics/age_coping_edgi_clean.rds")
dim(age_dat_edgi_coping)
colnames(age_dat_edgi_coping)

age_dat_glad_coping <- readRDS(file =  "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data/latest_freeze/coping_glad/demographics/age_coping_glad_clean.rds")
dim(age_dat_glad_coping)
colnames(age_dat_glad_coping)

# NBR
age_dat_nbr <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data/latest_freeze/coping_nbr/demographics/age_coping_nbr_clean.rds")
dim(age_dat_nbr)
colnames(age_dat_nbr)
```


