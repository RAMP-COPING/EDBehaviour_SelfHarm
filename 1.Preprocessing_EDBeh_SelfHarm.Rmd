---
title: "Preprocessing_EDBeh_SelfHarm"
author: "Helena Davies"
date: "21/04/2021"
output: html_document
---

ORDER OF SCRIPTS
1. Pre-processing
2. Baseline ED groupings
3. Merging
4. Deriving variables
Configure global options for all chunks
```{r Setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,
  comment = '',
  prompt = FALSE,
  cache = FALSE
  )
```

Clear global environment prior to initiation
```{r Clear global environment}
remove(list = ls())
```

Add the add_numeric function - used to convert character variables into numeric variables
Add the remove_duplicates function - used to deduplicate and remove NAs from IDs
Add the sumscores function - used to generate sumscores
Add the package_check function - used to install and load dependencies
Add the imp_check function - used to check variables for implausible values
```{r Read in functions}
source(file = "/Users/helenadavies/werk/ilovedata/scripts/functions/add_numeric.R")
source(file = "/Users/helenadavies/werk/ilovedata/scripts/functions/remove_duplicates.R")
source(file = "/Users/helenadavies/werk/ilovedata/scripts/functions/package_check.R")
source("./functions.R")
```

Use package_check to install and load dependencies
Load tidyverse last
```{r Install load dependencies}
packages <- c("summarytools", "sjlabelled", "Amelia", "gtsummary", "tidyverse")
package_check(packages)
```

Retrieve recent date
We are using the recent date to save files with paste0() as an extension to not overwrite old versions
```{r Recent date}
date <- Sys.Date()
date
```

Specify cohort
```{r Specify cohort}
GLAD = FALSE
EDGI = FALSE
RAMP = FALSE
NBR = FALSE
COPING = TRUE
```

# Read in cleaned data 
## Age
This should include:
- Age at signup (i.e., EDGI and GLAD signup not COPING questionnaire)
- AGE AT COVID ASSESSMENT (i.e., EDGI and GLAD COPING baseline questionnaire NOT GLAD/EDGI signup)
```{r read in age cleaned data}
# STILL NEED
```

## Gender/sex
```{r read in gender/sex cleaned data}
if(EDGI == TRUE){
# EDGI
gender_sex_edgi_dat <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data/latest_freeze/edgi/demographics/sex_gender_sexuality_edgi_clean.rds")
dim(gender_sex_edgi_dat)
colnames(gender_sex_edgi_dat)
}

if(GLAD == TRUE){
# GLAD
gender_sex_glad_dat <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data/latest_freeze/glad/demographics/sex_gender_sexuality_glad_clean.rds")
dim(gender_sex_glad_dat)
colnames(gender_sex_glad_dat)
}

if(NBR == TRUE){
# NBR
# Still need!
}

if(RAMP == TRUE){
# RAMP
gender_sex_dat_ramp <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data/latest_freeze/ramp/demographics/sex_gender_sexuality_ramp_clean.rds")
dim(gender_sex_dat_ramp)
colnames(gender_sex_dat_ramp)
}

# Merge
#gender_sex_dat <- gender_sex_edgi_dat %>%
#  bind_rows(gender_sex_glad_dat,
#            gender_sex_nbr_dat,
#            gender_sex_dat_ramp)
```

## Ethnicity 
```{r read in ethnicity cleaned data}
if(EDGI == TRUE){
# EDGI
ethnicity_dat_edgi <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data/latest_freeze/edgi/demographics/ethnicity_edgi_clean.rds")
dim(ethnicity_dat_edgi)
colnames(ethnicity_dat_edgi)
}

if(GLAD == TRUE){
# GLAD
ethnicity_dat_glad <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data/latest_freeze/glad/demographics/ethnicity_glad_clean.rds")
dim(ethnicity_dat_glad)
colnames(ethnicity_dat_glad)
}

if(NBR == TRUE){
# NBR
# Still need!
}

if(RAMP == TRUE){
# RAMP
ethnicity_dat_ramp <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data/latest_freeze/ramp/demographics/ethnicity_RAMP_2021-08-20.rds")
dim(ethnicity_dat_ramp)
colnames(ethnicity_dat_ramp)
}

# Merge
#ethnicity_dat <- ethnicity_dat_edgi %>%
#  bind_rows(ethnicity_dat_glad,
#            ethnicity_dat_nbr,
#            ethnicity_dat_ramp)
```

# Education & Employment
Read in employment/education data & clean
NB: These have been cleaned but will use my version as need them as one variable and also need prepan and pandemic.
```{r exclude cols demographics}
if(RAMP == TRUE | GLAD == TRUE | EDGI == TRUE | NBR == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate",
                  "endDate")
}
```

### Read in RAMP employment data
```{r Read in data RAMP employment}
if(RAMP == TRUE){
ramp.dem.employ.raw <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data_raw/latest_freeze/ramp/employ_ramp.rds")
dim(ramp.dem.employ.raw)
colnames(ramp.dem.employ.raw)
}
```

Select variables RAMP employment
```{r Select variables RAMP employment}
if(RAMP == TRUE){
ramp.dem.employ.raw.id <- ramp.dem.employ.raw %>% #new dataset with ID
  drop_na(`Login ID`) %>% # Drop NAs
  remove_duplicates("Login ID") %>% # Remove duplicates based on ID
  add_column(cohort_name = "ramp", .before = "startDate") %>% #create new column 
  select(
         ID = `Login ID`, # ID
         cohort_name, # Sample
         everything()
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  mutate_if(is.numeric, ~na_if(., -99)) %>%
  mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) %>% # Drop empty factor levels
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(ramp.dem.employ.raw.id)
# Inspect colnames
colnames(ramp.dem.employ.raw.id)
#Differences
dim(ramp.dem.employ.raw)[1]-dim(ramp.dem.employ.raw.id)[1]
}
```

### Read in NBR employment data
```{r Read in data NBR employment}
if(NBR == TRUE){
nbr.dem.employ.raw <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data_raw/latest_freeze/coping_nbr/employ_coping_nbr.rds")
dim(nbr.dem.employ.raw)
colnames(nbr.dem.employ.raw)

}
```

Select variables NBR employment
```{r Select variables NBR employment}
if(NBR == TRUE){
nbr.dem.employ.raw.id <- nbr.dem.employ.raw%>% #new dataset with ID
  drop_na(subjectid) %>% # Drop NAs
  remove_duplicates("subjectid") %>% # Remove duplicates based on ID
  add_column(cohort_name = "nbr", .before = "startDate") %>% #create new column 
  select(
         ID = subjectid, # ID
         cohort_name, # Sample
         #startDate_baseline = startDate,
         everything()
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  mutate_if(is.numeric, ~na_if(., -99)) %>%
  mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) %>% # Drop empty factor levels
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(nbr.dem.employ.raw.id)
# Inspect colnames
colnames(nbr.dem.employ.raw.id)
#Differences
dim(nbr.dem.employ.raw)[1]-dim(nbr.dem.employ.raw.id)[1]
}
```

### Read in EDGI COPING employment data
```{r Read in data EDGI COPING employment}
if(EDGI == TRUE){
edgi.coping.dem4.employ.raw <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data_raw/latest_freeze/coping_edgi/employ_coping_edgi.rds")
dim(edgi.coping.dem4.employ.raw)
colnames(edgi.coping.dem4.employ.raw)

}
```

Select variables
```{r Select variables EDGI employment}
if(EDGI == TRUE){
edgi.coping.dem4.employ.raw.id <- edgi.coping.dem4.employ.raw %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  remove_duplicates("externalDataReference") %>% # Remove duplicates based on ID
  add_column(cohort_name = "coping_edgi", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         #startDate_baseline = startDate,
         everything()
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  mutate_if(is.numeric, ~na_if(., -99)) %>%
  mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) %>% # Drop empty factor levels
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(edgi.coping.dem4.employ.raw.id)
# Inspect colnames
colnames(edgi.coping.dem4.employ.raw.id)
#Differences
dim(edgi.coping.dem4.employ.raw)[1]-dim(edgi.coping.dem4.employ.raw.id)[1]

}
```

### Read in GLAD COPING employment data
```{r Read in data GLAD employment}
if(GLAD == TRUE){
glad.coping.dem4.employ.raw <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data_raw/latest_freeze/coping_glad/employ_coping_glad.rds")
dim(glad.coping.dem4.employ.raw)
colnames(glad.coping.dem4.employ.raw)
}
```

Select variables
```{r Select variables GLAD employment}
if(GLAD == TRUE){
glad.coping.dem4.employ.raw.id <- glad.coping.dem4.employ.raw %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  remove_duplicates("externalDataReference") %>% # Remove duplicates based on ID
  add_column(cohort_name = "coping_glad", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         # startDate_baseline = startDate,
         everything()
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  mutate_if(is.numeric, ~na_if(., -99)) %>%
  mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) %>% # Drop empty factor levels
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(glad.coping.dem4.employ.raw.id)
# Inspect colnames
colnames(glad.coping.dem4.employ.raw.id)
#Differences
dim(glad.coping.dem4.employ.raw)[1]-dim(glad.coping.dem4.employ.raw.id)[1]
}
```

### Read in EDGI sign-up demographics data
```{r Read in data EDGI demographics 3}
if(EDGI == TRUE){
edgi.dem3.raw <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data_raw/latest_freeze/edgi/dem_edgi.rds")
dim(edgi.dem3.raw)
colnames(edgi.dem3.raw)
}
```

Select variables EDGI demographics 3
```{r Select variables EDGI demographics 3}
if(EDGI == TRUE){
edgi.dem3.raw.id <- edgi.dem3.raw %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  remove_duplicates("externalDataReference") %>% # Remove duplicates based on ID
  add_column(cohort_name = "coping_edgi", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         startDate_prepandemic = startDate,
         # age_unc = dem.how_old_are_you_now.txt,
         # dem.month,
         # dem.day,
         # dem.year,
         # ethnicity_unc = demographics.what_is_your_ethnic_origin,
         # ethnicity_unc_text = demographics.what_is_your_ethnic_origin.txt,
         # transgender = demographics.do_you_consider_yourself_to_be_transgender,
         demographics.collegeuniversity,
         demographics.asa_levels,
         demographics.cse,
         demographics.gcse,
         demographics.nvq,
         demographics.other.1,
         demographics.none_of_the_above,
         demographics.other_text.txt.1
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  mutate_if(is.numeric, ~na_if(., -99)) %>%
  mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) %>% # Drop empty factor levels
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))
  

# Inspect dimensions
dim(edgi.dem3.raw.id)
# Inspect colnames
colnames(edgi.dem3.raw.id)
#Differences
dim(edgi.dem3.raw)[1]-dim(edgi.dem3.raw.id)[1]
}
```

### Read in GLAD sign-up demographics data
```{r Read in data GLAD demographics}
if(GLAD == TRUE){
glad.dem3.raw <- readRDS(file = "../data_raw/glad/dem_glad.rds")
"/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data_raw/latest_freeze/glad/dem_glad.rds"
dim(glad.dem3.raw)
colnames(glad.dem3.raw)
}
```

Select variables
```{r Select variables GLAD demographics}
if(GLAD == TRUE){
glad.dem3.raw.id <- glad.dem3.raw %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  remove_duplicates("externalDataReference") %>% # Remove duplicates based on ID
  add_column(cohort_name = "coping_glad", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         startDate_prepandemic = startDate,
         age_unc = dem.how_old_are_you_now.txt,
         dem.day,
         dem.month,
         dem.year,
         ethnicity_unc = dem.questions_based_ethnic_origin,
         ethnicity_unc_text = dem.questions_based_ethnic_origin.txt,
         dem.college_or_university_degree,
         dem.a_levelsas_levels_or_equivalent,
         dem.o_levelsgcses_or_equivalent,
         dem.cses_or_equivalent,
         dem.nvq_or_hnd_or_hnc_or_equivalent,
         dem.other_professional_qualifications,
         dem.other_professional_qualifications_text.txt,
         dem.none_of_the_above_education = dem.none_of_the_above,
         transgender = dem.do_you_identify_as_transgender
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  mutate_if(is.numeric, ~na_if(., -99)) %>%
  mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) %>% # Drop empty factor levels
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(glad.dem3.raw.id)
# Inspect colnames
colnames(glad.dem3.raw.id)
#Differences
dim(glad.dem3.raw)[1]-dim(glad.dem3.raw.id)[1]
}
```

# Run source scripts
Employment and key worker source script
```{r employment and key worker source script}
if(NBR == TRUE | EDGI == TRUE | GLAD == TRUE | RAMP == TRUE) {
source("./employment_ALLdatasets.R")
}
```

Highest education source script (prepan and during pan)
```{r employment and key worker source script}
if(NBR == TRUE | EDGI == TRUE | GLAD == TRUE | RAMP == TRUE) {
source("./education_ALLdatasets.R")
}
```

## Mental health diagnosis
```{r read in mental health diagnosis cleaned data}
# STILL NEED
```

### GLAD ED100K self-reported diagnosis
```{r read in GLAD ED100K self reported diagnosis}
glad_ed100k_selfreport <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data/latest_freeze/glad/eating/selfreported_ed100k_diagnoses_glad_clean.rds")
dim(glad_ed100k_selfreport)
colnames(glad_ed100k_selfreport)
```

# Demographics 
## GLAD 2
### Read in data
```{r Read in data GLAD COPING demographic 2}
if(GLAD == TRUE){
glad.coping.dem2.raw <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data_raw/latest_freeze/coping_glad/dem2_coping_glad.rds")
dim(glad.coping.dem2.raw)
colnames(glad.coping.dem2.raw)
}
```

Select variables GLAD COPING demographic 2
```{r Select variables GLAD COPING demographic 2}
if(GLAD == TRUE){
glad.coping.dem2.raw.id <- glad.coping.dem2.raw %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  remove_duplicates("externalDataReference") %>% # Remove duplicates based on ID
  add_column(cohort_name = "coping_glad", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference,# ID
         cohort_name, # Sample
         everything()
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  mutate_if(is.numeric, ~na_if(., -99)) %>%
  mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) %>% # Drop empty factor levels
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(glad.coping.dem2.raw.id)
# Inspect colnames
colnames(glad.coping.dem2.raw.id)
#Differences
dim(glad.coping.dem2.raw)[1]-dim(glad.coping.dem2.raw.id)[1]
}
```

# Demographics 
## EDGI 2
### Read in data
```{r Read in data EDGI COPING demographics 2}
if(EDGI == TRUE){
edgi.coping.dem2.raw <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data_raw/latest_freeze/coping_edgi/dem2_coping_edgi.rds")
dim(edgi.coping.dem2.raw)
colnames(edgi.coping.dem2.raw)
}
```

Select variables EDGI COPING demographics 2
```{r Select variables EDGI COPING demographics 2}
if(EDGI == TRUE){
edgi.coping.dem2.raw.id <- edgi.coping.dem2.raw %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  remove_duplicates("externalDataReference") %>% # Remove duplicates based on ID
  add_column(cohort_name = "coping_edgi", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference,# ID
         cohort_name, # Sample
         everything()
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  mutate_if(is.numeric, ~na_if(., -99)) %>%
  mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) %>% # Drop empty factor levels
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(edgi.coping.dem2.raw.id)
# Inspect colnames
colnames(edgi.coping.dem2.raw.id)
#Differences
dim(edgi.coping.dem2.raw)[1]-dim(edgi.coping.dem2.raw.id)[1]
}
```

# Demographics 
## NBR 2
### Read in data
```{r Read in data NBR demographics 2}
if(NBR == TRUE){
nbr.dem2.raw <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data_raw/latest_freeze/coping_nbr/dem_coping_nbr.rds")
dim(nbr.dem2.raw)
colnames(nbr.dem2.raw)
}
```

Select variables
```{r Select variables NBR demographics 2}
if(NBR == TRUE){
nbr.dem2.raw.id <- nbr.dem2.raw %>% #new dataset with ID
  drop_na(subjectid) %>% # Drop NAs
  remove_duplicates("subjectid") %>% # Remove duplicates based on ID
  add_column(cohort_name = "nbr", .before = "startDate") %>% #create new column 
  select(
         ID = subjectid,# ID
         cohort_name, # Sample
         everything()
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  mutate_if(is.numeric, ~na_if(., -99)) %>%
  mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) %>% # Drop empty factor levels
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(nbr.dem2.raw.id)
# Inspect colnames
colnames(nbr.dem2.raw.id)
#Differences
dim(nbr.dem2.raw)[1]-dim(nbr.dem2.raw.id)[1]
}
```

# Demographics 
## RAMP
### Read in data
```{r Read in data RAMP demographics}
if(RAMP == TRUE){
ramp.dem.raw <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data_raw/latest_freeze/ramp/dem_ramp.rds")
dim(ramp.dem.raw)
colnames(ramp.dem.raw)
}
```

Select variables
```{r Select variables RAMP demographics}
if(RAMP == TRUE){
ramp.dem.raw.id <- ramp.dem.raw %>% #new dataset with ID
  drop_na(`Login ID`) %>% # Drop NAs
  remove_duplicates("Login ID") %>% # Remove duplicates based on ID
  add_column(cohort_name = "ramp", .before = "startDate") %>% #create new column
  select(
         ID = `Login ID`,# ID
         cohort_name, # Sample
         startDate_baseline = startDate,
         everything()
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  mutate_if(is.numeric, ~na_if(., -99)) %>%
  mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) %>% # Drop empty factor levels
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))
# Inspect dimensions
dim(ramp.dem.raw.id)
# Inspect colnames
colnames(ramp.dem.raw.id)
#Differences
dim(ramp.dem.raw)[1]-dim(ramp.dem.raw.id)[1]
}
```

# Pandemic worry at baseline
## EDGI
### Read in data 
```{r Read in data EDGI baseline pandemic worry}
if(EDGI == TRUE){
edgi_pan_worry <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data_raw/latest_freeze/coping_edgi/panworry_coping_edgi.rds")
dim(edgi_pan_worry)
colnames(edgi_pan_worry)
}
```

Select variables EDGI baseline pandemic worry
```{r Select variables EDGI baseline pandemic worry}
if(EDGI == TRUE){
exclude_cols_dem <- c("ID",
                      "cohort_name")

edgi_pan_worry.id <- edgi_pan_worry %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  remove_duplicates("externalDataReference") %>% # Remove duplicates based on ID
  add_column(cohort_name = "coping_edgi", .before = "panworry.impact_on_your_employment_status") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name,
         everything()
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  mutate_if(is.numeric, ~na_if(., -99)) %>%
  mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) %>% # Drop empty factor levels
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(edgi_pan_worry.id)
# Inspect colnames
colnames(edgi_pan_worry.id)
#Differences
dim(edgi_pan_worry)[1]-dim(edgi_pan_worry.id)[1]
}

```

# Pandemic worry at baseline
## GLAD
### Read in data 
```{r Read in data GLAD baseline pandemic worry}
if(GLAD == TRUE){
glad_pan_worry <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data_raw/latest_freeze/coping_glad/panworry_coping_glad.rds")
dim(glad_pan_worry)
colnames(glad_pan_worry)
}
```

Select variables GLAD baseline pandemic worry
```{r Select variables GLAD baseline pandemic worry}
if(GLAD == TRUE){
exclude_cols_dem <- c("ID",
                      "cohort_name")

glad_pan_worry.id <- glad_pan_worry %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  remove_duplicates(externalDataReference, .keep_all = TRUE) %>% # Remove duplicates based on ID
  add_column(cohort_name = "coping_glad", .before = "panworry.impact_on_your_employment_status") %>% #create new column
  select(
         ID = externalDataReference, # ID
         cohort_name,
         everything()
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  mutate_if(is.numeric, ~na_if(., -99)) %>%
  mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) %>% # Drop empty factor levels
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(glad_pan_worry.id)
# Inspect colnames
colnames(glad_pan_worry.id)
#Differences
dim(glad_pan_worry)[1]-dim(glad_pan_worry.id)[1]
}

```

# Pandemic worry at baseline
## NBR
### Read in data 
```{r Read in data NBR baseline pandemic worry}
if(NBR == TRUE){
nbr_pan_worry <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data_raw/latest_freeze/coping_nbr/panworry_coping_nbr.rds")
dim(nbr_pan_worry)
colnames(nbr_pan_worry)
}
```

Select variables NBR baseline pandemic worry
```{r Select variables NBR baseline pandemic worry}
if(NBR == TRUE){
exclude_cols_dem <- c("ID",
                      "cohort_name")

nbr_pan_worry.id <- nbr_pan_worry %>% #new dataset with ID
  drop_na(subjectid) %>% # Drop NAs
  remove_duplicates("subjectid") %>% # Remove duplicates based on ID
  add_column(cohort_name = "nbr", .before = "panworry.impact_on_your_employment_status") %>% #create new column
  select(
     ID = subjectid, # ID
     cohort_name,
         everything()
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  mutate_if(is.numeric, ~na_if(., -99)) %>%
  mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) %>% # Drop empty factor levels
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(nbr_pan_worry.id)
# Inspect colnames
colnames(nbr_pan_worry.id)
#Differences
dim(nbr_pan_worry)[1]-dim(nbr_pan_worry.id)[1]
}

```

# Pandemic worry at baseline
## RAMP
### Read in data 
```{r Read in data RAMP baseline pandemic worry}
if(RAMP == TRUE){
ramp_pan_worry <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data_raw/latest_freeze/ramp/panworry_ramp.rds")
dim(ramp_pan_worry)
colnames(ramp_pan_worry)
}
```

Select variables
```{r Select variables RAMP baseline pandemic worry}
if(RAMP == TRUE){
exclude_cols_dem <- c("ID",
                      "cohort_name")

ramp_pan_worry.id <- ramp_pan_worry %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  remove_duplicates("externalDataReference") %>% # Remove duplicates based on ID
  add_column(cohort_name = "ramp", .before = "panworry.impact_on_your_employment_status") %>% #create new column
  select(
         ID = externalDataReference, # ID
         cohort_name,
         everything()
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  mutate_if(is.numeric, ~na_if(., -99)) %>%
  mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) %>% # Drop empty factor levels
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(ramp_pan_worry.id)
# Inspect colnames
colnames(ramp_pan_worry.id)
#Differences
dim(ramp_pan_worry)[1]-dim(ramp_pan_worry.id)[1]
}

```

# Read in EDEQ baseline data (although note that is only present in RAMP)
## RAMP 
### Read in data
```{r Read in data RAMP EDEQ baseline}
if(RAMP == TRUE){
edeq.ramp.baseline.raw <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data_raw/latest_freeze/ramp/edeq_ramp.rds")
dim(edeq.ramp.baseline.raw)
colnames(edeq.ramp.baseline.raw)
}
```

Select variables RAMP EDEQ baseline
```{r Select variables RAMP EDEQ baseline}
if(RAMP == TRUE){
edeq.ramp.baseline.raw.id <- edeq.ramp.baseline.raw %>% #new dataset with ID
  drop_na(`Login ID`) %>% # Drop NAs
  remove_duplicates("Login ID") %>% # Remove duplicates based on ID
  add_column(cohort_name = "ramp", .before = "startDate") %>% #create new column 
  select(
         ID = `Login ID`, # ID
         cohort_name, # Sample
         startDate_baseline = startDate,
         #endDate,
         edeq.deliberately_limit_amount_influence_.Wavebaseline = edeq.deliberately_limit_amount_influence,
         edeq.calories_made_body_shape_.Wavebaseline = edeq.calories_made_body_shape,
         edeq.weight_influenced_person_.Wavebaseline = edeq.weight_influenced_person,
         edeq.dissatisfied_shape_weight_.Wavebaseline = edeq.dissatisfied_shape_weight,
         edeq.nibbled_picked_snacks_grazed_.Wavebaseline = edeq.nibbled_picked_snacks_grazed,
         edeq.felt_anxious_blue_bored_.Wavebaseline = edeq.felt_anxious_blue_bored,
         edeq.felt_anxious_blue_bored.1_.Wavebaseline = edeq.felt_anxious_blue_bored.1,
         edeq.eating_behaviours_concerns_distressed_.Wavebaseline = edeq.eating_behaviours_concerns_distressed,
         edeq.deliberately_limit_amount_influence.1_.Wavebaseline = edeq.deliberately_limit_amount_influence.1,
         edeq.calories_made_body_shape.1_.Wavebaseline = edeq.calories_made_body_shape.1,
         edeq.weight_influenced_person.1_.Wavebaseline = edeq.weight_influenced_person.1,
         edeq.dissatisfied_shape_weight.1_.Wavebaseline = edeq.dissatisfied_shape_weight.1,
         edeq.eating_behaviours_concerns_distressed.1_.Wavebaseline = edeq.eating_behaviours_concerns_distressed.1,
         edeq.feelings_pandemic_felt_.Wavebaseline = edeq.feelings_pandemic_felt,
         edeq.actively_been_monitoring_your_shape_or_weight_.Wavebaseline = edeq.actively_been_monitoring_your_shape_or_weight_,
         edeq.regard_lost_control_eaten_.Wavebaseline = edeq.regard_lost_control_eaten,
         edeq.sick_means_made_shape_.Wavebaseline = edeq.sick_means_made_shape,
         edeq.diuretics_laxatives_means_shape_.Wavebaseline = edeq.diuretics_laxatives_means_shape,
         edeq.compulsive_driven_burn_calories_.Wavebaseline = edeq.compulsive_driven_burn_calories,
         edeq.nibbled_picked_snacks_grazed.1_.Wavebaseline = edeq.nibbled_picked_snacks_grazed.1,
         edeq.felt_anxious_blue_bored.2_.Wavebaseline = edeq.felt_anxious_blue_bored.2,
         edeq.felt_anxious_blue_bored.3_.Wavebaseline = edeq.felt_anxious_blue_bored.3,
         edeq.actively_been_monitoring_your_shape_or_weight_.1_.Wavebaseline = edeq.actively_been_monitoring_your_shape_or_weight_.1,
         edeq.regard_lost_control_eaten.1_.Wavebaseline = edeq.regard_lost_control_eaten.1,
         edeq.sick_means_made_shape.1_.Wavebaseline = edeq.sick_means_made_shape.1,
         edeq.diuretics_laxatives_means_shape.1_.Wavebaseline = edeq.diuretics_laxatives_means_shape.1,
         edeq.compulsive_driven_burn_calories.1_.Wavebaseline = edeq.compulsive_driven_burn_calories.1
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  #mutate_if(is.numeric, ~na_if(., -99)) %>%
  #mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
 # mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  #mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
  #mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
  #mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
  #mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(edeq.ramp.baseline.raw.id)
# Inspect colnames
colnames(edeq.ramp.baseline.raw.id)
#Differences
dim(edeq.ramp.baseline.raw)[1]-dim(edeq.ramp.baseline.raw.id)[1]
}

```

# EDEQ screener follow up B
## COPING
### Read in data
NB: The EDEQ screener is only available in follow up B across both RAMP and COPING.
```{r Read in data COPING follow up B EDEQ screener}
if(COPING == TRUE){
edeq.coping.followupb.screener.raw <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data_raw/latest_freeze/coping_followupb/ed_scid5_coping_followupb.rds")
dim(edeq.coping.followupb.screener.raw)
colnames(edeq.coping.followupb.screener.raw)
}

```

Select variables COPING follow up B EDEQ screener
```{r Select variables COPING follow up B EDEQ screener}
if(COPING == TRUE){
  exclude_cols_dem <- c("ID",
                      "cohort_name")
edeq.coping.followupb.screener.raw.id <- edeq.coping.followupb.screener.raw %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  add_column(cohort_name = "coping", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         startDate_waves = startDate,
         #endDate,
         ed_scid5.regular_episodes_eating_binges,
         ed_scid5.weigh_weighed_past_month
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  #mutate_if(is.numeric, ~na_if(., -99)) %>%
 # mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  #mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  #mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
  #mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  #mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(edeq.coping.followupb.screener.raw.id)
# Inspect colnames
colnames(edeq.coping.followupb.screener.raw.id)
#Differences
dim(edeq.coping.followupb.screener.raw)[1]-dim(edeq.coping.followupb.screener.raw.id)[1]
}
```

# EDEQ screener follow up B
## RAMP
### Read in data
```{r Read in data RAMP follow up B EDEQ screener}
if(RAMP == TRUE){
edeq.ramp.followupb.screener.raw <- readRDS(file = "XXXXXXXXXX")
dim(edeq.ramp.followupb.screener.raw)
colnames(edeq.ramp.followupb.screener.raw)

}
```

Select variables RAMP follow up B EDEQ screener
```{r Select variables RAMP follow up B EDEQ screener}
if(RAMP == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate_waves",
                  "endDate")

edeq.ramp.followupb.screener.raw.id <- edeq.ramp.followupb.screener.raw %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  add_column(cohort_name = "ramp", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         startDate_waves = startDate,
         #endDate,
         ed_scid5.regular_episodes_eating_binges,
         ed_scid5.weigh_weighed_past_month
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  #mutate_if(is.numeric, ~na_if(., -99)) %>%
 # mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  #mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  #mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
  #mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  #mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(edeq.ramp.followupb.screener.raw.id)
# Inspect colnames
colnames(edeq.ramp.followupb.screener.raw.id)
#Differences
dim(edeq.ramp.followupb.screener.raw)[1]-dim(edeq.ramp.followupb.screener.raw.id)[1]
}
```

There are data on whether people have taken a COVID test and what result they have received in two datasets: "Virus" and "Resp". "Virus" questionnaire is asked only at follow up B. The "resp" questionnaire is asked at baseline and every single follow up. I will use both to find whether someone has a positive COVID test.

# Virus follow up B
## COPING
### Read in data
```{r Read in data COPING follow up B virus}
if(COPING == TRUE){
coping.followupb.virus <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data_raw/latest_freeze/coping_followupb/virus_coping_followupb.rds")
dim(coping.followupb.virus)
colnames(coping.followupb.virus)
}
```

Select variables COPING follow up B virus
```{r Select variables COPING follow up B virus}
if(COPING == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate_waves",
                  "endDate")

coping.followupb.virus.id <- coping.followupb.virus %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  add_column(cohort_name = "coping", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         startDate_waves = startDate,
         virus.back_positive_antibodies_tests, 
         virus.past_surveys_include_covid19 
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  #mutate_if(is.numeric, ~na_if(., -99)) %>%
 # mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  #mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  #mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
  #mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  #mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(coping.followupb.virus.id)
# Inspect colnames
colnames(coping.followupb.virus.id)
#Differences
dim(coping.followupb.virus)[1]-dim(coping.followupb.virus.id)[1]
}
```

# Virus follow up B
## RAMP
### Read in data
```{r Read in data RAMP follow up B virus}
if(RAMP == TRUE){
ramp.followupb.virus <- readRDS(file = "XXXXXXX")
dim(ramp.followupb.virus)
colnames(ramp.followupb.virus)
}
```

Select variables RAMP follow up B virus
```{r Select variables RAMP follow up B virus}
if(RAMP == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate_waves",
                  "endDate")

ramp.followupb.virus.id <- ramp.followupb.virus %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  add_column(cohort_name = "coping", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         startDate_waves = startDate,
         virus.back_positive_antibodies_tests,
         virus.past_surveys_include_covid19
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  #mutate_if(is.numeric, ~na_if(., -99)) %>%
 # mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  #mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  #mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
  #mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  #mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(ramp.followupb.virus.id)
# Inspect colnames
colnames(ramp.followupb.virus.id)
#Differences
dim(ramp.followupb.virus.id)[1]-dim(ramp.followupb.virus.id)[1]
}
```

# Resp baseline
## GLAD
### Read in data
```{r Read in data GLAD baseline resp}
if(GLAD == TRUE){
glad.baseline.resp <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data_raw/latest_freeze/coping_glad/resp_coping_glad.rds")
dim(glad.baseline.resp)
colnames(glad.baseline.resp)
}
```

Select variables GLAD baseline resp
```{r Select variables GLAD baseline resp}
if(GLAD == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate_baseline",
                  "endDate")

glad.baseline.resp.id <- glad.baseline.resp %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  add_column(cohort_name = "coping_glad", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         startDate_baseline = startDate,
         resp.coronavirus_test_nosethroat_swab,
         resp.results_nosethroat_swab_test,
         resp.coronavirus_antibody_test,
         resp.results_antibody_test
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  #mutate_if(is.numeric, ~na_if(., -99)) %>%
 # mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  #mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  #mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
  #mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  #mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(glad.baseline.resp.id)
# Inspect colnames
colnames(glad.baseline.resp.id)
#Differences
dim(glad.baseline.resp)[1]-dim(glad.baseline.resp.id)[1]
}
```

# Resp baseline
## EDGI
### Read in data
```{r Read in data EDGI baseline resp}
if(EDGI == TRUE){
edgi.baseline.resp <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data_raw/latest_freeze/coping_edgi/resp_coping_edgi.rds")
dim(edgi.baseline.resp)
colnames(edgi.baseline.resp)
}

```

Select variables EDGI baseline resp
```{r Select variables EDGI baseline resp}
if(EDGI == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate_baseline",
                  "endDate")

edgi.baseline.resp.id <- edgi.baseline.resp %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
   add_column(cohort_name = "coping_edgi", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         startDate_baseline = startDate,
         resp.coronavirus_test_nosethroat_swab,
         resp.results_nosethroat_swab_test,
         resp.coronavirus_antibody_test,
         resp.results_antibody_test
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  #mutate_if(is.numeric, ~na_if(., -99)) %>%
 # mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  #mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  #mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
  #mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  #mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(edgi.baseline.resp.id)
# Inspect colnames
colnames(edgi.baseline.resp.id)
#Differences
dim(edgi.baseline.resp)[1]-dim(edgi.baseline.resp.id)[1]
}
```

# Resp baseline
## NBR
### Read in data
```{r Read in data NBR baseline resp}
if(NBR == TRUE){
nbr.baseline.resp <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data_raw/latest_freeze/coping_nbr/resp_coping_nbr.rds")
dim(nbr.baseline.resp)
colnames(nbr.baseline.resp)
}
```

Select variables NBR baseline resp
```{r Select variables NBR baseline resp}
if(NBR == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate_baseline",
                  "endDate")

nbr.baseline.resp.id <- nbr.baseline.resp %>% #new dataset with ID
  drop_na(subjectid) %>% # Drop NAs
  add_column(cohort_name = "nbr", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         startDate_baseline = startDate,
         resp.coronavirus_test_nosethroat_swab,
         resp.results_nosethroat_swab_test,
         resp.coronavirus_antibody_test,
         resp.results_antibody_test
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  #mutate_if(is.numeric, ~na_if(., -99)) %>%
 # mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  #mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  #mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
  #mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  #mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(nbr.baseline.resp.id)
# Inspect colnames
colnames(nbr.baseline.resp.id)
#Differences
dim(nbr.baseline.resp)[1]-dim(nbr.baseline.resp.id)[1]
}
```

# Resp baseline
## RAMP
### Read in data
NB: In the RAMP baseline, participants are asked whether they've had tests in the last week, rather than ever as in GLAD, NBR, and EDGI.
```{r Read in data RAMP baseline resp}
if(RAMP == TRUE){
ramp.baseline.resp <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data_raw/latest_freeze/ramp/resp_ramp.rds")
dim(ramp.baseline.resp)
colnames(ramp.baseline.resp)
}
```

Select variables RAMP baseline resp
```{r Select variables RAMP baseline resp}
if(RAMP == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate_baseline",
                  "endDate")

ramp.baseline.resp.id <- ramp.baseline.resp %>% #new dataset with ID
  drop_na(`Login ID`) %>% # Drop NAs
  add_column(cohort_name = "ramp", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         startDate_baseline = startDate,
         resp.coronavirus_test_nosethroat_swab = resp.coronavirus_test_week_nosethroat,
         resp.results_nosethroat_swab_test,
         resp.coronavirus_antibody_test = resp.coronavirus_week_antibody_test,
         resp.results_antibody_test
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  #mutate_if(is.numeric, ~na_if(., -99)) %>%
 # mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  #mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  #mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
  #mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  #mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(ramp.baseline.resp.id)
# Inspect colnames
colnames(ramp.baseline.resp.id)
#Differences
dim(ramp.baseline.resp)[1]-dim(ramp.baseline.resp.id)[1]
}
```
# Resp follow up A
## COPING 1
### Read in data
```{r Read in data COPING follow up A resp}
if(COPING == TRUE){
coping.followupa1.resp <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data_raw/latest_freeze/coping_followupa/resp_coping_followupa.rds")
dim(coping.followupa1.resp)
colnames(coping.followupa1.resp)

}
```

Select variables COPING follow up A resp
```{r Select variables COPING follow up A resp}
if(COPING == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate_waves",
                  "endDate")

coping.followupa1.resp.id <- coping.followupa1.resp %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
   add_column(cohort_name = "coping", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         startDate_waves = startDate,
         resp.coronavirus_test_nosethroat_swab = resp.test_coronavirus_week_nosethroat,
         resp.results_nosethroat_swab_test,
         resp.coronavirus_antibody_test = resp.coronavirus_week_antibody_test,
         resp.results_antibody_test
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  #mutate_if(is.numeric, ~na_if(., -99)) %>%
 # mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  #mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  #mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
  #mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  #mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(coping.followupa1.resp.id)
# Inspect colnames
colnames(coping.followupa1.resp.id)
#Differences
dim(coping.followupa1.resp)[1]-dim(coping.followupa1.resp.id)[1]
}
```

# Resp follow up A
## COPING 2 ongoing
### Read in data
```{r Read in data COPING follow up A ongoing resp}
if(COPING == TRUE){
coping.followupa2.resp <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data_raw/latest_freeze/coping_followupa_ongoing/resp_coping_followupa_ongoing.rds")
dim(coping.followupa2.resp)
colnames(coping.followupa2.resp)
}
```

Select variables COPING follow up A ongoing resp
```{r Select variables COPING follow up A ongoing resp}
if(COPING == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate_waves",
                  "endDate")

coping.followupa2.resp.id <- coping.followupa2.resp %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  add_column(cohort_name = "coping", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         startDate_waves = startDate,
         resp.coronavirus_test_nosethroat_swab = resp.test_coronavirus_week_nosethroat,
         resp.results_nosethroat_swab_test,
         resp.coronavirus_antibody_test = resp.coronavirus_week_antibody_test,
         resp.results_antibody_test
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  #mutate_if(is.numeric, ~na_if(., -99)) %>%
 # mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  #mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  #mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
  #mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  #mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(coping.followupa2.resp.id)
# Inspect colnames
colnames(coping.followupa2.resp.id)
#Differences
dim(coping.followupa2.resp)[1]-dim(coping.followupa2.resp.id)[1]
}
```

Combine resp COPING follow up A datasets 
```{r Combine COPING follow up A resp datasets}
if(COPING == TRUE){
    coping.followupa.resp.id <- rbind(coping.followupa1.resp.id,
                                      coping.followupa2.resp.id) 
    # **Note that some people may be in both datasets, i.e. answered the questionnaire using the original link during the time period that is considered the start of the 'ongoing' dataset, before realising and answering through the correct link. Example - questionnaires answered on the 29th July are present in both datasets. This is fine - as long as it's different people. Will need to filter by duplicate ID and duplicate wave once wave variable is created.
  
# Inspect dimensions
  dim(coping.followupa.resp.id)
# Inspect colnames
  colnames(coping.followupa.resp.id)
}
```
# Resp follow up B
## COPING 
### Read in data
```{r Read in data COPING follow up B resp}
if(COPING == TRUE){
coping.followupb.resp <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data_raw/latest_freeze/coping_followupb/resp_coping_followupb.rds")
dim(coping.followupb.resp)
colnames(coping.followupb.resp)
}
```

Select variables COPING follow up B resp
```{r Select variables COPING follow up B resp}
if(COPING == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate_waves",
                  "endDate")

coping.followupb.resp.id <- coping.followupb.resp %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  add_column(cohort_name = "coping", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         startDate_waves = startDate,
         resp.coronavirus_test_nosethroat_swab = resp.coronavirus_test_week_nosethroat,
         resp.results_nosethroat_swab_test,
         resp.coronavirus_antibody_test = resp.antibody_test_coronavirus_week,
         resp.results_antibody_test = resp.antibody_test_results
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  #mutate_if(is.numeric, ~na_if(., -99)) %>%
 # mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  #mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  #mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
  #mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  #mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(coping.followupb.resp.id)
# Inspect colnames
colnames(coping.followupb.resp.id)
#Differences
dim(coping.followupb.resp)[1]-dim(coping.followupb.resp.id)[1]
}
```

# Resp follow up A
## RAMP 
### Read in data
```{r Read in data RAMP follow up A resp}
if(RAMP == TRUE){
ramp.followupa.resp <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data_raw/latest_freeze/ramp_followupa/resp_ramp_followupa.rds")
dim(ramp.followupa.resp)
colnames(ramp.followupa.resp)
}
```

Select variables RAMP follow up A resp
```{r Select variables RAMP follow up A resp}
if(RAMP == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate_waves",
                  "endDate")

ramp.followupa.resp.id <- ramp.followupa.resp %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  add_column(cohort_name = "ramp", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         startDate_waves = startDate,
         resp.coronavirus_test_nosethroat_swab = resp.test_coronavirus_weeks_nosethroat,
         resp.results_nosethroat_swab_test,
         resp.coronavirus_antibody_test = resp.coronavirus_weeks_antibody_test,
         resp.results_antibody_test
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  #mutate_if(is.numeric, ~na_if(., -99)) %>%
 # mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  #mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  #mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
  #mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  #mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(ramp.followupa.resp.id)
# Inspect colnames
colnames(ramp.followupa.resp.id)
#Differences
dim(ramp.followupa.resp)[1]-dim(ramp.followupa.resp.id)[1]
}
```

# Resp follow up B
## RAMP 
### Read in data
```{r Read in data RAMP follow up B resp}
if(RAMP == TRUE){
ramp.followupb.resp <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data_raw/latest_freeze/ramp_followupb/XXXXXXX")
dim(ramp.followupb.resp)
colnames(ramp.followupb.resp)
}
```

Select variables RAMP follow up B resp
```{r Select variables RAMP follow up B resp}
if(RAMP == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate_waves",
                  "endDate")

ramp.followupb.resp.id <- ramp.followupb.resp %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  add_column(cohort_name = "ramp", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         startDate_waves = startDate,
         resp.coronavirus_test_nosethroat_swab = resp.test_coronavirus_weeks_nosethroat,
         resp.results_nosethroat_swab_test,
         resp.coronavirus_antibody_test = resp.coronavirus_weeks_antibody_test,
         resp.results_antibody_test
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  #mutate_if(is.numeric, ~na_if(., -99)) %>%
 # mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  #mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  #mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
  #mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  #mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(ramp.followupb.resp.id)
# Inspect colnames
colnames(ramp.followupb.resp.id)
#Differences
dim(ramp.followupb.resp)[1]-dim(ramp.followupb.resp.id)[1]
}
```

# TAF - baseline (Thoughts & Feelings questionnaires from UKB that contains questions about self-harm thoughts & behaviours)
## GLAD 
### Read in data
```{r Read in data GLAD TAF baseline}
if(GLAD == TRUE){
taf.glad.coping.baseline.raw <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data_raw/latest_freeze/coping_glad/taf_coping_glad.rds")
dim(taf.glad.coping.baseline.raw)
colnames(taf.glad.coping.baseline.raw)
}

```

Select variables GLAD TAF baseline
```{r Select variables GLAD TAF baseline}
if(GLAD == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate",
                  "endDate")

taf.glad.coping.baseline.raw.id <- taf.glad.coping.baseline.raw %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  remove_duplicates("externalDataReference") %>% # Remove duplicates based on ID
  add_column(cohort_name = "coping_glad", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         startDate_baseline = startDate,
         #endDate,
         taf.worth_living_life_people_.Wavebaseline = taf.worth_living_life_thoughts, #renamed to same as follow up
         taf.felt_weeks_past_.Wavebaseline = taf.past_felt_weeks,#renamed to same as follow up
         taf.pandemic_felt_.Wavebaseline = taf.pandemic_felt,
         taf.have_you_contemplated_harming_yourself_.Wavebaseline = taf.have_you_contemplated_harming_yourself_,
         taf.felt_weeks_past.1_.Wavebaseline = taf.past_felt_weeks.1, #renamed to same as follow up
         taf.pandemic_felt.1_.Wavebaseline = taf.pandemic_felt.1,
         taf.meant_life_end_weeks_.Wavebaseline = taf.meant_end_life_weeks, #renamed to same as follow up
         taf.meant_end_life_pandemic_.Wavebaseline = taf.meant_end_life_pandemic
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  #mutate_if(is.numeric, ~na_if(., -99)) %>%
 # mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
 # mutate_if(is.factor, ~na_if(., "Don't know")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
#  mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
#  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(taf.glad.coping.baseline.raw.id)
# Inspect colnames
colnames(taf.glad.coping.baseline.raw.id)
#Differences
dim(taf.glad.coping.baseline.raw)[1]-dim(taf.glad.coping.baseline.raw.id)[1]
}


```

# TAF - baseline
## EDGI  
### Read in data
```{r Read in data EDGI TAF baseline}
if(EDGI == TRUE){
taf.edgi.coping.baseline.raw <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data_raw/latest_freeze/coping_edgi/taf_coping_edgi.rds")
dim(taf.edgi.coping.baseline.raw)
colnames(taf.edgi.coping.baseline.raw)
}
```

Select variables - EDGI TAF baseline
```{r Select variables EDGI TAF baseline}
if(EDGI == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate",
                  "endDate")


taf.edgi.coping.baseline.raw.id <- taf.edgi.coping.baseline.raw %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  remove_duplicates("externalDataReference") %>% # Remove duplicates based on ID
  add_column(cohort_name = "coping_edgi", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         startDate_baseline = startDate,
         #endDate,
         taf.worth_living_life_people_.Wavebaseline = taf.worth_living_thoughts_life, #renamed to same as follow up
         taf.felt_weeks_past_.Wavebaseline = taf.weeks_past_felt,#renamed to same as follow up
         taf.pandemic_felt_.Wavebaseline = taf.pandemic_felt,
         taf.have_you_contemplated_harming_yourself_.Wavebaseline = taf.have_you_contemplated_harming_yourself_,
         taf.felt_weeks_past.1_.Wavebaseline = taf.weeks_past_felt.1, #renamed to same as follow up
         taf.pandemic_felt.1_.Wavebaseline = taf.pandemic_felt.1,
         taf.meant_life_end_weeks_.Wavebaseline = taf.meant_end_weeks_life, #renamed to same as follow up
         taf.meant_end_life_pandemic_.Wavebaseline = taf.meant_end_life_pandemic
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
 # mutate_if(is.numeric, ~na_if(., -99)) %>%
 # mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
 # mutate_if(is.factor, ~na_if(., "Don't know")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered"))  # Drop empty factor levels
#  mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
#  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) 
#  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(taf.edgi.coping.baseline.raw.id)
# Inspect colnames
colnames(taf.edgi.coping.baseline.raw.id)
#Differences
dim(taf.edgi.coping.baseline.raw)[1]-dim(taf.edgi.coping.baseline.raw.id)[1]
}
```

# TAF - baseline 
## NBR 
### Read in data
```{r Read in data NBR TAF baseline}
if(NBR == TRUE){
taf.nbr.baseline.raw <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data_raw/latest_freeze/coping_nbr/taf_coping_nbr.rds")
dim(taf.nbr.baseline.raw)
colnames(taf.nbr.baseline.raw)
}

```

Select variables NBR TAF baseline
```{r Select variables NBR TAF baseline}
if(NBR == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate",
                  "endDate")

taf.nbr.baseline.raw.id <- taf.nbr.baseline.raw %>% #new dataset with ID
  drop_na(subjectid) %>% # Drop NAs
  remove_duplicates("subjectid") %>% # Remove duplicates based on ID
  add_column(cohort_name = "nbr", .before = "startDate") %>% #create new column 
  select(
         ID = subjectid, # ID
         cohort_name, # Sample
         startDate_baseline = startDate,
         #endDate,
         taf.worth_living_life_people_.Wavebaseline = taf.worth_living_thoughts_life, #renamed to same as follow up
         taf.felt_weeks_past_.Wavebaseline = taf.past_felt_weeks,#renamed to same as follow up
         taf.pandemic_felt_.Wavebaseline = taf.pandemic_felt,
         taf.have_you_contemplated_harming_yourself_.Wavebaseline = taf.have_you_contemplated_harming_yourself_,
         taf.felt_weeks_past.1_.Wavebaseline = taf.past_felt_weeks.1, #renamed to same as follow up
         taf.pandemic_felt.1_.Wavebaseline = taf.pandemic_felt.1,
         taf.meant_life_end_weeks_.Wavebaseline = taf.meant_end_life_weeks, #renamed to same as follow up
         taf.meant_end_life_pandemic_.Wavebaseline = taf.meant_end_pandemic_life #renamed to same as follow up
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  #mutate_if(is.numeric, ~na_if(., -99)) %>%
  #mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  #mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  #mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
  #mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
  #mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
  #mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) 
  #mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(taf.nbr.baseline.raw.id)
# Inspect colnames
colnames(taf.nbr.baseline.raw.id)
#Differences
dim(taf.nbr.baseline.raw)[1]-dim(taf.nbr.baseline.raw.id)[1]
}
```

# TAF - baseline 
## RAMP
### Read in data
```{r Read in data RAMP TAF baseline}
if(RAMP == TRUE){
taf.ramp.baseline.raw <- readRDS(file ="/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data_raw/latest_freeze/ramp/taf_ramp.rds")
dim(taf.ramp.baseline.raw)
colnames(taf.ramp.baseline.raw)

}
```

Select variables RAMP TAF baseline
```{r Select variables RAMP TAF baseline}
if(RAMP == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate_baseline",
                  "endDate")

taf.ramp.baseline.raw.id <- taf.ramp.baseline.raw %>% #new dataset with ID
  drop_na(`Login ID`) %>% # Drop NAs
  remove_duplicates("Login ID") %>% # Remove duplicates based on ID
  add_column(cohort_name = "ramp", .before = "startDate") %>% #create new column 
  select(
         ID = `Login ID`, # ID
         cohort_name, # Sample
         startDate_baseline = startDate,
         #endDate,
         taf.worth_living_life_people_.Wavebaseline = taf.worth_living_thoughts_life, #renamed to same as follow up
         taf.felt_weeks_past_.Wavebaseline = taf.past_felt_weeks,#renamed to same as follow up
         taf.pandemic_felt_.Wavebaseline = taf.pandemic_felt,
         taf.have_you_contemplated_harming_yourself_.Wavebaseline = taf.have_you_contemplated_harming_yourself_,
         taf.felt_weeks_past.1_.Wavebaseline = taf.past_felt_weeks.1, #renamed to same as follow up
         taf.pandemic_felt.1_.Wavebaseline = taf.pandemic_felt.1,
         taf.meant_life_end_weeks_.Wavebaseline = taf.meant_end_life_weeks, #renamed to same as follow up
         taf.meant_end_life_pandemic_.Wavebaseline = taf.meant_end_pandemic_life #renamed to same as follow up
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
 # mutate_if(is.numeric, ~na_if(., -99)) %>%
 # mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
 # mutate_if(is.factor, ~na_if(., "Don't know")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
#  mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
#  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(taf.ramp.baseline.raw.id)
# Inspect colnames
colnames(taf.ramp.baseline.raw.id)
#Differences
dim(taf.ramp.baseline.raw)[1]-dim(taf.ramp.baseline.raw.id)[1]
}
```

# TAF - follow up A
## COPING (first 2 phases)
### Read in data
```{r Read in data COPING follow up A TAF first two phases}
if(COPING == TRUE){
taf.coping.followupa.raw.1 <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data_raw/latest_freeze/coping_followupa/taf_coping_followupa.rds")
dim(taf.coping.followupa.raw.1)
colnames(taf.coping.followupa.raw.1)
}
```

Select variables COPING follow up A TAF first two phases
```{r Select variables COPING follow up A TAF first two phases}
if(COPING == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate_waves",
                  "endDate")

taf.coping.followupa.raw.id.1 <- taf.coping.followupa.raw.1 %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  add_column(cohort_name = "coping", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         startDate_waves = startDate,
         #endDate,
         taf.worth_living_life_people = taf.worth_living_life_felt,
         taf.felt_weeks_past = taf.felt_weeks_past,
         taf.have_you_contemplated_harming_yourself = taf.have_you_contemplated_harming_yourself_,
         taf.felt_weeks_past.1 = taf.felt_weeks_past.1,
         taf.meant_life_end_weeks = taf.meant_life_end_weeks
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
 # mutate_if(is.numeric, ~na_if(., -99)) %>%
 # mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
 # mutate_if(is.factor, ~na_if(., "Don't know")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(taf.coping.followupa.raw.id.1)
# Inspect colnames
colnames(taf.coping.followupa.raw.id.1)
#Differences
dim(taf.coping.followupa.raw.1)[1]-dim(taf.coping.followupa.raw.id.1)[1]
}
```

# TAF - follow up A
## COPING (subsequent phases)
### Read in data
```{r Read in data COPING follow up A TAF first subsequent phases}
if(COPING == TRUE){
taf.coping.followupa.raw.2 <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data_raw/latest_freeze/coping_followupa_ongoing/taf_coping_followupa_ongoing.rds")
dim(taf.coping.followupa.raw.2)
colnames(taf.coping.followupa.raw.2)
}
```

Select variables COPING follow up A TAF first subsequent phases
```{r Select variables COPING follow up A TAF first subsequent phases}
if(COPING == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate_waves",
                  "endDate")

taf.coping.followupa.raw.id.2 <- taf.coping.followupa.raw.2 %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  add_column(cohort_name = "coping", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         startDate_waves = startDate,
         #endDate,
         taf.worth_living_life_people = taf.worth_living_life_people,
         taf.felt_weeks_past = taf.felt_weeks_past,
         taf.have_you_contemplated_harming_yourself = taf.have_you_contemplated_harming_yourself_,
         taf.felt_weeks_past.1 = taf.felt_weeks_past.1,
         taf.meant_life_end_weeks = taf.meant_life_end_weeks
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
# mutate_if(is.numeric, ~na_if(., -99)) %>%
 # mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
 # mutate_if(is.factor, ~na_if(., "Don't know")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered"))  # Drop empty factor levels
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(taf.coping.followupa.raw.id.2)
# Inspect colnames
colnames(taf.coping.followupa.raw.id.2)
#Differences
dim(taf.coping.followupa.raw.2)[1]-dim(taf.coping.followupa.raw.id.2)[1]
}
```

Combine TAF COPING follow up A datasets 
```{r Combine COPING follow up A TAF datasets}
if(COPING == TRUE){
    taf.coping.followupa.raw.id <- rbind(taf.coping.followupa.raw.id.2, taf.coping.followupa.raw.id.1) # **Note that some people may be in both datasets, i.e. answered the questionnaire using the original link during the time period that is considered the start of the 'ongoing' dataset, before realising and answering through the correct link. Example - questionnaires answered on the 29th July are present in both datasets. This is fine - as long as it's different people. Will need to filter by duplicate ID and duplicate wave once wave variable is created.
  
# Inspect dimensions
  dim(taf.coping.followupa.raw.id)
# Inspect colnames
  colnames(taf.coping.followupa.raw.id)
}
```

# TAF - follow up b
## COPING
### Read in data
```{r Read in data COPING follow up B TAF}
if(COPING == TRUE){
taf.coping.followupb.raw <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data_raw/latest_freeze/coping_followupb/taf_coping_followupb.rds")
dim(taf.coping.followupb.raw)
colnames(taf.coping.followupb.raw)
}
```

Select variables COPING follow up B TAF
```{r Select variables COPING follow up B TAF}
if(COPING == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate_waves",
                  "endDate")

taf.coping.followupb.raw.id <- taf.coping.followupb.raw %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
 add_column(cohort_name = "coping", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         startDate_waves = startDate,
         #endDate,
         taf.worth_living_life_people = taf.worth_living_life_people,
         taf.felt_weeks_past = taf.weeks_past_felt, #renamed to same follow up a
         taf.have_you_contemplated_harming_yourself = taf.have_you_contemplated_harming_yourself_,
         taf.felt_weeks_past.1 = taf.weeks_past_felt.1, #renamed to same follow up a
         taf.meant_life_end_weeks = taf.deliberately_harmed_meant_end #renamed to same follow up a
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
 # mutate_if(is.numeric, ~na_if(., -99)) %>%
 # mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
 # mutate_if(is.factor, ~na_if(., "Don't know")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
  #mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered"))  # Drop empty factor levels
#  mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(taf.coping.followupb.raw.id)
# Inspect colnames
colnames(taf.coping.followupb.raw.id)
#Differences
dim(taf.coping.followupb.raw)[1]-dim(taf.coping.followupb.raw.id)[1]
}
```

# TAF - follow up A
## RAMP
### Read in data
```{r Read in data RAMP follow up A TAF}
if(RAMP == TRUE){
taf.ramp.followupa.raw <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data_raw/latest_freeze/ramp_followupa/taf_ramp_followupa.rds")
dim(taf.ramp.followupa.raw)
colnames(taf.ramp.followupa.raw)
}
```

Select variables RAMP follow up A TAF
```{r Select variables RAMP follow up A TAF}
if(RAMP == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate_waves",
                  "endDate")

taf.ramp.followupa.raw.id <- taf.ramp.followupa.raw %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  add_column(cohort_name = "ramp", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         startDate_waves = startDate,
         #endDate,
         taf.worth_living_life_people = taf.worth_living_life_felt,
         taf.felt_weeks_past = taf.felt_weeks_past,
         taf.have_you_contemplated_harming_yourself = taf.have_you_contemplated_harming_yourself_,
         taf.felt_weeks_past.1 = taf.felt_weeks_past.1,
         taf.meant_life_end_weeks = taf.meant_life_end_weeks
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
 # mutate_if(is.numeric, ~na_if(., -99)) %>%
  #mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
 # mutate_if(is.factor, ~na_if(., "Don't know")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
#  mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
#  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(taf.ramp.followupa.raw.id)
# Inspect colnames
colnames(taf.ramp.followupa.raw.id)
#Differences
dim(taf.ramp.followupa.raw)[1]-dim(taf.ramp.followupa.raw.id)[1]
}
```

# TAF - follow up B
## RAMP
### Read in data
```{r Read in data RAMP follow up B TAF}
if(RAMP == TRUE){
taf.ramp.followupb.raw <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data_raw/latest_freeze/ramp_followupb/XXXXXXXXXX")
dim(taf.ramp.followupb.raw)
colnames(taf.ramp.followupb.raw)
}
```

Select variables RAMP follow up B TAF
```{r Select variables RAMP follow up B TAF}
if(RAMP == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate_waves",
                  "endDate")

taf.ramp.followupb.raw.id <- taf.ramp.followupb.raw %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  add_column(cohort_name = "ramp", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         startDate_waves = startDate,
         #endDate,
         taf.worth_living_life_people = taf.worth_living_life_felt,
         taf.felt_weeks_past = taf.felt_weeks_past,
         taf.have_you_contemplated_harming_yourself = taf.have_you_contemplated_harming_yourself_,
         taf.felt_weeks_past.1 = taf.felt_weeks_past.1,
         taf.meant_life_end_weeks = taf.meant_life_end_weeks
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
 #mutate_if(is.numeric, ~na_if(., -99)) %>%
  #mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
 # mutate_if(is.factor, ~na_if(., "Don't know")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(taf.ramp.followupb.raw.id)
# Inspect colnames
colnames(taf.ramp.followupb.raw.id)
#Differences
dim(taf.ramp.followupb.raw)[1]-dim(taf.ramp.followupb.raw.id)[1]
}
```

# Demographics follow up A
## RAMP
### Read in data 
```{r Read in data RAMP follow up A demographics}
if(RAMP == TRUE) {
  dem.ramp.followupa.raw <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data_raw/latest_freeze/ramp_followupa/dem_ramp_followupa.rds")
dim(dem.ramp.followupa.raw)
colnames(dem.ramp.followupa.raw)

}
```

Select variables RAMP follow up A demographics
```{r Select variables RAMP follow up A demographics}
if(RAMP == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate_waves",
                  "endDate")

dem.ramp.followupa.raw.id <- dem.ramp.followupa.raw %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  add_column(cohort_name = "ramp", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         startDate_waves = startDate,
         #endDate,
         dem.nothing_has_changed,                                     
         dem.living_situation,
         dem.employment,
         dem.physical_health,
         dem.health_of_a_relative,
         dem.household_employment_status_key,
         dem.children__dependants_returning_to_school__other_education,
         dem.living_alone,
         dem.living_with_partner_or_spouse ,
         dem.living_with_housemates,
         dem.age_children_living,
         dem.age_children_living.1,
         dem.living_with_other_members_of_my_family,
         dem.spouse_partner_members_living = dem.members_living_partner_spouse,
         dem.staying_live,
         dem.staying_live.1,
         dem.prefer_not_to_say,
         dem.made_redundant,
         dem.became_unemployed = dem.become_unemployed,
         dem.reduction_in_hours,
         dem.reduction_in_salary,
         dem.benefits_increased,
         # dem.benefits_decreased, +++ where is this variable?!
         dem.change_in_duties_or_responsibilites = dem.change_in_duties_or_responsibilities,
         dem.became_employed,
         dem.increased_hours,
         dem.increased_salary,
         dem.furloughed_or_paid_leave_government_funded = dem.furloughed_or_paid_leave_,
         dem.furloughed_or_paid_leave_company_funded = dem.furloughed_or_paid_leave_.1,
         dem.paid_leave_furloughed = dem.paid_leave_furloughed,
         dem.paid_leave_returned_work,
         dem.retired
        
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
 #mutate_if(is.numeric, ~na_if(., -99)) %>%
  #mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
 # mutate_if(is.factor, ~na_if(., "Don't know")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(dem.ramp.followupa.raw.id)
# Inspect colnames
colnames(dem.ramp.followupa.raw.id)
#Differences
dim(dem.ramp.followupa.raw.id)[1]-dim(dem.ramp.followupa.raw)[1]
}
```

# Demographics follow up B
## RAMP
### Read in data 
```{r Read in data RAMP follow up B demographics} 
if(RAMP == TRUE) {
dem.ramp.followupb.raw <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data_raw/latest_freeze/ramp_followupb/dem_ramp_followupb.rds")
dim(dem.ramp.followupb.raw)
colnames(dem.ramp.followupb.raw)
}
  
```

Select variables RAMP follow up B demographics
```{r Select variables RAMP follow up B demographics}
if(RAMP == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate_waves",
                  "endDate")

dem.ramp.followupb.raw.id <- dem.ramp.followupb.raw %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  add_column(cohort_name = "ramp", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         startDate_waves = startDate,
         #endDate,
         dem.nothing_has_changed,                                     
         dem.living_situation,
         dem.employment,
         dem.physical_health,
         dem.health_of_a_relative,
         dem.household_employment_status_key,
         dem.children__dependants_returning_to_school__other_education,
         dem.living_alone,
         dem.living_with_partner_or_spouse ,
         dem.living_with_housemates,
         dem.age_children_living,
         dem.age_children_living.1,
         dem.living_with_other_members_of_my_family,
         dem.spouse_partner_members_living = dem.members_living_partner_spouse,
         dem.staying_live,
         dem.staying_live.1,
         dem.prefer_not_to_say,
         dem.made_redundant,
         dem.became_unemployed = dem.become_unemployed,
         dem.reduction_in_hours,
         dem.reduction_in_salary,
         dem.benefits_increased,
         # dem.benefits_decreased, +++ where is this variable?!
         dem.change_in_duties_or_responsibilites = dem.change_in_duties_or_responsibilities,
         dem.became_employed,
         dem.increased_hours,
         dem.increased_salary,
         dem.furloughed_or_paid_leave_government_funded = dem.furloughed_or_paid_leave_,
         dem.furloughed_or_paid_leave_company_funded = dem.furloughed_or_paid_leave_.1,
         dem.paid_leave_furloughed = dem.paid_leave_furloughed,
         dem.paid_leave_returned_work = dem.paid_leave_returned_furlough,
         dem.retired
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
 #mutate_if(is.numeric, ~na_if(., -99)) %>%
  #mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
 # mutate_if(is.factor, ~na_if(., "Don't know")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(dem.ramp.followupb.raw.id)
# Inspect colnames
colnames(dem.ramp.followupb.raw.id)
#Differences
dim(dem.ramp.followupb.raw)[1]-dim(dem.ramp.followupb.raw.id)[1]
}
```

# Demographics follow up A first two phases
## COPING
### Read in data 
```{r Read in data COPING follow up A demographics first two phases}
if(COPING == TRUE) {
coping.dem.followupa.raw <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data_raw/latest_freeze/coping_followupa/dem_coping_followupa.rds")
dim(coping.dem.followupa.raw)
colnames(coping.dem.followupa.raw)
}
  
```

Select variables COPING follow up A demographics
```{r Select variables COPING follow up A demographics first two phases}
if(COPING == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate_waves",
                  "endDate")

coping.dem.followupa.raw.id.1 <- coping.dem.followupa.raw %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
   add_column(cohort_name = "coping", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         startDate_waves = startDate,
         #endDate,
         dem.nothing_has_changed,                                     
         dem.living_situation,
         dem.employment,
         dem.physical_health,
         dem.health_of_a_relative,
         dem.household_employment_status_key,
         dem.children__dependants_returning_to_school__other_education = dem.school_childrendependants_returning_education,
         dem.living_alone,
         dem.living_with_partner_or_spouse,
         dem.living_with_housemates,
         dem.age_children_living,
         dem.age_children_living.1,
         dem.living_with_other_members_of_my_family,
         dem.spouse_partner_members_living = dem.members_living_partner_spouse,
         dem.staying_live,
         dem.staying_live.1,
         dem.prefer_not_to_say,
         dem.made_redundant,
         dem.became_unemployed,
         dem.reduction_in_hours,
         dem.reduction_in_salary,
         dem.benefits_increased,
         dem.benefits_decreased,
         dem.change_in_duties_or_responsibilites,
         dem.became_employed,
         dem.increased_hours,
         dem.increased_salary,
         dem.furloughed_or_paid_leave_government_funded = dem.furloughed_or_paid_leave_,
         dem.furloughed_or_paid_leave_company_funded = dem.furloughed_or_paid_leave_.1,
         dem.paid_leave_furloughed = dem.paid_leave_furloughed,
         dem.paid_leave_returned_work,
         dem.retired
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
 #mutate_if(is.numeric, ~na_if(., -99)) %>%
  #mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
 # mutate_if(is.factor, ~na_if(., "Don't know")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(coping.dem.followupa.raw.id.1)
# Inspect colnames
colnames(coping.dem.followupa.raw.id.1)
#Differences
dim(coping.dem.followupa.raw.id.1)[1]-dim(coping.dem.followupa.raw)[1]
}
```

# Demographics follow up A subsequent phases
## COPING
### Read in data 
```{r Read in data COPING follow up A demographics subsequent phases}
if(COPING == TRUE) {
  
coping.dem.followupa.ongoing.raw <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data_raw/latest_freeze/coping_followupa_ongoing/dem_coping_followupa_ongoing.rds")
dim(coping.dem.followupa.ongoing.raw)
colnames(coping.dem.followupa.ongoing.raw)
}
  
```

Select variables COPING follow up B demographics
```{r Select variables COPING follow up A demographics subsequent phases}
if(COPING == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate_waves",
                  "endDate")

coping.dem.followupa.ongoing.raw.id <- coping.dem.followupa.ongoing.raw %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
 add_column(cohort_name = "coping", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         startDate_waves = startDate,
         #endDate,
         dem.nothing_has_changed,                                     
         dem.living_situation,
         dem.employment,
         dem.physical_health,
         dem.health_of_a_relative,
         dem.household_employment_status_key,
         dem.children__dependants_returning_to_school__other_education = dem.school_childrendependants_returning_education,
         dem.living_alone,
         dem.living_with_partner_or_spouse,
         dem.living_with_housemates,
         dem.age_children_living,
         dem.age_children_living.1,
         dem.living_with_other_members_of_my_family,
         dem.spouse_partner_members_living = dem.members_living_partner_spouse,
         dem.staying_live,
         dem.staying_live.1,
         dem.prefer_not_to_say,
         dem.made_redundant,
         dem.became_unemployed,
         dem.reduction_in_hours,
         dem.reduction_in_salary,
         dem.benefits_increased,
         dem.benefits_decreased,
         dem.change_in_duties_or_responsibilites,
         dem.became_employed,
         dem.increased_hours,
         dem.increased_salary,
         dem.furloughed_or_paid_leave_government_funded = dem.furloughed_or_paid_leave_,
         dem.furloughed_or_paid_leave_company_funded = dem.furloughed_or_paid_leave_.1,
         dem.paid_leave_furloughed = dem.paid_leave_furloughed,
         dem.paid_leave_returned_work,
         dem.retired
        
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
 #mutate_if(is.numeric, ~na_if(., -99)) %>%
  #mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
 # mutate_if(is.factor, ~na_if(., "Don't know")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(coping.dem.followupa.ongoing.raw.id)
# Inspect colnames
colnames(coping.dem.followupa.ongoing.raw.id)
#Differences
dim(coping.dem.followupa.ongoing.raw)[1]-dim(coping.dem.followupa.ongoing.raw.id)[1]
}
```

Combine demographics COPING follow up A datasets 
```{r Combine demographics COPING follow up A datasets}
if(COPING == TRUE){
    coping.dem.followupa.raw.id <- rbind(coping.dem.followupa.raw.id.1,
                                         coping.dem.followupa.ongoing.raw.id) 
# Inspect dimensions
  dim(coping.dem.followupa.raw.id)
# Inspect colnames
  colnames(coping.dem.followupa.raw.id)
}
```

# Demographics follow up B
## COPING
### Read in data 
```{r Read in data COPING follow up B demographics}
if(COPING == TRUE) {
coping.dem.followupb.raw <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data_raw/latest_freeze/coping_followupb/dem_coping_followupb.rds")
dim(coping.dem.followupb.raw)
colnames(coping.dem.followupb.raw)
}
  
```

Select variables COPING follow up B demographics
```{r Select variables COPING follow up B demographics}
if(COPING == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate_waves",
                  "endDate")

coping.dem.followupb.raw.id <- coping.dem.followupb.raw %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  add_column(cohort_name = "coping", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         startDate_waves = startDate,
         #endDate,
         dem.nothing_has_changed,                                     
         dem.living_situation,
         dem.employment,
         dem.physical_health,
         dem.health_of_a_relative,
         dem.household_employment_status_key,
         dem.children__dependants_returning_to_school__other_education = dem.school_childrendependants_returning_education,
         dem.living_alone,
         dem.living_with_partner_or_spouse,
         dem.living_with_housemates,
         dem.age_children_living,
         dem.age_children_living.1,
         dem.living_with_other_members_of_my_family,
         dem.spouse_partner_members_living = dem.members_living_partner_spouse,
         dem.staying_live,
         dem.staying_live.1,
         dem.prefer_not_to_say,
         dem.made_redundant,
         dem.became_unemployed,
         dem.reduction_in_hours,
         dem.reduction_in_salary,
         dem.benefits_increased,
         dem.benefits_decreased,
         dem.change_in_duties_or_responsibilites,
         dem.became_employed,
         dem.increased_hours,
         dem.increased_salary,
         dem.furloughed_or_paid_leave_government_funded = dem.furloughed_or_paid_leave_,
         dem.furloughed_or_paid_leave_company_funded = dem.furloughed_or_paid_leave_.1,
         dem.paid_leave_furloughed = dem.paid_leave_furloughed,
         dem.paid_leave_returned_work = dem.paid_leave_returned_furlough,
         dem.retired
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
 #mutate_if(is.numeric, ~na_if(., -99)) %>%
  #mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
 # mutate_if(is.factor, ~na_if(., "Don't know")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(coping.dem.followupb.raw.id)
# Inspect colnames
colnames(coping.dem.followupb.raw.id)
#Differences
dim(coping.dem.followupb.raw)[1]-dim(coping.dem.followupb.raw.id)[1]
}
```

# Losing someone due to COVID 
## GLAD
### Read in data
```{r Read in data GLAD losing someone due to COVID}
if(GLAD == TRUE) {
glad.loss.baseline.raw <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data_raw/latest_freeze/coping_glad/grief_coping_glad.rds")
dim(glad.loss.baseline.raw)
colnames(glad.loss.baseline.raw)
}
  
```

Select variables GLAD losing someone due to COVID
```{r Select variables GLAD losing someone due to COVID} 
if(GLAD == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "endDate"
                  )

glad.loss.baseline.raw.id <- glad.loss.baseline.raw %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  add_column(cohort_name = "coping_glad", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
       grief.covid_lost_due_close = grief.lost_due_close_past,
       grief.suffered_past_month_loss
       
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
 #mutate_if(is.numeric, ~na_if(., -99)) %>%
  #mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
 # mutate_if(is.factor, ~na_if(., "Don't know")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))
# Inspect dimensions
dim(glad.loss.baseline.raw.id)
# Inspect colnames
colnames(glad.loss.baseline.raw.id)
#Differences
dim(glad.loss.baseline.raw.id)[1]-dim(glad.loss.baseline.raw)[1]
}
```

# Losing someone due to COVID 
## EDGI
### Read in data
```{r Read in dat EDGI losing someone due to COVID}
if(EDGI == TRUE) {
edgi.loss.baseline.raw <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data_raw/latest_freeze/coping_edgi/grief_coping_edgi.rds")
dim(edgi.loss.baseline.raw)
colnames(edgi.loss.baseline.raw)
}
```

Select variables
```{r Select variables EDGI losing someone due to COVID}
if(EDGI == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "endDate")
edgi.loss.baseline.raw.id <- edgi.loss.baseline.raw %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  add_column(cohort_name = "coping_edgi", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
       grief.covid_lost_due_close = grief.due_lost_past_month,
       grief.suffered_past_month_loss = grief.significant_relationship_suffered_loss
       
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
 #mutate_if(is.numeric, ~na_if(., -99)) %>%
  #mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
 # mutate_if(is.factor, ~na_if(., "Don't know")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))
# Inspect dimensions
dim(edgi.loss.baseline.raw.id)
# Inspect colnames
colnames(edgi.loss.baseline.raw.id)
#Differences
dim(edgi.loss.baseline.raw.id)[1]-dim(edgi.loss.baseline.raw)[1]
}
```

# Losing someone due to COVID 
## NBR
### Read in data
```{r Read in dat NBR losing someone due to COVID}
if(NBR == TRUE) {
nbr.loss.baseline.raw<- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data_raw/latest_freeze/coping_nbr/grief_coping_nbr.rds")
dim(nbr.loss.baseline.raw)
colnames(nbr.loss.baseline.raw)
}
```

Select variables NBR losing someone due to COVID
```{r Select variables NBR losing someone due to COVID}
if(NBR == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "endDate")
nbr.loss.baseline.raw.id <- nbr.loss.baseline.raw %>% #new dataset with ID
  drop_na(subjectid) %>% # Drop NAs
  add_column(cohort_name = "nbr", .before = "startDate") %>% #create new column 
  select(
         ID = subjectid, # ID
         cohort_name, # Sample
       grief.covid_lost_due_close = grief.lost_due_close_past,
       grief.suffered_past_month_loss = grief.significant_relationship_suffered_past
       
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
 #mutate_if(is.numeric, ~na_if(., -99)) %>%
  #mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
 # mutate_if(is.factor, ~na_if(., "Don't know")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))
# Inspect dimensions
dim(nbr.loss.baseline.raw.id)
# Inspect colnames
colnames(nbr.loss.baseline.raw.id)
#Differences
dim(nbr.loss.baseline.raw.id)[1]-dim(nbr.loss.baseline.raw)[1]
}
```

# Losing someone due to COVID 
## RAMP
### Read in data
```{r Read in data RAMP losing someone due to COVID}
if(RAMP == TRUE) {
ramp.loss.baseline.raw<- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data_raw/latest_freeze/ramp/grief_ramp.rds")
dim(ramp.loss.baseline.raw)
colnames(ramp.loss.baseline.raw)

}
```

Select variables RAMP losing someone due to COVID
```{r RAMP losing somone due to COVID baseline select variables}
if(RAMP == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "endDate")
ramp.loss.baseline.raw.id <- ramp.loss.baseline.raw %>% #new dataset with ID
  drop_na(`Login ID`) %>% # Drop NAs
  add_column(cohort_name = "ramp", .before = "startDate") %>% #create new column 
  select(
         ID = `Login ID`, # ID
         cohort_name, # Sample
       grief.covid_lost_due_close = grief.lost_due_close_past,
       grief.suffered_past_month_loss = grief.significant_relationship_suffered_past
       
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
 #mutate_if(is.numeric, ~na_if(., -99)) %>%
  #mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
 # mutate_if(is.factor, ~na_if(., "Don't know")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))
# Inspect dimensions
dim(ramp.loss.baseline.raw.id)
# Inspect colnames
colnames(ramp.loss.baseline.raw.id)
#Differences
dim(ramp.loss.baseline.raw.id)[1]-dim(ramp.loss.baseline.raw)[1]
}
```

# Losing someone due to COVID - follow up
## COPING 
### Read in data
```{r Read in data losing someone due to COVID COPING follow up}
if(COPING == TRUE) {
coping.loss.followupb.raw <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data_raw/latest_freeze/coping_followupb/grief_coping_followupb.rds")
dim(coping.loss.followupb.raw)
colnames(coping.loss.followupb.raw)
}
```

Select variables losing someone due to COVID COPING follow up
```{r Select variables losing someone due to COVID COPING follow up}
if(COPING == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate_waves",
                  "endDate")
coping.loss.followupb.raw.id <- coping.loss.followupb.raw %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  add_column(cohort_name = "coping", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         startDate_waves = startDate,
         #endDate,
         grief.due_past_month_lost,
         grief.suffered_past_month_loss
        
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
 #mutate_if(is.numeric, ~na_if(., -99)) %>%
  #mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
 # mutate_if(is.factor, ~na_if(., "Don't know")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))
# Inspect dimensions
dim(coping.loss.followupb.raw.id)
# Inspect colnames
colnames(coping.loss.followupb.raw.id)
#Differences
dim(coping.loss.followupb.raw.id)[1]-dim(coping.loss.followupb.raw)[1]
}
```

# Losing someone due to COVID - follow up
## RAMP 
### Read in data
```{r Read in data losing someone due to RAMP COPING follow up}
if(RAMP == TRUE) {
ramp.loss.followupb.raw <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data_raw/latest_freeze/ramp_followupb/XXXXXXX")
dim(ramp.loss.followupb.raw)
colnames(ramp.loss.followupb.raw)
}
```

Select variables losing someone due to RAMP COPING follow up
```{r Select variables losing someone due to RAMP COPING follow up}
if(RAMP == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate_waves",
                  "endDate")
ramp.loss.followupb.raw.id <- ramp.loss.followupb.raw %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  #distinct(externalDataReference, .keep_all = TRUE) %>% # Remove duplicates based on ID
  #separate(externalDataReference, into = c("Sample", "ID"), sep = 4) %>% # Split ID in Sample and Number
  #mutate(externalDataReference = as.numeric(externalDataReference)) %>%
  add_column(cohort_name = "ramp", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         startDate_waves = startDate,
         #endDate,
         grief.due_past_month_lost = grief.due_past_month_covid,
         grief.suffered_past_month_loss = grief.loss_suffered_past_month
        
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
 #mutate_if(is.numeric, ~na_if(., -99)) %>%
  #mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
 # mutate_if(is.factor, ~na_if(., "Don't know")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))
# Inspect dimensions
dim(ramp.loss.followupb.raw.id)
# Inspect colnames
colnames(ramp.loss.followupb.raw.id)
#Differences
dim(ramp.loss.followupb.raw.id)[1]-dim(ramp.loss.followupb.raw)[1]
}
```

# Loneliness at baseline
## GLAD
### Read in data
```{r Read in data GLAD loneliness at baseline}
if(GLAD == TRUE) {
glad.loneliness.baseline.raw <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data_raw/latest_freeze/coping_glad/lone_coping_glad.rds")
dim(glad.loneliness.baseline.raw)
colnames(glad.loneliness.baseline.raw)
}
```

Select variables GLAD loneliness at baseline
```{r Select variables GLAD loneliness at baseline}
if(GLAD == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "endDate")

glad.loneliness.baseline.raw.id <- glad.loneliness.baseline.raw %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  add_column(cohort_name = "coping_glad", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
        lone.felt_that_you_lack_companionship,
        lone.felt_left_out,
        lone.felt_isolated_from_others,
        lone.felt_alone,
        lone.similar_felt_pandemic = lone.similar_felt_pandemici_felt,
        lone.felt_that_you_lack_companionship.1,
        lone.felt_left_out.1,
        lone.felt_isolated_from_others.1,
        lone.felt_alone.1
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
 #mutate_if(is.numeric, ~na_if(., -99)) %>%
  #mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
 # mutate_if(is.factor, ~na_if(., "Don't know")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))
# Inspect dimensions
dim(glad.loneliness.baseline.raw.id)
# Inspect colnames
colnames(glad.loneliness.baseline.raw.id)
#Differences
dim(glad.loneliness.baseline.raw)[1]-dim(glad.loneliness.baseline.raw.id)[1]
}
```

# Loneliness at baseline
## EDGI
### Read in data
```{r Read in data EDGI loneliness at baseline}
if(EDGI == TRUE) {
edgi.loneliness.baseline.raw <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data_raw/latest_freeze/coping_edgi/lone_coping_edgi.rds")
dim(edgi.loneliness.baseline.raw)
colnames(edgi.loneliness.baseline.raw)
}
  
```

Select variables EDGI loneliness at baseline
```{r Select variables EDGI loneliness at baseline}
if(EDGI == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "endDate")
edgi.loneliness.baseline.raw.id <- edgi.loneliness.baseline.raw %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  add_column(cohort_name = "coping_edgi", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
        lone.felt_that_you_lack_companionship,
        lone.felt_left_out,
        lone.felt_isolated_from_others,
        lone.felt_alone,
        lone.similar_felt_pandemic = lone.similar_felt_pandemici_felt,
        lone.felt_that_you_lack_companionship.1,
        lone.felt_left_out.1,
        lone.felt_isolated_from_others.1,
        lone.felt_alone.1
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
 #mutate_if(is.numeric, ~na_if(., -99)) %>%
  #mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
 # mutate_if(is.factor, ~na_if(., "Don't know")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))
# Inspect dimensions
dim(edgi.loneliness.baseline.raw.id)
# Inspect colnames
colnames(edgi.loneliness.baseline.raw.id)
#Differences
dim(edgi.loneliness.baseline.raw.id)[1]-dim(edgi.loneliness.baseline.raw.id)[1]
}
```

# Loneliness at baseline
## RAMP
### Read in data
```{r Read in data RAMP loneliness at baseline}
if(RAMP == TRUE) {
  ramp.loneliness.baseline.raw <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data_raw/latest_freeze/ramp/lone_ramp.rds")
dim(ramp.loneliness.baseline.raw)
colnames(ramp.loneliness.baseline.raw)

}
  
```

Select variables RAMP loneliness at baseline
```{r Select variables RAMP loneliness at baseline}
if(RAMP == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "endDate")
ramp.loneliness.baseline.raw.id <- ramp.loneliness.baseline.raw %>% #new dataset with ID
  drop_na(`Login ID`) %>% # Drop NAs
  add_column(cohort_name = "ramp", .before = "startDate") %>% #create new column 
  select(
         ID = `Login ID`, # ID
         cohort_name, # Sample
        lone.felt_that_you_lack_companionship,
        lone.felt_left_out,
        lone.felt_isolated_from_others,
        lone.felt_alone,
        lone.similar_felt_pandemic = lone.similar_felt_pandemici_felt,
        lone.felt_that_you_lack_companionship.1,
        lone.felt_left_out.1,
        lone.felt_isolated_from_others.1,
        lone.felt_alone.1
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
 #mutate_if(is.numeric, ~na_if(., -99)) %>%
  #mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
 # mutate_if(is.factor, ~na_if(., "Don't know")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))
# Inspect dimensions
dim(ramp.loneliness.baseline.raw.id)
# Inspect colnames
colnames(ramp.loneliness.baseline.raw.id)
#Differences
dim(ramp.loneliness.baseline.raw.id)[1]-dim(ramp.loneliness.baseline.raw)[1]
}
```

# Loneliness at baseline
## NBR
### Read in data
```{r Read in data NBR loneliness at baseline}
if(NBR == TRUE) {
nbr.loneliness.baseline.raw <- readRDS(file = "/Users/helenadavies/King's College London/MT-TNG BioResource EDIT - ilovedata - ilovedata/data_raw/latest_freeze/coping_nbr/lone_coping_nbr.rds")
dim(nbr.loneliness.baseline.raw)
colnames(nbr.loneliness.baseline.raw)
}
  
```

Select variables NBR loneliness at baseline
```{r Select variables NBR loneliness at baseline}
if(NBR == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "endDate")
nbr.loneliness.baseline.raw.id <- nbr.loneliness.baseline.raw %>% #new dataset with ID
  drop_na(subjectid) %>% # Drop NAs
  add_column(cohort_name = "nbr", .before = "startDate") %>% #create new column 
  select(
         ID = subjectid, # ID
         cohort_name, # Sample
        lone.felt_that_you_lack_companionship,
        lone.felt_left_out,
        lone.felt_isolated_from_others,
        lone.felt_alone,
        lone.similar_felt_pandemic = lone.similar_felt_pandemici_felt,
        lone.felt_that_you_lack_companionship.1,
        lone.felt_left_out.1,
        lone.felt_isolated_from_others.1,
        lone.felt_alone.1
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
 #mutate_if(is.numeric, ~na_if(., -99)) %>%
  #mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
 # mutate_if(is.factor, ~na_if(., "Don't know")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))
# Inspect dimensions
dim(nbr.loneliness.baseline.raw.id)
# Inspect colnames
colnames(nbr.loneliness.baseline.raw.id)
#Differences
dim(nbr.loneliness.baseline.raw)[1]-dim(nbr.loneliness.baseline.raw.id)[1]
}
```



# TIMEPOINTS / PHASES - RAMP Demographics

Create phase columns in follow up data - RAMP
```{r Identify phases source script RAMP}
if (RAMP ==TRUE) {
source("./timepoints_RAMP.R")
}
```

Join demographics follow ups (RAMP)
```{r Merge RAMP follow up data demographics}
if(RAMP == TRUE) {
dat.raw.dem.ramp.followup <- rbind(dem.ramp.followupa.raw.id,
    dem.ramp.followupb.raw.id)

# Check column names
colnames(dat.raw.dem.ramp.followup)
}
```

Checking for number of entries per phase
```{r Check number of entries per phase RAMP demographics}
if(RAMP == TRUE) {
dat.raw.dem.ramp.followup %>%
  group_by(wave_dem) %>%
  count()
}
```

Identify duplicate IDs in a single timepoint
```{r Identify duplicate IDs in a single timepoint RAMP demographics}
if(RAMP == TRUE) {
# Identify dup IDs in a single wave 
dat.raw.dem.ramp.followup %>%
   group_by(wave_dem, ID) %>%
   summarize(N = n()) %>%
   filter(N > 1)
}
```


FOR NOW - Want the LATER data entry from people who answered twice within a single phase 
Later on - want to create variable with 'answered YES at least once' (i.e., include these entries)
[want ID AND wave to be unique]
```{r Later date entry twice in single phase RAMP demographics}
if(RAMP == TRUE) {
# Confirm number of rows in current dataset 
nrow(dat.raw.dem.ramp.followup)

# Filter out duplicated IDs AND phase, keeping the LAST entry
dat.raw.dem.ramp.followup <- dat.raw.dem.ramp.followup %>% 
    group_by(ID) %>% 
    filter(!duplicated(wave_dem,
                      fromLast = TRUE)
           )

# Confirm number of rows in dataset after filtering 
nrow(dat.raw.dem.ramp.followup)
}
```

Change follow up RAMP demographics to wide format
```{r RAMP demographics wide format}
if(RAMP == TRUE) {
dat.raw.dem.ramp.followup <- dat.raw.dem.ramp.followup %>%
  group_by(wave_dem) %>%
  mutate(row = row_number()) %>%
  tidyr::pivot_wider(id_cols = ID,
    names_from = wave_dem, 
                     values_from = c(
                      dem.nothing_has_changed,                                     
         dem.living_situation,
         dem.employment,
         dem.physical_health,
         dem.health_of_a_relative,
         dem.household_employment_status_key,
         dem.children__dependants_returning_to_school__other_education,
         dem.living_alone,
         dem.living_with_partner_or_spouse,
         dem.living_with_housemates,
         dem.age_children_living,
         dem.age_children_living.1,
         dem.living_with_other_members_of_my_family,
         dem.spouse_partner_members_living,
         dem.staying_live,
         dem.staying_live.1,
         dem.prefer_not_to_say,
         dem.made_redundant,
         dem.became_unemployed,
         dem.reduction_in_hours,
         dem.reduction_in_salary,
         dem.benefits_increased,
         dem.benefits_decreased,
         dem.change_in_duties_or_responsibilites,
         dem.became_employed,
         dem.increased_hours,
         dem.increased_salary,
         dem.furloughed_or_paid_leave_government_funded,
         dem.furloughed_or_paid_leave_company_funded,
         dem.paid_leave_furloughed,
         dem.paid_leave_returned_work,
         dem.retired )) 
  
}

```

Select variables for dataset RAMP demographics
```{r Select variables for dataset RAMP demographics}
if(RAMP == TRUE) {
dat.raw.dem.ramp.followup <- dat.raw.dem.ramp.followup %>%
  select(ID,
         `dem.nothing_has_changed_.Wave_1a`,
         `dem.nothing_has_changed_.Wave_1b`,
         `dem.nothing_has_changed_.Wave_2a`,
         `dem.nothing_has_changed_.Wave_2b`,
         `dem.nothing_has_changed_.Wave_3a`,
         `dem.nothing_has_changed_.Wave_3b`,
         `dem.nothing_has_changed_.Wave_4a`,
         `dem.nothing_has_changed_.Wave_4b`,
         `dem.nothing_has_changed_.Wave_5a`,
         `dem.nothing_has_changed_.Wave_6b`,
         `dem.nothing_has_changed_.Wave_7a`,
         `dem.nothing_has_changed_.Wave_8b`,
         `dem.nothing_has_changed_.Wave_9a`,
         `dem.nothing_has_changed_.Wave_10b`,
         `dem.nothing_has_changed_.Wave_11a`,
         `dem.nothing_has_changed_.Wave_12b`,
         `dem.nothing_has_changed_.Wave_13a`,
         `dem.nothing_has_changed_.Wave_14b`,
         `dem.nothing_has_changed_.Wave_15a`,
         `dem.nothing_has_changed_.Wave_16b`,
         `dem.nothing_has_changed_.Wave_17a`,
         
         `dem.living_situation_.Wave_1a`,
         `dem.living_situation_.Wave_1b`,
         `dem.living_situation_.Wave_2a`,
         `dem.living_situation_.Wave_2b`,
         `dem.living_situation_.Wave_3a`,
         `dem.living_situation_.Wave_3b`,
         `dem.living_situation_.Wave_4a`,
         `dem.living_situation_.Wave_4b`,
         `dem.living_situation_.Wave_5a`,
         `dem.living_situation_.Wave_6b`,
         `dem.living_situation_.Wave_7a`,
         `dem.living_situation_.Wave_8b`,
         `dem.living_situation_.Wave_9a`,
         `dem.living_situation_.Wave_10b`,
         `dem.living_situation_.Wave_11a`,
         `dem.living_situation_.Wave_12b`,
          `dem.living_situation_.Wave_13a`,
         `dem.living_situation_.Wave_14b`,
         `dem.living_situation_.Wave_15a`,
         `dem.living_situation_.Wave_16b`,
         `dem.living_situation_.Wave_17a`,
         
          
         `dem.employment_.Wave_1a`,
         `dem.employment_.Wave_1b`,
         `dem.employment_.Wave_2a`,
         `dem.employment_.Wave_2b`,
         `dem.employment_.Wave_3a`,
         `dem.employment_.Wave_3b`,
         `dem.employment_.Wave_4a`,
         `dem.employment_.Wave_4b`,
         `dem.employment_.Wave_5a`,
         `dem.employment_.Wave_6b`,
         `dem.employment_.Wave_7a`,
         `dem.employment_.Wave_8b`,
         `dem.employment_.Wave_9a`,
         `dem.employment_.Wave_10b`,
         `dem.employment_.Wave_11a`,
         `dem.employment_.Wave_12b`,
         `dem.employment_.Wave_13a`,
         `dem.employment_.Wave_14b`,
         `dem.employment_.Wave_15a`,
         `dem.employment_.Wave_16b`,
         `dem.employment_.Wave_17a`,
         
         `dem.physical_health_.Wave_1a`,
         `dem.physical_health_.Wave_1b`,
         `dem.physical_health_.Wave_2a`,
         `dem.physical_health_.Wave_2b`,
         `dem.physical_health_.Wave_3a`,
         `dem.physical_health_.Wave_3b`,
         `dem.physical_health_.Wave_4a`,
         `dem.physical_health_.Wave_4b`,
         `dem.physical_health_.Wave_5a`,
         `dem.physical_health_.Wave_6b`,
         `dem.physical_health_.Wave_7a`,
         `dem.physical_health_.Wave_8b`,
         `dem.physical_health_.Wave_9a`,
         `dem.physical_health_.Wave_10b`,
         `dem.physical_health_.Wave_11a`,
         `dem.physical_health_.Wave_12b`,
         `dem.physical_health_.Wave_13a`,
         `dem.physical_health_.Wave_14b`,
         `dem.physical_health_.Wave_15a`,
         `dem.physical_health_.Wave_16b`,
         `dem.physical_health_.Wave_17a`,
         
         `dem.health_of_a_relative_.Wave_1a`,
         `dem.health_of_a_relative_.Wave_1b`,
         `dem.health_of_a_relative_.Wave_2a`,
         `dem.health_of_a_relative_.Wave_2b`,
         `dem.health_of_a_relative_.Wave_3a`,
         `dem.health_of_a_relative_.Wave_3b`,
         `dem.health_of_a_relative_.Wave_4a`,
         `dem.health_of_a_relative_.Wave_4b`,
         `dem.health_of_a_relative_.Wave_5a`,
         `dem.health_of_a_relative_.Wave_6b`,
         `dem.health_of_a_relative_.Wave_7a`,
         `dem.health_of_a_relative_.Wave_8b`,
         `dem.health_of_a_relative_.Wave_9a`,
         `dem.health_of_a_relative_.Wave_10b`,
         `dem.health_of_a_relative_.Wave_11a`,
         `dem.health_of_a_relative_.Wave_12b`,
         `dem.health_of_a_relative_.Wave_13a`,
         `dem.health_of_a_relative_.Wave_14b`,
         `dem.health_of_a_relative_.Wave_15a`,
         `dem.health_of_a_relative_.Wave_16b`,
         `dem.health_of_a_relative_.Wave_17a`,
         
         `dem.household_employment_status_key_.Wave_1a`,
         `dem.household_employment_status_key_.Wave_1b`,
         `dem.household_employment_status_key_.Wave_2a`,
         `dem.household_employment_status_key_.Wave_2b`,
         `dem.household_employment_status_key_.Wave_3a`,
         `dem.household_employment_status_key_.Wave_3b`,
         `dem.household_employment_status_key_.Wave_4a`,
         `dem.household_employment_status_key_.Wave_4b`,
         `dem.household_employment_status_key_.Wave_5a`,
         `dem.household_employment_status_key_.Wave_6b`,
         `dem.household_employment_status_key_.Wave_7a`,
         `dem.household_employment_status_key_.Wave_8b`,
         `dem.household_employment_status_key_.Wave_9a`,
         `dem.household_employment_status_key_.Wave_10b`,
         `dem.household_employment_status_key_.Wave_11a`,
         `dem.household_employment_status_key_.Wave_12b`,
         `dem.household_employment_status_key_.Wave_13a`,
         `dem.household_employment_status_key_.Wave_14b`,
         `dem.household_employment_status_key_.Wave_15a`,
         `dem.household_employment_status_key_.Wave_16b`,
         `dem.household_employment_status_key_.Wave_17a`,
         
         `dem.children__dependants_returning_to_school__other_education_.Wave_1a`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_1b`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_2a`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_2b`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_3a`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_3b`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_4a`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_4b`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_5a`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_6b`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_7a`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_8b`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_9a`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_10b`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_11a`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_12b`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_13a`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_14b`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_15a`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_16b`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_17a`,
         
        
         
         `dem.living_alone_.Wave_1a`,
         `dem.living_alone_.Wave_1b`,
         `dem.living_alone_.Wave_2a`,
         `dem.living_alone_.Wave_2b`,
         `dem.living_alone_.Wave_3a`,
         `dem.living_alone_.Wave_3b`,
         `dem.living_alone_.Wave_4a`,
         `dem.living_alone_.Wave_4b`,
         `dem.living_alone_.Wave_5a`,
         `dem.living_alone_.Wave_6b`,
         `dem.living_alone_.Wave_7a`,
         `dem.living_alone_.Wave_8b`,
         `dem.living_alone_.Wave_9a`,
         `dem.living_alone_.Wave_10b`,
         `dem.living_alone_.Wave_11a`,
         `dem.living_alone_.Wave_12b`,
         `dem.living_alone_.Wave_13a`,
         `dem.living_alone_.Wave_14b`,
         `dem.living_alone_.Wave_15a`,
         `dem.living_alone_.Wave_16b`,
         `dem.living_alone_.Wave_17a`,
         
         `dem.living_with_partner_or_spouse_.Wave_1a`,
         `dem.living_with_partner_or_spouse_.Wave_1b`,
         `dem.living_with_partner_or_spouse_.Wave_2a`,
         `dem.living_with_partner_or_spouse_.Wave_2b`,
         `dem.living_with_partner_or_spouse_.Wave_3a`,
         `dem.living_with_partner_or_spouse_.Wave_3b`,
         `dem.living_with_partner_or_spouse_.Wave_4a`,
         `dem.living_with_partner_or_spouse_.Wave_4b`,
         `dem.living_with_partner_or_spouse_.Wave_5a`,
         `dem.living_with_partner_or_spouse_.Wave_6b`,
         `dem.living_with_partner_or_spouse_.Wave_7a`,
         `dem.living_with_partner_or_spouse_.Wave_8b`,
         `dem.living_with_partner_or_spouse_.Wave_9a`,
         `dem.living_with_partner_or_spouse_.Wave_10b`,
         `dem.living_with_partner_or_spouse_.Wave_11a`,
         `dem.living_with_partner_or_spouse_.Wave_12b`,
         `dem.living_with_partner_or_spouse_.Wave_13a`,
         `dem.living_with_partner_or_spouse_.Wave_14b`,
         `dem.living_with_partner_or_spouse_.Wave_15a`,
         `dem.living_with_partner_or_spouse_.Wave_16b`,
         `dem.living_with_partner_or_spouse_.Wave_17a`,
         
         `dem.living_with_housemates_.Wave_1a`,
         `dem.living_with_housemates_.Wave_1b`,
         `dem.living_with_housemates_.Wave_2a`,
         `dem.living_with_housemates_.Wave_2b`,
         `dem.living_with_housemates_.Wave_3a`,
         `dem.living_with_housemates_.Wave_3b`,
         `dem.living_with_housemates_.Wave_4a`,
         `dem.living_with_housemates_.Wave_4b`,
         `dem.living_with_housemates_.Wave_5a`,
         `dem.living_with_housemates_.Wave_6b`,
         `dem.living_with_housemates_.Wave_7a`,
         `dem.living_with_housemates_.Wave_8b`,
         `dem.living_with_housemates_.Wave_9a`,
         `dem.living_with_housemates_.Wave_10b`,
         `dem.living_with_housemates_.Wave_11a`,
         `dem.living_with_housemates_.Wave_12b`,
         `dem.living_with_housemates_.Wave_13a`,
         `dem.living_with_housemates_.Wave_14b`,
         `dem.living_with_housemates_.Wave_15a`,
         `dem.living_with_housemates_.Wave_16b`,
         `dem.living_with_housemates_.Wave_17a`,
         
         `dem.age_children_living_.Wave_1a`,
         `dem.age_children_living_.Wave_1b`,
         `dem.age_children_living_.Wave_2a`,
         `dem.age_children_living_.Wave_2b`,
         `dem.age_children_living_.Wave_3a`,
         `dem.age_children_living_.Wave_3b`,
         `dem.age_children_living_.Wave_4a`,
         `dem.age_children_living_.Wave_4b`,
         `dem.age_children_living_.Wave_5a`,
         `dem.age_children_living_.Wave_6b`,
         `dem.age_children_living_.Wave_7a`,
         `dem.age_children_living_.Wave_8b`,
         `dem.age_children_living_.Wave_9a`,
         `dem.age_children_living_.Wave_10b`,
         `dem.age_children_living_.Wave_11a`,
         `dem.age_children_living_.Wave_12b`,
         `dem.age_children_living_.Wave_13a`,
         `dem.age_children_living_.Wave_14b`,
         `dem.age_children_living_.Wave_15a`,
         `dem.age_children_living_.Wave_16b`,
         `dem.age_children_living_.Wave_17a`,
         
         `dem.age_children_living.1_.Wave_1a`,
         `dem.age_children_living.1_.Wave_1b`,
         `dem.age_children_living.1_.Wave_2a`,
         `dem.age_children_living.1_.Wave_2b`,
         `dem.age_children_living.1_.Wave_3a`,
         `dem.age_children_living.1_.Wave_3b`,
         `dem.age_children_living.1_.Wave_4a`,
         `dem.age_children_living.1_.Wave_4b`,
         `dem.age_children_living.1_.Wave_5a`,
         `dem.age_children_living.1_.Wave_6b`,
         `dem.age_children_living.1_.Wave_7a`,
         `dem.age_children_living.1_.Wave_8b`,
         `dem.age_children_living.1_.Wave_9a`,
         `dem.age_children_living.1_.Wave_10b`,
         `dem.age_children_living.1_.Wave_11a`,
         `dem.age_children_living.1_.Wave_12b`,
         `dem.age_children_living.1_.Wave_13a`,
         `dem.age_children_living.1_.Wave_14b`,
         `dem.age_children_living.1_.Wave_15a`,
         `dem.age_children_living.1_.Wave_16b`,
         `dem.age_children_living.1_.Wave_17a`,
         
         `dem.living_with_other_members_of_my_family_.Wave_1a`,
         `dem.living_with_other_members_of_my_family_.Wave_1b`,
         `dem.living_with_other_members_of_my_family_.Wave_2a`,
         `dem.living_with_other_members_of_my_family_.Wave_2b`,
         `dem.living_with_other_members_of_my_family_.Wave_3a`,
         `dem.living_with_other_members_of_my_family_.Wave_3b`,
         `dem.living_with_other_members_of_my_family_.Wave_4a`,
         `dem.living_with_other_members_of_my_family_.Wave_4b`,
         `dem.living_with_other_members_of_my_family_.Wave_5a`,
         `dem.living_with_other_members_of_my_family_.Wave_6b`,
         `dem.living_with_other_members_of_my_family_.Wave_7a`,
         `dem.living_with_other_members_of_my_family_.Wave_8b`,
         `dem.living_with_other_members_of_my_family_.Wave_9a`,
         `dem.living_with_other_members_of_my_family_.Wave_10b`,
         `dem.living_with_other_members_of_my_family_.Wave_11a`,
         `dem.living_with_other_members_of_my_family_.Wave_12b`,
         `dem.living_with_other_members_of_my_family_.Wave_13a`,
         `dem.living_with_other_members_of_my_family_.Wave_14b`,
         `dem.living_with_other_members_of_my_family_.Wave_15a`,
         `dem.living_with_other_members_of_my_family_.Wave_16b`,
         `dem.living_with_other_members_of_my_family_.Wave_17a`,
         
         
         `dem.spouse_partner_members_living_.Wave_1a`,
         `dem.spouse_partner_members_living_.Wave_1b`,
         `dem.spouse_partner_members_living_.Wave_2a`,
         `dem.spouse_partner_members_living_.Wave_2b`,
         `dem.spouse_partner_members_living_.Wave_3a`,
         `dem.spouse_partner_members_living_.Wave_3b`,
         `dem.spouse_partner_members_living_.Wave_4a`,
         `dem.spouse_partner_members_living_.Wave_4b`,
         `dem.spouse_partner_members_living_.Wave_5a`,
         `dem.spouse_partner_members_living_.Wave_6b`,
         `dem.spouse_partner_members_living_.Wave_7a`,
         `dem.spouse_partner_members_living_.Wave_8b`,
         `dem.spouse_partner_members_living_.Wave_9a`,
         `dem.spouse_partner_members_living_.Wave_10b`,
         `dem.spouse_partner_members_living_.Wave_11a`,
         `dem.spouse_partner_members_living_.Wave_12b`,
         `dem.spouse_partner_members_living_.Wave_13a`,
         `dem.spouse_partner_members_living_.Wave_14b`,
         `dem.spouse_partner_members_living_.Wave_15a`,
         `dem.spouse_partner_members_living_.Wave_16b`,
         `dem.spouse_partner_members_living_.Wave_17a`,
         
         `dem.staying_live_.Wave_1a`,
         `dem.staying_live_.Wave_1b`,
         `dem.staying_live_.Wave_2a`,
         `dem.staying_live_.Wave_2b`,
         `dem.staying_live_.Wave_3a`,
         `dem.staying_live_.Wave_3b`,
         `dem.staying_live_.Wave_4a`,
         `dem.staying_live_.Wave_4b`,
         `dem.staying_live_.Wave_5a`,
         `dem.staying_live_.Wave_6b`,
         `dem.staying_live_.Wave_7a`,
         `dem.staying_live_.Wave_8b`,
         `dem.staying_live_.Wave_9a`,
         `dem.staying_live_.Wave_10b`,
         `dem.staying_live_.Wave_11a`,
         `dem.staying_live_.Wave_12b`,
         `dem.staying_live_.Wave_13a`,
         `dem.staying_live_.Wave_14b`,
         `dem.staying_live_.Wave_15a`,
         `dem.staying_live_.Wave_16b`,
         `dem.staying_live_.Wave_17a`,
         
         `dem.staying_live.1_.Wave_1a`,
         `dem.staying_live.1_.Wave_1b`,
         `dem.staying_live.1_.Wave_2a`,
         `dem.staying_live.1_.Wave_2b`,
         `dem.staying_live.1_.Wave_3a`,
         `dem.staying_live.1_.Wave_3b`,
         `dem.staying_live.1_.Wave_4a`,
         `dem.staying_live.1_.Wave_4b`,
         `dem.staying_live.1_.Wave_5a`,
         `dem.staying_live.1_.Wave_6b`,
         `dem.staying_live.1_.Wave_7a`,
         `dem.staying_live.1_.Wave_8b`,
         `dem.staying_live.1_.Wave_9a`,
         `dem.staying_live.1_.Wave_10b`,
         `dem.staying_live.1_.Wave_11a`,
         `dem.staying_live.1_.Wave_12b`,
         `dem.staying_live.1_.Wave_13a`,
         `dem.staying_live.1_.Wave_14b`,
         `dem.staying_live.1_.Wave_15a`,
         `dem.staying_live.1_.Wave_16b`,
         `dem.staying_live.1_.Wave_17a`,
   
         `dem.prefer_not_to_say_.Wave_1a`,
         `dem.prefer_not_to_say_.Wave_1b`,
         `dem.prefer_not_to_say_.Wave_2a`,
         `dem.prefer_not_to_say_.Wave_2b`,
         `dem.prefer_not_to_say_.Wave_3a`,
         `dem.prefer_not_to_say_.Wave_3b`,
         `dem.prefer_not_to_say_.Wave_4a`,
         `dem.prefer_not_to_say_.Wave_4b`,
         `dem.prefer_not_to_say_.Wave_5a`,
         `dem.prefer_not_to_say_.Wave_6b`,
         `dem.prefer_not_to_say_.Wave_7a`,
         `dem.prefer_not_to_say_.Wave_8b`,
         `dem.prefer_not_to_say_.Wave_9a`,
         `dem.prefer_not_to_say_.Wave_10b`,
         `dem.prefer_not_to_say_.Wave_11a`,
         `dem.prefer_not_to_say_.Wave_12b`,
         `dem.prefer_not_to_say_.Wave_13a`,
         `dem.prefer_not_to_say_.Wave_14b`,
         `dem.prefer_not_to_say_.Wave_15a`,
         `dem.prefer_not_to_say_.Wave_16b`,
         `dem.prefer_not_to_say_.Wave_17a`,
         
         
         `dem.made_redundant_.Wave_1a`,
         `dem.made_redundant_.Wave_1b`,
         `dem.made_redundant_.Wave_2a`,
         `dem.made_redundant_.Wave_2b`,
         `dem.made_redundant_.Wave_3a`,
         `dem.made_redundant_.Wave_3b`,
         `dem.made_redundant_.Wave_4a`,
         `dem.made_redundant_.Wave_4b`,
         `dem.made_redundant_.Wave_5a`,
         `dem.made_redundant_.Wave_6b`,
         `dem.made_redundant_.Wave_7a`,
         `dem.made_redundant_.Wave_8b`,
         `dem.made_redundant_.Wave_9a`,
         `dem.made_redundant_.Wave_10b`,
         `dem.made_redundant_.Wave_11a`,
         `dem.made_redundant_.Wave_12b`,
          `dem.made_redundant_.Wave_13a`,
         `dem.made_redundant_.Wave_14b`,
         `dem.made_redundant_.Wave_15a`,
         `dem.made_redundant_.Wave_16b`,
         `dem.made_redundant_.Wave_17a`,
         
         `dem.became_unemployed_.Wave_1a`,
         `dem.became_unemployed_.Wave_1b`,
         `dem.became_unemployed_.Wave_2a`,
         `dem.became_unemployed_.Wave_2b`,
         `dem.became_unemployed_.Wave_3a`,
         `dem.became_unemployed_.Wave_3b`,
         `dem.became_unemployed_.Wave_4a`,
         `dem.became_unemployed_.Wave_4b`,
         `dem.became_unemployed_.Wave_5a`,
         `dem.became_unemployed_.Wave_6b`,
         `dem.became_unemployed_.Wave_7a`,
         `dem.became_unemployed_.Wave_8b`,
         `dem.became_unemployed_.Wave_9a`,
         `dem.became_unemployed_.Wave_10b`,
         `dem.became_unemployed_.Wave_11a`,
         `dem.became_unemployed_.Wave_12b`,
         `dem.became_unemployed_.Wave_13a`,
         `dem.became_unemployed_.Wave_14b`,
         `dem.became_unemployed_.Wave_15a`,
         `dem.became_unemployed_.Wave_16b`,
         `dem.became_unemployed_.Wave_17a`,
         
         `dem.reduction_in_hours_.Wave_1a`,
         `dem.reduction_in_hours_.Wave_1b`,
         `dem.reduction_in_hours_.Wave_2a`,
         `dem.reduction_in_hours_.Wave_2b`,
         `dem.reduction_in_hours_.Wave_3a`,
         `dem.reduction_in_hours_.Wave_3b`,
         `dem.reduction_in_hours_.Wave_4a`,
         `dem.reduction_in_hours_.Wave_4b`,
         `dem.reduction_in_hours_.Wave_5a`,
         `dem.reduction_in_hours_.Wave_6b`,
         `dem.reduction_in_hours_.Wave_7a`,
         `dem.reduction_in_hours_.Wave_8b`,
         `dem.reduction_in_hours_.Wave_9a`,
         `dem.reduction_in_hours_.Wave_10b`,
         `dem.reduction_in_hours_.Wave_11a`,
         `dem.reduction_in_hours_.Wave_12b`,
         `dem.reduction_in_hours_.Wave_13a`,
         `dem.reduction_in_hours_.Wave_14b`,
         `dem.reduction_in_hours_.Wave_15a`,
         `dem.reduction_in_hours_.Wave_16b`,
         `dem.reduction_in_hours_.Wave_17a`,
         
         `dem.reduction_in_salary_.Wave_1a`,
         `dem.reduction_in_salary_.Wave_1b`,
         `dem.reduction_in_salary_.Wave_2a`,
         `dem.reduction_in_salary_.Wave_2b`,
         `dem.reduction_in_salary_.Wave_3a`,
         `dem.reduction_in_salary_.Wave_3b`,
         `dem.reduction_in_salary_.Wave_4a`,
         `dem.reduction_in_salary_.Wave_4b`,
         `dem.reduction_in_salary_.Wave_5a`,
         `dem.reduction_in_salary_.Wave_6b`,
         `dem.reduction_in_salary_.Wave_7a`,
         `dem.reduction_in_salary_.Wave_8b`,
         `dem.reduction_in_salary_.Wave_9a`,
         `dem.reduction_in_salary_.Wave_10b`,
         `dem.reduction_in_salary_.Wave_11a`,
         `dem.reduction_in_salary_.Wave_12b`,
         `dem.reduction_in_salary_.Wave_13a`,
         `dem.reduction_in_salary_.Wave_14b`,
         `dem.reduction_in_salary_.Wave_15a`,
         `dem.reduction_in_salary_.Wave_16b`,
         `dem.reduction_in_salary_.Wave_17a`,
         
         `dem.benefits_increased_.Wave_1a`,
         `dem.benefits_increased_.Wave_1b`,
         `dem.benefits_increased_.Wave_2a`,
         `dem.benefits_increased_.Wave_2b`,
         `dem.benefits_increased_.Wave_3a`,
         `dem.benefits_increased_.Wave_3b`,
         `dem.benefits_increased_.Wave_4a`,
         `dem.benefits_increased_.Wave_4b`,
         `dem.benefits_increased_.Wave_5a`,
         `dem.benefits_increased_.Wave_6b`,
         `dem.benefits_increased_.Wave_7a`,
         `dem.benefits_increased_.Wave_8b`,
         `dem.benefits_increased_.Wave_9a`,
         `dem.benefits_increased_.Wave_10b`,
         `dem.benefits_increased_.Wave_11a`,
         `dem.benefits_increased_.Wave_12b`,
         `dem.benefits_increased_.Wave_13a`,
         `dem.benefits_increased_.Wave_14b`,
         `dem.benefits_increased_.Wave_15a`,
         `dem.benefits_increased_.Wave_16b`,
         `dem.benefits_increased_.Wave_17a`,
         
         `dem.benefits_decreased_.Wave_1a`,
         `dem.benefits_decreased_.Wave_1b`,
         `dem.benefits_decreased_.Wave_2a`,
         `dem.benefits_decreased_.Wave_2b`,
         `dem.benefits_decreased_.Wave_3a`,
         `dem.benefits_decreased_.Wave_3b`,
         `dem.benefits_decreased_.Wave_4a`,
         `dem.benefits_decreased_.Wave_4b`,
         `dem.benefits_decreased_.Wave_5a`,
         `dem.benefits_decreased_.Wave_6b`,
         `dem.benefits_decreased_.Wave_7a`,
         `dem.benefits_decreased_.Wave_8b`,
         `dem.benefits_decreased_.Wave_9a`,
         `dem.benefits_decreased_.Wave_10b`,
         `dem.benefits_decreased_.Wave_11a`,
         `dem.benefits_decreased_.Wave_12b`,
         `dem.benefits_decreased_.Wave_13a`,
         `dem.benefits_decreased_.Wave_14b`,
         `dem.benefits_decreased_.Wave_15a`,
         `dem.benefits_decreased_.Wave_16b`,
         `dem.benefits_decreased_.Wave_17a`,
         
         `dem.change_in_duties_or_responsibilites_.Wave_1a`,
         `dem.change_in_duties_or_responsibilites_.Wave_1b`,
         `dem.change_in_duties_or_responsibilites_.Wave_2a`,
         `dem.change_in_duties_or_responsibilites_.Wave_2b`,
         `dem.change_in_duties_or_responsibilites_.Wave_3a`,
         `dem.change_in_duties_or_responsibilites_.Wave_3b`,
         `dem.change_in_duties_or_responsibilites_.Wave_4a`,
         `dem.change_in_duties_or_responsibilites_.Wave_4b`,
         `dem.change_in_duties_or_responsibilites_.Wave_5a`,
         `dem.change_in_duties_or_responsibilites_.Wave_6b`,
         `dem.change_in_duties_or_responsibilites_.Wave_7a`,
         `dem.change_in_duties_or_responsibilites_.Wave_8b`,
         `dem.change_in_duties_or_responsibilites_.Wave_9a`,
         `dem.change_in_duties_or_responsibilites_.Wave_10b`,
         `dem.change_in_duties_or_responsibilites_.Wave_11a`,
         `dem.change_in_duties_or_responsibilites_.Wave_12b`,
         `dem.change_in_duties_or_responsibilites_.Wave_13a`,
         `dem.change_in_duties_or_responsibilites_.Wave_14b`,
         `dem.change_in_duties_or_responsibilites_.Wave_15a`,
         `dem.change_in_duties_or_responsibilites_.Wave_16b`,
         `dem.change_in_duties_or_responsibilites_.Wave_17a`,
         
         `dem.became_employed_.Wave_1a`,
         `dem.became_employed_.Wave_1b`,
         `dem.became_employed_.Wave_2a`,
         `dem.became_employed_.Wave_2b`,
         `dem.became_employed_.Wave_3a`,
         `dem.became_employed_.Wave_3b`,
         `dem.became_employed_.Wave_4a`,
         `dem.became_employed_.Wave_4b`,
         `dem.became_employed_.Wave_5a`,
         `dem.became_employed_.Wave_6b`,
         `dem.became_employed_.Wave_7a`,
         `dem.became_employed_.Wave_8b`,
         `dem.became_employed_.Wave_9a`,
         `dem.became_employed_.Wave_10b`,
         `dem.became_employed_.Wave_11a`,
         `dem.became_employed_.Wave_12b`,
         `dem.became_employed_.Wave_13a`,
         `dem.became_employed_.Wave_14b`,
         `dem.became_employed_.Wave_15a`,
         `dem.became_employed_.Wave_16b`,
         `dem.became_employed_.Wave_17a`,
         
         `dem.increased_hours_.Wave_1a`,
         `dem.increased_hours_.Wave_1b`,
         `dem.increased_hours_.Wave_2a`,
         `dem.increased_hours_.Wave_2b`,
         `dem.increased_hours_.Wave_3a`,
         `dem.increased_hours_.Wave_3b`,
         `dem.increased_hours_.Wave_4a`,
         `dem.increased_hours_.Wave_4b`,
         `dem.increased_hours_.Wave_5a`,
         `dem.increased_hours_.Wave_6b`,
         `dem.increased_hours_.Wave_7a`,
         `dem.increased_hours_.Wave_8b`,
         `dem.increased_hours_.Wave_9a`,
         `dem.increased_hours_.Wave_10b`,
         `dem.increased_hours_.Wave_11a`,
         `dem.increased_hours_.Wave_12b`,
         `dem.increased_hours_.Wave_13a`,
         `dem.increased_hours_.Wave_14b`,
         `dem.increased_hours_.Wave_15a`,
         `dem.increased_hours_.Wave_16b`,
         `dem.increased_hours_.Wave_17a`,
         
         `dem.furloughed_or_paid_leave_government_funded_.Wave_1a`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_1b`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_2a`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_2b`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_3a`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_3b`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_4a`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_4b`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_5a`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_6b`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_7a`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_8b`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_9a`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_10b`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_11a`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_12b`,
          `dem.furloughed_or_paid_leave_government_funded_.Wave_13a`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_14b`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_15a`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_16b`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_17a`,
         
          `dem.furloughed_or_paid_leave_company_funded_.Wave_1a`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_1b`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_2a`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_2b`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_3a`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_3b`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_4a`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_4b`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_5a`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_6b`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_7a`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_8b`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_9a`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_10b`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_11a`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_12b`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_13a`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_14b`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_15a`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_16b`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_17a`,
         
          `dem.paid_leave_furloughed_.Wave_1a`,
         `dem.paid_leave_furloughed_.Wave_1b`,
         `dem.paid_leave_furloughed_.Wave_2a`,
         `dem.paid_leave_furloughed_.Wave_2b`,
         `dem.paid_leave_furloughed_.Wave_3a`,
         `dem.paid_leave_furloughed_.Wave_3b`,
         `dem.paid_leave_furloughed_.Wave_4a`,
         `dem.paid_leave_furloughed_.Wave_4b`,
         `dem.paid_leave_furloughed_.Wave_5a`,
         `dem.paid_leave_furloughed_.Wave_6b`,
         `dem.paid_leave_furloughed_.Wave_7a`,
         `dem.paid_leave_furloughed_.Wave_8b`,
         `dem.paid_leave_furloughed_.Wave_9a`,
         `dem.paid_leave_furloughed_.Wave_10b`,
         `dem.paid_leave_furloughed_.Wave_11a`,
         `dem.paid_leave_furloughed_.Wave_12b`,
         `dem.paid_leave_furloughed_.Wave_13a`,
         `dem.paid_leave_furloughed_.Wave_14b`,
         `dem.paid_leave_furloughed_.Wave_15a`,
         `dem.paid_leave_furloughed_.Wave_16b`,
         `dem.paid_leave_furloughed_.Wave_17a`,
         
          `dem.paid_leave_returned_work_.Wave_1a`,
         `dem.paid_leave_returned_work_.Wave_1b`,
         `dem.paid_leave_returned_work_.Wave_2a`,
         `dem.paid_leave_returned_work_.Wave_2b`,
         `dem.paid_leave_returned_work_.Wave_3a`,
         `dem.paid_leave_returned_work_.Wave_3b`,
         `dem.paid_leave_returned_work_.Wave_4a`,
         `dem.paid_leave_returned_work_.Wave_4b`,
         `dem.paid_leave_returned_work_.Wave_5a`,
         `dem.paid_leave_returned_work_.Wave_6b`,
         `dem.paid_leave_returned_work_.Wave_7a`,
         `dem.paid_leave_returned_work_.Wave_8b`,
         `dem.paid_leave_returned_work_.Wave_9a`,
         `dem.paid_leave_returned_work_.Wave_10b`,
         `dem.paid_leave_returned_work_.Wave_11a`,
         `dem.paid_leave_returned_work_.Wave_12b`,
         `dem.paid_leave_returned_work_.Wave_13a`,
         `dem.paid_leave_returned_work_.Wave_14b`,
         `dem.paid_leave_returned_work_.Wave_15a`,
         `dem.paid_leave_returned_work_.Wave_16b`,
         `dem.paid_leave_returned_work_.Wave_17a`,
         
          `dem.retired_.Wave_1a`,
         `dem.retired_.Wave_1b`,
         `dem.retired_.Wave_2a`,
         `dem.retired_.Wave_2b`,
         `dem.retired_.Wave_3a`,
         `dem.retired_.Wave_3b`,
         `dem.retired_.Wave_4a`,
         `dem.retired_.Wave_4b`,
         `dem.retired_.Wave_5a`,
         `dem.retired_.Wave_6b`,
         `dem.retired_.Wave_7a`,
         `dem.retired_.Wave_8b`,
         `dem.retired_.Wave_9a`,
         `dem.retired_.Wave_10b`,
         `dem.retired_.Wave_11a`,
         `dem.retired_.Wave_12b`,
         `dem.retired_.Wave_13a`,
         `dem.retired_.Wave_14b`,
         `dem.retired_.Wave_15a`,
         `dem.retired_.Wave_16b`,
         `dem.retired_.Wave_17a`
         
         )
}
```

Remove duplicate IDs RAMP demographics
```{r Remove duplicate IDs RAMP demographics}
if(RAMP == TRUE) {
# Check col names
colnames(dat.raw.dem.ramp.followup)

# Remove dupilcate IDs (as each wave is now a column, there should be NO dup IDs)
dat.raw.dem.ramp.followup  <- dat.raw.dem.ramp.followup %>%
  filter(., !duplicated(ID)) 

# Check number of rows
nrow(dat.raw.dem.ramp.followup)
}
```

# TIMEPOINTS / PHASES - TAF RAMP
Create phase columns in follow up data - RAMP
```{r Identify phase datas RAMP TAF}
if (RAMP ==TRUE) {
source("./timepoints_RAMP.R")
}
```

Join TAF follow ups (RAMP)
```{r Merge follow up RAMP TAF}
if(RAMP == TRUE) {
dat.raw.taf.ramp <- rbind(taf.ramp.followupa.raw.id,
    taf.ramp.followupb.raw.id)

# Check column names
colnames(dat.raw.taf.ramp)
}
```

Check for number of entries per wave
```{r Check number of entries per wave RAMP TAF}
if(RAMP == TRUE) {
dat.raw.taf.ramp %>%
  group_by(wave_taf) %>%
  count()
}
```

Identify duplicate IDs in a single timepoint
```{r Identify duplicate IDs in a single timepoint RAMP TAF}
if(RAMP == TRUE) {
# Identify dup IDs in a single wave 
dat.raw.taf.ramp %>%
   group_by(wave_taf, ID) %>%
   summarize(N = n()) %>%
   filter(N > 1)
}
```

(Again) FOR NOW - Want the LATER data entry from people who answered twice within a single wave 
Later on - want to create variable with 'answered YES at least once'
[want ID AND wave to be unique]
```{r Later data entry RAMP TAF}
if(RAMP == TRUE) {

# Confirm number of rows in current dataset 
nrow(dat.raw.taf.ramp)

# Filter out duplicated IDs AND wave, keeping the LAST entry
dat.raw.taf.ramp <- dat.raw.taf.ramp %>% 
    group_by(ID) %>% 
    filter(!duplicated(wave_taf,
                      fromLast = TRUE)
           )

# Confirm number of rows in dataset after filtering 
nrow(dat.raw.taf.ramp)
}
```

Change follow up TAF RAMP to wide format
```{r TAF RAMP wide format}
if(RAMP == TRUE) {
dat.raw.taf.ramp <- dat.raw.taf.ramp %>%
  group_by(wave_taf) %>%
  mutate(row = row_number()) %>%
  tidyr::pivot_wider(id_cols = ID,
    names_from = wave_taf, 
                     values_from = c(taf.worth_living_life_people,
                              taf.felt_weeks_past,
                              taf.have_you_contemplated_harming_yourself,
                              taf.felt_weeks_past.1,
                              taf.meant_life_end_weeks)) 
  
}

```

Select variables for dataset TAF RAMP
```{r Select variables for dataset TAF RAMP}
if(RAMP == TRUE) {
dat.raw.taf.ramp <- dat.raw.taf.ramp %>%
  select(ID,
         `taf.worth_living_life_people_.Wave_1a`,
         `taf.worth_living_life_people_.Wave_1b`,
         `taf.worth_living_life_people_.Wave_2a`,
         `taf.worth_living_life_people_.Wave_2b`,
         `taf.worth_living_life_people_.Wave_3a`,
         `taf.worth_living_life_people_.Wave_3b`,
         `taf.worth_living_life_people_.Wave_4a`,
         `taf.worth_living_life_people_.Wave_4b`,
         `taf.worth_living_life_people_.Wave_5a`,
         `taf.worth_living_life_people_.Wave_6b`,
         `taf.worth_living_life_people_.Wave_7a`,
         `taf.worth_living_life_people_.Wave_8b`,
         `taf.worth_living_life_people_.Wave_9a`,
         `taf.worth_living_life_people_.Wave_10b`,
         `taf.worth_living_life_people_.Wave_11a`,
         `taf.worth_living_life_people_.Wave_12b`,
         `taf.worth_living_life_people_.Wave_13a`,
         `taf.worth_living_life_people_.Wave_14b`,
         `taf.worth_living_life_people_.Wave_15a`,
         `taf.worth_living_life_people_.Wave_16b`,
         `taf.worth_living_life_people_.Wave_17a`,
         
         
         `taf.felt_weeks_past_.Wave_1a`,
         `taf.felt_weeks_past_.Wave_1b`,
         `taf.felt_weeks_past_.Wave_2a`,
         `taf.felt_weeks_past_.Wave_2b`,
         `taf.felt_weeks_past_.Wave_3a`,
         `taf.felt_weeks_past_.Wave_3b`,
         `taf.felt_weeks_past_.Wave_4a`,
         `taf.felt_weeks_past_.Wave_4b`,
         `taf.felt_weeks_past_.Wave_5a`,
         `taf.felt_weeks_past_.Wave_6b`,
         `taf.felt_weeks_past_.Wave_7a`,
         `taf.felt_weeks_past_.Wave_8b`,
         `taf.felt_weeks_past_.Wave_9a`,
         `taf.felt_weeks_past_.Wave_10b`,
         `taf.felt_weeks_past_.Wave_11a`,
         `taf.felt_weeks_past_.Wave_12b`,
         `taf.felt_weeks_past_.Wave_13a`,
         `taf.felt_weeks_past_.Wave_14b`,
         `taf.felt_weeks_past_.Wave_15a`,
         `taf.felt_weeks_past_.Wave_16b`,
         `taf.felt_weeks_past_.Wave_17a`,
         
         `taf.have_you_contemplated_harming_yourself_.Wave_1a`,
         `taf.have_you_contemplated_harming_yourself_.Wave_1b`,
         `taf.have_you_contemplated_harming_yourself_.Wave_2a`,
         `taf.have_you_contemplated_harming_yourself_.Wave_2b`,
         `taf.have_you_contemplated_harming_yourself_.Wave_3a`,
         `taf.have_you_contemplated_harming_yourself_.Wave_3b`,
         `taf.have_you_contemplated_harming_yourself_.Wave_4a`,
         `taf.have_you_contemplated_harming_yourself_.Wave_4b`,
         `taf.have_you_contemplated_harming_yourself_.Wave_5a`,
         `taf.have_you_contemplated_harming_yourself_.Wave_6b`,
         `taf.have_you_contemplated_harming_yourself_.Wave_7a`,
         `taf.have_you_contemplated_harming_yourself_.Wave_8b`,
         `taf.have_you_contemplated_harming_yourself_.Wave_9a`,
         `taf.have_you_contemplated_harming_yourself_.Wave_10b`,
         `taf.have_you_contemplated_harming_yourself_.Wave_11a`,
         `taf.have_you_contemplated_harming_yourself_.Wave_12b`,
         `taf.have_you_contemplated_harming_yourself_.Wave_13a`,
         `taf.have_you_contemplated_harming_yourself_.Wave_14b`,
         `taf.have_you_contemplated_harming_yourself_.Wave_15a`,
         `taf.have_you_contemplated_harming_yourself_.Wave_16b`,
         `taf.have_you_contemplated_harming_yourself_.Wave_17a`,
         
         `taf.felt_weeks_past.1_.Wave_1a`,
         `taf.felt_weeks_past.1_.Wave_1b`,
         `taf.felt_weeks_past.1_.Wave_2a`,
         `taf.felt_weeks_past.1_.Wave_2b`,
         `taf.felt_weeks_past.1_.Wave_3a`,
         `taf.felt_weeks_past.1_.Wave_3b`,
         `taf.felt_weeks_past.1_.Wave_4a`,
         `taf.felt_weeks_past.1_.Wave_4b`,
         `taf.felt_weeks_past.1_.Wave_5a`,
         `taf.felt_weeks_past.1_.Wave_6b`,
         `taf.felt_weeks_past.1_.Wave_7a`,
         `taf.felt_weeks_past.1_.Wave_8b`,
         `taf.felt_weeks_past.1_.Wave_9a`,
         `taf.felt_weeks_past.1_.Wave_10b`,
         `taf.felt_weeks_past.1_.Wave_11a`,
         `taf.felt_weeks_past.1_.Wave_12b`,
         `taf.felt_weeks_past.1_.Wave_13a`,
         `taf.felt_weeks_past.1_.Wave_14b`,
         `taf.felt_weeks_past.1_.Wave_15a`,
         `taf.felt_weeks_past.1_.Wave_16b`,
         `taf.felt_weeks_past.1_.Wave_17a`,
         
         
         
         `taf.meant_life_end_weeks_.Wave_1a`,
         `taf.meant_life_end_weeks_.Wave_1b`,
         `taf.meant_life_end_weeks_.Wave_2a`,
         `taf.meant_life_end_weeks_.Wave_2b`,
         `taf.meant_life_end_weeks_.Wave_3a`,
         `taf.meant_life_end_weeks_.Wave_3b`,
         `taf.meant_life_end_weeks_.Wave_4a`,
         `taf.meant_life_end_weeks_.Wave_4b`,
         `taf.meant_life_end_weeks_.Wave_5a`,
         `taf.meant_life_end_weeks_.Wave_6b`,
         `taf.meant_life_end_weeks_.Wave_7a`,
         `taf.meant_life_end_weeks_.Wave_8b`,
         `taf.meant_life_end_weeks_.Wave_9a`,
         `taf.meant_life_end_weeks_.Wave_10b`,
         `taf.meant_life_end_weeks_.Wave_11a`,
         `taf.meant_life_end_weeks_.Wave_12b`,
         `taf.meant_life_end_weeks_.Wave_13a`,
         `taf.meant_life_end_weeks_.Wave_14b`,
         `taf.meant_life_end_weeks_.Wave_15a`,
         `taf.meant_life_end_weeks_.Wave_16b`,
         `taf.meant_life_end_weeks_.Wave_17a`
         )
}
```

Remove duplicate IDs TAF RAMP
```{r Remove duplicate IDs TAF RAMP}
if(RAMP == TRUE) {
# Check col names
colnames(dat.raw.taf.ramp)

# Remove dupilcate IDs (as each wave is now a column, there should be NO dup IDs)
dat.raw.taf.ramp  <- dat.raw.taf.ramp %>%
  filter(., !duplicated(ID)) 

# Check number of rows
nrow(dat.raw.taf.ramp)
}
```

# TIMEPOINTS / PHASES - RAMP - EDEQ SCREENER RAMP

**Need to think about people who answered EDEQ screener (which is only in follow up B) in an 'A' timepoint = 11 people
(think will just drop them for the plots, but for the regression should actually keep them)

Check number of entries per wave
```{r Check number of entries per wave RAMP EDEQ screener}
if(RAMP == TRUE) {
edeq.ramp.followupb.screener.raw.id %>%
  group_by(wave_edeq) %>%
  count()
}
```

Idenfity duplicate IDs in a single wave
```{r Idenfity duplicate IDs in a single wave RAMP EDEQ screener}
if(RAMP == TRUE) {
# Identify dup IDs in a single wave
edeq.ramp.followupb.screener.raw.id %>%
   group_by(wave_edeq, ID) %>%
   summarize(N = n()) %>%
   filter(N > 1)
}
```

Want the LATER data entry from people who answered twice within a single wave (again, for now!)
[want ID AND wave to be unique]
```{r Later date entry RAMP EDEQ screener}
if(RAMP == TRUE) {

# Confirm number of rows in current dataset (= 26411)
nrow(edeq.ramp.followupb.screener.raw.id)

# Filter out duplicated IDs AND wave, keeping the LAST entry
edeq.ramp.followupb.screener.raw.id <- edeq.ramp.followupb.screener.raw.id %>% 
    group_by(ID) %>% 
    filter(!duplicated(wave_edeq,
                      fromLast = TRUE)
           )

# Confirm number of rows in dataset after filtering (should be 26411 - 41)
nrow(edeq.ramp.followupb.screener.raw.id)
}
```

Change follow up EDEQ RAMP screener to wide format
```{r RAMP EDEQ screener wide format}
if(RAMP == TRUE) {
edeq.ramp.followupb.screener.raw.id <- edeq.ramp.followupb.screener.raw.id %>%
  group_by(wave_edeq) %>%
  mutate(row = row_number()) %>%
  tidyr::pivot_wider(id_cols = ID,
    names_from = wave_edeq, 
                     values_from = c(ed_scid5.regular_episodes_eating_binges,
                                     ed_scid5.weigh_weighed_past_month,
                                     ed_scid5.regular_episodes_eating_binges_numeric,
                                     ed_scid5.weigh_weighed_past_month_numeric)) 
  
}
```

Select variables for dataset EDEQ RAMP screener
```{r Select variables for dataset RAMP EDEQ screener}
if(RAMP == TRUE) {
edeq.ramp.followupb.screener.raw.id <- edeq.ramp.followupb.screener.raw.id  %>%
  select(ID,
         `ed_scid5.regular_episodes_eating_binges_.Wave_1b`,
         `ed_scid5.regular_episodes_eating_binges_.Wave_2b` ,    
         `ed_scid5.regular_episodes_eating_binges_.Wave_3b` ,       
         `ed_scid5.regular_episodes_eating_binges_.Wave_4b`,
         `ed_scid5.regular_episodes_eating_binges_.Wave_6b`,
         `ed_scid5.regular_episodes_eating_binges_.Wave_8b`,
         `ed_scid5.regular_episodes_eating_binges_.Wave_10b`,
         `ed_scid5.regular_episodes_eating_binges_.Wave_12b`,
         `ed_scid5.regular_episodes_eating_binges_.Wave_14b`,
         `ed_scid5.regular_episodes_eating_binges_.Wave_16b`,
         
         `ed_scid5.weigh_weighed_past_month_.Wave_1b`,
         `ed_scid5.weigh_weighed_past_month_.Wave_2b` ,    
         `ed_scid5.weigh_weighed_past_month_.Wave_3b` ,       
         `ed_scid5.weigh_weighed_past_month_.Wave_4b`,
         `ed_scid5.weigh_weighed_past_month_.Wave_6b`,
         `ed_scid5.weigh_weighed_past_month_.Wave_8b`,
         `ed_scid5.weigh_weighed_past_month_.Wave_10b`,
         `ed_scid5.weigh_weighed_past_month_.Wave_12b`,
         `ed_scid5.weigh_weighed_past_month_.Wave_14b`,
         `ed_scid5.weigh_weighed_past_month_.Wave_16b`,
         
          `ed_scid5.regular_episodes_eating_binges_numeric_.Wave_1b`,
         `ed_scid5.regular_episodes_eating_binges_numeric_.Wave_2b` ,    
         `ed_scid5.regular_episodes_eating_binges_numeric_.Wave_3b` ,       
         `ed_scid5.regular_episodes_eating_binges_numeric_.Wave_4b`,
         `ed_scid5.regular_episodes_eating_binges_numeric_.Wave_6b`,
         `ed_scid5.regular_episodes_eating_binges_numeric_.Wave_8b`,
         `ed_scid5.regular_episodes_eating_binges_numeric_.Wave_10b`,
         `ed_scid5.regular_episodes_eating_binges_numeric_.Wave_12b`,
         `ed_scid5.regular_episodes_eating_binges_numeric_.Wave_14b`,
         `ed_scid5.regular_episodes_eating_binges_numeric_.Wave_16b`,
         
         `ed_scid5.weigh_weighed_past_month_numeric_.Wave_1b`,
         `ed_scid5.weigh_weighed_past_month_numeric_.Wave_2b` ,    
         `ed_scid5.weigh_weighed_past_month_numeric_.Wave_3b` ,       
         `ed_scid5.weigh_weighed_past_month_numeric_.Wave_4b`,
         `ed_scid5.weigh_weighed_past_month_numeric_.Wave_6b`,
         `ed_scid5.weigh_weighed_past_month_numeric_.Wave_8b`,
         `ed_scid5.weigh_weighed_past_month_numeric_.Wave_10b`,
         `ed_scid5.weigh_weighed_past_month_numeric_.Wave_12b`,
         `ed_scid5.weigh_weighed_past_month_numeric_.Wave_14b`,
         `ed_scid5.weigh_weighed_past_month_numeric_.Wave_16b`
         )
}
```

Remove duplicate IDs EDEQ RAMP screener
```{r Remove duplicate IDs RAMP EDEQ screener}
if(RAMP == TRUE) {
# Check col names
colnames(edeq.ramp.followupb.screener.raw.id)

# Remove dupilcate IDs (as each wave is now a column, there should be NO dup IDs)
edeq.ramp.followupb.screener.raw.id  <- edeq.ramp.followupb.screener.raw.id  %>%
  filter(., !duplicated(ID)) 

# Check number of rows
nrow(edeq.ramp.followupb.screener.raw.id)
}

```

# TIMEPOINTS / PHASES - loss of loved one due to COVID RAMP
```{r Check number of entries per phase loss of loved one due to COVID RAMP}
if(RAMP == TRUE) {
ramp.loss.followupb.raw.id %>%
  group_by(wave_loss) %>%
  count()
}
```

Identify duplicate IDs in a single timepoint
```{r Identify duplicate IDs in a single timepoint loss of loved one due to COVID RAMP}
if(RAMP == TRUE) {
##Identify dup IDs in a single wave 
ramp.loss.followupb.raw.id %>%
   group_by(wave_loss, ID) %>%
   summarize(N = n()) %>%
   filter(N > 1)
}
```

*FOR NOW - Want the LATER data entry from people who answered twice within a single wave 
Later on - want to create variable with 'answered YES at least once'
[want ID AND wave to be unique]
```{r Later date entry loss of loved one due to COVID RAMP}
if(RAMP == TRUE) {
# Confirm number of rows in current dataset 
nrow(ramp.loss.followupb.raw.id)
# Filter out duplicated IDs AND wave, keeping the LAST entry
ramp.loss.followupb.raw.id <- ramp.loss.followupb.raw.id %>% 
    group_by(ID) %>% 
    filter(!duplicated(wave_loss,
                      fromLast = TRUE)
           )
# Confirm number of rows in dataset after filtering 
nrow(ramp.loss.followupb.raw.id)
}
```

Change follow up loss of loved one due to COVID RAMP to wide format
```{r Loss of loved one due to COVID RAMP wide format}
if(RAMP == TRUE) {
ramp.loss.followupb.raw.id <- ramp.loss.followupb.raw.id %>%
  group_by(wave_loss) %>%
  mutate(row = row_number()) %>%
  tidyr::pivot_wider(id_cols = ID,
    names_from = wave_loss, 
                     values_from = c( grief.due_past_month_lost,
                                      grief.suffered_past_month_loss
                       )) 
  
}
```

Select variables for dataset loss of loved one due to COVID RAMP
```{r Select variable loss of loved one due to COVID RAMP}
if(RAMP == TRUE) {
ramp.loss.followupb.raw.id <- ramp.loss.followupb.raw.id %>%
  select(ID,
         `grief.due_past_month_lost_.Wave_1b`,
         `grief.due_past_month_lost_.Wave_2b`,
         `grief.due_past_month_lost_.Wave_3b`,
         `grief.due_past_month_lost_.Wave_4b`,
         `grief.due_past_month_lost_.Wave_6b`,
         `grief.due_past_month_lost_.Wave_8b`,
         `grief.due_past_month_lost_.Wave_10b`, # Why was this hashed out?
         `grief.due_past_month_lost_.Wave_12b`,
         `grief.due_past_month_lost_.Wave_14b`,
         `grief.due_past_month_lost_.Wave_16b`,
         
         `grief.suffered_past_month_loss_.Wave_1b`,
         `grief.suffered_past_month_loss_.Wave_2b`,
         `grief.suffered_past_month_loss_.Wave_3b`,
         `grief.suffered_past_month_loss_.Wave_4b`,
         `grief.suffered_past_month_loss_.Wave_6b`,
         `grief.suffered_past_month_loss_.Wave_8b`,
         `grief.suffered_past_month_loss_.Wave_10b`,
         `grief.suffered_past_month_loss_.Wave_12b`,
         `grief.suffered_past_month_loss_.Wave_14b`,
         `grief.suffered_past_month_loss_.Wave_16b`
         
         
         )
}
```

Remove duplicate IDs loss of loved one due to COVID RAMP
```{r Remove duplicate IDs loss of loved one due to COVID RAMP}
if(RAMP == TRUE) {
# Check col names
colnames(ramp.loss.followupb.raw.id)
# Remove dupilcate IDs (as each wave is now a column, there should be NO dup IDs)
ramp.loss.followupb.raw.id  <- ramp.loss.followupb.raw.id %>%
  filter(., !duplicated(ID)) 
# Check number of rows
nrow(ramp.loss.followupb.raw.id)
}
```

# TIMEPOINTS / PHASES - RESP RAMP 

Join RAMP resp datasets follow ups
```{r Merge RAMP resp}
if(RAMP == TRUE) {
ramp.followup.resp.id <- rbind(ramp.followupa.resp.id,
    ramp.followupb.resp.id)

# Check column names
colnames(ramp.followup.resp.id)
}
```

Check number of entries per wave
```{r Check number of entries per wave RAMP resp}
if(RAMP == TRUE) {
ramp.followup.resp.id %>%
  group_by(wave_resp) %>%
  count()
}
```

Idenfity duplicate IDs in a single wave
```{r Idenfity duplicate IDs in a single wave RAMP resp}
if(RAMP == TRUE) {
# Identify dup IDs in a single wave
ramp.followup.resp.id %>%
   group_by(wave_resp, ID) %>%
   summarize(N = n()) %>%
   filter(N > 1)
}
```

Want the LATER data entry from people who answered twice within a single wave (again, for now!)
[want ID AND wave to be unique]
```{r Later date entry RAMP resp}
if(RAMP == TRUE) {

# Confirm number of rows in current dataset
nrow(ramp.followup.resp.id)

# Filter out duplicated IDs AND wave, keeping the LAST entry
ramp.followup.resp.id <- ramp.followup.resp.id %>% 
    group_by(ID) %>% 
    filter(!duplicated(wave_resp,
                      fromLast = TRUE)
           )

# Confirm number of rows in dataset after filtering 
nrow(ramp.followup.resp.id)
}
```

Change follow up RAMP resp to wide format
```{r RAMP resp wide format}
if(RAMP == TRUE) {
ramp.followup.resp.id <- ramp.followup.resp.id %>%
  group_by(wave_resp) %>%
  mutate(row = row_number()) %>%
  tidyr::pivot_wider(id_cols = ID,
    names_from = wave_resp, 
                     values_from = c(resp.coronavirus_test_nosethroat_swab,
         resp.results_nosethroat_swab_test,
         resp.coronavirus_antibody_test,
         resp.coronavirus_antibody_test)) 
  
} 
```

Select variables for dataset RAMP resp
```{r Select variables for dataset RAMP resp}
if(RAMP == TRUE) {
ramp.followup.resp.id <- ramp.followup.resp.id  %>%
  select(ID,
         `resp.coronavirus_test_nosethroat_swab_.Wave_1a`,
         `resp.coronavirus_test_nosethroat_swab_.Wave_1b`,
         `resp.coronavirus_test_nosethroat_swab_.Wave_2a`,
         `resp.coronavirus_test_nosethroat_swab_.Wave_2b` ,
         `resp.coronavirus_test_nosethroat_swab_.Wave_3a`,
         `resp.coronavirus_test_nosethroat_swab_.Wave_3b` , 
         `resp.coronavirus_test_nosethroat_swab_.Wave_4a`,
         `resp.coronavirus_test_nosethroat_swab_.Wave_4b`,
         `resp.coronavirus_test_nosethroat_swab_.Wave_5a`,
         `resp.coronavirus_test_nosethroat_swab_.Wave_6b`,
         `resp.coronavirus_test_nosethroat_swab_.Wave_7a`,
         `resp.coronavirus_test_nosethroat_swab_.Wave_8b`,
         `resp.coronavirus_test_nosethroat_swab_.Wave_9a`,
         `resp.coronavirus_test_nosethroat_swab_.Wave_10b`,
         `resp.coronavirus_test_nosethroat_swab_.Wave_11a`,
         `resp.coronavirus_test_nosethroat_swab_.Wave_12b`,
         `resp.coronavirus_test_nosethroat_swab_.Wave_13a`,
         `resp.coronavirus_test_nosethroat_swab_.Wave_14b`,
         `resp.coronavirus_test_nosethroat_swab_.Wave_15a`,
         `resp.coronavirus_test_nosethroat_swab_.Wave_16b`,
         `resp.coronavirus_test_nosethroat_swab_.Wave_17a`,
         
         `resp.results_nosethroat_swab_test_.Wave_1a`,
         `resp.results_nosethroat_swab_test_.Wave_1b`,
         `resp.results_nosethroat_swab_test_.Wave_2a`,
         `resp.results_nosethroat_swab_test_.Wave_2b` ,
         `resp.results_nosethroat_swab_test_.Wave_3a`,
         `resp.results_nosethroat_swab_test_.Wave_3b` , 
         `resp.results_nosethroat_swab_test_.Wave_4a`,
         `resp.results_nosethroat_swab_test_.Wave_4b`,
         `resp.results_nosethroat_swab_test_.Wave_5a`,
         `resp.results_nosethroat_swab_test_.Wave_6b`,
         `resp.results_nosethroat_swab_test_.Wave_7a`,
         `resp.results_nosethroat_swab_test_.Wave_8b`,
         `resp.results_nosethroat_swab_test_.Wave_9a`,
         `resp.results_nosethroat_swab_test_.Wave_10b`,
         `resp.results_nosethroat_swab_test_.Wave_11a`,
         `resp.results_nosethroat_swab_test_.Wave_12b`,
         `resp.results_nosethroat_swab_test_.Wave_13a`,
         `resp.results_nosethroat_swab_test_.Wave_14b`,
         `resp.results_nosethroat_swab_test_.Wave_15a`,
         `resp.results_nosethroat_swab_test_.Wave_16b`,
         `resp.results_nosethroat_swab_test_.Wave_17a`,
         
          `resp.coronavirus_antibody_test_.Wave_1a`,
         `resp.coronavirus_antibody_test_.Wave_1b`,
         `resp.coronavirus_antibody_test_.Wave_2a`,
         `resp.coronavirus_antibody_test_.Wave_2b` ,
         `resp.coronavirus_antibody_test_.Wave_3a`,
         `resp.coronavirus_antibody_test_.Wave_3b` , 
         `resp.coronavirus_antibody_test_.Wave_4a`,
         `resp.coronavirus_antibody_test_.Wave_4b`,
         `resp.coronavirus_antibody_test_.Wave_5a`,
         `resp.coronavirus_antibody_test_.Wave_6b`,
         `resp.coronavirus_antibody_test_.Wave_7a`,
         `resp.coronavirus_antibody_test_.Wave_8b`,
         `resp.coronavirus_antibody_test_.Wave_9a`,
         `resp.coronavirus_antibody_test_.Wave_10b`,
         `resp.coronavirus_antibody_test_.Wave_11a`,
         `resp.coronavirus_antibody_test_.Wave_12b`,
         `resp.coronavirus_antibody_test_.Wave_13a`,
         `resp.coronavirus_antibody_test_.Wave_14b`,
         `resp.coronavirus_antibody_test_.Wave_15a`,
         `resp.coronavirus_antibody_test_.Wave_16b`,
         `resp.coronavirus_antibody_test_.Wave_17a`,
         
         `resp.coronavirus_antibody_test_.Wave_1a`,
         `resp.coronavirus_antibody_test_.Wave_1b`,
         `resp.coronavirus_antibody_test_.Wave_2a`,
         `resp.coronavirus_antibody_test_.Wave_2b` ,
         `resp.coronavirus_antibody_test_.Wave_3a`,
         `resp.coronavirus_antibody_test_.Wave_3b` , 
         `resp.coronavirus_antibody_test_.Wave_4a`,
         `resp.coronavirus_antibody_test_.Wave_4b`,
         `resp.coronavirus_antibody_test_.Wave_5a`,
         `resp.coronavirus_antibody_test_.Wave_6b`,
         `resp.coronavirus_antibody_test_.Wave_7a`,
         `resp.coronavirus_antibody_test_.Wave_8b`,
         `resp.coronavirus_antibody_test_.Wave_9a`,
         `resp.coronavirus_antibody_test_.Wave_10b`,
         `resp.coronavirus_antibody_test_.Wave_11a`,
         `resp.coronavirus_antibody_test_.Wave_12b`,
         `resp.coronavirus_antibody_test_.Wave_13a`,
         `resp.coronavirus_antibody_test_.Wave_14b`,
         `resp.coronavirus_antibody_test_.Wave_15a`,
         `resp.coronavirus_antibody_test_.Wave_16b`,
         `resp.coronavirus_antibody_test_.Wave_17a`)
}
```

Remove duplicate RAMP resp screener
```{r Remove duplicate IDs RAMP resp}
if(RAMP == TRUE) {
# Check col names
colnames(ramp.followup.resp.id)

# Remove dupilcate IDs (as each wave is now a column, there should be NO dup IDs)
ramp.followup.resp.id  <- ramp.followup.resp.id  %>%
  filter(., !duplicated(ID)) 

# Check number of rows
nrow(ramp.followup.resp.id)
}

```

# TIMEPOINTS / PHASES - COPING demographics

Create a phase columns in follow up data
```{r Identify phase data COPING follow up demographics}
if (COPING ==TRUE) {
source("./timepoints_COPING.R")
}
```

Join COPING demographics datasets follow ups
```{r Merge COPING follow up demographics}
if(COPING == TRUE) {
dat.raw.dem.coping.followup <- rbind(coping.dem.followupb.raw.id,
    coping.dem.followupa.raw.id)

# Check column names
colnames(dat.raw.dem.coping.followup)
}
```

Check for number of entries per wave
```{r Check for number of entries per wave COPING follow up demographics}
if(COPING == TRUE) {
dat.raw.dem.coping.followup %>%
  group_by(wave_dem) %>%
  count()

}
```

Identify duplicate IDs in a single timepoint
```{r Identify duplicate IDs in a single timepoint COPING follow up demographics}
if(COPING == TRUE) {

# Identify dup IDs in a single wave 
dat.raw.dem.coping.followup %>%
   group_by(wave_dem, ID) %>%
   summarize(N = n()) %>%
   filter(N > 1)
}
```

*FOR NOW - Want the LATER data entry from people who answered twice within a single wave (for now)
Later on - want to create variable with 'answered YES at least once'
[want ID AND wave to be unique]
```{r Later entry COPING follow up demographics}
if(COPING == TRUE) {
# Confirm number of rows in current dataset 
nrow(dat.raw.dem.coping.followup)

# Filter out duplicated IDs AND wave, keeping the LAST entry
dat.raw.dem.coping.followup <- dat.raw.dem.coping.followup %>% 
    group_by(ID) %>% 
    filter(!duplicated(wave_dem,
                      fromLast = TRUE)
           )

# Confirm number of rows in dataset after filtering 
nrow(dat.raw.dem.coping.followup)
}
```

Change follow up COPING demographics to wide format
```{r COPING follow up demographics wide format}
if(COPING == TRUE) {
dat.raw.dem.coping.followup <- dat.raw.dem.coping.followup %>%
  group_by(wave_dem) %>%
  mutate(row = row_number()) %>%
  tidyr::pivot_wider(id_cols = ID,
    names_from = wave_dem, 
                     values_from = c(
                      dem.nothing_has_changed,                                     
         dem.living_situation,
         dem.employment,
         dem.physical_health,
         dem.health_of_a_relative,
         dem.household_employment_status_key,
         dem.children__dependants_returning_to_school__other_education,
         dem.living_alone,
         dem.living_with_partner_or_spouse,
         dem.living_with_housemates,
         dem.age_children_living,
         dem.age_children_living.1,
         dem.living_with_other_members_of_my_family,
         dem.spouse_partner_members_living,
         dem.staying_live,
         dem.staying_live.1,
         dem.prefer_not_to_say,
         dem.made_redundant,
         dem.became_unemployed,
         dem.reduction_in_hours,
         dem.reduction_in_salary,
         dem.benefits_increased,
         dem.benefits_decreased,
         dem.change_in_duties_or_responsibilites,
         dem.became_employed,
         dem.increased_hours,
         dem.increased_salary,
         dem.furloughed_or_paid_leave_government_funded,
         dem.furloughed_or_paid_leave_company_funded,
         dem.paid_leave_furloughed,
         dem.paid_leave_returned_work,
         dem.retired )) 
  
}

```

Select variables for dataset COPING follow up demographics
```{r Select variables COPING follow up demographics}
if(COPING == TRUE) {
dat.raw.dem.coping.followup <- dat.raw.dem.coping.followup %>%
  select(ID,
       #`dem.nothing_has_changed_.Wave_1a`,
       #  `dem.nothing_has_changed_.Wave_1b`,
         `dem.nothing_has_changed_.Wave_2a`,
         `dem.nothing_has_changed_.Wave_2b`,
         `dem.nothing_has_changed_.Wave_3a`,
         `dem.nothing_has_changed_.Wave_3b`,
         `dem.nothing_has_changed_.Wave_4a`,
         `dem.nothing_has_changed_.Wave_4b`,
         `dem.nothing_has_changed_.Wave_5a`,
         `dem.nothing_has_changed_.Wave_6b`,
         `dem.nothing_has_changed_.Wave_7a`,
         `dem.nothing_has_changed_.Wave_8b`,
         `dem.nothing_has_changed_.Wave_9a`,
         `dem.nothing_has_changed_.Wave_10b`,
         `dem.nothing_has_changed_.Wave_11a`,
         `dem.nothing_has_changed_.Wave_12b`,
         `dem.nothing_has_changed_.Wave_13a`,
         `dem.nothing_has_changed_.Wave_14b`,
         `dem.nothing_has_changed_.Wave_15a`,
         `dem.nothing_has_changed_.Wave_16b`,
         `dem.nothing_has_changed_.Wave_17a`,
         
       #  `dem.living_situation_.Wave_1a`,
       #  `dem.living_situation_.Wave_1b`,
         `dem.living_situation_.Wave_2a`,
         `dem.living_situation_.Wave_2b`,
         `dem.living_situation_.Wave_3a`,
         `dem.living_situation_.Wave_3b`,
         `dem.living_situation_.Wave_4a`,
         `dem.living_situation_.Wave_4b`,
         `dem.living_situation_.Wave_5a`,
         `dem.living_situation_.Wave_6b`,
         `dem.living_situation_.Wave_7a`,
         `dem.living_situation_.Wave_8b`,
         `dem.living_situation_.Wave_9a`,
         `dem.living_situation_.Wave_10b`,
         `dem.living_situation_.Wave_11a`,
         `dem.living_situation_.Wave_12b`,
          `dem.living_situation_.Wave_13a`,
         `dem.living_situation_.Wave_14b`,
         `dem.living_situation_.Wave_15a`,
         `dem.living_situation_.Wave_16b`,
         `dem.living_situation_.Wave_17a`,
         
          
       #  `dem.employment_.Wave_1a`,
       #  `dem.employment_.Wave_1b`,
         `dem.employment_.Wave_2a`,
         `dem.employment_.Wave_2b`,
         `dem.employment_.Wave_3a`,
         `dem.employment_.Wave_3b`,
         `dem.employment_.Wave_4a`,
         `dem.employment_.Wave_4b`,
         `dem.employment_.Wave_5a`,
         `dem.employment_.Wave_6b`,
         `dem.employment_.Wave_7a`,
         `dem.employment_.Wave_8b`,
         `dem.employment_.Wave_9a`,
         `dem.employment_.Wave_10b`,
         `dem.employment_.Wave_11a`,
         `dem.employment_.Wave_12b`,
         `dem.employment_.Wave_13a`,
         `dem.employment_.Wave_14b`,
         `dem.employment_.Wave_15a`,
         `dem.employment_.Wave_16b`,
         `dem.employment_.Wave_17a`,
         
       #  `dem.physical_health_.Wave_1a`,
       #  `dem.physical_health_.Wave_1b`,
         `dem.physical_health_.Wave_2a`,
         `dem.physical_health_.Wave_2b`,
         `dem.physical_health_.Wave_3a`,
         `dem.physical_health_.Wave_3b`,
         `dem.physical_health_.Wave_4a`,
         `dem.physical_health_.Wave_4b`,
         `dem.physical_health_.Wave_5a`,
         `dem.physical_health_.Wave_6b`,
         `dem.physical_health_.Wave_7a`,
         `dem.physical_health_.Wave_8b`,
         `dem.physical_health_.Wave_9a`,
         `dem.physical_health_.Wave_10b`,
         `dem.physical_health_.Wave_11a`,
         `dem.physical_health_.Wave_12b`,
         `dem.physical_health_.Wave_13a`,
         `dem.physical_health_.Wave_14b`,
         `dem.physical_health_.Wave_15a`,
         `dem.physical_health_.Wave_16b`,
         `dem.physical_health_.Wave_17a`,
         
       #  `dem.health_of_a_relative_.Wave_1a`,
       #  `dem.health_of_a_relative_.Wave_1b`,
         `dem.health_of_a_relative_.Wave_2a`,
         `dem.health_of_a_relative_.Wave_2b`,
         `dem.health_of_a_relative_.Wave_3a`,
         `dem.health_of_a_relative_.Wave_3b`,
         `dem.health_of_a_relative_.Wave_4a`,
         `dem.health_of_a_relative_.Wave_4b`,
         `dem.health_of_a_relative_.Wave_5a`,
         `dem.health_of_a_relative_.Wave_6b`,
         `dem.health_of_a_relative_.Wave_7a`,
         `dem.health_of_a_relative_.Wave_8b`,
         `dem.health_of_a_relative_.Wave_9a`,
         `dem.health_of_a_relative_.Wave_10b`,
         `dem.health_of_a_relative_.Wave_11a`,
         `dem.health_of_a_relative_.Wave_12b`,
         `dem.health_of_a_relative_.Wave_13a`,
         `dem.health_of_a_relative_.Wave_14b`,
         `dem.health_of_a_relative_.Wave_15a`,
         `dem.health_of_a_relative_.Wave_16b`,
         `dem.health_of_a_relative_.Wave_17a`,
         
        # `dem.household_employment_status_key_.Wave_1a`,
        # `dem.household_employment_status_key_.Wave_1b`,
         `dem.household_employment_status_key_.Wave_2a`,
         `dem.household_employment_status_key_.Wave_2b`,
         `dem.household_employment_status_key_.Wave_3a`,
         `dem.household_employment_status_key_.Wave_3b`,
         `dem.household_employment_status_key_.Wave_4a`,
         `dem.household_employment_status_key_.Wave_4b`,
         `dem.household_employment_status_key_.Wave_5a`,
         `dem.household_employment_status_key_.Wave_6b`,
         `dem.household_employment_status_key_.Wave_7a`,
         `dem.household_employment_status_key_.Wave_8b`,
         `dem.household_employment_status_key_.Wave_9a`,
         `dem.household_employment_status_key_.Wave_10b`,
         `dem.household_employment_status_key_.Wave_11a`,
         `dem.household_employment_status_key_.Wave_12b`,
         `dem.household_employment_status_key_.Wave_13a`,
         `dem.household_employment_status_key_.Wave_14b`,
         `dem.household_employment_status_key_.Wave_15a`,
         `dem.household_employment_status_key_.Wave_16b`,
         `dem.household_employment_status_key_.Wave_17a`,
         
        # `dem.children__dependants_returning_to_school__other_education_.Wave_1a`,
        # `dem.children__dependants_returning_to_school__other_education_.Wave_1b`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_2a`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_2b`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_3a`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_3b`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_4a`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_4b`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_5a`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_6b`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_7a`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_8b`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_9a`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_10b`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_11a`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_12b`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_13a`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_14b`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_15a`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_16b`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_17a`,
         
        
         
        # `dem.living_alone_.Wave_1a`,
        # `dem.living_alone_.Wave_1b`,
         `dem.living_alone_.Wave_2a`,
         `dem.living_alone_.Wave_2b`,
         `dem.living_alone_.Wave_3a`,
         `dem.living_alone_.Wave_3b`,
         `dem.living_alone_.Wave_4a`,
         `dem.living_alone_.Wave_4b`,
         `dem.living_alone_.Wave_5a`,
         `dem.living_alone_.Wave_6b`,
         `dem.living_alone_.Wave_7a`,
         `dem.living_alone_.Wave_8b`,
         `dem.living_alone_.Wave_9a`,
         `dem.living_alone_.Wave_10b`,
         `dem.living_alone_.Wave_11a`,
         `dem.living_alone_.Wave_12b`,
         `dem.living_alone_.Wave_13a`,
         `dem.living_alone_.Wave_14b`,
         `dem.living_alone_.Wave_15a`,
         `dem.living_alone_.Wave_16b`,
         `dem.living_alone_.Wave_17a`,
         
        # `dem.living_with_partner_or_spouse_.Wave_1a`,
        # `dem.living_with_partner_or_spouse_.Wave_1b`,
         `dem.living_with_partner_or_spouse_.Wave_2a`,
         `dem.living_with_partner_or_spouse_.Wave_2b`,
         `dem.living_with_partner_or_spouse_.Wave_3a`,
         `dem.living_with_partner_or_spouse_.Wave_3b`,
         `dem.living_with_partner_or_spouse_.Wave_4a`,
         `dem.living_with_partner_or_spouse_.Wave_4b`,
         `dem.living_with_partner_or_spouse_.Wave_5a`,
         `dem.living_with_partner_or_spouse_.Wave_6b`,
         `dem.living_with_partner_or_spouse_.Wave_7a`,
         `dem.living_with_partner_or_spouse_.Wave_8b`,
         `dem.living_with_partner_or_spouse_.Wave_9a`,
         `dem.living_with_partner_or_spouse_.Wave_10b`,
         `dem.living_with_partner_or_spouse_.Wave_11a`,
         `dem.living_with_partner_or_spouse_.Wave_12b`,
         `dem.living_with_partner_or_spouse_.Wave_13a`,
         `dem.living_with_partner_or_spouse_.Wave_14b`,
         `dem.living_with_partner_or_spouse_.Wave_15a`,
         `dem.living_with_partner_or_spouse_.Wave_16b`,
         `dem.living_with_partner_or_spouse_.Wave_17a`,
         
        # `dem.living_with_housemates_.Wave_1a`,
        # `dem.living_with_housemates_.Wave_1b`,
         `dem.living_with_housemates_.Wave_2a`,
         `dem.living_with_housemates_.Wave_2b`,
         `dem.living_with_housemates_.Wave_3a`,
         `dem.living_with_housemates_.Wave_3b`,
         `dem.living_with_housemates_.Wave_4a`,
         `dem.living_with_housemates_.Wave_4b`,
         `dem.living_with_housemates_.Wave_5a`,
         `dem.living_with_housemates_.Wave_6b`,
         `dem.living_with_housemates_.Wave_7a`,
         `dem.living_with_housemates_.Wave_8b`,
         `dem.living_with_housemates_.Wave_9a`,
         `dem.living_with_housemates_.Wave_10b`,
         `dem.living_with_housemates_.Wave_11a`,
         `dem.living_with_housemates_.Wave_12b`,
         `dem.living_with_housemates_.Wave_13a`,
         `dem.living_with_housemates_.Wave_14b`,
         `dem.living_with_housemates_.Wave_15a`,
         `dem.living_with_housemates_.Wave_16b`,
         `dem.living_with_housemates_.Wave_17a`,
         
       #  `dem.age_children_living_.Wave_1a`,
       #  `dem.age_children_living_.Wave_1b`,
         `dem.age_children_living_.Wave_2a`,
         `dem.age_children_living_.Wave_2b`,
         `dem.age_children_living_.Wave_3a`,
         `dem.age_children_living_.Wave_3b`,
         `dem.age_children_living_.Wave_4a`,
         `dem.age_children_living_.Wave_4b`,
         `dem.age_children_living_.Wave_5a`,
         `dem.age_children_living_.Wave_6b`,
         `dem.age_children_living_.Wave_7a`,
         `dem.age_children_living_.Wave_8b`,
         `dem.age_children_living_.Wave_9a`,
         `dem.age_children_living_.Wave_10b`,
         `dem.age_children_living_.Wave_11a`,
         `dem.age_children_living_.Wave_12b`,
         `dem.age_children_living_.Wave_13a`,
         `dem.age_children_living_.Wave_14b`,
         `dem.age_children_living_.Wave_15a`,
         `dem.age_children_living_.Wave_16b`,
         `dem.age_children_living_.Wave_17a`,
         
       #  `dem.age_children_living.1_.Wave_1a`,
       #  `dem.age_children_living.1_.Wave_1b`,
         `dem.age_children_living.1_.Wave_2a`,
         `dem.age_children_living.1_.Wave_2b`,
         `dem.age_children_living.1_.Wave_3a`,
         `dem.age_children_living.1_.Wave_3b`,
         `dem.age_children_living.1_.Wave_4a`,
         `dem.age_children_living.1_.Wave_4b`,
         `dem.age_children_living.1_.Wave_5a`,
         `dem.age_children_living.1_.Wave_6b`,
         `dem.age_children_living.1_.Wave_7a`,
         `dem.age_children_living.1_.Wave_8b`,
         `dem.age_children_living.1_.Wave_9a`,
         `dem.age_children_living.1_.Wave_10b`,
         `dem.age_children_living.1_.Wave_11a`,
         `dem.age_children_living.1_.Wave_12b`,
         `dem.age_children_living.1_.Wave_13a`,
         `dem.age_children_living.1_.Wave_14b`,
         `dem.age_children_living.1_.Wave_15a`,
         `dem.age_children_living.1_.Wave_16b`,
         `dem.age_children_living.1_.Wave_17a`,
         
       #  `dem.living_with_other_members_of_my_family_.Wave_1a`,
       #  `dem.living_with_other_members_of_my_family_.Wave_1b`,
         `dem.living_with_other_members_of_my_family_.Wave_2a`,
         `dem.living_with_other_members_of_my_family_.Wave_2b`,
         `dem.living_with_other_members_of_my_family_.Wave_3a`,
         `dem.living_with_other_members_of_my_family_.Wave_3b`,
         `dem.living_with_other_members_of_my_family_.Wave_4a`,
         `dem.living_with_other_members_of_my_family_.Wave_4b`,
         `dem.living_with_other_members_of_my_family_.Wave_5a`,
         `dem.living_with_other_members_of_my_family_.Wave_6b`,
         `dem.living_with_other_members_of_my_family_.Wave_7a`,
         `dem.living_with_other_members_of_my_family_.Wave_8b`,
         `dem.living_with_other_members_of_my_family_.Wave_9a`,
         `dem.living_with_other_members_of_my_family_.Wave_10b`,
         `dem.living_with_other_members_of_my_family_.Wave_11a`,
         `dem.living_with_other_members_of_my_family_.Wave_12b`,
         `dem.living_with_other_members_of_my_family_.Wave_13a`,
         `dem.living_with_other_members_of_my_family_.Wave_14b`,
         `dem.living_with_other_members_of_my_family_.Wave_15a`,
         `dem.living_with_other_members_of_my_family_.Wave_16b`,
         `dem.living_with_other_members_of_my_family_.Wave_17a`,
         
         
      #   `dem.spouse_partner_members_living_.Wave_1a`,
      #   `dem.spouse_partner_members_living_.Wave_1b`,
         `dem.spouse_partner_members_living_.Wave_2a`,
         `dem.spouse_partner_members_living_.Wave_2b`,
         `dem.spouse_partner_members_living_.Wave_3a`,
         `dem.spouse_partner_members_living_.Wave_3b`,
         `dem.spouse_partner_members_living_.Wave_4a`,
         `dem.spouse_partner_members_living_.Wave_4b`,
         `dem.spouse_partner_members_living_.Wave_5a`,
         `dem.spouse_partner_members_living_.Wave_6b`,
         `dem.spouse_partner_members_living_.Wave_7a`,
         `dem.spouse_partner_members_living_.Wave_8b`,
         `dem.spouse_partner_members_living_.Wave_9a`,
         `dem.spouse_partner_members_living_.Wave_10b`,
         `dem.spouse_partner_members_living_.Wave_11a`,
         `dem.spouse_partner_members_living_.Wave_12b`,
         `dem.spouse_partner_members_living_.Wave_13a`,
         `dem.spouse_partner_members_living_.Wave_14b`,
         `dem.spouse_partner_members_living_.Wave_15a`,
         `dem.spouse_partner_members_living_.Wave_16b`,
         `dem.spouse_partner_members_living_.Wave_17a`,
         
      #   `dem.staying_live_.Wave_1a`,
      #   `dem.staying_live_.Wave_1b`,
         `dem.staying_live_.Wave_2a`,
         `dem.staying_live_.Wave_2b`,
         `dem.staying_live_.Wave_3a`,
         `dem.staying_live_.Wave_3b`,
         `dem.staying_live_.Wave_4a`,
         `dem.staying_live_.Wave_4b`,
         `dem.staying_live_.Wave_5a`,
         `dem.staying_live_.Wave_6b`,
         `dem.staying_live_.Wave_7a`,
         `dem.staying_live_.Wave_8b`,
         `dem.staying_live_.Wave_9a`,
         `dem.staying_live_.Wave_10b`,
         `dem.staying_live_.Wave_11a`,
         `dem.staying_live_.Wave_12b`,
         `dem.staying_live_.Wave_13a`,
         `dem.staying_live_.Wave_14b`,
         `dem.staying_live_.Wave_15a`,
         `dem.staying_live_.Wave_16b`,
         `dem.staying_live_.Wave_17a`,
         
     #    `dem.staying_live.1_.Wave_1a`,
      #   `dem.staying_live.1_.Wave_1b`,
         `dem.staying_live.1_.Wave_2a`,
         `dem.staying_live.1_.Wave_2b`,
         `dem.staying_live.1_.Wave_3a`,
         `dem.staying_live.1_.Wave_3b`,
         `dem.staying_live.1_.Wave_4a`,
         `dem.staying_live.1_.Wave_4b`,
         `dem.staying_live.1_.Wave_5a`,
         `dem.staying_live.1_.Wave_6b`,
         `dem.staying_live.1_.Wave_7a`,
         `dem.staying_live.1_.Wave_8b`,
         `dem.staying_live.1_.Wave_9a`,
         `dem.staying_live.1_.Wave_10b`,
         `dem.staying_live.1_.Wave_11a`,
         `dem.staying_live.1_.Wave_12b`,
         `dem.staying_live.1_.Wave_13a`,
         `dem.staying_live.1_.Wave_14b`,
         `dem.staying_live.1_.Wave_15a`,
         `dem.staying_live.1_.Wave_16b`,
         `dem.staying_live.1_.Wave_17a`,
   
      #   `dem.prefer_not_to_say_.Wave_1a`,
      #   `dem.prefer_not_to_say_.Wave_1b`,
         `dem.prefer_not_to_say_.Wave_2a`,
         `dem.prefer_not_to_say_.Wave_2b`,
         `dem.prefer_not_to_say_.Wave_3a`,
         `dem.prefer_not_to_say_.Wave_3b`,
         `dem.prefer_not_to_say_.Wave_4a`,
         `dem.prefer_not_to_say_.Wave_4b`,
         `dem.prefer_not_to_say_.Wave_5a`,
         `dem.prefer_not_to_say_.Wave_6b`,
         `dem.prefer_not_to_say_.Wave_7a`,
         `dem.prefer_not_to_say_.Wave_8b`,
         `dem.prefer_not_to_say_.Wave_9a`,
         `dem.prefer_not_to_say_.Wave_10b`,
         `dem.prefer_not_to_say_.Wave_11a`,
         `dem.prefer_not_to_say_.Wave_12b`,
         `dem.prefer_not_to_say_.Wave_13a`,
         `dem.prefer_not_to_say_.Wave_14b`,
         `dem.prefer_not_to_say_.Wave_15a`,
         `dem.prefer_not_to_say_.Wave_16b`,
         `dem.prefer_not_to_say_.Wave_17a`,
         
         
      #   `dem.made_redundant_.Wave_1a`,
      #   `dem.made_redundant_.Wave_1b`,
         `dem.made_redundant_.Wave_2a`,
         `dem.made_redundant_.Wave_2b`,
         `dem.made_redundant_.Wave_3a`,
         `dem.made_redundant_.Wave_3b`,
         `dem.made_redundant_.Wave_4a`,
         `dem.made_redundant_.Wave_4b`,
         `dem.made_redundant_.Wave_5a`,
         `dem.made_redundant_.Wave_6b`,
         `dem.made_redundant_.Wave_7a`,
         `dem.made_redundant_.Wave_8b`,
         `dem.made_redundant_.Wave_9a`,
         `dem.made_redundant_.Wave_10b`,
         `dem.made_redundant_.Wave_11a`,
         `dem.made_redundant_.Wave_12b`,
          `dem.made_redundant_.Wave_13a`,
         `dem.made_redundant_.Wave_14b`,
         `dem.made_redundant_.Wave_15a`,
         `dem.made_redundant_.Wave_16b`,
         `dem.made_redundant_.Wave_17a`,
         
      #   `dem.became_unemployed_.Wave_1a`,
      #   `dem.became_unemployed_.Wave_1b`,
         `dem.became_unemployed_.Wave_2a`,
         `dem.became_unemployed_.Wave_2b`,
         `dem.became_unemployed_.Wave_3a`,
         `dem.became_unemployed_.Wave_3b`,
         `dem.became_unemployed_.Wave_4a`,
         `dem.became_unemployed_.Wave_4b`,
         `dem.became_unemployed_.Wave_5a`,
         `dem.became_unemployed_.Wave_6b`,
         `dem.became_unemployed_.Wave_7a`,
         `dem.became_unemployed_.Wave_8b`,
         `dem.became_unemployed_.Wave_9a`,
         `dem.became_unemployed_.Wave_10b`,
         `dem.became_unemployed_.Wave_11a`,
         `dem.became_unemployed_.Wave_12b`,
         `dem.became_unemployed_.Wave_13a`,
         `dem.became_unemployed_.Wave_14b`,
         `dem.became_unemployed_.Wave_15a`,
         `dem.became_unemployed_.Wave_16b`,
         `dem.became_unemployed_.Wave_17a`,
         
     #    `dem.reduction_in_hours_.Wave_1a`,
     #    `dem.reduction_in_hours_.Wave_1b`,
         `dem.reduction_in_hours_.Wave_2a`,
         `dem.reduction_in_hours_.Wave_2b`,
         `dem.reduction_in_hours_.Wave_3a`,
         `dem.reduction_in_hours_.Wave_3b`,
         `dem.reduction_in_hours_.Wave_4a`,
         `dem.reduction_in_hours_.Wave_4b`,
         `dem.reduction_in_hours_.Wave_5a`,
         `dem.reduction_in_hours_.Wave_6b`,
         `dem.reduction_in_hours_.Wave_7a`,
         `dem.reduction_in_hours_.Wave_8b`,
         `dem.reduction_in_hours_.Wave_9a`,
         `dem.reduction_in_hours_.Wave_10b`,
         `dem.reduction_in_hours_.Wave_11a`,
         `dem.reduction_in_hours_.Wave_12b`,
         `dem.reduction_in_hours_.Wave_13a`,
         `dem.reduction_in_hours_.Wave_14b`,
         `dem.reduction_in_hours_.Wave_15a`,
         `dem.reduction_in_hours_.Wave_16b`,
         `dem.reduction_in_hours_.Wave_17a`,
         
     #    `dem.reduction_in_salary_.Wave_1a`,
     #    `dem.reduction_in_salary_.Wave_1b`,
         `dem.reduction_in_salary_.Wave_2a`,
         `dem.reduction_in_salary_.Wave_2b`,
         `dem.reduction_in_salary_.Wave_3a`,
         `dem.reduction_in_salary_.Wave_3b`,
         `dem.reduction_in_salary_.Wave_4a`,
         `dem.reduction_in_salary_.Wave_4b`,
         `dem.reduction_in_salary_.Wave_5a`,
         `dem.reduction_in_salary_.Wave_6b`,
         `dem.reduction_in_salary_.Wave_7a`,
         `dem.reduction_in_salary_.Wave_8b`,
         `dem.reduction_in_salary_.Wave_9a`,
         `dem.reduction_in_salary_.Wave_10b`,
         `dem.reduction_in_salary_.Wave_11a`,
         `dem.reduction_in_salary_.Wave_12b`,
         `dem.reduction_in_salary_.Wave_13a`,
         `dem.reduction_in_salary_.Wave_14b`,
         `dem.reduction_in_salary_.Wave_15a`,
         `dem.reduction_in_salary_.Wave_16b`,
         `dem.reduction_in_salary_.Wave_17a`,
         
      #   `dem.benefits_increased_.Wave_1a`,
      #   `dem.benefits_increased_.Wave_1b`,
         `dem.benefits_increased_.Wave_2a`,
         `dem.benefits_increased_.Wave_2b`,
         `dem.benefits_increased_.Wave_3a`,
         `dem.benefits_increased_.Wave_3b`,
         `dem.benefits_increased_.Wave_4a`,
         `dem.benefits_increased_.Wave_4b`,
         `dem.benefits_increased_.Wave_5a`,
         `dem.benefits_increased_.Wave_6b`,
         `dem.benefits_increased_.Wave_7a`,
         `dem.benefits_increased_.Wave_8b`,
         `dem.benefits_increased_.Wave_9a`,
         `dem.benefits_increased_.Wave_10b`,
         `dem.benefits_increased_.Wave_11a`,
         `dem.benefits_increased_.Wave_12b`,
         `dem.benefits_increased_.Wave_13a`,
         `dem.benefits_increased_.Wave_14b`,
         `dem.benefits_increased_.Wave_15a`,
         `dem.benefits_increased_.Wave_16b`,
         `dem.benefits_increased_.Wave_17a`,
         
      #   `dem.benefits_decreased_.Wave_1a`,
      #   `dem.benefits_decreased_.Wave_1b`,
         `dem.benefits_decreased_.Wave_2a`,
         `dem.benefits_decreased_.Wave_2b`,
         `dem.benefits_decreased_.Wave_3a`,
         `dem.benefits_decreased_.Wave_3b`,
         `dem.benefits_decreased_.Wave_4a`,
         `dem.benefits_decreased_.Wave_4b`,
         `dem.benefits_decreased_.Wave_5a`,
         `dem.benefits_decreased_.Wave_6b`,
         `dem.benefits_decreased_.Wave_7a`,
         `dem.benefits_decreased_.Wave_8b`,
         `dem.benefits_decreased_.Wave_9a`,
         `dem.benefits_decreased_.Wave_10b`,
         `dem.benefits_decreased_.Wave_11a`,
         `dem.benefits_decreased_.Wave_12b`,
         `dem.benefits_decreased_.Wave_13a`,
         `dem.benefits_decreased_.Wave_14b`,
         `dem.benefits_decreased_.Wave_15a`,
         `dem.benefits_decreased_.Wave_16b`,
         `dem.benefits_decreased_.Wave_17a`,
         
     #    `dem.change_in_duties_or_responsibilites_.Wave_1a`,
     #    `dem.change_in_duties_or_responsibilites_.Wave_1b`,
         `dem.change_in_duties_or_responsibilites_.Wave_2a`,
         `dem.change_in_duties_or_responsibilites_.Wave_2b`,
         `dem.change_in_duties_or_responsibilites_.Wave_3a`,
         `dem.change_in_duties_or_responsibilites_.Wave_3b`,
         `dem.change_in_duties_or_responsibilites_.Wave_4a`,
         `dem.change_in_duties_or_responsibilites_.Wave_4b`,
         `dem.change_in_duties_or_responsibilites_.Wave_5a`,
         `dem.change_in_duties_or_responsibilites_.Wave_6b`,
         `dem.change_in_duties_or_responsibilites_.Wave_7a`,
         `dem.change_in_duties_or_responsibilites_.Wave_8b`,
         `dem.change_in_duties_or_responsibilites_.Wave_9a`,
         `dem.change_in_duties_or_responsibilites_.Wave_10b`,
         `dem.change_in_duties_or_responsibilites_.Wave_11a`,
         `dem.change_in_duties_or_responsibilites_.Wave_12b`,
         `dem.change_in_duties_or_responsibilites_.Wave_13a`,
         `dem.change_in_duties_or_responsibilites_.Wave_14b`,
         `dem.change_in_duties_or_responsibilites_.Wave_15a`,
         `dem.change_in_duties_or_responsibilites_.Wave_16b`,
         `dem.change_in_duties_or_responsibilites_.Wave_17a`,
         
      #   `dem.became_employed_.Wave_1a`,
      #   `dem.became_employed_.Wave_1b`,
         `dem.became_employed_.Wave_2a`,
         `dem.became_employed_.Wave_2b`,
         `dem.became_employed_.Wave_3a`,
         `dem.became_employed_.Wave_3b`,
         `dem.became_employed_.Wave_4a`,
         `dem.became_employed_.Wave_4b`,
         `dem.became_employed_.Wave_5a`,
         `dem.became_employed_.Wave_6b`,
         `dem.became_employed_.Wave_7a`,
         `dem.became_employed_.Wave_8b`,
         `dem.became_employed_.Wave_9a`,
         `dem.became_employed_.Wave_10b`,
         `dem.became_employed_.Wave_11a`,
         `dem.became_employed_.Wave_12b`,
         `dem.became_employed_.Wave_13a`,
         `dem.became_employed_.Wave_14b`,
         `dem.became_employed_.Wave_15a`,
         `dem.became_employed_.Wave_16b`,
         `dem.became_employed_.Wave_17a`,
         
      #   `dem.increased_hours_.Wave_1a`,
      #   `dem.increased_hours_.Wave_1b`,
         `dem.increased_hours_.Wave_2a`,
         `dem.increased_hours_.Wave_2b`,
         `dem.increased_hours_.Wave_3a`,
         `dem.increased_hours_.Wave_3b`,
         `dem.increased_hours_.Wave_4a`,
         `dem.increased_hours_.Wave_4b`,
         `dem.increased_hours_.Wave_5a`,
         `dem.increased_hours_.Wave_6b`,
         `dem.increased_hours_.Wave_7a`,
         `dem.increased_hours_.Wave_8b`,
         `dem.increased_hours_.Wave_9a`,
         `dem.increased_hours_.Wave_10b`,
         `dem.increased_hours_.Wave_11a`,
         `dem.increased_hours_.Wave_12b`,
         `dem.increased_hours_.Wave_13a`,
         `dem.increased_hours_.Wave_14b`,
         `dem.increased_hours_.Wave_15a`,
         `dem.increased_hours_.Wave_16b`,
         `dem.increased_hours_.Wave_17a`,
         
      #   `dem.furloughed_or_paid_leave_government_funded_.Wave_1a`,
      #   `dem.furloughed_or_paid_leave_government_funded_.Wave_1b`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_2a`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_2b`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_3a`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_3b`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_4a`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_4b`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_5a`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_6b`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_7a`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_8b`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_9a`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_10b`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_11a`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_12b`,
          `dem.furloughed_or_paid_leave_government_funded_.Wave_13a`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_14b`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_15a`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_16b`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_17a`,
         
    #      `dem.furloughed_or_paid_leave_company_funded_.Wave_1a`,
    #     `dem.furloughed_or_paid_leave_company_funded_.Wave_1b`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_2a`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_2b`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_3a`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_3b`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_4a`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_4b`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_5a`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_6b`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_7a`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_8b`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_9a`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_10b`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_11a`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_12b`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_13a`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_14b`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_15a`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_16b`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_17a`,
         
    #      `dem.paid_leave_furloughed_.Wave_1a`,
    #     `dem.paid_leave_furloughed_.Wave_1b`,
         `dem.paid_leave_furloughed_.Wave_2a`,
         `dem.paid_leave_furloughed_.Wave_2b`,
         `dem.paid_leave_furloughed_.Wave_3a`,
         `dem.paid_leave_furloughed_.Wave_3b`,
         `dem.paid_leave_furloughed_.Wave_4a`,
         `dem.paid_leave_furloughed_.Wave_4b`,
         `dem.paid_leave_furloughed_.Wave_5a`,
         `dem.paid_leave_furloughed_.Wave_6b`,
         `dem.paid_leave_furloughed_.Wave_7a`,
         `dem.paid_leave_furloughed_.Wave_8b`,
         `dem.paid_leave_furloughed_.Wave_9a`,
         `dem.paid_leave_furloughed_.Wave_10b`,
         `dem.paid_leave_furloughed_.Wave_11a`,
         `dem.paid_leave_furloughed_.Wave_12b`,
         `dem.paid_leave_furloughed_.Wave_13a`,
         `dem.paid_leave_furloughed_.Wave_14b`,
         `dem.paid_leave_furloughed_.Wave_15a`,
         `dem.paid_leave_furloughed_.Wave_16b`,
         `dem.paid_leave_furloughed_.Wave_17a`,
         
      #    `dem.paid_leave_returned_work_.Wave_1a`,
      #   `dem.paid_leave_returned_work_.Wave_1b`,
         `dem.paid_leave_returned_work_.Wave_2a`,
         `dem.paid_leave_returned_work_.Wave_2b`,
         `dem.paid_leave_returned_work_.Wave_3a`,
         `dem.paid_leave_returned_work_.Wave_3b`,
         `dem.paid_leave_returned_work_.Wave_4a`,
         `dem.paid_leave_returned_work_.Wave_4b`,
         `dem.paid_leave_returned_work_.Wave_5a`,
         `dem.paid_leave_returned_work_.Wave_6b`,
         `dem.paid_leave_returned_work_.Wave_7a`,
         `dem.paid_leave_returned_work_.Wave_8b`,
         `dem.paid_leave_returned_work_.Wave_9a`,
         `dem.paid_leave_returned_work_.Wave_10b`,
         `dem.paid_leave_returned_work_.Wave_11a`,
         `dem.paid_leave_returned_work_.Wave_12b`,
         `dem.paid_leave_returned_work_.Wave_13a`,
         `dem.paid_leave_returned_work_.Wave_14b`,
         `dem.paid_leave_returned_work_.Wave_15a`,
         `dem.paid_leave_returned_work_.Wave_16b`,
         `dem.paid_leave_returned_work_.Wave_17a`,
         
      #   `dem.retired_.Wave_1a`,
      #   `dem.retired_.Wave_1b`,
         `dem.retired_.Wave_2a`,
         `dem.retired_.Wave_2b`,
         `dem.retired_.Wave_3a`,
         `dem.retired_.Wave_3b`,
         `dem.retired_.Wave_4a`,
         `dem.retired_.Wave_4b`,
         `dem.retired_.Wave_5a`,
         `dem.retired_.Wave_6b`,
         `dem.retired_.Wave_7a`,
         `dem.retired_.Wave_8b`,
         `dem.retired_.Wave_9a`,
         `dem.retired_.Wave_10b`,
         `dem.retired_.Wave_11a`,
         `dem.retired_.Wave_12b`,
         `dem.retired_.Wave_13a`,
         `dem.retired_.Wave_14b`,
         `dem.retired_.Wave_15a`,
         `dem.retired_.Wave_16b`,
         `dem.retired_.Wave_17a`
         
         )
}
```

Remove duplicate IDs COPING follow up demographics
```{r Remove duplicate IDs COPING follow up demographics}
if(COPING == TRUE) {
# Check col names
colnames(dat.raw.dem.coping.followup)

# Remove dupilcate IDs (as each wave is now a column, there should be NO dup IDs)
dat.raw.dem.coping.followup  <- dat.raw.dem.coping.followup %>%
  filter(., !duplicated(ID)) 

# Check number of rows
nrow(dat.raw.dem.coping.followup)
}

```

# TIMEPOINTS / PHASES - COPING TAF

Create a phase columns in follow up data 
```{r Identify phases COPING follow up TAF}
if (COPING ==TRUE) {
source("./timepoints_COPING.R")
}
```

Join TAF COPING follow ups 
```{r Merge COPING follow ups TAF}
if(COPING == TRUE) {
dat.raw.taf.coping <- rbind(taf.coping.followupa.raw.id,
    taf.coping.followupb.raw.id)

# Check col names
colnames(dat.raw.taf.coping)

# Check number of rows
nrow(dat.raw.taf.coping)

}
```

Check for number of entries per wave
```{r Check for number of entries per wave COPING follow up TAF}
if(COPING == TRUE) {
dat.raw.taf.coping %>%
  group_by(wave_taf) %>%
  count()

}
```

Identify duplicate IDs in a single wave
```{r Identify duplicate IDs in a single wave COPING follow up TAF}
if(COPING == TRUE) {

# Identify dup IDs in a single wave
dat.raw.taf.coping %>%
   group_by(wave_taf, ID) %>%
   summarize(N = n()) %>%
   filter(N > 1)
}
```

Want the LATER data entry from people who answered twice within a single wave (for now!)
[want ID AND wave to be unique]
```{r Later entry COPING follow up TAF}
if(COPING == TRUE) {

# Confirm number of rows in current dataset
nrow(dat.raw.taf.coping)

# Filter out duplicated IDs AND wave, keeping the LAST entry
dat.raw.taf.coping <- dat.raw.taf.coping %>% 
    group_by(ID) %>% 
    filter(!duplicated(wave_taf,
                      fromLast = TRUE)
           )

# Confirm number of rows in dataset after filtering 
nrow(dat.raw.taf.coping)
}
```

Change follow up TAF COPING to wide format
```{r TAF COPING wide format}
if(COPING == TRUE) {
dat.raw.taf.coping.wide <- dat.raw.taf.coping %>%
  group_by(wave_taf) %>%
  mutate(row = row_number()) %>%
  tidyr::pivot_wider(id_cols = ID,
                     names_from = wave_taf,
                     values_from = c(taf.worth_living_life_people,
                              taf.felt_weeks_past,
                              taf.have_you_contemplated_harming_yourself,
                              taf.felt_weeks_past.1,
                              taf.meant_life_end_weeks))

}
```

Select variables for dataset TAF COPING
```{r Select variables COPING follow up TAF}
if(COPING == TRUE) {
dat.raw.taf.coping <- dat.raw.taf.coping.wide %>%
  select(ID,
          #`taf.worth_living_life_people_.Wave_1a`,
        # `taf.worth_living_life_people_.Wave_1b`,
         `taf.worth_living_life_people_.Wave_2a`,
         `taf.worth_living_life_people_.Wave_2b`,
         `taf.worth_living_life_people_.Wave_3a`,
         `taf.worth_living_life_people_.Wave_3b`,
         `taf.worth_living_life_people_.Wave_4a`,
        `taf.worth_living_life_people_.Wave_4b`,
         `taf.worth_living_life_people_.Wave_5a`,
         `taf.worth_living_life_people_.Wave_6b`,
         `taf.worth_living_life_people_.Wave_7a`,
         `taf.worth_living_life_people_.Wave_8b`,
         `taf.worth_living_life_people_.Wave_9a`,
         `taf.worth_living_life_people_.Wave_10b`,
         `taf.worth_living_life_people_.Wave_11a`,
         `taf.worth_living_life_people_.Wave_12b`,
         
         
       #  `taf.felt_weeks_past_.Wave_1a`,
        # `taf.felt_weeks_past_.Wave_1b`,
         `taf.felt_weeks_past_.Wave_2a`,
         `taf.felt_weeks_past_.Wave_2b`,
         `taf.felt_weeks_past_.Wave_3a`,
         `taf.felt_weeks_past_.Wave_3b`,
         `taf.felt_weeks_past_.Wave_4a`,
       `taf.felt_weeks_past_.Wave_4b`,
         `taf.felt_weeks_past_.Wave_5a`,
         `taf.felt_weeks_past_.Wave_6b`,
         `taf.felt_weeks_past_.Wave_7a`,
         `taf.felt_weeks_past_.Wave_8b`,
         `taf.felt_weeks_past_.Wave_9a`,
         `taf.felt_weeks_past_.Wave_10b`,
         `taf.felt_weeks_past_.Wave_11a`,
         `taf.felt_weeks_past_.Wave_12b`,
         
        # `taf.have_you_contemplated_harming_yourself_.Wave_1a`,
        # `taf.have_you_contemplated_harming_yourself_.Wave_1b`,
         `taf.have_you_contemplated_harming_yourself_.Wave_2a`,
         `taf.have_you_contemplated_harming_yourself_.Wave_2b`,
         `taf.have_you_contemplated_harming_yourself_.Wave_3a`,
         `taf.have_you_contemplated_harming_yourself_.Wave_3b`,
         `taf.have_you_contemplated_harming_yourself_.Wave_4a`,
       `taf.have_you_contemplated_harming_yourself_.Wave_4b`,
         `taf.have_you_contemplated_harming_yourself_.Wave_5a`,
         `taf.have_you_contemplated_harming_yourself_.Wave_6b`,
         `taf.have_you_contemplated_harming_yourself_.Wave_7a`,
         `taf.have_you_contemplated_harming_yourself_.Wave_8b`,
         `taf.have_you_contemplated_harming_yourself_.Wave_9a`,
         `taf.have_you_contemplated_harming_yourself_.Wave_10b`,
         `taf.have_you_contemplated_harming_yourself_.Wave_11a`,
         `taf.have_you_contemplated_harming_yourself_.Wave_12b`,
         
        # `taf.felt_weeks_past.1_.Wave_1a`,
        # `taf.felt_weeks_past.1_.Wave_1b`,
         `taf.felt_weeks_past.1_.Wave_2a`,
         `taf.felt_weeks_past.1_.Wave_2b`,
         `taf.felt_weeks_past.1_.Wave_3a`,
         `taf.felt_weeks_past.1_.Wave_3b`,
         `taf.felt_weeks_past.1_.Wave_4a`,
        `taf.felt_weeks_past.1_.Wave_4b`,
         `taf.felt_weeks_past.1_.Wave_5a`,
         `taf.felt_weeks_past.1_.Wave_6b`,
         `taf.felt_weeks_past.1_.Wave_7a`,
         `taf.felt_weeks_past.1_.Wave_8b`,
         `taf.felt_weeks_past.1_.Wave_9a`,
         `taf.felt_weeks_past.1_.Wave_10b`,
         `taf.felt_weeks_past.1_.Wave_11a`,
         `taf.felt_weeks_past.1_.Wave_12b`,
         
        # `taf.meant_life_end_weeks_.Wave_1a`,
        # `taf.meant_life_end_weeks_.Wave_1b`,
         `taf.meant_life_end_weeks_.Wave_2a`,
         `taf.meant_life_end_weeks_.Wave_2b`,
         `taf.meant_life_end_weeks_.Wave_3a`,
         `taf.meant_life_end_weeks_.Wave_3b`,
         `taf.meant_life_end_weeks_.Wave_4a`,
       `taf.meant_life_end_weeks_.Wave_4b`,
         `taf.meant_life_end_weeks_.Wave_5a`,
         `taf.meant_life_end_weeks_.Wave_6b`,
         `taf.meant_life_end_weeks_.Wave_7a`,
         `taf.meant_life_end_weeks_.Wave_8b`,
         `taf.meant_life_end_weeks_.Wave_9a`,
         `taf.meant_life_end_weeks_.Wave_10b`,
         `taf.meant_life_end_weeks_.Wave_11a`,
         `taf.meant_life_end_weeks_.Wave_12b`
         )
}
```

Remove duplicate IDs TAF COPING
```{r Remove duplicate IDs TAF COPING}
if(COPING == TRUE) {
# Check col names
colnames(dat.raw.taf.coping)

# Remove dupilcate IDs (as each wave is now a column, there should be NO dup IDs)
dat.raw.taf.coping  <- dat.raw.taf.coping  %>%
  filter(., !duplicated(ID)) 

# Check number of rows
nrow(dat.raw.taf.coping)
}

```


# TIMEPOINTS / PHASES - RESP COPING 

Join COPING resp datasets follow ups
```{r Merge COPING resp}
if(COPING == TRUE) {
coping.followup.resp.id <- rbind(coping.followupa.resp.id,
    coping.followupb.resp.id)

# Check column names
colnames(coping.followup.resp.id)
}
```

Check number of entries per wave
```{r Check number of entries per wave COPING resp}
if(COPING == TRUE) {
coping.followup.resp.id %>%
  group_by(wave_resp) %>%
  count()
}
```

Idenfity duplicate IDs in a single wave
```{r Idenfity duplicate IDs in a single wave COPING resp}
if(COPING == TRUE) {
# Identify dup IDs in a single wave
coping.followup.resp.id %>%
   group_by(wave_resp, ID) %>%
   summarize(N = n()) %>%
   filter(N > 1)
}
```

Want the LATER data entry from people who answered twice within a single wave (again, for now!)
[want ID AND wave to be unique]
```{r Later date entry COPING resp}
if(COPING == TRUE) {

# Confirm number of rows in current dataset
nrow(coping.followup.resp.id)

# Filter out duplicated IDs AND wave, keeping the LAST entry
coping.followup.resp.id <- coping.followup.resp.id %>% 
    group_by(ID) %>% 
    filter(!duplicated(wave_resp,
                      fromLast = TRUE)
           )

# Confirm number of rows in dataset after filtering 
nrow(coping.followup.resp.id)
}
```

Change follow up COPING resp to wide format
```{r COPING resp wide format}
if(COPING == TRUE) {
coping.followup.resp.id <- coping.followup.resp.id %>%
  group_by(wave_resp) %>%
  mutate(row = row_number()) %>%
  tidyr::pivot_wider(id_cols = ID,
    names_from = wave_resp, 
                     values_from = c(
                       resp.coronavirus_test_nosethroat_swab,
         resp.results_nosethroat_swab_test,
         resp.coronavirus_antibody_test,
         resp.coronavirus_antibody_test)) 
  
} 
```

Select variables for dataset COPING resp
```{r Select variables for dataset COPING resp}
if(COPING == TRUE) {
coping.followup.resp.id <- coping.followup.resp.id  %>%
  select(ID,
         #`resp.coronavirus_test_nosethroat_swab_.Wave_1a`,
        # `resp.coronavirus_test_nosethroat_swab_.Wave_1b`,
         `resp.coronavirus_test_nosethroat_swab_.Wave_2a`,
         `resp.coronavirus_test_nosethroat_swab_.Wave_2b` ,
         `resp.coronavirus_test_nosethroat_swab_.Wave_3a`,
         `resp.coronavirus_test_nosethroat_swab_.Wave_3b` , 
         `resp.coronavirus_test_nosethroat_swab_.Wave_4a`,
         `resp.coronavirus_test_nosethroat_swab_.Wave_4b`,
         `resp.coronavirus_test_nosethroat_swab_.Wave_5a`,
         `resp.coronavirus_test_nosethroat_swab_.Wave_6b`,
         `resp.coronavirus_test_nosethroat_swab_.Wave_7a`,
         `resp.coronavirus_test_nosethroat_swab_.Wave_8b`,
         `resp.coronavirus_test_nosethroat_swab_.Wave_9a`,
         `resp.coronavirus_test_nosethroat_swab_.Wave_10b`,
         `resp.coronavirus_test_nosethroat_swab_.Wave_11a`,
         `resp.coronavirus_test_nosethroat_swab_.Wave_12b`,
        `resp.coronavirus_test_nosethroat_swab_.Wave_13a`,
         `resp.coronavirus_test_nosethroat_swab_.Wave_14b`,
         `resp.coronavirus_test_nosethroat_swab_.Wave_15a`,
         `resp.coronavirus_test_nosethroat_swab_.Wave_16b`,
         `resp.coronavirus_test_nosethroat_swab_.Wave_17a`,
         
        # `resp.results_nosethroat_swab_test_.Wave_1a`,
        # `resp.results_nosethroat_swab_test_.Wave_1b`,
         `resp.results_nosethroat_swab_test_.Wave_2a`,
         `resp.results_nosethroat_swab_test_.Wave_2b` ,
         `resp.results_nosethroat_swab_test_.Wave_3a`,
         `resp.results_nosethroat_swab_test_.Wave_3b` , 
         `resp.results_nosethroat_swab_test_.Wave_4a`,
         `resp.results_nosethroat_swab_test_.Wave_4b`,
         `resp.results_nosethroat_swab_test_.Wave_5a`,
         `resp.results_nosethroat_swab_test_.Wave_6b`,
         `resp.results_nosethroat_swab_test_.Wave_7a`,
         `resp.results_nosethroat_swab_test_.Wave_8b`,
         `resp.results_nosethroat_swab_test_.Wave_9a`,
         `resp.results_nosethroat_swab_test_.Wave_10b`,
         `resp.results_nosethroat_swab_test_.Wave_11a`,
         `resp.results_nosethroat_swab_test_.Wave_12b`,
        `resp.results_nosethroat_swab_test_.Wave_13a`,
         `resp.results_nosethroat_swab_test_.Wave_14b`,
         `resp.results_nosethroat_swab_test_.Wave_15a`,
         `resp.results_nosethroat_swab_test_.Wave_16b`,
         `resp.results_nosethroat_swab_test_.Wave_17a`,
         
        #  `resp.coronavirus_antibody_test_.Wave_1a`,
        # `resp.coronavirus_antibody_test_.Wave_1b`,
         `resp.coronavirus_antibody_test_.Wave_2a`,
         `resp.coronavirus_antibody_test_.Wave_2b` ,
         `resp.coronavirus_antibody_test_.Wave_3a`,
         `resp.coronavirus_antibody_test_.Wave_3b` , 
         `resp.coronavirus_antibody_test_.Wave_4a`,
         `resp.coronavirus_antibody_test_.Wave_4b`,
         `resp.coronavirus_antibody_test_.Wave_5a`,
         `resp.coronavirus_antibody_test_.Wave_6b`,
         `resp.coronavirus_antibody_test_.Wave_7a`,
         `resp.coronavirus_antibody_test_.Wave_8b`,
         `resp.coronavirus_antibody_test_.Wave_9a`,
         `resp.coronavirus_antibody_test_.Wave_10b`,
         `resp.coronavirus_antibody_test_.Wave_11a`,
         `resp.coronavirus_antibody_test_.Wave_12b`,
        `resp.coronavirus_antibody_test_.Wave_13a`,
         `resp.coronavirus_antibody_test_.Wave_14b`,
         `resp.coronavirus_antibody_test_.Wave_15a`,
         `resp.coronavirus_antibody_test_.Wave_16b`,
         `resp.coronavirus_antibody_test_.Wave_17a`,
         
        # `resp.coronavirus_antibody_test_.Wave_1a`,
       #  `resp.coronavirus_antibody_test_.Wave_1b`,
         `resp.coronavirus_antibody_test_.Wave_2a`,
         `resp.coronavirus_antibody_test_.Wave_2b` ,
         `resp.coronavirus_antibody_test_.Wave_3a`,
         `resp.coronavirus_antibody_test_.Wave_3b` , 
         `resp.coronavirus_antibody_test_.Wave_4a`,
         `resp.coronavirus_antibody_test_.Wave_4b`,
         `resp.coronavirus_antibody_test_.Wave_5a`,
         `resp.coronavirus_antibody_test_.Wave_6b`,
         `resp.coronavirus_antibody_test_.Wave_7a`,
         `resp.coronavirus_antibody_test_.Wave_8b`,
         `resp.coronavirus_antibody_test_.Wave_9a`,
         `resp.coronavirus_antibody_test_.Wave_10b`,
         `resp.coronavirus_antibody_test_.Wave_11a`,
         `resp.coronavirus_antibody_test_.Wave_12b`,
         `resp.coronavirus_antibody_test_.Wave_13a`,
         `resp.coronavirus_antibody_test_.Wave_14b`,
         `resp.coronavirus_antibody_test_.Wave_15a`,
         `resp.coronavirus_antibody_test_.Wave_16b`,
         `resp.coronavirus_antibody_test_.Wave_17a`)
}
```

Remove duplicate COPING resp screener
```{r Remove duplicate IDs COPING resp}
if(COPING == TRUE) {
# Check col names
colnames(coping.followup.resp.id)

# Remove dupilcate IDs (as each wave is now a column, there should be NO dup IDs)
coping.followup.resp.id  <- coping.followup.resp.id  %>%
  filter(., !duplicated(ID)) 

# Check number of rows
nrow(coping.followup.resp.id)
}

```

# TIMEPOINTS / PHASES - loss of a loved one due to COVID COPING
```{r Identify phase dates loss of a loved one due to COVID COPING}
if (COPING ==TRUE) {
source("./timepoints_COPING.R")
}
```

Count number of entries per phase loss of a loved one due to COVID COPING
```{r Count entries per phase loss of a loved one due to COVID COPING}
if(COPING == TRUE) {
coping.loss.followupb.raw.id %>%
  group_by(wave_loss) %>%
  count()
}
```

Identify duplicate IDs in a single timepoint
```{r Identify duplicate IDs in a single timepoint loss of a loved one due to COVID COPING}
if(COPING == TRUE) {
##Identify dup IDs in a single wave 
coping.loss.followupb.raw.id %>%
   group_by(wave_loss, ID) %>%
   summarize(N = n()) %>%
   filter(N > 1)
}
```

*FOR NOW - Want the LATER data entry from people who answered twice within a single wave 
Later on - want to create variable with 'answered YES at least once'
[want ID AND wave to be unique]
```{r Late entry loss of a loved one due to COVID COPING}
if(COPING == TRUE) {
# Confirm number of rows in current dataset 
nrow(coping.loss.followupb.raw.id)
# Filter out duplicated IDs AND wave, keeping the LAST entry
coping.loss.followupb.raw.id <- coping.loss.followupb.raw.id %>% 
    group_by(ID) %>% 
    filter(!duplicated(wave_loss,
                      fromLast = TRUE)
           )
# Confirm number of rows in dataset after filtering 
nrow(coping.loss.followupb.raw.id)
}
```

Change follow up loss of a loved one due to COVID COPING to wide format
```{r Loss of a loved one due to COVID COPING wide format}
if(COPING == TRUE) {
coping.loss.followupb.raw.id <- coping.loss.followupb.raw.id %>%
  group_by(wave_loss) %>%
  mutate(row = row_number()) %>%
  tidyr::pivot_wider(id_cols = ID,
    names_from = wave_loss, 
                     values_from = c( grief.due_past_month_lost,
                                      grief.suffered_past_month_loss
                       )) 
  
}
```

Select variables for dataset loss of a loved one due to COVID COPING
```{r Select variables loss of a loved one due to COVID COPING}
if(COPING == TRUE) {
coping.loss.followupb.raw.id <- coping.loss.followupb.raw.id %>%
  select(ID,
        # `grief.due_past_month_lost_.Wave_1a`,
        # `grief.due_past_month_lost_.Wave_1b`,
         `grief.due_past_month_lost_.Wave_2b`,
         `grief.due_past_month_lost_.Wave_3b`,
         `grief.due_past_month_lost_.Wave_4b`,
         `grief.due_past_month_lost_.Wave_6b`,
         `grief.due_past_month_lost_.Wave_8b`,
         `grief.due_past_month_lost_.Wave_10b`,
         `grief.due_past_month_lost_.Wave_12b`,
        `grief.due_past_month_lost_.Wave_14b`,
        `grief.due_past_month_lost_.Wave_16b`,
         
       #   `grief.suffered_past_month_loss_.Wave_1a`,
       #  `grief.suffered_past_month_loss_.Wave_1b`,
         `grief.suffered_past_month_loss_.Wave_2b`,
         `grief.suffered_past_month_loss_.Wave_3b`,
         `grief.suffered_past_month_loss_.Wave_4b`,
         `grief.suffered_past_month_loss_.Wave_6b`,
         `grief.suffered_past_month_loss_.Wave_8b`,
         `grief.suffered_past_month_loss_.Wave_10b`,
         `grief.suffered_past_month_loss_.Wave_12b`,
       `grief.suffered_past_month_loss_.Wave_14b`,
       `grief.suffered_past_month_loss_.Wave_16b`
         
         )
}
```

Remove duplicate IDs loss of a loved one due to COVID COPING
```{r Remove duplicate IDs loss of a loved one due to COVID COPING}
if(COPING == TRUE) {
##Check col names
colnames(coping.loss.followupb.raw.id)
##Remove dupilcate IDs (as each wave is now a column, there should be NO dup IDs)
coping.loss.followupb.raw.id  <- coping.loss.followupb.raw.id %>%
  filter(., !duplicated(ID)) 
##Check number of rows
nrow(coping.loss.followupb.raw.id)
}
```

# TIMEPOINTS / PHASES - COPING EDEQ SCREENER 
```{r Check number of entries per phase COPING EDEQ screener}
if(COPING == TRUE) {
edeq.coping.followupb.screener.raw.id %>%
  group_by(wave_edeq) %>%
  count()

}
```

Idenfity duplicate IDs in a single phase COPING EDEQ screener 
```{r Idenfity duplicate IDs in a single phase COPING EDEQ screener }
if(COPING == TRUE) {

# Identify dup IDs in a single wave
edeq.coping.followupb.screener.raw.id %>%
   group_by(wave_edeq, ID) %>%
   summarize(N = n()) %>%
   filter(N > 1)
}
```

Want the LATER data entry from people who answered twice within a single wave (for now)
[want ID AND wave to be unique]
```{r Later date entry COPING EDEQ screener }
if(COPING == TRUE) {

# Confirm number of rows in current dataset
nrow(edeq.coping.followupb.screener.raw.id)

# Filter out duplicated IDs AND wave, keeping the LAST entry
edeq.coping.followupb.screener.raw.id <- edeq.coping.followupb.screener.raw.id %>% 
    group_by(ID) %>% 
    filter(!duplicated(wave_edeq,
                      fromLast = TRUE)
           )

# Confirm number of rows in dataset after filtering (84728 - 206)
nrow(edeq.coping.followupb.screener.raw.id)
}
```

Change follow up EDEQ COPING screener to wide format 
```{r COPING EDEQ screener wide format}
if(COPING == TRUE) {
edeq.coping.followupb.screener.raw.id <- edeq.coping.followupb.screener.raw.id %>%
  group_by(wave_edeq) %>%
  mutate(row = row_number()) %>%
  tidyr::pivot_wider(id_cols = ID,
    names_from = wave_edeq,
                     values_from = c(ed_scid5.regular_episodes_eating_binges,
                     ed_scid5.weigh_weighed_past_month,
                     ed_scid5.regular_episodes_eating_binges_numeric,
                     ed_scid5.weigh_weighed_past_month_numeric))
  
}

```

Select variables for dataset EDEQ COPING screener
```{r Select variables EDEQ COPING screener}
if(COPING == TRUE) {
edeq.coping.followupb.screener.raw.id <- edeq.coping.followupb.screener.raw.id  %>%
  select(ID,
         #`ed_scid5.regular_episodes_eating_binges_.Wave_1b`,
         `ed_scid5.regular_episodes_eating_binges_.Wave_2b` ,    
         `ed_scid5.regular_episodes_eating_binges_.Wave_3b` ,       
         `ed_scid5.regular_episodes_eating_binges_.Wave_4b`,
         `ed_scid5.regular_episodes_eating_binges_.Wave_6b`,
         `ed_scid5.regular_episodes_eating_binges_.Wave_8b`,
         `ed_scid5.regular_episodes_eating_binges_.Wave_10b`,
         `ed_scid5.regular_episodes_eating_binges_.Wave_12b`,
         `ed_scid5.regular_episodes_eating_binges_.Wave_14b`,
         `ed_scid5.regular_episodes_eating_binges_.Wave_16b`,
         
        # `ed_scid5.weigh_weighed_past_month_.Wave_1b`,
         `ed_scid5.weigh_weighed_past_month_.Wave_2b` ,    
         `ed_scid5.weigh_weighed_past_month_.Wave_3b` ,       
         `ed_scid5.weigh_weighed_past_month_.Wave_4b`,
         `ed_scid5.weigh_weighed_past_month_.Wave_6b`,
         `ed_scid5.weigh_weighed_past_month_.Wave_8b`,
         `ed_scid5.weigh_weighed_past_month_.Wave_10b`,
         `ed_scid5.weigh_weighed_past_month_.Wave_12b`,
         `ed_scid5.weigh_weighed_past_month_.Wave_14b`,
        `ed_scid5.weigh_weighed_past_month_.Wave_16b`,
         
         # `ed_scid5.regular_episodes_eating_binges_numeric_.Wave_1b`,
         `ed_scid5.regular_episodes_eating_binges_numeric_.Wave_2b` ,    
         `ed_scid5.regular_episodes_eating_binges_numeric_.Wave_3b` ,       
         `ed_scid5.regular_episodes_eating_binges_numeric_.Wave_4b`,
         `ed_scid5.regular_episodes_eating_binges_numeric_.Wave_6b`,
         `ed_scid5.regular_episodes_eating_binges_numeric_.Wave_8b`,
         `ed_scid5.regular_episodes_eating_binges_numeric_.Wave_10b`,
         `ed_scid5.regular_episodes_eating_binges_numeric_.Wave_12b`,
        `ed_scid5.regular_episodes_eating_binges_numeric_.Wave_14b`,
        `ed_scid5.regular_episodes_eating_binges_numeric_.Wave_16b`,
         
        # `ed_scid5.weigh_weighed_past_month_numeric_.Wave_1b`,
         `ed_scid5.weigh_weighed_past_month_numeric_.Wave_2b` ,    
         `ed_scid5.weigh_weighed_past_month_numeric_.Wave_3b` ,       
         `ed_scid5.weigh_weighed_past_month_numeric_.Wave_4b`,
         `ed_scid5.weigh_weighed_past_month_numeric_.Wave_6b`,
         `ed_scid5.weigh_weighed_past_month_numeric_.Wave_8b`,
         `ed_scid5.weigh_weighed_past_month_numeric_.Wave_10b`,
         `ed_scid5.weigh_weighed_past_month_numeric_.Wave_12b`,
         `ed_scid5.weigh_weighed_past_month_numeric_.Wave_14b`,
         `ed_scid5.weigh_weighed_past_month_numeric_.Wave_16b`
        )
}
```

Remove duplicate IDs EDEQ COPING screener
```{r Remove duplicate IDs EDEQ COPING screener}
if(COPING == TRUE) {
# Check col names
colnames(edeq.coping.followupb.screener.raw.id)

# Remove dupilcate IDs (as each wave is now a column, there should be NO dup IDs)
edeq.coping.followupb.screener.raw.id  <- edeq.coping.followupb.screener.raw.id  %>%
  filter(., !duplicated(ID)) 

# Check number of rows
nrow(edeq.coping.followupb.screener.raw.id)
}

```

# TIMEPOINTS / PHASES - Virus info COPING
[want ID AND wave to be unique]
```{r Last entry Virus info COPING}
if(COPING == TRUE) {
# Confirm number of rows in current dataset
nrow(coping.followupb.virus.id)

  # Filter out duplicated IDs AND wave, keeping the LAST entry
coping.followupb.virus.id <- coping.followupb.virus.id %>% 
    group_by(ID) %>% 
    filter(!duplicated(wave_virus,
                      fromLast = TRUE)
           )
# Coonfirm number of rows in dataset after filtering
nrow(coping.followupb.virus.id)
}
```
Change follow up COPING VIRUS to wide format 
```{r Virus info COPING wide format}
if(COPING == TRUE) {
coping.followupb.virus.id <- coping.followupb.virus.id %>%
  group_by(wave_virus) %>%
  mutate(row = row_number()) %>%
  tidyr::pivot_wider(id_cols = ID,
    names_from = wave_virus,
                     values_from = c(virus.back_positive_antibodies_tests,
                     virus.back_positive_antibodies_tests_numeric,
                     virus.past_surveys_include_covid19,
                     virus.past_surveys_include_covid19_numeric))
  
}
```

Select variables for dataset COPING VIRUS
```{r Select variables COPING VIRUS}
if(COPING == TRUE) {
coping.followupb.virus.id <- coping.followupb.virus.id  %>%
  select(ID,
         `virus.back_positive_antibodies_tests_.Wave_2b` ,    
         `virus.back_positive_antibodies_tests_.Wave_3b` ,       
         `virus.back_positive_antibodies_tests_.Wave_4b`,
         `virus.back_positive_antibodies_tests_.Wave_6b`,
         `virus.back_positive_antibodies_tests_.Wave_8b`,
         `virus.back_positive_antibodies_tests_.Wave_10b`,
         `virus.back_positive_antibodies_tests_.Wave_12b`,
         `virus.back_positive_antibodies_tests_.Wave_14b`,
         `virus.back_positive_antibodies_tests_.Wave_16b`,
         
         `virus.back_positive_antibodies_tests_numeric_.Wave_2b` ,    
         `virus.back_positive_antibodies_tests_numeric_.Wave_3b` ,       
         `virus.back_positive_antibodies_tests_numeric_.Wave_4b`,
         `virus.back_positive_antibodies_tests_numeric_.Wave_6b`,
         `virus.back_positive_antibodies_tests_numeric_.Wave_8b`,
         `virus.back_positive_antibodies_tests_numeric_.Wave_10b`,
         `virus.back_positive_antibodies_tests_numeric_.Wave_12b`,
         `virus.back_positive_antibodies_tests_numeric_.Wave_14b`,
         `virus.back_positive_antibodies_tests_numeric_.Wave_16b`,
         
         
         `virus.past_surveys_include_covid19_.Wave_2b` ,    
         `virus.past_surveys_include_covid19_.Wave_3b` ,       
         `virus.past_surveys_include_covid19_.Wave_4b`,
         `virus.past_surveys_include_covid19_.Wave_6b`,
         `virus.past_surveys_include_covid19_.Wave_8b`,
         `virus.past_surveys_include_covid19_.Wave_10b`,
         `virus.past_surveys_include_covid19_.Wave_12b`,
         `virus.past_surveys_include_covid19_.Wave_14b`,
         `virus.past_surveys_include_covid19_.Wave_16b`,
         
         `virus.past_surveys_include_covid19_numeric_.Wave_2b` ,    
         `virus.past_surveys_include_covid19_numeric_.Wave_3b` ,       
         `virus.past_surveys_include_covid19_numeric_.Wave_4b`,
         `virus.past_surveys_include_covid19_numeric_.Wave_6b`,
         `virus.past_surveys_include_covid19_numeric_.Wave_8b`,
         `virus.past_surveys_include_covid19_numeric_.Wave_10b`,
         `virus.past_surveys_include_covid19_numeric_.Wave_12b`,
         `virus.past_surveys_include_covid19_numeric_.Wave_14b`,
         `virus.past_surveys_include_covid19_numeric_.Wave_16b`
         
        )
}
```

Remove duplicate IDs COPING VIRUS
```{r}
if(COPING == TRUE) {
# Check col names
colnames(coping.followupb.virus.id)
# Remove dupilcate IDs (as each wave is now a column, there should be NO dup IDs)
coping.followupb.virus.id  <- coping.followupb.virus.id  %>%
  filter(., !duplicated(ID)) 
# Check number of rows
nrow(coping.followupb.virus.id)
}
```

# TIMEPOINTS / PHASES - Virus info RAMP
[want ID AND wave to be unique]
```{r  Last entry Virus info RAMP}
if(RAMP == TRUE) {
# Confirm number of rows in current dataset
nrow(ramp.followupb.virus.id)
# Filter out duplicated IDs AND wave, keeping the LAST entry
ramp.followupb.virus.id <- ramp.followupb.virus.id %>% 
    group_by(ID) %>% 
    filter(!duplicated(wave_virus,
                      fromLast = TRUE)
           )
# Confirm number of rows in dataset after filtering
nrow(ramp.followupb.virus.id)
}
```

Change follow up COPING VIRUS RAMP to wide format 
```{r RAMP VIRUS info wide format}
if(RAMP == TRUE) {
ramp.followupb.virus.id <- ramp.followupb.virus.id %>%
  group_by(wave_virus) %>%
  mutate(row = row_number()) %>%
  tidyr::pivot_wider(id_cols = ID,
    names_from = wave_virus,
                     values_from = c(virus.back_positive_antibodies_tests,
                     virus.back_positive_antibodies_tests_numeric,
                     virus.past_surveys_include_covid19,
                     virus.past_surveys_include_covid19_numeric))
  
}
```

Select variables for dataset RAMP VIRUS
```{r Select variables for RAMP VIRUS}
if(RAMP == TRUE) {
ramp.followupb.virus.id <- ramp.followupb.virus.id  %>%
  select(ID,
         `virus.back_positive_antibodies_tests_.Wave_1b`,
         `virus.back_positive_antibodies_tests_.Wave_2b` ,    
         `virus.back_positive_antibodies_tests_.Wave_3b` ,       
         `virus.back_positive_antibodies_tests_.Wave_4b`,
         `virus.back_positive_antibodies_tests_.Wave_6b`,
         `virus.back_positive_antibodies_tests_.Wave_8b`,
         `virus.back_positive_antibodies_tests_.Wave_10b`,
         `virus.back_positive_antibodies_tests_.Wave_12b`,
         `virus.back_positive_antibodies_tests_numeric_.Wave_1b`,
         `virus.back_positive_antibodies_tests_numeric_.Wave_2b` ,    
         `virus.back_positive_antibodies_tests_numeric_.Wave_3b` ,       
         `virus.back_positive_antibodies_tests_numeric_.Wave_4b`,
         `virus.back_positive_antibodies_tests_numeric_.Wave_6b`,
         `virus.back_positive_antibodies_tests_numeric_.Wave_8b`,
         `virus.back_positive_antibodies_tests_numeric_.Wave_10b`,
         `virus.back_positive_antibodies_tests_numeric_.Wave_12b`,
       
        `virus.past_surveys_include_covid19_.Wave_1b`,
         `virus.past_surveys_include_covid19_.Wave_2b` ,    
         `virus.past_surveys_include_covid19_.Wave_3b` ,       
         `virus.past_surveys_include_covid19_.Wave_4b`,
         `virus.past_surveys_include_covid19_.Wave_6b`,
         `virus.past_surveys_include_covid19_.Wave_8b`,
         `virus.past_surveys_include_covid19_.Wave_10b`,
         `virus.past_surveys_include_covid19_.Wave_12b`,
         
         `virus.past_surveys_include_covid19_numeric_.Wave_1b`,
         `virus.past_surveys_include_covid19_numeric_.Wave_2b` ,    
         `virus.past_surveys_include_covid19_numeric_.Wave_3b` ,       
         `virus.past_surveys_include_covid19_numeric_.Wave_4b`,
         `virus.past_surveys_include_covid19_numeric_.Wave_6b`,
         `virus.past_surveys_include_covid19_numeric_.Wave_8b`,
         `virus.past_surveys_include_covid19_numeric_.Wave_10b`,
         `virus.past_surveys_include_covid19_numeric_.Wave_12b`)
}
```

Remove duplicate IDs RAMP VIRUS
```{r}
if(RAMP == TRUE) {
# Check col names
colnames(ramp.followupb.virus.id)
# Remove dupilcate IDs (as each wave is now a column, there should be NO dup IDs)
ramp.followupb.virus.id  <- ramp.followupb.virus.id  %>%
  filter(., !duplicated(ID)) 
# Check number of rows
nrow(ramp.followupb.virus.id)
}
```

Remove duplicate IDs RAMP VIRUS
```{r Remove dup IDs RAMP VIRUS}
if(RAMP == TRUE) {
# Check col names
colnames(ramp.followupb.virus.id)

# Remove dupilcate IDs (as each wave is now a column, there should be NO dup IDs)
ramp.followupb.virus.id  <- ramp.followupb.virus.id  %>%
  filter(., !duplicated(ID)) 

# Check number of rows
nrow(ramp.followupb.virus.id)
}

```

# Export all follow up data
```{r Export follow up data}
if(COPING == TRUE) {

saveRDS(object = dat.raw.taf.coping, file = paste0("/Users/helenadavies/werk/EDBEHSELFHARM2/gitEDBEHSELFHARM/data_cleaned/TAF_coping", date, ".rds"))
  
  saveRDS(object = edeq.coping.followupb.screener.raw.id, file = paste0("/Users/helenadavies/werk/EDBEHSELFHARM2/gitEDBEHSELFHARM/data_cleaned/EDEQ_screener_coping", date, ".rds"))
  
  saveRDS(object = dat.raw.dem.coping.followup, file = paste0("/Users/helenadavies/werk/EDBEHSELFHARM2/gitEDBEHSELFHARM/data_cleaned/DEM_followup_coping", date, ".rds"))
  
  saveRDS(object = coping.loss.followupb.raw.id, file = paste0("/Users/helenadavies/werk/EDBEHSELFHARM2/gitEDBEHSELFHARM/data_cleaned/LOSS_coping_followup", date, ".rds"))
  
   saveRDS(object = coping.followupb.virus.id, file = paste0("/Users/helenadavies/werk/EDBEHSELFHARM2/gitEDBEHSELFHARM/data_cleaned/VIRUS_coping_followup", date, ".rds"))

     saveRDS(object = coping.followup.resp.id, file = paste0("/Users/helenadavies/werk/EDBEHSELFHARM2/gitEDBEHSELFHARM/data_cleaned/RESP_coping_followup", date, ".rds"))
}

if(RAMP == TRUE) {

  saveRDS(object = dat.raw.taf.ramp, file = paste0("/Users/helenadavies/werk/EDBEHSELFHARM2/gitEDBEHSELFHARM/data_cleaned/TAF_ramp", date, ".rds"))
  
  saveRDS(object = edeq.ramp.followupb.screener.raw.id, file = paste0("/Users/helenadavies/werk/EDBEHSELFHARM2/gitEDBEHSELFHARM/data_cleaned/EDEQ_screener_ramp", date, ".rds"))
  
   saveRDS(object = dat.raw.dem.ramp.followup, file = paste0("/Users/helenadavies/werk/EDBEHSELFHARM2/gitEDBEHSELFHARM/data_cleaned/DEM_followup_ramp", date, ".rds"))

   saveRDS(object = ramp.loss.followupb.raw.id, file = paste0("/Users/helenadavies/werk/EDBEHSELFHARM2/gitEDBEHSELFHARM/data_cleaned/LOSS_ramp_followup", date, ".rds"))
   
    saveRDS(object = ramp.followupb.virus.id, file = paste0("/Users/helenadavies/werk/EDBEHSELFHARM2/gitEDBEHSELFHARM/data_cleaned/VIRUS_ramp_followup", date, ".rds"))
   
    saveRDS(object = ramp.followup.resp.id, file = paste0("/Users/helenadavies/werk/EDBEHSELFHARM2/gitEDBEHSELFHARM/data_cleaned/RESP_ramp_followup", date, ".rds"))
}

```

# JOINING DATASETS - baseline 

## Select same variables from each dataset

EDGI select variables from each dataset
```{r EDGI select variables for final dataset}
if(EDGI == TRUE) {
  
  # Temporary solution - Drop one dup cohort name columns
edgi.coping.dem.raw.id$cohort_name.y <- NULL
edgi.coping.dem.raw.id <- edgi.coping.dem.raw.id %>% 
  rename(
    cohort_name = cohort_name.x
    )

edgi.1 <- edgi.coping.dem.raw.id %>% 
  select(ID,
  cohort_name,
  gender_unc,
  sex,
  uk_location,
  current_country,
  age_category_COPING
  )
  
edgi.2 <- edgi.dem3.raw.id %>% 
  select(ID,
  cohort_name,
  age_category_numeric,
  age_category,
  highest_education_prepan_numeric,
  highest_education_prepan,
  ethnicity, 
  transgender
  )
  
edgi.3 <- edgi.coping.dem4.employ.raw.id %>% 
  select(ID,
  cohort_name,
  highest_education_numeric,
  highest_education,
  employment_prior_covid_numeric,
  employment_prior_covid,
  employment_change_numeric,
  employment_change,
  key_worker,
  employed,
  employ.government_work_key_workers_numeric,
  employ.government_work_key_workers,
  key_worker_numeric,
  employ.fulltime_employed,
  employ.parttime_employed,
  employ.unemployed,
  employ.zerohours_contract,
  employ.stayathome_parent_or_carer,
  employ.selfemployed,
  employ.contract_or_freelance_work,
  employ.small_business_owner,
  employ.receiving_state_income,
  employ.retired,
  employ.student_gcse_or_a_level,
  employ.student_university,
  employ.my_employment_status_has_not_changed,
  employ.became_unemployed,
  employ.reduction_in_hours,
  employ.reduction_in_salary,
  employ.benefits_increased,
  employ.benefits_decreased,
  employ.change_in_duties_or_responsibilities,
  employ.became_employed,
  employ.increased_hours,
  employ.increased_salary,
  employ.furloughed_or_paid_leave_government_funded,
  employ.furloughed_or_paid_leave_company_funded,
  employ.paid_leave_furloughed,
  employ.taking_unpaid_leave,
  employ.other,
  employ.other_text.txt,
  employ.no_impact,
  employ.cancelled_exams,
  employ.change_in_format_of_exams,
  employ.automatic_pass,
  employ.change_in_deadlines,
  employ.change_in_lesson_delivery,
  employ.past_performance_grade_decided,
  employ.cancelled_classes,
  employ.cannot_complete_degree,
  employ.impact_on_studies_still_unknown,
  employ.other.1,
  employ.other_text.txt.1,
  employ.losing_job_due_risk,
  employ.increased_due_job_pandemic)
  
edgi.4 <- taf.edgi.coping.baseline.raw.id %>% 
  select(ID,
  cohort_name,
  taf.worth_living_life_people_.Wavebaseline,
  taf.felt_weeks_past_.Wavebaseline,
  taf.have_you_contemplated_harming_yourself_.Wavebaseline,
  taf.felt_weeks_past.1_.Wavebaseline,
  taf.meant_life_end_weeks_.Wavebaseline,
   taf.pandemic_felt_.Wavebaseline,
  taf.pandemic_felt.1_.Wavebaseline,
  taf.meant_end_life_pandemic_.Wavebaseline)

edgi.5 <- mhd.raw.id %>% 
  select(ID,
         cohort_name,
         control,
         control_numeric,
         depressive_disorders_numeric,
         anxiety_disorders_numeric,
         eating_disorders_diagnosed_numeric,
         obsessive_compulsive_disorders_numeric,
         psychotic_disorders_numeric,
         PERSONALITY_DISORDER_NUMERIC,
         agoraphobia_panic_disorder_numeric,
         depression_and_anxiety_numeric,
         bipolar_and_schizophrenia_numeric,
         mhd.mania_hypomania_bipolar_or_manicdepression_numeric,
         mhd.posttraumatic_stress_disorder_ptsd_numeric, 
         autism_spectrum_disorder_numeric,
         mhd.attention_deficit_hyperactivity_disorder_numeric,
         mhd.personality_disorder_numeric,
         mhd.suspected_eating_disorder_diagnosed_numeric,
         mhd.body_dysmorphic_disorder_bdd_numeric,
         mhd.anorexia_nervosa_numeric,
          mhd.atypical_anorexia_nervosa_numeric,
          mhd.bulimia_nervosa_numeric, 
          mhd.atypical_bulimia_nervosa_numeric,  
          mhd.bingeeating_disorder_numeric, 
          mhd.atypical_bingeeating_disorder_numeric, 
          mhd.purging_disorder_numeric, 
          mhd.night_eating_syndrome_numeric,  
          mhd.pica_numeric, 
          mhd.avoidantrestrictive_food_intake_disorder_numeric,
          mhd.rumination_disorder_numeric, 
          mhd.feeding_eating_disorder_numeric, 
          mhd.other_eating_disorder_numeric)

edgi.6 <- taf.edgi.coping.baseline.raw.id %>% 
  select(ID,
  cohort_name,
  taf.pandemic_felt_.Wavebaseline,
  taf.pandemic_felt.1_.Wavebaseline,
  taf.meant_end_life_pandemic_.Wavebaseline)

edgi.7 <- edgi.coping.dem2.raw.id %>%
  select(ID,
         cohort_name,
         dem2.living_with_partner_or_spouse,
         dem2.living_alone,
         dem2.living_with_partner_or_spouse,
         dem2.living_with_housemates,
         dem2.age_children_living,
         dem2.age_children_living.1,
         dem2.living_with_other_members_of_my_family,
         dem2.spouse_partner_members_living,
         dem2.staying_live,
         dem2.staying_live.1,
         dem2.prefer_not_to_say,
         dem2.living_situation_change_pandemic,
         dem2.living_alone.1,
         dem2.living_with_partner_or_spouse.1,
         dem2.living_with_housemates.1,
         dem2.age_children_living.2,
         dem2.age_children_living.3,
         dem2.living_with_other_members_of_my_family.1,
         dem2.spouse_partner_members_living.1,
         dem2.staying_live.2,
         dem2.staying_live.3,
         dem2.prefer_not_to_say.1,
          dem2.member_vulnerable_group,
         dem2.solid_organ_transplant_recipient,
         dem2.lung_cancer_radical_radiotherapy,
         dem2.bone_marrow_blood_leukaemia,
         dem2.immunotherapy_cancer_continuing_antibody,
         dem2.parp_inhibitors_affect_immune,
         dem2.stem_cell_transplants_bone,
         dem2.severe_copd_cystic_fibrosis,
         dem2.inborn_errors_rare_diseases,
         dem2.taking_medicine_that_weakens_your_immune_system,
         dem2.condition_infections_makes,
         dem2.congenital_pregnant_acquired_significant,
         dem2.pregnant,
         dem2.over_70_years_old,
         dem2.prefer_not_to_say.2,
         dem2.unsure)
  
edgi.8 <- edgi_pan_worry.id %>%
  select(ID,
         cohort_name,
         panworry.impact_on_your_employment_status,                                    
         panworry.employment_status_household_key,              
         panworry.impact_on_your_education_or_exams,            
         panworry.exams_impact_education_children,              
         panworry.financial_impact,                           
         panworry.contracting_the_virus,                       
         panworry.people_you_know_contracting_the_virus,       
         panworry.people_you_dont_know_contracting_the_virus,   
         panworry.impact_mental_health_wellbeing,               
         panworry.impact_mental_health_childrens,               
         panworry.impact_relatives_mental_health,           
         panworry.being_socially_isolated,                    
         panworry.people_you_know_being_socially_isolated,      
         panworry.shortage_of_essential_supplies,                
         panworry.shortage_of_medication_or_access_to_healthcare,
         panworry.healthcare_people_essential_supplies,          
         panworry.information_virus_government_accuracy,         
         panworry.the_governments_response_to_the_pandemic,      
         panworry.separation_from_family_members,         
         panworry.standing_impact_global_recession,
         panworry.other_,
         
         panworry.impact_on_your_employment_status_numeric,                                    
         panworry.employment_status_household_key_numeric,              
         panworry.impact_on_your_education_or_exams_numeric,            
         panworry.exams_impact_education_children_numeric,              
         panworry.financial_impact_numeric,                           
         panworry.contracting_the_virus_numeric,                       
         panworry.people_you_know_contracting_the_virus_numeric,       
         panworry.people_you_dont_know_contracting_the_virus_numeric,   
         panworry.impact_mental_health_wellbeing_numeric,               
         panworry.impact_mental_health_childrens_numeric,               
         panworry.impact_relatives_mental_health_numeric,           
         panworry.being_socially_isolated_numeric,                    
         panworry.people_you_know_being_socially_isolated_numeric,      
         panworry.shortage_of_essential_supplies_numeric,                
         panworry.shortage_of_medication_or_access_to_healthcare_numeric,
         panworry.healthcare_people_essential_supplies_numeric,          
         panworry.information_virus_government_accuracy_numeric,         
         panworry.the_governments_response_to_the_pandemic_numeric,      
         panworry.separation_from_family_members_numeric,         
         panworry.standing_impact_global_recession_numeric,
         panworry.other__numeric)
  
edgi.9 <- edgi.loneliness.baseline.raw.id %>%
  select(ID,
         cohort_name,
         lone.felt_that_you_lack_companionship,
        lone.felt_left_out,
        lone.felt_isolated_from_others,
        lone.felt_alone,lone.similar_felt_pandemic,
        lone.felt_that_you_lack_companionship.1,
        lone.felt_left_out.1,
        lone.felt_isolated_from_others.1,
        lone.felt_alone.1
  )
edgi.10 <- edgi.loss.baseline.raw.id %>%
  select(ID, 
         cohort_name,
         grief.covid_lost_due_close,
         grief.suffered_past_month_loss)


edgi.11 <- edgi.baseline.resp.id %>%
  select(ID, 
         cohort_name,
         resp.coronavirus_test_nosethroat_swab,
         resp.results_nosethroat_swab_test,
         resp.coronavirus_antibody_test,
         resp.coronavirus_antibody_test)

       
##See if IDs match with edgi.5
x <- edgi.5[edgi.5$ID %in% edgi.4$ID,]
length(unique(x$ID))
x <- edgi.5[edgi.5$ID %in% edgi.3$ID,]
length(unique(x$ID))
x <- edgi.5[edgi.5$ID %in% edgi.2$ID,]
length(unique(x$ID))
x <- edgi.5[edgi.5$ID %in% edgi.1$ID,]
length(unique(x$ID))
}
```

EDGI data frame list
```{r EDGI data frame list}
if(EDGI == TRUE) {
dfs.list <- list(
  edgi.1,
  edgi.2,
  edgi.3,
  edgi.4,
  edgi.5,
  edgi.7,
  edgi.8,
  edgi.9, 
  edgi.10,
  edgi.11
)
}
```

Join all EDGI
```{r Join all EDGI questionnaires}
if(EDGI == TRUE) {
dat.raw.edgi <- plyr::join_all(
  dfs.list,
  by = c("ID", "cohort_name") # Alternatively you can join by several columns EDGI -> "Age", "Sex", "Birthyear"
  )
# Look at the data
colnames(dat.raw.edgi)
}
```

Get rid of duplicates in EDGI
```{r Check duplicates EDGI final dataset}
if(EDGI == TRUE) {
dat.raw.edgi$ID.dup <- duplicated(dat.raw.edgi$ID)
summary(as.factor(dat.raw.edgi$ID.dup))
select(dat.raw.edgi)
 # Check for duplicate names of columns
names_freq <- as.data.frame(table(names(dat.raw.edgi)))
names_freq[names_freq$Freq > 1, ]
# Filter out duplicate column names
 dat.dup <- dat.raw.edgi %>%
  filter(ID.dup == TRUE)
dat.raw.edgi <- dat.raw.edgi %>%
  filter(ID.dup == FALSE)
colnames(dat.raw.edgi)
}
```

GLAD data frame list
```{r GLAD data frame list}
if(GLAD == TRUE) {
  
  # Temporary solution - Drop one dup cohort name columns
glad.coping.dem.raw.id$cohort_name.y <- NULL
glad.coping.dem.raw.id <- glad.coping.dem.raw.id %>% 
  rename(
    cohort_name = cohort_name.x
    )

glad.1 <-  glad.coping.dem.raw.id %>%
     select(ID,
            cohort_name,
            sex,
            gender_unc,
            uk_location,
            current_country,
            age_category_COPING
            )

glad.2 <- glad.dem3.raw.id %>%
  select(ID,
         cohort_name,
         age_category_numeric,
         age_category,
         ethnicity,
         highest_education_prepan_numeric,
         highest_education_prepan,
         transgender)

glad.3 <- glad.coping.dem4.employ.raw.id %>% 
  select(ID,
         cohort_name,
         highest_education_numeric,
         highest_education,
         employment_prior_covid,
         employment_prior_covid_numeric,
         employment_change,
         employment_change_numeric,
         key_worker,
         key_worker_numeric,
         employed,
         employ.government_work_key_workers_numeric,
           employ.government_work_key_workers,
         employ.fulltime_employed,
  employ.parttime_employed,
  employ.unemployed,
  employ.zerohours_contract,
  employ.stayathome_parent_or_carer,
  employ.selfemployed,
  employ.contract_or_freelance_work,
  employ.small_business_owner,
  employ.receiving_state_income,
  employ.retired,
  employ.student_gcse_or_a_level,
  employ.student_university,
  employ.my_employment_status_has_not_changed,
  employ.became_unemployed,
  employ.reduction_in_hours,
  employ.reduction_in_salary,
  employ.benefits_increased,
  employ.benefits_decreased,
  employ.change_in_duties_or_responsibilities,
  employ.became_employed,
  employ.increased_hours,
  employ.increased_salary,
  employ.furloughed_or_paid_leave_government_funded,
  employ.furloughed_or_paid_leave_company_funded,
  employ.paid_leave_furloughed,
  employ.taking_unpaid_leave,
  employ.other,
  employ.other_text.txt,
  employ.no_impact,
  employ.cancelled_exams,
  employ.change_in_format_of_exams,
  employ.automatic_pass,
  employ.change_in_deadlines,
  employ.change_in_lesson_delivery,
  employ.past_performance_grade_decided,
  employ.cancelled_classes,
  employ.cannot_complete_degree,
  employ.impact_on_studies_still_unknown,
  employ.other.1,
  employ.other_text.txt.1,
  employ.losing_job_due_risk,
  employ.increased_due_job_pandemic)

glad.4 <- taf.glad.coping.baseline.raw.id%>%
  select(ID,
  cohort_name,
  taf.worth_living_life_people_.Wavebaseline,
  taf.felt_weeks_past_.Wavebaseline,
  taf.have_you_contemplated_harming_yourself_.Wavebaseline,
  taf.felt_weeks_past.1_.Wavebaseline,
  taf.meant_life_end_weeks_.Wavebaseline,
   taf.pandemic_felt_.Wavebaseline,
  taf.pandemic_felt.1_.Wavebaseline,
  taf.meant_end_life_pandemic_.Wavebaseline)

glad.5 <- mhd.raw.id %>%
  select(ID,
         cohort_name,
         control,
         control_numeric,
         depressive_disorders_numeric,
         anxiety_disorders_numeric,
         eating_disorders_diagnosed_numeric,
         obsessive_compulsive_disorders_numeric,
         psychotic_disorders_numeric,
         PERSONALITY_DISORDER_NUMERIC,
         agoraphobia_panic_disorder_numeric,
         depression_and_anxiety_numeric,
         bipolar_and_schizophrenia_numeric,
         mhd.mania_hypomania_bipolar_or_manicdepression_numeric,
        mhd.posttraumatic_stress_disorder_ptsd_numeric, 
        autism_spectrum_disorder_numeric,
        mhd.attention_deficit_hyperactivity_disorder_numeric,
        mhd.personality_disorder_numeric,
        mhd.suspected_eating_disorder_diagnosed_numeric,
        mhd.body_dysmorphic_disorder_bdd_numeric,
        mhd.anorexia_nervosa_numeric,
          mhd.atypical_anorexia_nervosa_numeric,
          mhd.bulimia_nervosa_numeric, 
          mhd.atypical_bulimia_nervosa_numeric,  
          mhd.bingeeating_disorder_numeric, 
          mhd.atypical_bingeeating_disorder_numeric, 
          mhd.purging_disorder_numeric, 
          mhd.night_eating_syndrome_numeric,  
          mhd.pica_numeric, 
          mhd.avoidantrestrictive_food_intake_disorder_numeric,
          mhd.rumination_disorder_numeric, 
          mhd.feeding_eating_disorder_numeric, 
          mhd.other_eating_disorder_numeric)

glad.6 <- glad.coping.dem2.raw.id %>%
  select(ID,
         cohort_name,
         dem2.living_with_partner_or_spouse,
         dem2.living_alone,
         dem2.living_with_partner_or_spouse,
         dem2.living_with_housemates,
         dem2.age_children_living,
         dem2.age_children_living.1,
         dem2.living_with_other_members_of_my_family,
         dem2.spouse_partner_members_living,
         dem2.staying_live,
         dem2.staying_live.1,
         dem2.prefer_not_to_say,
         dem2.living_situation_change_pandemic,
         dem2.living_alone.1,
         dem2.living_with_partner_or_spouse.1,
         dem2.living_with_housemates.1,
         dem2.age_children_living.2,
         dem2.age_children_living.3,
         dem2.living_with_other_members_of_my_family.1,
         dem2.spouse_partner_members_living.1,
         dem2.staying_live.2,
         dem2.staying_live.3,
         dem2.prefer_not_to_say.1,
         dem2.member_vulnerable_group,
         dem2.solid_organ_transplant_recipient,
         dem2.lung_cancer_radical_radiotherapy,
         dem2.bone_marrow_blood_leukaemia,
         dem2.immunotherapy_cancer_continuing_antibody,
         dem2.parp_inhibitors_affect_immune,
         dem2.stem_cell_transplants_bone,
         dem2.severe_copd_cystic_fibrosis,
         dem2.inborn_errors_rare_diseases,
         dem2.taking_medicine_that_weakens_your_immune_system,
         dem2.condition_infections_makes,
         dem2.congenital_pregnant_acquired_significant,
         dem2.pregnant,
         dem2.over_70_years_old,
         dem2.prefer_not_to_say.2,
         dem2.unsure)
  
glad.7 <- glad_pan_worry.id %>%
  select(ID,
         cohort_name,
         panworry.impact_on_your_employment_status,                                    
         panworry.employment_status_household_key,              
         panworry.impact_on_your_education_or_exams,            
         panworry.exams_impact_education_children,              
         panworry.financial_impact,                           
         panworry.contracting_the_virus,                       
         panworry.people_you_know_contracting_the_virus,       
         panworry.people_you_dont_know_contracting_the_virus,   
         panworry.impact_mental_health_wellbeing,               
         panworry.impact_mental_health_childrens,               
         panworry.impact_relatives_mental_health,           
         panworry.being_socially_isolated,                    
         panworry.people_you_know_being_socially_isolated,      
         panworry.shortage_of_essential_supplies,                
         panworry.shortage_of_medication_or_access_to_healthcare,
         panworry.healthcare_people_essential_supplies,          
         panworry.information_virus_government_accuracy,         
         panworry.the_governments_response_to_the_pandemic,      
         panworry.separation_from_family_members,         
         panworry.standing_impact_global_recession,
         panworry.other_,
         
         panworry.impact_on_your_employment_status_numeric,                                    
         panworry.employment_status_household_key_numeric,              
         panworry.impact_on_your_education_or_exams_numeric,            
         panworry.exams_impact_education_children_numeric,              
         panworry.financial_impact_numeric,                           
         panworry.contracting_the_virus_numeric,                       
         panworry.people_you_know_contracting_the_virus_numeric,       
         panworry.people_you_dont_know_contracting_the_virus_numeric,   
         panworry.impact_mental_health_wellbeing_numeric,               
         panworry.impact_mental_health_childrens_numeric,               
         panworry.impact_relatives_mental_health_numeric,           
         panworry.being_socially_isolated_numeric,                    
         panworry.people_you_know_being_socially_isolated_numeric,      
         panworry.shortage_of_essential_supplies_numeric,                
         panworry.shortage_of_medication_or_access_to_healthcare_numeric,
         panworry.healthcare_people_essential_supplies_numeric,          
         panworry.information_virus_government_accuracy_numeric,         
         panworry.the_governments_response_to_the_pandemic_numeric,      
         panworry.separation_from_family_members_numeric,         
         panworry.standing_impact_global_recession_numeric,
         panworry.other__numeric)

glad.8 <- glad.loneliness.baseline.raw.id %>%
  select(ID,
         cohort_name,
         lone.felt_that_you_lack_companionship,
        lone.felt_left_out,
        lone.felt_isolated_from_others,
        lone.felt_alone,lone.similar_felt_pandemic,
        lone.felt_that_you_lack_companionship.1,
        lone.felt_left_out.1,
        lone.felt_isolated_from_others.1,
        lone.felt_alone.1
  )

glad.9 <- glad.loss.baseline.raw.id %>%
  select(ID, 
         cohort_name,
         grief.covid_lost_due_close,
         grief.suffered_past_month_loss)

glad.10 <-  glad.baseline.resp.id %>%
  select(ID, 
         cohort_name,
         resp.coronavirus_test_nosethroat_swab,
         resp.results_nosethroat_swab_test,
         resp.coronavirus_antibody_test,
         resp.coronavirus_antibody_test)
  
# See if IDs match with glad.3
x <- glad.3[glad.3$ID %in% glad.1$ID,]
length(unique(x$ID))
x <- glad.3[glad.3$ID %in% glad.2$ID,]
length(unique(x$ID))
x <- glad.3[glad.3$ID %in% glad.4$ID,]
length(unique(x$ID))
x <- glad.3[glad.3$ID %in% glad.5$ID,]
length(unique(x$ID))
}
```

GLAD data frame list
```{r GLAD data frame list}
if(GLAD == TRUE) {
dfs.list <- list(
  glad.1,
  glad.2,
  glad.3,
  glad.4,
  glad.5,
  glad.6,
  glad.7,
  glad.8,
  glad.9,
  glad.10
  )
}
```

Join all GLAD
```{r Join all GLAD questionnaires}
if(GLAD == TRUE) {
dat.raw.glad <- plyr::join_all(
  dfs.list,
  by = c("ID", "cohort_name")
  )
# Look at the data
colnames(dat.raw.glad)
}
```

Get rid of duplicates in GLAD
```{r Check duplicates GLAD final dataset}
if(GLAD == TRUE) {
  dat.raw.glad$ID.dup <- duplicated(dat.raw.glad$ID)
summary(as.factor(dat.raw.glad$ID.dup))
select(dat.raw.glad)
# Check for duplicate names of columns
names_freq <- as.data.frame(table(names(dat.raw.glad)))
names_freq[names_freq$Freq > 1, ]
# Filter out duplicate column names
 #dat.dup <- dat.raw.glad %>%
 # filter(ID.dup == TRUE)
#dat.raw.glad <- dat.raw.glad %>%
#  filter(ID.dup == FALSE)
colnames(dat.raw.glad)
}
```

NBR selected variables
```{r NBR selected variables final dataset}
if(NBR == TRUE) {
  nbr.1 <- nbr.dem.employ.raw.id %>%
    select(ID,
           cohort_name,
           highest_education_numeric,
           highest_education,
           employment_change_numeric,
           employment_change,
           employment_prior_covid,
           employment_prior_covid_numeric,
           key_worker,
           key_worker_numeric,
           employed,
           employ.government_work_key_workers_numeric,
           employ.government_work_key_workers,
           employ.fulltime_employed,
           employ.parttime_employed,
employ.unemployed,
employ.zerohours_contract,
employ.stayathome_parent_or_carer,
employ.selfemployed,
employ.contract_or_freelance_work,
employ.small_business_owner,
employ.receiving_state_income,
employ.retired,
employ.student_gcse_or_a_level,
employ.student_university,
employ.my_employment_status_has_not_changed,
employ.became_unemployed,
employ.reduction_in_hours,
employ.reduction_in_salary,
employ.benefits_increased,
employ.benefits_decreased,
employ.change_in_duties_or_responsibilities,
employ.became_employed,
employ.increased_hours,
employ.increased_salary,
employ.furloughed_or_paid_leave_government_funded,
employ.furloughed_or_paid_leave_company_funded,
employ.paid_leave_furloughed,
employ.taking_unpaid_leave,
employ.other,
employ.other_text.txt,
employ.no_impact,
employ.cancelled_exams,
employ.change_in_format_of_exams,
employ.automatic_pass,
employ.change_in_deadlines,
employ.change_in_lesson_delivery,
employ.past_performance_grade_decided,
employ.cancelled_classes,
employ.cannot_complete_degree,
employ.impact_on_studies_still_unknown,
employ.other.1,
employ.other_text.txt.1,
employ.losing_job_due_risk,
employ.increased_due_job_pandemic,)
  
nbr.2 <- nbr.dem.raw.id.complete %>%
  select(ID,
         cohort_name,
         sex,
         gender_unc,
         ethnicity,
         current_country,
         uk_location)

nbr.3 <- nbr.dem.raw.id %>%
    select(ID,
           cohort_name,
           age_category,
           age_category_numeric)

nbr.4 <- taf.nbr.baseline.raw.id %>%
  select(ID,
  cohort_name,
  taf.worth_living_life_people_.Wavebaseline,
  taf.felt_weeks_past_.Wavebaseline,
  taf.have_you_contemplated_harming_yourself_.Wavebaseline,
  taf.felt_weeks_past.1_.Wavebaseline,
  taf.meant_life_end_weeks_.Wavebaseline,
  taf.pandemic_felt_.Wavebaseline,
  taf.pandemic_felt.1_.Wavebaseline,
  taf.meant_end_life_pandemic_.Wavebaseline)

nbr.5 <- mhd.raw.id %>% 
  select(ID,
         cohort_name,
         control,
         control_numeric,
         depressive_disorders_numeric,
         anxiety_disorders_numeric,
         eating_disorders_diagnosed_numeric,
         obsessive_compulsive_disorders_numeric,
         psychotic_disorders_numeric,
         PERSONALITY_DISORDER_NUMERIC,
         agoraphobia_panic_disorder_numeric,
         depression_and_anxiety_numeric,
         bipolar_and_schizophrenia_numeric,
         mhd.mania_hypomania_bipolar_or_manicdepression_numeric,
        mhd.posttraumatic_stress_disorder_ptsd_numeric, 
        autism_spectrum_disorder_numeric,
        mhd.attention_deficit_hyperactivity_disorder_numeric,
        mhd.personality_disorder_numeric,
        mhd.suspected_eating_disorder_diagnosed_numeric,
        mhd.body_dysmorphic_disorder_bdd_numeric,
        mhd.anorexia_nervosa_numeric,
          mhd.atypical_anorexia_nervosa_numeric,
          mhd.bulimia_nervosa_numeric, 
          mhd.atypical_bulimia_nervosa_numeric,  
          mhd.bingeeating_disorder_numeric, 
          mhd.atypical_bingeeating_disorder_numeric, 
          mhd.purging_disorder_numeric, 
          mhd.night_eating_syndrome_numeric,  
          mhd.pica_numeric, 
          mhd.avoidantrestrictive_food_intake_disorder_numeric,
          mhd.rumination_disorder_numeric, 
          mhd.feeding_eating_disorder_numeric, 
          mhd.other_eating_disorder_numeric)

nbr.6 <- nbr.dem2.raw.id %>%
  select(ID,
         cohort_name,
         dem2.living_with_partner_or_spouse,
         dem2.living_alone,
         dem2.living_with_partner_or_spouse,
         dem2.living_with_housemates,
         dem2.age_children_living,
         dem2.age_children_living.1,
         dem2.living_with_other_members_of_my_family,
         dem2.spouse_partner_members_living, 
         dem2.staying_live,
         dem2.staying_live.1,
         dem2.prefer_not_to_say,
         dem2.living_situation_change_pandemic,
         dem2.living_alone.1,
         dem2.living_with_partner_or_spouse.1,
         dem2.living_with_housemates.1,
         dem2.age_children_living.2,
         dem2.age_children_living.3,
         dem2.living_with_other_members_of_my_family.1,
         dem2.spouse_partner_members_living.1, 
         dem2.staying_live.2,
         dem2.staying_live.3,
         dem2.prefer_not_to_say.1,
         
         dem2.member_vulnerable_group,
         dem2.solid_organ_transplant_recipient,
         dem2.lung_cancer_radical_radiotherapy,
         dem2.bone_marrow_blood_leukaemia,
         dem2.immunotherapy_cancer_continuing_antibody,
         dem2.parp_inhibitors_affect_immune,
         dem2.stem_cell_transplants_bone,
         dem2.severe_copd_cystic_fibrosis,
         dem2.inborn_errors_rare_diseases,
         dem2.taking_medicine_that_weakens_your_immune_system,
         dem2.condition_infections_makes,
         dem2.congenital_pregnant_acquired_significant,
         dem2.pregnant,
         dem2.over_70_years_old,
         dem2.prefer_not_to_say.2,
         dem2.unsure)

nbr.7 <- nbr_pan_worry.id %>%
  select(ID,
         cohort_name,
         panworry.impact_on_your_employment_status,                                    
         panworry.employment_status_household_key,              
         panworry.impact_on_your_education_or_exams,            
         panworry.exams_impact_education_children,              
         panworry.financial_impact,                           
         panworry.contracting_the_virus,                       
         panworry.people_you_know_contracting_the_virus,       
         panworry.people_you_dont_know_contracting_the_virus,   
         panworry.impact_mental_health_wellbeing,               
         panworry.impact_mental_health_childrens,               
         panworry.impact_relatives_mental_health,           
         panworry.being_socially_isolated,                    
         panworry.people_you_know_being_socially_isolated,      
         panworry.shortage_of_essential_supplies,                
         panworry.shortage_of_medication_or_access_to_healthcare,
         panworry.healthcare_people_essential_supplies,          
         panworry.information_virus_government_accuracy,         
         panworry.the_governments_response_to_the_pandemic,      
         panworry.separation_from_family_members,         
         panworry.standing_impact_global_recession,
         
         panworry.other_,
        panworry.impact_on_your_employment_status_numeric,                                    
         panworry.employment_status_household_key_numeric,              
         panworry.impact_on_your_education_or_exams_numeric,            
         panworry.exams_impact_education_children_numeric,              
         panworry.financial_impact_numeric,                           
         panworry.contracting_the_virus_numeric,                       
         panworry.people_you_know_contracting_the_virus_numeric,       
         panworry.people_you_dont_know_contracting_the_virus_numeric,   
         panworry.impact_mental_health_wellbeing_numeric,               
         panworry.impact_mental_health_childrens_numeric,               
         panworry.impact_relatives_mental_health_numeric,           
         panworry.being_socially_isolated_numeric,                    
         panworry.people_you_know_being_socially_isolated_numeric,      
         panworry.shortage_of_essential_supplies_numeric,                
         panworry.shortage_of_medication_or_access_to_healthcare_numeric,
         panworry.healthcare_people_essential_supplies_numeric,          
         panworry.information_virus_government_accuracy_numeric,         
         panworry.the_governments_response_to_the_pandemic_numeric,      
         panworry.separation_from_family_members_numeric,         
         panworry.standing_impact_global_recession_numeric,
         panworry.other__numeric)

nbr.8 <- nbr.loneliness.baseline.raw.id %>%
  select(ID,
         cohort_name,
         lone.felt_that_you_lack_companionship,
        lone.felt_left_out,
        lone.felt_isolated_from_others,
        lone.felt_alone,lone.similar_felt_pandemic,
        lone.felt_that_you_lack_companionship.1,
        lone.felt_left_out.1,
        lone.felt_isolated_from_others.1,
        lone.felt_alone.1
  )

nbr.9 <- nbr.loss.baseline.raw.id %>%
  select(ID, 
         cohort_name,
         grief.covid_lost_due_close,
         grief.suffered_past_month_loss)

nbr.10 <- nbr.baseline.resp.id %>%
  select(ID, 
         cohort_name,
         resp.coronavirus_test_nosethroat_swab,
         resp.results_nosethroat_swab_test,
         resp.coronavirus_antibody_test,
         resp.coronavirus_antibody_test)
  
#Check nbr mhd data IDs
x <- nbr.5[nbr.5$ID %in% nbr.1$ID,]
length(unique(x$ID))
x <- nbr.5[nbr.5$ID %in% nbr.2$ID,]
length(unique(x$ID))
x <- nbr.5[nbr.5$ID %in% nbr.3$ID,]
length(unique(x$ID))
x <- nbr.5[nbr.5$ID %in% nbr.4$ID,]
length(unique(x$ID))
x <- nbr.9[nbr.9$ID %in% nbr.1$ID,]
length(unique(x$ID))    
nrow(nbr.5)
nrow(nbr.4)
nrow(nbr.3)
nrow(nbr.2)
nrow(nbr.1)
nrow(nbr.9)
}
```

NBR  data frame list
```{r NBR data frame list for final dataset}
if(NBR == TRUE) {
dfs.list <- list(
  nbr.1,
  nbr.2,
  nbr.3,
  nbr.4,
  nbr.5,
  nbr.6,
  nbr.7,
  nbr.8,
  nbr.9,
  nbr.10
)
}
```

Join all NBR 
```{r Join all NBR questionnaires for final dataset}
if(NBR == TRUE) {
dat.raw.nbr <- plyr::join_all(
  dfs.list,
  by = c("ID", "cohort_name") # Alternatively you can join by several columns EDGI -> "Age", "Sex", "Birthyear"
  )
# Look at the data
colnames(dat.raw.nbr)
}
```

Get rid of duplicates in NBR
```{r Check duplicates NBR final dataset}
if(NBR == TRUE) {
dat.raw.nbr$ID.dup <- duplicated(dat.raw.nbr$ID)
summary(as.factor(dat.raw.nbr$ID.dup))
select(dat.raw.nbr)
 # Check for duplicate names of columns
names_freq <- as.data.frame(table(names(dat.raw.nbr)))
names_freq[names_freq$Freq > 1, ]
# Filter out duplicate column names
 dat.dup <- dat.raw.nbr %>%
  filter(ID.dup == TRUE)
dat.raw.nbr <- dat.raw.nbr %>%
  filter(ID.dup == FALSE)
colnames(dat.raw.nbr)
}
```

RAMP variable list
```{r RAMP variable list}
if(RAMP == TRUE) {

  ramp.1 <- ramp.dem.raw.id %>%
    select(ID,
           cohort_name,
           gender_unc,
           ethnicity,
           age_unc,
           dem2.member_vulnerable_group,
           dem2.solid_organ_transplant_recipient,
           dem2.lung_cancer_radical_radiotherapy,
           dem2.bone_marrow_blood_leukaemia,
           dem2.immunotherapy_cancer_continuing_antibody,
           dem2.parp_inhibitors_affect_immune,
           dem2.stem_cell_transplants_bone,
           dem2.severe_copd_cystic_fibrosis, #= dem2.cystic_fibrosis_severe_asthma,
           dem2.inborn_errors_rare_diseases, # = dem2.inborn_errors_metabolism_infections,
           dem2.taking_medicine_that_weakens_your_immune_system,
           dem2.congenital_pregnant_acquired_significant, # = dem2.condition_infections_makes,
           dem2.pregnant,
           dem2.over_70_years_old,
           dem2.prefer_not_to_say.2, # = dem2.prefer_not_to_say.1,
           dem2.unsure,
           transgender,
           dem2.living_with_partner_or_spouse,
         dem2.living_alone,
         dem2.living_with_partner_or_spouse,
         dem2.living_with_housemates,
         dem2.age_children_living,
         dem2.age_children_living.1,
         dem2.living_with_other_members_of_my_family,
         dem2.spouse_partner_members_living,
         dem2.staying_live,
         dem2.staying_live.1,
         dem2.prefer_not_to_say,
         dem2.living_situation_change_pandemic,
         dem2.living_alone.1,
         dem2.living_with_partner_or_spouse.1,
         dem2.living_with_housemates.1,
         dem2.age_children_living.2,
         dem2.age_children_living.3,
         dem2.living_with_other_members_of_my_family.1,
         dem2.spouse_partner_members_living.1,
         dem2.staying_live.2,
         dem2.staying_live.3,
         dem2.prefer_not_to_say.1)

  ramp.2 <- ramp.dem.employ.raw.id %>%
    select(ID,
           cohort_name,
           highest_education,
           highest_education_numeric,
           employment_prior_covid,
           employment_prior_covid_numeric,
           employment_change,
           employment_change_numeric,
           key_worker,
           key_worker_numeric,
           employed,
           employ.government_work_key_workers_numeric,
           employ.government_work_key_workers,
           employ.fulltime_employed,
  employ.parttime_employed,
  employ.unemployed,
employ.zerohours_contract,
  employ.stayathome_parent_or_carer,
  employ.selfemployed,
  employ.contract_or_freelance_work,
  employ.small_business_owner,
  employ.receiving_state_income,
  employ.retired,
  employ.student_gcse_or_a_level,
  employ.student_university,
  employ.my_employment_status_has_not_changed,
  employ.became_unemployed,
  employ.reduction_in_hours,
  employ.reduction_in_salary,
  employ.benefits_increased,
  employ.benefits_decreased,
  employ.change_in_duties_or_responsibilities,
  employ.became_employed,
  employ.increased_hours,
  employ.increased_salary,
  employ.furloughed_or_paid_leave_government_funded,
  employ.furloughed_or_paid_leave_company_funded,
  employ.paid_leave_furloughed,
  #employ.taking_unpaid_leave,
  employ.other,
  employ.other_text.txt,
  employ.no_impact,
  employ.cancelled_exams,
  employ.change_in_format_of_exams,
  employ.automatic_pass,
  employ.change_in_deadlines,
  employ.change_in_lesson_delivery,
  employ.past_performance_grade_decided,
  employ.cancelled_classes,
  employ.cannot_complete_degree,
  employ.impact_on_studies_still_unknown,
  employ.other.1,
  employ.other_text.txt.1,
  employ.losing_job_due_risk,
  employ.increased_due_job_pandemic)

  ramp.3 <- edeq.ramp.baseline.raw.id %>%
    select(ID,
           cohort_name,
           edeq.deliberately_limit_amount_influence.1_.Wavebaseline,
           edeq.calories_made_body_shape.1_.Wavebaseline,
           edeq.weight_influenced_person.1_.Wavebaseline,
           edeq.dissatisfied_shape_weight.1_.Wavebaseline,
           edeq.eating_behaviours_concerns_distressed.1_.Wavebaseline,
           edeq.nibbled_picked_snacks_grazed.1_.Wavebaseline,
           edeq.felt_anxious_blue_bored.2_.Wavebaseline,
           edeq.felt_anxious_blue_bored.3_.Wavebaseline,
           edeq.actively_been_monitoring_your_shape_or_weight_.1_.Wavebaseline,
           edeq.regard_lost_control_eaten.1_.Wavebaseline,
           edeq.sick_means_made_shape.1_.Wavebaseline,
           edeq.diuretics_laxatives_means_shape.1_.Wavebaseline,
           edeq.compulsive_driven_burn_calories.1_.Wavebaseline,
           edeq.deliberately_limit_amount_influence.1_.Wavebaseline_numeric,
           edeq.calories_made_body_shape.1_.Wavebaseline_numeric,
           edeq.weight_influenced_person.1_.Wavebaseline_numeric,
           edeq.dissatisfied_shape_weight.1_.Wavebaseline_numeric,
           edeq.eating_behaviours_concerns_distressed.1_.Wavebaseline_numeric,
           edeq.nibbled_picked_snacks_grazed.1_.Wavebaseline_numeric,
           edeq.felt_anxious_blue_bored.2_.Wavebaseline_numeric,
           edeq.felt_anxious_blue_bored.3_.Wavebaseline_numeric,
           edeq.actively_been_monitoring_your_shape_or_weight_.1_.Wavebaseline_numeric,
           edeq.regard_lost_control_eaten.1_.Wavebaseline_numeric,
           edeq.sick_means_made_shape.1_.Wavebaseline_numeric,
           edeq.diuretics_laxatives_means_shape.1_.Wavebaseline_numeric,
           edeq.compulsive_driven_burn_calories.1_.Wavebaseline_numeric,
           edeq.deliberately_limit_amount_influence_.Wavebaseline,
          edeq.calories_made_body_shape_.Wavebaseline ,
          edeq.weight_influenced_person_.Wavebaseline,
          edeq.dissatisfied_shape_weight_.Wavebaseline ,
         edeq.nibbled_picked_snacks_grazed_.Wavebaseline ,
         edeq.felt_anxious_blue_bored_.Wavebaseline ,
         edeq.felt_anxious_blue_bored.1_.Wavebaseline ,
         edeq.eating_behaviours_concerns_distressed_.Wavebaseline,
         edeq.actively_been_monitoring_your_shape_or_weight_.Wavebaseline,
         edeq.regard_lost_control_eaten_.Wavebaseline,
         edeq.sick_means_made_shape_.Wavebaseline,
         edeq.diuretics_laxatives_means_shape_.Wavebaseline,
         edeq.compulsive_driven_burn_calories_.Wavebaseline,
         edeq.deliberately_limit_amount_influence_.Wavebaseline_numeric,
         edeq.calories_made_body_shape_.Wavebaseline_numeric,
         edeq.weight_influenced_person_.Wavebaseline_numeric,
         edeq.dissatisfied_shape_weight_.Wavebaseline_numeric ,
         edeq.nibbled_picked_snacks_grazed_.Wavebaseline_numeric ,
         edeq.felt_anxious_blue_bored_.Wavebaseline_numeric ,
         edeq.felt_anxious_blue_bored.1_.Wavebaseline_numeric ,
         edeq.eating_behaviours_concerns_distressed_.Wavebaseline_numeric ,
         edeq.actively_been_monitoring_your_shape_or_weight_.Wavebaseline_numeric,
         edeq.regard_lost_control_eaten_.Wavebaseline_numeric,
         edeq.sick_means_made_shape_.Wavebaseline_numeric,
         edeq.diuretics_laxatives_means_shape_.Wavebaseline_numeric ,
         edeq.compulsive_driven_burn_calories_.Wavebaseline_numeric 
  )
  
ramp.4 <- mhd.raw.id %>% 
  select(ID,
         cohort_name,
         control,
         control_numeric,
         depressive_disorders_numeric,
         anxiety_disorders_numeric,
         eating_disorders_diagnosed_numeric,
         obsessive_compulsive_disorders_numeric,
         psychotic_disorders_numeric,
         PERSONALITY_DISORDER_NUMERIC,
         agoraphobia_panic_disorder_numeric,
         depression_and_anxiety_numeric,
         bipolar_and_schizophrenia_numeric,
         mhd.mania_hypomania_bipolar_or_manicdepression_numeric,
         mhd.posttraumatic_stress_disorder_ptsd_numeric, 
         autism_spectrum_disorder_numeric,
         mhd.attention_deficit_hyperactivity_disorder_numeric,
         mhd.personality_disorder_numeric,
         mhd.body_dysmorphic_disorder_bdd_numeric,
         mhd.anorexia_nervosa_numeric,
         mhd.atypical_anorexia_nervosa_numeric,
         mhd.bulimia_nervosa_numeric,
         mhd.bingeeating_disorder_numeric)

ramp.5 <- taf.ramp.baseline.raw.id  %>% 
  select(ID,
         cohort_name,
         taf.worth_living_life_people_.Wavebaseline,
         taf.felt_weeks_past_.Wavebaseline,
         taf.have_you_contemplated_harming_yourself_.Wavebaseline,
         taf.felt_weeks_past.1_.Wavebaseline,
         taf.meant_life_end_weeks_.Wavebaseline)

ramp.6 <- taf.ramp.baseline.raw.id %>% #for retro prepan
  select(ID,
  cohort_name,
  taf.pandemic_felt_.Wavebaseline,
  taf.pandemic_felt.1_.Wavebaseline,
  taf.meant_end_life_pandemic_.Wavebaseline)

ramp.7 <- ramp_pan_worry.id %>%
  select(ID,
         cohort_name,
         panworry.impact_on_your_employment_status,                                    
         panworry.employment_status_household_key,              
         panworry.impact_on_your_education_or_exams,            
         panworry.exams_impact_education_children,              
         panworry.financial_impact,                           
         panworry.contracting_the_virus,                       
         panworry.people_you_know_contracting_the_virus,       
         panworry.people_you_dont_know_contracting_the_virus,   
         panworry.impact_mental_health_wellbeing,               
         panworry.impact_mental_health_childrens,               
         panworry.impact_relatives_mental_health,           
         panworry.being_socially_isolated,                    
         panworry.people_you_know_being_socially_isolated,      
         panworry.shortage_of_essential_supplies,                
         panworry.shortage_of_medication_or_access_to_healthcare,
         panworry.healthcare_people_essential_supplies,          
         panworry.information_virus_government_accuracy,         
         panworry.the_governments_response_to_the_pandemic,      
         panworry.separation_from_family_members,         
         panworry.standing_impact_global_recession,
         panworry.other_,
         panworry.impact_on_your_employment_status_numeric,                                    
         panworry.employment_status_household_key_numeric,              
         panworry.impact_on_your_education_or_exams_numeric,            
         panworry.exams_impact_education_children_numeric,              
         panworry.financial_impact_numeric,                           
         panworry.contracting_the_virus_numeric,                       
         panworry.people_you_know_contracting_the_virus_numeric,       
         panworry.people_you_dont_know_contracting_the_virus_numeric,   
         panworry.impact_mental_health_wellbeing_numeric,               
         panworry.impact_mental_health_childrens_numeric,               
         panworry.impact_relatives_mental_health_numeric,           
         panworry.being_socially_isolated_numeric,                    
         panworry.people_you_know_being_socially_isolated_numeric,      
         panworry.shortage_of_essential_supplies_numeric,                
         panworry.shortage_of_medication_or_access_to_healthcare_numeric,
         panworry.healthcare_people_essential_supplies_numeric,          
         panworry.information_virus_government_accuracy_numeric,         
         panworry.the_governments_response_to_the_pandemic_numeric,      
         panworry.separation_from_family_members_numeric,         
         panworry.standing_impact_global_recession_numeric,
         panworry.other__numeric)

ramp.8 <- ramp.loneliness.baseline.raw.id %>%
  select(ID,
         cohort_name,
         lone.felt_that_you_lack_companionship,
        lone.felt_left_out,
        lone.felt_isolated_from_others,
        lone.felt_alone,lone.similar_felt_pandemic,
        lone.felt_that_you_lack_companionship.1,
        lone.felt_left_out.1,
        lone.felt_isolated_from_others.1,
        lone.felt_alone.1
  )

ramp.9 <- ramp.loss.baseline.raw.id %>%
  select(ID, 
         cohort_name,
         grief.covid_lost_due_close,
         grief.suffered_past_month_loss)

ramp.10 <- ramp.baseline.resp.id %>%
  select(ID, 
         cohort_name,
         resp.coronavirus_test_nosethroat_swab,
         resp.results_nosethroat_swab_test,
         resp.coronavirus_antibody_test,
         resp.coronavirus_antibody_test)
  
# Check ramp.4 has same IDs as other datasets
x <- ramp.4[ramp.4$ID %in% ramp.1$ID,]
length(unique(x$ID))
x <- ramp.4[ramp.4$ID %in% ramp.2$ID,]
length(unique(x$ID))
x <- ramp.4[ramp.4$ID %in% ramp.3$ID,]
length(unique(x$ID))
x <- ramp.4[ramp.4$ID %in% ramp.5$ID,]
length(unique(x$ID))    
}
```

RAMP  data frame list
```{r RAMP data frame list}
if(RAMP == TRUE) {
dfs.list <- list(
  ramp.1,
  ramp.2,
  ramp.3,
  ramp.4,
  ramp.5,
  ramp.6,
  ramp.7,
  ramp.8,
  ramp.9,
  ramp.10
)
}
```

Join all RAMP 
```{r Join all RAMP questionnaires final dataset}
if(RAMP == TRUE) {
dat.raw.ramp <- plyr::join_all(
  dfs.list,
  by = c("ID", "cohort_name") # Alternatively you can join by several columns EDGI -> "Age", "Sex", "Birthyear"
  )
# Look at the data
colnames(dat.raw.ramp)
}
```

Get rid of duplicates in RAMP
```{r Check duplicates RAMP final dataset}
if(RAMP == TRUE) {
dat.raw.ramp$ID.dup <- duplicated(dat.raw.ramp$ID)
summary(as.factor(dat.raw.ramp$ID.dup))
 # Check for duplicate names of columns
names_freq <- as.data.frame(table(names(dat.raw.ramp)))
names_freq[names_freq$Freq > 1, ]
# Filter out duplicate column names
 dat.dup <- dat.raw.ramp %>%
  filter(ID.dup == TRUE)
dat.raw.ramp <- dat.raw.ramp %>%
  filter(ID.dup == FALSE)
}
```

# Export baseline data
```{r export data}
if(GLAD == TRUE) {
saveRDS(object = dat.raw.glad, file = paste0("/Users/helenadavies/werk/EDBEHSELFHARM2/gitEDBEHSELFHARM/data_cleaned/BASELINE_glad", date, ".rds"))
}
if(EDGI == TRUE) {
saveRDS(object = dat.raw.edgi, file = paste0("/Users/helenadavies/werk/EDBEHSELFHARM2/gitEDBEHSELFHARM/data_cleaned/BASELINE_edgi", date, ".rds"))
  
}
if(RAMP == TRUE) {
  saveRDS(object = dat.raw.ramp, file = paste0("/Users/helenadavies/werk/EDBEHSELFHARM2/gitEDBEHSELFHARM/data_cleaned/BASELINE_ramp", date, ".rds"))
}
if(NBR == TRUE) {
  saveRDS(object = dat.raw.nbr, file = paste0("/Users/helenadavies/werk/EDBEHSELFHARM2/gitEDBEHSELFHARM/data_cleaned/BASELINE_nbr", date, ".rds"))
}
```







