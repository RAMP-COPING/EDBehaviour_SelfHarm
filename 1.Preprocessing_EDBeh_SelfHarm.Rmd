---
title: "Preprocessing_EDBeh_SelfHarm"
author: "Helena Davies"
date: "21/04/2021"
output: html_document
---

# Set up 
```{r Setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      comment=NA,
                      prompt=FALSE,
                      cache=FALSE)
```

Delete everything in your global environment
```{r Delete everything in your global environment}
remove(list = ls())
```

Call in library script
```{r Source library files}
source("./libraries.R")
```

Retrieve the recent date
```{r Recent date}
date = Sys.Date()
date
```

Call in R functions scripts
```{r Call in function library functions}
source("./functions.R")
```

Specify cohort
```{r Specify cohort}
GLAD = TRUE
EDGI = FALSE
RAMP = FALSE
NBR = FALSE
COPING = FALSE
```

# Demographics 
## GLAD 1
### Read in data
```{r Read in data GLAD COPING demographic}
if(GLAD == TRUE){
glad.coping.dem.raw <- readRDS(file = "../data_raw/glad/dem_coping_glad.rds")
dim(glad.coping.dem.raw)
colnames(glad.coping.dem.raw)
}
```

Select variables
```{r Select variables GLAD COPING demographic}
if(GLAD == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate",
                  "endDate")

glad.coping.dem.raw.id <- glad.coping.dem.raw %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  distinct(externalDataReference, .keep_all = TRUE) %>% # Remove duplicates based on ID
  #separate(externalDataReference, into = c("Sample", "ID"), sep = 4) %>% # Split ID in Sample and Number
  #mutate(externalDataReference = as.numeric(externalDataReference)) %>%
  add_column(cohort_name = "coping_glad", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         startDate_baseline = startDate,
         endDate,
         #Age_uncleaned = demographics.how_old_are_you_now.txt, # Age
         gender_unc = dem.which_gender_do_you_identify_with, # Gender
         sex = dem.select_questionnaire_items_medical, #Sex
         pregnant_binary = dem.baby_pregnant_months,
         #EduYrs = demographics.school_education_school_years.txt, # Years in education
         #demographics.college_or_university_degree, # level of education - univeristy
         #demographics.a_levelsas_levels_or_equivalent, # level of education - alevel
         #demographics.o_levelsgcses_or_equivalent, # level of education - gcse
         #demographics.cses_or_equivalent, # level of education - cse
         #demographics.nvq_or_hnd_or_hnc_or_equivalent, # level of education - nvq
         #Ethnicity_unc = demographics.questions_based_ethnic_origin # Ethnicity
         height_ft_unc = dem.what_is_your_current_height,
         height_inch_unc = dem.what_is_your_current_height.1,
         height_cm_unc = dem.what_is_your_current_height.2,
         weight_st_unc = dem.current_weight_provide_pregnant,
         weight_lb_unc = dem.current_weight_provide_pregnant.1,
         weight_kg_unc = dem.current_weight_provide_pregnant.2,
         highest_weight_st_unc = dem.provide_pregnant_weighed_weight,
         highest_weight_lb_unc = dem.provide_pregnant_weighed_weight.1,
         highest_weight_kg_unc = dem.provide_pregnant_weighed_weight.2,
         lowest_weight_st_unc = dem.adult_height_reaching_weighed,
         lowest_weight_lb_unc = dem.adult_height_reaching_weighed.1,
         lowest_weight_kg_unc = dem.adult_height_reaching_weighed.2,
         age_highest_weight_unc = dem.highest_weight.txt,
         age_lowest_weight_unc = dem.adult_height_lowest_weight.txt,
         uk_location = dem.live,
         current_country = dem.in_which_country_do_you_currently_reside
         
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  mutate_if(is.numeric, ~na_if(., -99)) %>%
  mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) %>% # Drop empty factor levels
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(glad.coping.dem.raw.id)
# Inspect colnames
colnames(glad.coping.dem.raw.id)
#Differences
dim(glad.coping.dem.raw)[1]-dim(glad.coping.dem.raw.id)[1]
}
```

Summarise GLAD COPING demographic
```{r GLAD COPING demographic summary, eval=FALSE, include=FALSE}
if(GLAD == TRUE) {
summarytools::dfSummary(
  glad.coping.dem.raw.id,
  graph.col = F,
  valid.col = F,
  labels.col = F)
}
```

# Demographics 
## GLAD 2
### Read in data
```{r Read in data GLAD COPING demographic 2}
if(GLAD == TRUE){
glad.coping.dem2.raw <- readRDS(file = "../data_raw/glad/dem2_coping_glad.rds")
dim(glad.coping.dem2.raw)
colnames(glad.coping.dem2.raw)
}
```

Select variables GLAD COPING demographic 2
```{r Select variables GLAD COPING demographic 2}
if(GLAD == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate",
                  "endDate")

glad.coping.dem2.raw.id <- glad.coping.dem2.raw %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  distinct(externalDataReference, .keep_all = TRUE) %>% # Remove duplicates based on ID
  #separate(externalDataReference, into = c("Sample", "ID"), sep = 4) %>% # Split ID in Sample and Number
  #mutate(externalDataReference = as.numeric(externalDataReference)) %>%
  add_column(cohort_name = "coping_glad", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference,# ID
         cohort_name, # Sample
         #startDate_baseline = startDate,
         #endDate,
         dem2.living_with_partner_or_spouse,
         dem2.living_alone,
         dem2.living_with_partner_or_spouse,
         dem2.living_with_housemates,
         dem2.age_children_living,
         dem2.age_children_living.1,
         dem2.living_with_other_members_of_my_family,
         dem2.spouse_partner_members_living,
         dem2.staying_live,
         dem2.staying_live.1,
         dem2.prefer_not_to_say,
         dem2.living_situation_change_pandemic,
         dem2.living_alone.1,
         dem2.living_with_partner_or_spouse.1,
         dem2.living_with_housemates.1,
         dem2.age_children_living.2,
         dem2.age_children_living.3,
         dem2.living_with_other_members_of_my_family.1,
         dem2.spouse_partner_members_living.1,
         dem2.staying_live.2,
         dem2.staying_live.3,
         dem2.prefer_not_to_say.1,
         dem2.household_living_place_answer,
         dem2.include_living_areas_count,
        # dem2.relationships_describe_question_place,
         dem2.cats,
         dem2.dogs,
         dem2.fish,
         dem2.bird,
         dem2.reptile,
         dem2.small_rodent,
         dem2.none,
         dem2.other_please_specify_species,
         dem2.other_please_specify_species_text.txt,
         dem2.do_you_have_any_children,
         dem2.02_years,
         dem2.35_years,
         dem2.610_years,
         dem2.1115_years,
         dem2.1618_years,
         dem2.adult_children_home_living,
         dem2.adult_children_pandemic_returned,
         dem2.under_50_years,
         dem2.5060_years,
         dem2.6170_years,
         dem2.7180_years,
         dem2.81_years,
         dem2.member_vulnerable_group,
         dem2.solid_organ_transplant_recipient,
         dem2.lung_cancer_radical_radiotherapy,
         dem2.bone_marrow_blood_leukaemia,
         dem2.immunotherapy_cancer_continuing_antibody,
         dem2.parp_inhibitors_affect_immune,
         dem2.stem_cell_transplants_bone,
         dem2.severe_copd_cystic_fibrosis,
         dem2.inborn_errors_rare_diseases,
         dem2.taking_medicine_that_weakens_your_immune_system,
         dem2.condition_infections_makes,
         dem2.congenital_pregnant_acquired_significant,
         dem2.pregnant,
         dem2.over_70_years_old,
         dem2.prefer_not_to_say.2,
         dem2.unsure,
         dem2.adult_children_home_living.1,
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  mutate_if(is.numeric, ~na_if(., -99)) %>%
  mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) %>% # Drop empty factor levels
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(glad.coping.dem2.raw.id)
# Inspect colnames
colnames(glad.coping.dem2.raw.id)
#Differences
dim(glad.coping.dem2.raw)[1]-dim(glad.coping.dem2.raw.id)[1]
}
```

Summarise GLAD COPING demographic 2
```{r GLAD COPING demographic 2 summary, eval=FALSE, include=FALSE}
if(GLAD == TRUE) {
summarytools::dfSummary(
  glad.coping.dem2.raw.id,
  graph.col = F,
  valid.col = F,
  labels.col = F)
}
```

# Demographics 
## GLAD 3  [sign up]
### Read in data
```{r Read in data GLAD demographics}
if(GLAD == TRUE){
glad.dem3.raw <- readRDS(file = "../data_raw/glad/dem_glad.rds")
dim(glad.dem3.raw)
colnames(glad.dem3.raw)
}
```

Select variables
```{r Select variables GLAD demographics}
if(GLAD == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate",
                  "endDate")

glad.dem3.raw.id <- glad.dem3.raw %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  distinct(externalDataReference, .keep_all = TRUE) %>% # Remove duplicates based on ID
  #separate(externalDataReference, into = c("Sample", "ID"), sep = 4) %>% # Split ID in Sample and Number
  #mutate(externalDataReference = as.numeric(externalDataReference)) %>%
  add_column(cohort_name = "coping_glad", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         startDate_prepandemic = startDate,
         age_unc = dem.how_old_are_you_now.txt,
         dem.day,
         dem.month,
         dem.year,
         ethnicity_unc = dem.questions_based_ethnic_origin,
         ethnicity_unc_text = dem.questions_based_ethnic_origin.txt,
         dem.college_or_university_degree,
         dem.a_levelsas_levels_or_equivalent,
         dem.o_levelsgcses_or_equivalent,
         dem.cses_or_equivalent,
         dem.nvq_or_hnd_or_hnc_or_equivalent,
         dem.other_professional_qualifications,
         dem.other_professional_qualifications_text.txt,
         dem.none_of_the_above_education = dem.none_of_the_above,
         transgender = dem.do_you_identify_as_transgender
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  mutate_if(is.numeric, ~na_if(., -99)) %>%
  mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) %>% # Drop empty factor levels
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(glad.dem3.raw.id)
# Inspect colnames
colnames(glad.dem3.raw.id)
#Differences
dim(glad.dem3.raw)[1]-dim(glad.dem3.raw.id)[1]
}
```

# Demographics 
## EDGI 
### Read in data
```{r Read in data EDGI COPING demographics}
if(EDGI == TRUE){
edgi.coping.dem.raw <- readRDS(file = "../data_raw/edgi/dem_coping_edgi.rds")
dim(edgi.coping.dem.raw)
colnames(edgi.coping.dem.raw)
}
```

Select variables EDGI COPING demographics
```{r Select variables EDGI COPING demographics}
if(EDGI == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate",
                  "endDate")

edgi.coping.dem.raw.id <- edgi.coping.dem.raw %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  distinct(externalDataReference, .keep_all = TRUE) %>% # Remove duplicates based on ID
  #separate(externalDataReference, into = c("Sample", "ID"), sep = 4) %>% # Split ID in Sample and Number
  #mutate(externalDataReference = as.numeric(externalDataReference)) %>%
  add_column(cohort_name = "coping_edgi", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         startDate_baseline = startDate,
         endDate,
         #startDate.prepandemic = startDate, #Date when participant signed up to glad
         #Age_uncleaned = demographics.how_old_are_you_now.txt, # Age
         gender_unc = dem.which_gender_do_you_identify_with, # Gender
         sex = dem.select_questionnaire_items_medical, #Sex
         pregnant_binary = dem.baby_pregnant_months,
         #EduYrs = demographics.school_education_school_years.txt, # Years in education
         #demographics.college_or_university_degree, # level of education - univeristy
         #demographics.a_levelsas_levels_or_equivalent, # level of education - alevel
         #demographics.o_levelsgcses_or_equivalent, # level of education - gcse
         #demographics.cses_or_equivalent, # level of education - cse
         #demographics.nvq_or_hnd_or_hnc_or_equivalent, # level of education - nvq
         #Ethnicity_unc = demographics.questions_based_ethnic_origin # Ethnicity
         height_ft_unc = dem.what_is_your_current_height,
         height_inch_unc = dem.what_is_your_current_height.1,
         height_cm_unc = dem.what_is_your_current_height.2,
         weight_st_unc = dem.current_weight_provide_weight,
         weight_lb_unc = dem.current_weight_provide_weight.1,
         weight_kg_unc = dem.current_weight_provide_weight.2,
         highest_weight_st_unc = dem.provide_weighed_pregnant_weight,
         highest_weight_lb_unc = dem.provide_weighed_pregnant_weight.1,
         highest_weight_kg_unc = dem.provide_weighed_pregnant_weight.2,
         lowest_weight_st_unc = dem.adult_height_reaching_weighed,
         lowest_weight_lb_unc = dem.adult_height_reaching_weighed.1,
         lowest_weight_kg_unc = dem.adult_height_reaching_weighed.2,
         age_highest_weight_unc = dem.highest_weight.txt,
         age_lowest_weight_unc = dem.lowest_weight_adult_height.txt,
         uk_location = dem.live,
         current_country = dem.in_which_country_do_you_currently_reside
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  mutate_if(is.numeric, ~na_if(., -99)) %>%
  mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) %>% # Drop empty factor levels
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(edgi.coping.dem.raw.id)
# Inspect colnames
colnames(edgi.coping.dem.raw.id)
#Differences
dim(edgi.coping.dem.raw)[1]-dim(edgi.coping.dem.raw.id)[1]
}
```

Summarise EDGI COPING demographics
```{r Summarise EDGI COPING demographics}
if(EDGI == TRUE) {
summarytools::dfSummary(
  edgi.coping.dem.raw.id,
  graph.col = F,
  valid.col = F,
  labels.col = F)
}
```

# Demographics 
## EDGI 2
### Read in data
```{r Read in data EDGI COPING demographics 2}
if(EDGI == TRUE){
edgi.coping.dem2.raw <- readRDS(file = "../data_raw/edgi/dem2_coping_edgi.rds")
dim(edgi.coping.dem2.raw)
colnames(edgi.coping.dem2.raw)
}
```

Select variables EDGI COPING demographics 2
```{r Select variables EDGI COPING demographics 2}
if(EDGI == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate",
                  "endDate")

edgi.coping.dem2.raw.id <- edgi.coping.dem2.raw %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  distinct(externalDataReference, .keep_all = TRUE) %>% # Remove duplicates based on ID
  #separate(externalDataReference, into = c("Sample", "ID"), sep = 4) %>% # Split ID in Sample and Number
  #mutate(externalDataReference = as.numeric(externalDataReference)) %>%
  add_column(cohort_name = "coping_edgi", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference,# ID
         cohort_name, # Sample
         #startDate_baseline = startDate,
         #endDate,
         dem2.living_with_partner_or_spouse,
         dem2.living_alone,
         dem2.living_with_partner_or_spouse,
         dem2.living_with_housemates,
         dem2.age_children_living,
         dem2.age_children_living.1,
         dem2.living_with_other_members_of_my_family,
         dem2.spouse_partner_members_living,
         dem2.staying_live,
         dem2.staying_live.1,
         dem2.prefer_not_to_say,
         dem2.living_situation_change_pandemic,
         dem2.living_alone.1,
         dem2.living_with_partner_or_spouse.1,
         dem2.living_with_housemates.1,
         dem2.age_children_living.2,
         dem2.age_children_living.3,
         dem2.living_with_other_members_of_my_family.1,
         dem2.spouse_partner_members_living.1,
         dem2.staying_live.2,
         dem2.staying_live.3,
         dem2.prefer_not_to_say.1,
         dem2.household_living_place_answer,
         dem2.include_living_areas_count,
         #dem2.relationships_describe_question_place,
         dem2.cats,
         dem2.dogs,
         dem2.fish,
         dem2.bird,
         dem2.reptile,
         dem2.small_rodent,
         dem2.none,
         dem2.other_please_specify_species,
         dem2.other_please_specify_species_text.txt,
         dem2.do_you_have_any_children,
         dem2.02_years,
         dem2.35_years,
         dem2.610_years,
         dem2.1115_years,
         dem2.1618_years,
         dem2.adult_children_home_living,
         dem2.adult_children_pandemic_returned,
         dem2.under_50_years,
         dem2.5060_years,
         dem2.6170_years,
         dem2.7180_years,
         dem2.81_years,
         dem2.member_vulnerable_group,
         dem2.solid_organ_transplant_recipient,
         dem2.lung_cancer_radical_radiotherapy,
         dem2.bone_marrow_blood_leukaemia,
         dem2.immunotherapy_cancer_continuing_antibody,
         dem2.parp_inhibitors_affect_immune,
         dem2.stem_cell_transplants_bone,
         dem2.severe_copd_cystic_fibrosis,
         dem2.inborn_errors_rare_diseases,
         dem2.taking_medicine_that_weakens_your_immune_system,
         dem2.condition_infections_makes,
         dem2.congenital_pregnant_acquired_significant = dem2.significant_heart_disease_congenital, #To match name in GLAD
         dem2.pregnant,
         dem2.over_70_years_old,
         dem2.prefer_not_to_say.2,
         dem2.unsure,
         dem2.adult_children_home_living.1,
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  mutate_if(is.numeric, ~na_if(., -99)) %>%
  mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) %>% # Drop empty factor levels
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(edgi.coping.dem2.raw.id)
# Inspect colnames
colnames(edgi.coping.dem2.raw.id)
#Differences
dim(edgi.coping.dem2.raw)[1]-dim(edgi.coping.dem2.raw.id)[1]
}
```

Summarise EDGI COPING demographics 2
```{r Summarise EDGI COPING demographics 2, eval=FALSE, include=FALSE}
if(EDGI == TRUE) {
summarytools::dfSummary(
  edgi.coping.dem2.raw.id,
  graph.col = F,
  valid.col = F,
  labels.col = F)
}
```

# Demographics 
## EDGI 3  [sign up]
### Read in data
```{r Read in data EDGI demographics 3}
if(EDGI == TRUE){
edgi.dem3.raw <- readRDS(file = "../data_raw/edgi/demographics_edgi.rds")
dim(edgi.dem3.raw)
colnames(edgi.dem3.raw)
}
```

Select variables EDGI demographics 3
```{r Select variables EDGI demographics 3}
if(EDGI == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate",
                  "endDate")

edgi.dem3.raw.id <- edgi.dem3.raw %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  distinct(externalDataReference, .keep_all = TRUE) %>% # Remove duplicates based on ID
  #separate(externalDataReference, into = c("Sample", "ID"), sep = 4) %>% # Split ID in Sample and Number
  #mutate(externalDataReference = as.numeric(externalDataReference)) %>%
  add_column(cohort_name = "coping_edgi", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         startDate_prepandemic = startDate,
         age_unc = dem.how_old_are_you_now.txt,
         dem.month,
         dem.day,
         dem.year,
         ethnicity_unc = demographics.what_is_your_ethnic_origin,
         ethnicity_unc_text = demographics.what_is_your_ethnic_origin.txt,
         transgender = demographics.do_you_consider_yourself_to_be_transgender,
         demographics.collegeuniversity,
         demographics.asa_levels,
         demographics.cse,
         demographics.gcse,
         demographics.nvq,
         demographics.other.1,
         demographics.none_of_the_above,
         demographics.other_text.txt.1
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  mutate_if(is.numeric, ~na_if(., -99)) %>%
  mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) %>% # Drop empty factor levels
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(edgi.dem3.raw.id)
# Inspect colnames
colnames(edgi.dem3.raw.id)
#Differences
dim(edgi.dem3.raw)[1]-dim(edgi.dem3.raw.id)[1]
}
```

# Demographics 
## GLAD 4 employment 
### Read in data
```{r Read in data GLAD employment}
if(GLAD == TRUE){
glad.coping.dem4.employ.raw <- readRDS(file = "../data_raw/glad/employ_coping_glad.rds")
dim(glad.coping.dem4.employ.raw)
colnames(glad.coping.dem4.employ.raw)
}
```

Select variables
```{r Select variables GLAD employment}
if(GLAD == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate",
                  "endDate")

glad.coping.dem4.employ.raw.id <- glad.coping.dem4.employ.raw %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  distinct(externalDataReference, .keep_all = TRUE) %>% # Remove duplicates based on ID
  #separate(externalDataReference, into = c("Sample", "ID"), sep = 4) %>% # Split ID in Sample and Number
  #mutate(externalDataReference = as.numeric(externalDataReference)) %>%
  add_column(cohort_name = "coping_glad", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         #startDate_baseline = startDate,
         employ.phd,
         employ.masters_degree_or_equivalent,
         employ.postgraduate_degree_or_equivalent,
         employ.bachelors_degree_or_equivalent,
         employ.a_levelsas_levels_or_equivalent,
         employ.o_levelsgcses_or_equivalent,
         employ.cses_or_equivalent,
         employ.nvq_or_hnd_or_hnc_or_equivalent,
         employ.other_professional_qualifications_e.g._nursing_teaching,
         employ.other_professional_qualifications_e.g._nursing_teaching_text.txt,
         employ.none_of_the_above,
         employ.fulltime_employed,
         employ.parttime_employed,
         employ.unemployed,
         employ.zerohours_contract,
         employ.stayathome_parent_or_carer,
         employ.selfemployed,
         employ.contract_or_freelance_work,
         employ.small_business_owner,
         employ.receiving_state_income,
         employ.retired,
         employ.student_gcse_or_a_level,
         employ.student_university,
         employ.my_employment_status_has_not_changed,
         employ.became_unemployed,
         employ.reduction_in_hours,
         employ.reduction_in_salary,
         employ.benefits_increased,
         employ.benefits_decreased,
         employ.change_in_duties_or_responsibilities,
         employ.became_employed,
         employ.increased_hours,
         employ.increased_salary,
         employ.furloughed_or_paid_leave_government_funded,
         employ.furloughed_or_paid_leave_company_funded,
         employ.paid_leave_furloughed,
         employ.taking_unpaid_leave,
         employ.other,
         employ.other_text.txt,
         employ.no_impact,
         employ.cancelled_exams,
         employ.change_in_format_of_exams,
         employ.automatic_pass,
         employ.change_in_deadlines,
         employ.change_in_lesson_delivery,
         employ.past_performance_grade_decided,
         employ.cancelled_classes,
         employ.impact_on_studies_still_unknown,
         employ.other.1,
         employ.other_text.txt.1,
         employ.complete_home_work,
         employ.are_you_currently_working_from_home,
         employ.attend_work_encouraged_work,
         employ.government_work_key_workers.txt,
         employ.government_work_key_workers,
         employ.type_role = employ.role_type, #renamed to be same as edgi
         employ.type_role.txt = employ.role_type.txt, #renamed to be same as edgi
         employ.type_role.1 = employ.role_type.1, #renamed to be same as edgi
         employ.does_your_job_include_caring_for_others,
         employ.is_your_job_public_facing_,
         employ.losing_job_due_risk = employ.job_due_losing_risk, #renamed to be same as edgi
         employ.increased_due_job_pandemic = employ.increased_job_due_pandemic #renamed to be same as edgi
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  mutate_if(is.numeric, ~na_if(., -99)) %>%
  mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) %>% # Drop empty factor levels
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(glad.coping.dem4.employ.raw.id)
# Inspect colnames
colnames(glad.coping.dem4.employ.raw.id)
#Differences
dim(glad.coping.dem4.employ.raw)[1]-dim(glad.coping.dem4.employ.raw.id)[1]
}
```

# Demographics 
## EDGI 4 employment
### Read in data
```{r Read in data EDGI employment}
if(EDGI == TRUE){
edgi.coping.dem4.employ.raw <- readRDS(file = "../data_raw/edgi/employ_coping_edgi.rds")
dim(edgi.coping.dem4.employ.raw)
colnames(edgi.coping.dem4.employ.raw)
}
```

Select variables
```{r Select variables EDGI employment}
if(EDGI == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate",
                  "endDate")

edgi.coping.dem4.employ.raw.id <- edgi.coping.dem4.employ.raw %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  distinct(externalDataReference, .keep_all = TRUE) %>% # Remove duplicates based on ID
  #separate(externalDataReference, into = c("Sample", "ID"), sep = 4) %>% # Split ID in Sample and Number
  #mutate(externalDataReference = as.numeric(externalDataReference)) %>%
  add_column(cohort_name = "coping_edgi", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         #startDate_baseline = startDate,
         employ.phd,
         employ.masters_degree_or_equivalent,
         employ.postgraduate_degree_or_equivalent,
         employ.bachelors_degree_or_equivalent,
         employ.a_levelsas_levels_or_equivalent,
         employ.o_levelsgcses_or_equivalent,
         employ.cses_or_equivalent,
         employ.nvq_or_hnd_or_hnc_or_equivalent,
         employ.other_professional_qualifications_e.g._nursing_teaching,
         employ.other_professional_qualifications_e.g._nursing_teaching_text.txt,
         employ.none_of_the_above,
         employ.fulltime_employed,
         employ.parttime_employed,
         employ.unemployed,
         employ.zerohours_contract,
         employ.stayathome_parent_or_carer,
         employ.selfemployed,
         employ.contract_or_freelance_work,
         employ.small_business_owner,
         employ.receiving_state_income,
         employ.retired,
         employ.student_gcse_or_a_level,
         employ.student_university,
         employ.my_employment_status_has_not_changed,
         employ.became_unemployed,
         employ.reduction_in_hours,
         employ.reduction_in_salary,
         employ.benefits_increased,
         employ.benefits_decreased,
         employ.change_in_duties_or_responsibilities,
         employ.became_employed,
         employ.increased_hours,
         employ.increased_salary,
         employ.furloughed_or_paid_leave_government_funded,
         employ.furloughed_or_paid_leave_company_funded,
         employ.paid_leave_furloughed,
         employ.taking_unpaid_leave,
         employ.other,
         employ.other_text.txt,
         employ.no_impact,
         employ.cancelled_exams,
         employ.change_in_format_of_exams,
         employ.automatic_pass,
         employ.change_in_deadlines,
         employ.change_in_lesson_delivery,
         employ.past_performance_grade_decided,
         employ.cancelled_classes,
         employ.impact_on_studies_still_unknown,
         employ.other.1,
         employ.other_text.txt.1,
         employ.complete_home_work,
         employ.are_you_currently_working_from_home,
         employ.attend_work_encouraged_work,
         employ.government_work_key_workers.txt,
         employ.government_work_key_workers,
         employ.type_role,
         employ.type_role.txt,
         employ.type_role.1,
         employ.does_your_job_include_caring_for_others,
         employ.is_your_job_public_facing_,
         employ.losing_job_due_risk,
         employ.increased_due_job_pandemic
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  mutate_if(is.numeric, ~na_if(., -99)) %>%
  mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) %>% # Drop empty factor levels
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(edgi.coping.dem4.employ.raw.id)
# Inspect colnames
colnames(edgi.coping.dem4.employ.raw.id)
#Differences
dim(edgi.coping.dem4.employ.raw)[1]-dim(edgi.coping.dem4.employ.raw.id)[1]

}
```

# Demographics 
## NBR 1
### Read in data
```{r Read in data NBR demographics}
if(NBR == TRUE){
nbr.dem.raw <- readRDS(file = "../data_raw/nbr/demographics_coping_nbr.rds")
dim(nbr.dem.raw)
colnames(nbr.dem.raw)
}
```

Select variables
```{r Select variables NBR demographics}
if(NBR == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate",
                  "endDate")

nbr.dem.raw.id <- nbr.dem.raw %>% #new dataset with ID
  drop_na(subjectid) %>% # Drop NAs
  distinct(subjectid, .keep_all = TRUE) %>% # Remove duplicates based on ID
  #separate(externalDataReference, into = c("Sample", "ID"), sep = 4) %>% # Split ID in Sample and Number
  #mutate(externalDataReference = as.numeric(externalDataReference)) %>%
  add_column(cohort_name = "nbr", .before = "startDate") %>% #create new column 
  select(
         ID = subjectid, # ID
         cohort_name, # Sample
         startDate_baseline = startDate,
         endDate,
         #startDate.prepandemic = startDate, #Date when participant signed up to glad
         #Age_uncleaned = demographics.how_old_are_you_now.txt, # Age
         gender_unc = demographics.which_gender_do_you_identify_with, # Gender
         sex = demographics.select_questionnaire_items_medical, #Sex
         pregnant_binary = demographics.baby_pregnant_months,
         birthday_day = demographics.day,
         birthday_month = demographics.month,
         birthday_year = demographics.year,
         #EduYrs = demographics.school_education_school_years.txt, # Years in education
         #demographics.college_or_university_degree, # level of education - univeristy
         #demographics.a_levelsas_levels_or_equivalent, # level of education - alevel
         #demographics.o_levelsgcses_or_equivalent, # level of education - gcse
         #demographics.cses_or_equivalent, # level of education - cse
         #demographics.nvq_or_hnd_or_hnc_or_equivalent, # level of education - nvq
         #Ethnicity_unc = demographics.questions_based_ethnic_origin # Ethnicity
         height_ft_unc = demographics.what_is_your_current_height,
         height_inch_unc = demographics.what_is_your_current_height.1,
         height_cm_unc = demographics.what_is_your_current_height.2,
         weight_st_unc = demographics.provide_current_weight_pregnant,
         weight_lb_unc = demographics.provide_current_weight_pregnant.1,
         weight_kg_unc = demographics.provide_current_weight_pregnant.2,
         highest_weight_st_unc = demographics.provide_pregnant_weighed_weight,
         highest_weight_lb_unc = demographics.provide_pregnant_weighed_weight.1,
         highest_weight_kg_unc = demographics.provide_current_weight_pregnant.2,
         lowest_weight_st_unc = demographics.adult_height_reaching_weighed,
         lowest_weight_lb_unc = demographics.adult_height_reaching_weighed.1,
         lowest_weight_kg_unc = demographics.adult_height_reaching_weighed.2,
         age_highest_weight_unc = demographics.highest_weight.txt,
         age_lowest_weight_unc = demographics.adult_height_lowest_weight.txt,
         uk_location = demographics.live,
         current_country = demographics.in_which_country_do_you_currently_reside,
         
         
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  mutate_if(is.numeric, ~na_if(., -99)) %>%
  mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) %>% # Drop empty factor levels
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(nbr.dem.raw.id)
# Inspect colnames
colnames(nbr.dem.raw.id)
#Differences
dim(nbr.dem.raw)[1]-dim(nbr.dem.raw.id)[1]
}
```

# Demographics 
## NBR 2
### Read in data
```{r Read in data NBR demographics 2}
if(NBR == TRUE){
nbr.dem2.raw <- readRDS(file = "../data_raw/nbr/dem_coping_nbr.rds")
dim(nbr.dem2.raw)
colnames(nbr.dem2.raw)
}
```

Select variables
```{r Select variables NBR demographics 2}
if(NBR == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate",
                  "endDate")

nbr.dem2.raw.id <- nbr.dem2.raw %>% #new dataset with ID
  drop_na(subjectid) %>% # Drop NAs
  distinct(subjectid, .keep_all = TRUE) %>% # Remove duplicates based on ID
  #separate(externalDataReference, into = c("Sample", "ID"), sep = 4) %>% # Split ID in Sample and Number
  #mutate(externalDataReference = as.numeric(externalDataReference)) %>%
  add_column(cohort_name = "nbr", .before = "startDate") %>% #create new column 
  select(
         ID = subjectid,# ID
         cohort_name, # Sample
         #startDate_baseline = startDate,
         #endDate,
         dem2.living_with_partner_or_spouse,
         dem2.living_alone,
         dem2.living_with_partner_or_spouse,
         dem2.living_with_housemates,
         dem2.age_children_living,
         dem2.age_children_living.1,
         dem2.living_with_other_members_of_my_family,
         dem2.spouse_partner_members_living = dem2.spouse_members_partner_living, #Renamed to be same as edgi/glad
         dem2.staying_live,
         dem2.staying_live.1,
         dem2.prefer_not_to_say,
         dem2.living_situation_change_pandemic,
         dem2.living_alone.1,
         dem2.living_with_partner_or_spouse.1,
         dem2.living_with_housemates.1,
         dem2.age_children_living.2,
         dem2.age_children_living.3,
         dem2.living_with_other_members_of_my_family.1,
         dem2.spouse_partner_members_living.1 = dem2.spouse_members_partner_living.1, #Renamed to be same as edgi/glad
         dem2.staying_live.2,
         dem2.staying_live.3,
         dem2.prefer_not_to_say.1,
         dem2.household_living_place_answer,
         dem2.include_living_areas_count,
         dem2.relationships_describe_question_place = dem2.relationships_describe_place_question, #Renamed to be same as edgi/glad
         dem2.cats,
         dem2.dogs,
         dem2.fish,
         dem2.bird,
         dem2.reptile,
         dem2.small_rodent,
         dem2.none,
         dem2.other_please_specify_species,
         dem2.other_please_specify_species_text.txt,
         dem2.do_you_have_any_children,
         dem2.02_years,
         dem2.35_years,
         dem2.610_years,
         dem2.1115_years,
         dem2.1618_years,
         dem2.adult_children_home_living,
         dem2.adult_children_pandemic_returned,
         dem2.under_50_years,
         dem2.5060_years,
         dem2.6170_years,
         dem2.7180_years,
         dem2.81_years,
         dem2.member_vulnerable_group,
         dem2.solid_organ_transplant_recipient,
         dem2.lung_cancer_radical_radiotherapy,
         dem2.bone_marrow_blood_leukaemia,
         dem2.immunotherapy_cancer_continuing_antibody,
         dem2.parp_inhibitors_affect_immune,
         dem2.stem_cell_transplants_bone,
         dem2.severe_copd_cystic_fibrosis,
         dem2.inborn_errors_rare_diseases,
         dem2.taking_medicine_that_weakens_your_immune_system,
         dem2.condition_infections_makes,
         dem2.congenital_pregnant_acquired_significant = dem2.significant_heart_disease_congenital, #To match name in GLAD
         dem2.pregnant,
         dem2.over_70_years_old,
         dem2.prefer_not_to_say.2,
         dem2.unsure,
         dem2.adult_children_home_living.1
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  mutate_if(is.numeric, ~na_if(., -99)) %>%
  mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) %>% # Drop empty factor levels
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(nbr.dem2.raw.id)
# Inspect colnames
colnames(nbr.dem2.raw.id)
#Differences
dim(nbr.dem2.raw)[1]-dim(nbr.dem2.raw.id)[1]
}
```

Summarise NBR demographics 2
```{r NBR demographics 2 summary, eval=FALSE, include=FALSE}
if(NBR == TRUE) {
summarytools::dfSummary(
  nbr.dem2.raw.id,
  graph.col = F,
  valid.col = F,
  labels.col = F)
}
```

# Demographics 
## NBR employment 
### Read in data
```{r Read in data NBR employment}
if(NBR == TRUE){
nbr.dem.employ.raw <- readRDS(file = "../data_raw/nbr/employ_coping_nbr.rds")
dim(nbr.dem.employ.raw)
colnames(nbr.dem.employ.raw)
}
```

Select variables NBR employment
```{r Select variables NBR employment}
if(NBR == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate",
                  "endDate")

nbr.dem.employ.raw.id <- nbr.dem.employ.raw%>% #new dataset with ID
  drop_na(subjectid) %>% # Drop NAs
  distinct(subjectid, .keep_all = TRUE) %>% # Remove duplicates based on ID
  #separate(externalDataReference, into = c("Sample", "ID"), sep = 4) %>% # Split ID in Sample and Number
  #mutate(externalDataReference = as.numeric(externalDataReference)) %>%
  add_column(cohort_name = "nbr", .before = "startDate") %>% #create new column 
  select(
         ID = subjectid, # ID
         cohort_name, # Sample
         #startDate_baseline = startDate,
         employ.phd,
         employ.masters_degree_or_equivalent,
         employ.postgraduate_degree_or_equivalent,
         employ.bachelors_degree_or_equivalent,
         employ.a_levelsas_levels_or_equivalent,
         employ.o_levelsgcses_or_equivalent,
         employ.cses_or_equivalent,
         employ.nvq_or_hnd_or_hnc_or_equivalent,
         employ.other_professional_qualifications_e.g._nursing_teaching,
         employ.other_professional_qualifications_e.g._nursing_teaching_text.txt,
         employ.none_of_the_above,
         employ.fulltime_employed,
         employ.parttime_employed,
         employ.unemployed,
         employ.zerohours_contract,
         employ.stayathome_parent_or_carer,
         employ.selfemployed,
         employ.contract_or_freelance_work,
         employ.small_business_owner,
         employ.receiving_state_income,
         employ.retired,
         employ.student_gcse_or_a_level,
         employ.student_university,
         employ.my_employment_status_has_not_changed,
         employ.became_unemployed,
         employ.reduction_in_hours,
         employ.reduction_in_salary,
         employ.benefits_increased,
         employ.benefits_decreased,
         employ.change_in_duties_or_responsibilities,
         employ.became_employed,
         employ.increased_hours,
         employ.increased_salary,
         employ.furloughed_or_paid_leave_government_funded,
         employ.furloughed_or_paid_leave_company_funded,
         employ.paid_leave_furloughed,
         employ.taking_unpaid_leave,
         employ.other,
         employ.other_text.txt,
         employ.no_impact,
         employ.cancelled_exams,
         employ.change_in_format_of_exams,
         employ.automatic_pass,
         employ.change_in_deadlines,
         employ.change_in_lesson_delivery,
         employ.past_performance_grade_decided,
         employ.cancelled_classes,
         employ.impact_on_studies_still_unknown,
         employ.other.1,
         employ.other_text.txt.1,
         employ.complete_home_work,
         employ.are_you_currently_working_from_home,
         employ.attend_work_encouraged_work,
         employ.government_work_key_workers.txt,
         employ.government_work_key_workers,
         employ.type_role,
         employ.type_role.txt,
         employ.type_role.1,
         employ.does_your_job_include_caring_for_others,
         employ.is_your_job_public_facing_,
         employ.losing_job_due_risk = employ.job_due_losing_risk, #renamed to same as edgi
         employ.increased_due_job_pandemic
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  mutate_if(is.numeric, ~na_if(., -99)) %>%
  mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) %>% # Drop empty factor levels
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(nbr.dem.employ.raw.id)
# Inspect colnames
colnames(nbr.dem.employ.raw.id)
#Differences
dim(nbr.dem.employ.raw)[1]-dim(nbr.dem.employ.raw.id)[1]
}

```

# Demographics 
## RAMP
### Read in data
```{r Read in data RAMP demographics}
if(RAMP == TRUE){
ramp.dem.raw <- readRDS(file = "../data_raw/ramp/dem_ramp.rds")
dim(ramp.dem.raw)
colnames(ramp.dem.raw)
}
```

Select variables
```{r Select variables RAMP demographics}
if(RAMP == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate",
                  "endDate")

ramp.dem.raw.id <- ramp.dem.raw %>% #new dataset with ID
  drop_na(`Login ID`) %>% # Drop NAs
  distinct(`Login ID`, .keep_all = TRUE) %>% # Remove duplicates based on ID
  #separate(externalDataReference, into = c("Sample", "ID"), sep = 4) %>% # Split ID in Sample and Number
  #mutate(externalDataReference = as.numeric(externalDataReference)) %>%
  add_column(cohort_name = "ramp", .before = "startDate") %>% #create new column
  select(
         ID = `Login ID`,# ID
         cohort_name, # Sample
         startDate_baseline = startDate,
         #endDate,
         age_unc = dem2.how_old_are_you,
         gender_unc = dem2.which_gender_do_you_identify_with, # Gender
         pregnant_binary = dem2.are_you_pregnant, 
         #dem2.what_is_your_current_maritalrelationship_status #Not in COPING 
            
         #Need to rename all to same as GLAD/EDGI/NBR - named wrong way round in RAMP
         dem2.living_alone =  dem2.living_alone.1,
         dem2.living_with_partner_or_spouse =  dem2.living_with_partner_or_spouse.1,
         dem2.living_with_housemates =  dem2.living_with_housemates.1,
         dem2.age_children_living =  dem2.age_children_living.1,
         dem2.age_children_living.1 =  dem2.living_children_under_the_age_of_18.1,
         dem2.living_with_other_members_of_my_family =  dem2.living_with_other_members_of_my_family.1,
         dem2.spouse_partner_members_living =  dem2.spouse_partner_members_living.1,
         dem2.staying_live =  dem2.staying_live.2,
         dem2.staying_live.1 =  dem2.staying_live.3,
         dem2.prefer_not_to_say =  dem2.prefer_not_to_say.2,
         dem2.living_situation_change_pandemic,
         dem2.living_alone.1 = dem2.living_alone,
        dem2.living_with_partner_or_spouse.1 = dem2.living_with_partner_or_spouse,
        dem2.living_with_housemates.1 = dem2.living_with_housemates,
        dem2.age_children_living.2 = dem2.age_children_living,
        dem2.age_children_living.3 = dem2.living_children_under_the_age_of_18,
        dem2.living_with_other_members_of_my_family.1 = dem2.living_with_other_members_of_my_family,
        dem2.spouse_partner_members_living.1 = dem2.spouse_partner_members_living,
        dem2.staying_live.2 = dem2.staying_live,
        dem2.staying_live.3 = dem2.staying_live.1,
        dem2.prefer_not_to_say.1 = dem2.prefer_not_to_say,
        dem2.relationships_describe_question_place = dem2.describe_relationships_live_living, #Rename to be same as coping glad/edgi
         dem2.household_living_place_answer, 
         dem2.include_living_areas_count = dem2.count_bathrooms_bedrooms_hallways,
         dem2.cats,
         dem2.dogs,
         dem2.fish,
         dem2.bird,
         dem2.reptile,
         dem2.small_rodent,
         dem2.other_please_specify_species,
         dem2.other_please_specify_species_text.txt,
         dem2.none,
         dem2.02_years,
         dem2.35_years,
         dem2.610_years,
         dem2.1115_years,
         dem2.1618_years,
         dem2.member_vulnerable_group,
         dem2.solid_organ_transplant_recipient,
         dem2.lung_cancer_radical_radiotherapy,
         dem2.bone_marrow_blood_leukaemia,
         dem2.immunotherapy_cancer_continuing_antibody,
         dem2.parp_inhibitors_affect_immune,
         dem2.stem_cell_transplants_bone,
         dem2.severe_copd_cystic_fibrosis,
         dem2.inborn_errors_rare_diseases,
         dem2.taking_medicine_that_weakens_your_immune_system,
         dem2.condition_infections_makes,
         dem2.congenital_pregnant_acquired_significant = dem2.significant_heart_disease_congenital,
         dem2.pregnant,
         dem2.over_70_years_old,
         dem2.prefer_not_to_say.2,
         dem2.unsure,
         transgender = dem2.do_you_identify_as_transgender,
         dem2.adult_children_pandemic_returned,
        # dem2.adult_children_pandemic_returned.txt,
         dem.live = dem2.where_in_the_uk_do_you_live.txt, #changed wording to match glad edgi dem
         ethnicity_unc_text = dem2.what_is_your_ethnic_origin.txt,
         ethnicity_unc = dem2.what_is_your_ethnic_origin,
         dem2.living_alone,
         dem2.living_with_partner_or_spouse,
         dem2.living_with_housemates,
         dem2.age_children_living,
         dem2.living_children_under_the_age_of_18.1,
         dem2.living_with_other_members_of_my_family,
         dem2.spouse_members_partner_living,
         dem2.staying_live,
         dem2.staying_live.1,
         dem2.prefer_not_to_say,
         dem2.household_living_place_answer,
         dem2.do_you_have_any_children,
         dem2.adult_children_home_living.1,
         dem2.under_50_years,
         dem2.5060_years,
         dem2.6170_years,
         dem2.7180_years,
         dem2.81_years,
         dem2.ramp_study_hear.txt,
         dem2.ramp_study_hear
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  mutate_if(is.numeric, ~na_if(., -99)) %>%
  mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) %>% # Drop empty factor levels
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(ramp.dem.raw.id)
# Inspect colnames
colnames(ramp.dem.raw.id)
#Differences
dim(ramp.dem.raw)[1]-dim(ramp.dem.raw.id)[1]
}

```

# Demographics 
## RAMP employment
### Read in data
```{r Read in data RAMP employment}
if(RAMP == TRUE){
ramp.dem.employ.raw <- readRDS(file = "../data_raw/ramp/employ_ramp.rds")
dim(ramp.dem.employ.raw)
colnames(ramp.dem.employ.raw)
}
```

Select variables RAMP employment
```{r Select variables RAMP employment}
if(RAMP == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate",
                  "endDate")

ramp.dem.employ.raw.id <- ramp.dem.employ.raw %>% #new dataset with ID
  drop_na(`Login ID`) %>% # Drop NAs
  distinct(`Login ID`, .keep_all = TRUE) %>% # Remove duplicates based on ID
  #separate(externalDataReference, into = c("Sample", "ID"), sep = 4) %>% # Split ID in Sample and Number
  #mutate(externalDataReference = as.numeric(externalDataReference)) %>%
  add_column(cohort_name = "ramp", .before = "startDate") %>% #create new column 
  select(
         ID = `Login ID`, # ID
         cohort_name, # Sample
         #startDate_baseline = startDate,
         #employ.phd,
         #employ.masters_degree_or_equivalent,
         #employ.postgraduate_degree_or_equivalent,
         #employ.bachelors_degree_or_equivalent,
         #employ.a_levelsas_levels_or_equivalent,
         #employ.o_levelsgcses_or_equivalent,
         #employ.cses_or_equivalent,
         #employ.nvq_or_hnd_or_hnc_or_equivalent,
         #employ.other_professional_qualifications_e.g._nursing_teaching,
         #employ.other_professional_qualifications_e.g._nursing_teaching_text.txt,
         employ.what_is_your_highest_level_of_education,
         #employ.none_of_the_above,
         employ.fulltime_employed,
         employ.parttime_employed,
         employ.unemployed,
         employ.zerohours_contract,
         employ.stayathome_parent_or_carer,
         employ.selfemployed,
         employ.contract_or_freelance_work,
         employ.small_business_owner,
         employ.receiving_state_income,
         employ.retired,
         employ.student_gcse_or_a_level,
         employ.student_university,
         employ.my_employment_status_has_not_changed,
         employ.became_unemployed,
         employ.reduction_in_hours,
         employ.reduction_in_salary,
         employ.benefits_increased,
         employ.benefits_decreased,
         employ.change_in_duties_or_responsibilities,
         employ.became_employed,
         employ.increased_hours,
         employ.increased_salary,
         employ.furloughed_or_paid_leave_government_funded,
         employ.furloughed_or_paid_leave_company_funded,
         employ.paid_leave_furloughed,
         #employ.taking_unpaid_leave, #Not in RAMP
         employ.other,
         employ.other_text.txt,
         employ.no_impact,
         employ.cancelled_exams,
         employ.change_in_format_of_exams,
         employ.automatic_pass,
         employ.change_in_deadlines,
         employ.change_in_lesson_delivery,
         employ.past_performance_grade_decided,
         employ.cancelled_classes,
         employ.impact_on_studies_still_unknown,
         employ.other.1,
         employ.other_text.txt.1,
         employ.complete_home_work,
         employ.are_you_currently_working_from_home,
         employ.attend_work_encouraged_work = employ.work_attend_work_encouraged, #renamed to same as edgi and glsd
        # employ.government_work_key_workers.txt,
         employ.government_work_key_workers,
         employ.type_role,
         #employ.type_role.txt = employ.role_type.txt,
        # employ.type_role.1 = employ.role_type.1,
        # employ.does_your_job_include_caring_for_others,
        # employ.is_your_job_public_facing_,
        # employ.losing_job_due_risk = employ.scale_line_losing_click,
        # employ.increased_due_job_pandemic
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  mutate_if(is.numeric, ~na_if(., -99)) %>%
  mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) %>% # Drop empty factor levels
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(ramp.dem.employ.raw.id)
# Inspect colnames
colnames(ramp.dem.employ.raw.id)
#Differences
dim(ramp.dem.employ.raw)[1]-dim(ramp.dem.employ.raw.id)[1]
}

```

# Pandemic worry at baseline
## EDGI
### Read in data 
```{r Read in data EDGI baseline pandemic worry}
if(EDGI == TRUE){
edgi_pan_worry <- readRDS(file = "../data_raw/edgi/panworry_coping_edgi.rds")
dim(edgi_pan_worry)
colnames(edgi_pan_worry)
}
```


Select variables EDGI baseline pandemic worry
```{r Select variables EDGI baseline pandemic worry}
if(EDGI == TRUE){
exclude_cols_dem <- c("ID",
                      "cohort_name")

edgi_pan_worry.id <- edgi_pan_worry %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  distinct(externalDataReference, .keep_all = TRUE) %>% # Remove duplicates based on ID
  #separate(externalDataReference, into = c("Sample", "ID"), sep = 4) %>% # Split ID in Sample and Number
  #mutate(externalDataReference = as.numeric(externalDataReference)) %>%
    add_column(cohort_name = "coping_edgi", .before = "panworry.impact_on_your_employment_status") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name,
         panworry.impact_on_your_employment_status,                                    
         panworry.employment_status_household_key,              
         panworry.impact_on_your_education_or_exams,            
         panworry.exams_impact_education_children,              
         panworry.financial_impact,                           
         panworry.contracting_the_virus,                       
         panworry.people_you_know_contracting_the_virus,       
         panworry.people_you_dont_know_contracting_the_virus,   
         panworry.impact_mental_health_wellbeing,               
         panworry.impact_mental_health_childrens,               
         panworry.impact_relatives_mental_health,           
         panworry.being_socially_isolated,                    
         panworry.people_you_know_being_socially_isolated,      
         panworry.shortage_of_essential_supplies,                
         panworry.shortage_of_medication_or_access_to_healthcare,
         panworry.healthcare_people_essential_supplies,          
         panworry.information_virus_government_accuracy,         
         panworry.the_governments_response_to_the_pandemic,      
         panworry.separation_from_family_members,         
         panworry.standing_impact_global_recession,
         panworry.other_
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  mutate_if(is.numeric, ~na_if(., -99)) %>%
  mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) %>% # Drop empty factor levels
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(edgi_pan_worry.id)
# Inspect colnames
colnames(edgi_pan_worry.id)
#Differences
dim(edgi_pan_worry)[1]-dim(edgi_pan_worry.id)[1]
}

```

# Pandemic worry at baseline
## GLAD
### Read in data 
```{r Read in data GLAD baseline pandemic worry}
if(GLAD == TRUE){
glad_pan_worry <- readRDS(file = "../data_raw/glad/panworry_coping_glad.rds")
dim(glad_pan_worry)
colnames(glad_pan_worry)
}
```

Select variables GLAD baseline pandemic worry
```{r Select variables GLAD baseline pandemic worry}
if(GLAD == TRUE){
exclude_cols_dem <- c("ID",
                      "cohort_name")

glad_pan_worry.id <- glad_pan_worry %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  distinct(externalDataReference, .keep_all = TRUE) %>% # Remove duplicates based on ID
  #separate(externalDataReference, into = c("Sample", "ID"), sep = 4) %>% # Split ID in Sample and Number
  #mutate(externalDataReference = as.numeric(externalDataReference)) %>%
  add_column(cohort_name = "coping_glad", .before = "panworry.impact_on_your_employment_status") %>% #create new column
  select(
         ID = externalDataReference, # ID
         cohort_name,
         panworry.impact_on_your_employment_status,                                    
         panworry.employment_status_household_key = panworry.household_employment_status_key,              
         panworry.impact_on_your_education_or_exams,            
         panworry.exams_impact_education_children,              
         panworry.financial_impact,                           
         panworry.contracting_the_virus,                       
         panworry.people_you_know_contracting_the_virus,       
         panworry.people_you_dont_know_contracting_the_virus,   
         panworry.impact_mental_health_wellbeing,               
         panworry.impact_mental_health_childrens,               
         panworry.impact_relatives_mental_health = panworry.relatives_impact_mental_health,           
         panworry.being_socially_isolated,                    
         panworry.people_you_know_being_socially_isolated,      
         panworry.shortage_of_essential_supplies,                
         panworry.shortage_of_medication_or_access_to_healthcare,
         panworry.healthcare_people_essential_supplies,          
         panworry.information_virus_government_accuracy,         
         panworry.the_governments_response_to_the_pandemic,      
         panworry.separation_from_family_members,         
         panworry.standing_impact_global_recession,
         panworry.other_
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  mutate_if(is.numeric, ~na_if(., -99)) %>%
  mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) %>% # Drop empty factor levels
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(glad_pan_worry.id)
# Inspect colnames
colnames(glad_pan_worry.id)
#Differences
dim(glad_pan_worry)[1]-dim(glad_pan_worry.id)[1]
}

```

# Pandemic worry at baseline
## NBR
### Read in data 
```{r Read in data NBR baseline pandemic worry}
if(NBR == TRUE){
nbr_pan_worry <- readRDS(file = "../data_raw/nbr/panworry_coping_nbr.rds")
dim(nbr_pan_worry)
colnames(nbr_pan_worry)
}
```

Select variables NBR baseline pandemic worry
```{r Select variables NBR baseline pandemic worry}
if(NBR == TRUE){
exclude_cols_dem <- c("ID",
                      "cohort_name")

nbr_pan_worry.id <- nbr_pan_worry %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  distinct(externalDataReference, .keep_all = TRUE) %>% # Remove duplicates based on ID
  #separate(externalDataReference, into = c("Sample", "ID"), sep = 4) %>% # Split ID in Sample and Number
  #mutate(externalDataReference = as.numeric(externalDataReference)) %>%
  add_column(cohort_name = "nbr", .before = "panworry.impact_on_your_employment_status") %>% #create new column
  select(
     ID = externalDataReference, # ID
     cohort_name,
         panworry.impact_on_your_employment_status,                                    
         panworry.employment_status_household_key,              
         panworry.impact_on_your_education_or_exams,            
         panworry.exams_impact_education_children,              
         panworry.financial_impact,                           
         panworry.contracting_the_virus,                       
         panworry.people_you_know_contracting_the_virus,       
         panworry.people_you_dont_know_contracting_the_virus,   
         panworry.impact_mental_health_wellbeing,               
         panworry.impact_mental_health_childrens,               
         panworry.impact_relatives_mental_health,           
         panworry.being_socially_isolated,                    
         panworry.people_you_know_being_socially_isolated,      
         panworry.shortage_of_essential_supplies,                
         panworry.shortage_of_medication_or_access_to_healthcare,
         panworry.healthcare_people_essential_supplies,          
         panworry.information_virus_government_accuracy,         
         panworry.the_governments_response_to_the_pandemic,      
         panworry.separation_from_family_members,         
         panworry.standing_impact_global_recession,
     panworry.other_
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  mutate_if(is.numeric, ~na_if(., -99)) %>%
  mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) %>% # Drop empty factor levels
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(nbr_pan_worry.id)
# Inspect colnames
colnames(nbr_pan_worry.id)
#Differences
dim(nbr_pan_worry)[1]-dim(nbr_pan_worry.id)[1]
}

```

# Pandemic worry at baseline
## RAMP
### Read in data 
```{r Read in data RAMP baseline pandemic worry}
if(RAMP == TRUE){
ramp_pan_worry <- readRDS(file = "../data_raw/ramp/panworry_ramp.rds")
dim(ramp_pan_worry)
colnames(ramp_pan_worry)
}
```

Select variables
```{r Select variables RAMP baseline pandemic worry}
if(RAMP == TRUE){
exclude_cols_dem <- c("ID",
                      "cohort_name")

ramp_pan_worry.id <- ramp_pan_worry %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  distinct(externalDataReference, .keep_all = TRUE) %>% # Remove duplicates based on ID
  #separate(externalDataReference, into = c("Sample", "ID"), sep = 4) %>% # Split ID in Sample and Number
  #mutate(externalDataReference = as.numeric(externalDataReference)) %>%
  add_column(cohort_name = "ramp", .before = "panworry.impact_on_your_employment_status") %>% #create new column
  select(
         ID = externalDataReference, # ID
         cohort_name,
         panworry.impact_on_your_employment_status,                                    
         panworry.employment_status_household_key,              
         panworry.impact_on_your_education_or_exams,            
         panworry.exams_impact_education_children,              
         panworry.financial_impact,                           
         panworry.contracting_the_virus,                       
         panworry.people_you_know_contracting_the_virus,       
         panworry.people_you_dont_know_contracting_the_virus,   
         panworry.impact_mental_health_wellbeing,               
         panworry.impact_mental_health_childrens,               
         panworry.impact_relatives_mental_health,           
         panworry.being_socially_isolated,                    
         panworry.people_you_know_being_socially_isolated,      
         panworry.shortage_of_essential_supplies,                
         panworry.shortage_of_medication_or_access_to_healthcare,
         panworry.healthcare_people_essential_supplies,          
         panworry.information_virus_government_accuracy,         
         panworry.the_governments_response_to_the_pandemic,      
         panworry.separation_from_family_members,         
         panworry.standing_impact_global_recession,
         panworry.other_
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  mutate_if(is.numeric, ~na_if(., -99)) %>%
  mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) %>% # Drop empty factor levels
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(ramp_pan_worry.id)
# Inspect colnames
colnames(ramp_pan_worry.id)
#Differences
dim(ramp_pan_worry)[1]-dim(ramp_pan_worry.id)[1]
}

```

# Read in EDEQ baseline data (although note that is only present in RAMP)
## RAMP 
### Read in data
```{r Read in data RAMP EDEQ baseline}
if(RAMP == TRUE){
edeq.ramp.baseline.raw <- readRDS(file = "../data_raw/ramp/edeq_ramp.rds")
dim(edeq.ramp.baseline.raw)
colnames(edeq.ramp.baseline.raw)
}
```

Select variables RAMP EDEQ baseline
```{r Select variables RAMP EDEQ baseline}
if(RAMP == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate",
                  "endDate")

edeq.ramp.baseline.raw.id <- edeq.ramp.baseline.raw %>% #new dataset with ID
  drop_na(`Login ID`) %>% # Drop NAs
  distinct(`Login ID`, .keep_all = TRUE) %>% # Remove duplicates based on ID
  #separate(externalDataReference, into = c("Sample", "ID"), sep = 4) %>% # Split ID in Sample and Number
  #mutate(externalDataReference = as.numeric(externalDataReference)) %>%
  add_column(cohort_name = "ramp", .before = "startDate") %>% #create new column 
  select(
         ID = `Login ID`, # ID
         cohort_name, # Sample
         startDate_baseline = startDate,
         #endDate,
         edeq.deliberately_limit_amount_influence_.Wavebaseline = edeq.deliberately_limit_amount_influence,
         edeq.calories_made_body_shape_.Wavebaseline = edeq.calories_made_body_shape,
         edeq.weight_influenced_person_.Wavebaseline = edeq.weight_influenced_person,
         edeq.dissatisfied_shape_weight_.Wavebaseline = edeq.dissatisfied_shape_weight,
         edeq.nibbled_picked_snacks_grazed_.Wavebaseline = edeq.nibbled_picked_snacks_grazed,
         edeq.felt_anxious_blue_bored_.Wavebaseline = edeq.felt_anxious_blue_bored,
         edeq.felt_anxious_blue_bored.1_.Wavebaseline = edeq.felt_anxious_blue_bored.1,
         edeq.eating_behaviours_concerns_distressed_.Wavebaseline = edeq.eating_behaviours_concerns_distressed,
         edeq.deliberately_limit_amount_influence.1_.Wavebaseline = edeq.deliberately_limit_amount_influence.1,
         edeq.calories_made_body_shape.1_.Wavebaseline = edeq.calories_made_body_shape.1,
         edeq.weight_influenced_person.1_.Wavebaseline = edeq.weight_influenced_person.1,
         edeq.dissatisfied_shape_weight.1_.Wavebaseline = edeq.dissatisfied_shape_weight.1,
         edeq.eating_behaviours_concerns_distressed.1_.Wavebaseline = edeq.eating_behaviours_concerns_distressed.1,
         edeq.feelings_pandemic_felt_.Wavebaseline = edeq.feelings_pandemic_felt,
         edeq.actively_been_monitoring_your_shape_or_weight_.Wavebaseline = edeq.actively_been_monitoring_your_shape_or_weight_,
         edeq.regard_lost_control_eaten_.Wavebaseline = edeq.regard_lost_control_eaten,
         edeq.sick_means_made_shape_.Wavebaseline = edeq.sick_means_made_shape,
         edeq.diuretics_laxatives_means_shape_.Wavebaseline = edeq.diuretics_laxatives_means_shape,
         edeq.compulsive_driven_burn_calories_.Wavebaseline = edeq.compulsive_driven_burn_calories,
         edeq.nibbled_picked_snacks_grazed.1_.Wavebaseline = edeq.nibbled_picked_snacks_grazed.1,
         edeq.felt_anxious_blue_bored.2_.Wavebaseline = edeq.felt_anxious_blue_bored.2,
         edeq.felt_anxious_blue_bored.3_.Wavebaseline = edeq.felt_anxious_blue_bored.3,
         edeq.actively_been_monitoring_your_shape_or_weight_.1_.Wavebaseline = edeq.actively_been_monitoring_your_shape_or_weight_.1,
         edeq.regard_lost_control_eaten.1_.Wavebaseline = edeq.regard_lost_control_eaten.1,
         edeq.sick_means_made_shape.1_.Wavebaseline = edeq.sick_means_made_shape.1,
         edeq.diuretics_laxatives_means_shape.1_.Wavebaseline = edeq.diuretics_laxatives_means_shape.1,
         edeq.compulsive_driven_burn_calories.1_.Wavebaseline = edeq.compulsive_driven_burn_calories.1
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  #mutate_if(is.numeric, ~na_if(., -99)) %>%
  #mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
 # mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  #mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
  #mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
  #mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
  #mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(edeq.ramp.baseline.raw.id)
# Inspect colnames
colnames(edeq.ramp.baseline.raw.id)
#Differences
dim(edeq.ramp.baseline.raw)[1]-dim(edeq.ramp.baseline.raw.id)[1]
}

```

# EDEQ screener follow up B
## COPING
### Read in data
NB: The EDEQ screener is only available in follow up B across both RAMP and COPING.
```{r Read in data COPING follow up B EDEQ screener}
if(COPING == TRUE){
edeq.coping.followupb.screener.raw <- readRDS(file = "../data_raw/coping/ed_scid5_coping_followupb.rds")
dim(edeq.coping.followupb.screener.raw)
colnames(edeq.coping.followupb.screener.raw)
}
```

Select variables COPING follow up B EDEQ screener
```{r Select variables COPING follow up B EDEQ screener}
if(COPING == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate_waves",
                  "endDate")

edeq.coping.followupb.screener.raw.id <- edeq.coping.followupb.screener.raw %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  #distinct(externalDataReference, .keep_all = TRUE) %>% # Remove duplicates based on ID
  #separate(externalDataReference, into = c("Sample", "ID"), sep = 4) %>% # Split ID in Sample and Number
  #mutate(externalDataReference = as.numeric(externalDataReference)) %>%
  add_column(cohort_name = "coping", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         startDate_waves = startDate,
         #endDate,
         ed_scid5.regular_episodes_eating_binges,
         ed_scid5.weigh_weighed_past_month
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  #mutate_if(is.numeric, ~na_if(., -99)) %>%
 # mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  #mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  #mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
  #mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  #mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(edeq.coping.followupb.screener.raw.id)
# Inspect colnames
colnames(edeq.coping.followupb.screener.raw.id)
#Differences
dim(edeq.coping.followupb.screener.raw)[1]-dim(edeq.coping.followupb.screener.raw.id)[1]
}
```

# EDEQ screener follow up B
## RAMP
### Read in data
```{r Read in data RAMP follow up B EDEQ screener}
if(RAMP == TRUE){
edeq.ramp.followupb.screener.raw <- readRDS(file = "../data_raw/ramp/ed_scid5_ramp_followupb.rds")
dim(edeq.ramp.followupb.screener.raw)
colnames(edeq.ramp.followupb.screener.raw)
}
```

Select variables RAMP follow up B EDEQ screener
```{r Select variables RAMP follow up B EDEQ screener}
if(RAMP == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate_waves",
                  "endDate")

edeq.ramp.followupb.screener.raw.id <- edeq.ramp.followupb.screener.raw %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  #distinct(externalDataReference, .keep_all = TRUE) %>% # Remove duplicates based on ID
  #separate(externalDataReference, into = c("Sample", "ID"), sep = 4) %>% # Split ID in Sample and Number
  #mutate(externalDataReference = as.numeric(externalDataReference)) %>%
  add_column(cohort_name = "ramp", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         startDate_waves = startDate,
         #endDate,
         ed_scid5.regular_episodes_eating_binges,
         ed_scid5.weigh_weighed_past_month
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  #mutate_if(is.numeric, ~na_if(., -99)) %>%
 # mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  #mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  #mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
  #mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  #mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(edeq.ramp.followupb.screener.raw.id)
# Inspect colnames
colnames(edeq.ramp.followupb.screener.raw.id)
#Differences
dim(edeq.ramp.followupb.screener.raw)[1]-dim(edeq.ramp.followupb.screener.raw.id)[1]
}
```

# Virus follow up B
## COPING
### Read in data
```{r Read in data COPING follow up B virus}
if(COPING == TRUE){
coping.followupb.virus <- readRDS(file = "../data_raw/coping/virus_coping_followupb.rds")
dim(coping.followupb.virus)
colnames(coping.followupb.virus)
}
```

Select variables COPING follow up B virus
```{r Select variables COPING follow up B virus}
if(COPING == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate_waves",
                  "endDate")

coping.followupb.virus.id <- coping.followupb.virus %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  #distinct(externalDataReference, .keep_all = TRUE) %>% # Remove duplicates based on ID
  #separate(externalDataReference, into = c("Sample", "ID"), sep = 4) %>% # Split ID in Sample and Number
  #mutate(externalDataReference = as.numeric(externalDataReference)) %>%
  add_column(cohort_name = "coping", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         startDate_waves = startDate,
         virus.back_positive_antibodies_covid,
         virus.past_surveys_include_reported
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  #mutate_if(is.numeric, ~na_if(., -99)) %>%
 # mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  #mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  #mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
  #mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  #mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(coping.followupb.virus.id)
# Inspect colnames
colnames(coping.followupb.virus.id)
#Differences
dim(coping.followupb.virus)[1]-dim(coping.followupb.virus.id)[1]
}
```

# Virus follow up B
## RAMP
### Read in data
```{r Read in data RAMP follow up B virus}
if(RAMP == TRUE){
ramp.followupb.virus <- readRDS(file = "../data_raw/ramp/virus_ramp_followupb.rds")
dim(ramp.followupb.virus)
colnames(ramp.followupb.virus)
}
```

Select variables RAMP follow up B virus
```{r Select variables RAMP follow up B virus}
if(RAMP == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate_waves",
                  "endDate")

ramp.followupb.virus.id <- ramp.followupb.virus %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  #distinct(externalDataReference, .keep_all = TRUE) %>% # Remove duplicates based on ID
  #separate(externalDataReference, into = c("Sample", "ID"), sep = 4) %>% # Split ID in Sample and Number
  #mutate(externalDataReference = as.numeric(externalDataReference)) %>%
  add_column(cohort_name = "coping", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         startDate_waves = startDate,
         virus.back_positive_antibodies_covid,
         virus.past_surveys_include_reported
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  #mutate_if(is.numeric, ~na_if(., -99)) %>%
 # mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  #mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  #mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
  #mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  #mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(ramp.followupb.virus.id)
# Inspect colnames
colnames(ramp.followupb.virus.id)
#Differences
dim(ramp.followupb.virus.id)[1]-dim(ramp.followupb.virus.id)[1]
}
```

# TAF - baseline (Thoughts & Feelings questionnaires from UKB that contains questions about self-harm thoughts & behaviours)
## GLAD 
### Read in data
```{r Read in data GLAD TAF baseline}
if(GLAD == TRUE){
taf.glad.coping.baseline.raw <- readRDS(file = "../data_raw/glad/taf_coping_glad.rds")
dim(taf.glad.coping.baseline.raw)
colnames(taf.glad.coping.baseline.raw)
}

```

Select variables GLAD TAF baseline
```{r Select variables GLAD TAF baseline}
if(GLAD == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate",
                  "endDate")

taf.glad.coping.baseline.raw.id <- taf.glad.coping.baseline.raw %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  distinct(externalDataReference, .keep_all = TRUE) %>% # Remove duplicates based on ID
  #separate(externalDataReference, into = c("Sample", "ID"), sep = 4) %>% # Split ID in Sample and Number
  #mutate(externalDataReference = as.numeric(externalDataReference)) %>%
  add_column(cohort_name = "coping_glad", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         startDate_baseline = startDate,
         #endDate,
         taf.worth_living_life_people_.Wavebaseline = taf.worth_living_life_thoughts, #renamed to same as follow up
         taf.felt_weeks_past_.Wavebaseline = taf.past_felt_weeks,#renamed to same as follow up
         taf.pandemic_felt_.Wavebaseline = taf.pandemic_felt,
         taf.have_you_contemplated_harming_yourself_.Wavebaseline = taf.have_you_contemplated_harming_yourself_,
         taf.felt_weeks_past.1_.Wavebaseline = taf.past_felt_weeks.1, #renamed to same as follow up
         taf.pandemic_felt.1_.Wavebaseline = taf.pandemic_felt.1,
         taf.meant_life_end_weeks_.Wavebaseline = taf.meant_end_life_weeks, #renamed to same as follow up
         taf.meant_end_life_pandemic_.Wavebaseline = taf.meant_end_life_pandemic
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  #mutate_if(is.numeric, ~na_if(., -99)) %>%
 # mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
 # mutate_if(is.factor, ~na_if(., "Don't know")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
#  mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
#  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(taf.glad.coping.baseline.raw.id)
# Inspect colnames
colnames(taf.glad.coping.baseline.raw.id)
#Differences
dim(taf.glad.coping.baseline.raw)[1]-dim(taf.glad.coping.baseline.raw.id)[1]
}


```

# TAF - baseline
## EDGI  
### Read in data
```{r Read in data EDGI TAF baseline}
if(EDGI == TRUE){
taf.edgi.coping.baseline.raw <- readRDS(file = "../data_raw/edgi/taf_coping_edgi.rds")
dim(taf.edgi.coping.baseline.raw)
colnames(taf.edgi.coping.baseline.raw)
}
```

Select variables - EDGI TAF baseline
```{r Select variables EDGI TAF baseline}
if(EDGI == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate",
                  "endDate")


taf.edgi.coping.baseline.raw.id <- taf.edgi.coping.baseline.raw %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  distinct(externalDataReference, .keep_all = TRUE) %>% # Remove duplicates based on ID
  #separate(externalDataReference, into = c("Sample", "ID"), sep = 4) %>% # Split ID in Sample and Number
  #mutate(externalDataReference = as.numeric(externalDataReference)) %>%
  add_column(cohort_name = "coping_edgi", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         startDate_baseline = startDate,
         #endDate,
         taf.worth_living_life_people_.Wavebaseline = taf.worth_living_thoughts_life, #renamed to same as follow up
         taf.felt_weeks_past_.Wavebaseline = taf.weeks_past_felt,#renamed to same as follow up
         taf.pandemic_felt_.Wavebaseline = taf.pandemic_felt,
         taf.have_you_contemplated_harming_yourself_.Wavebaseline = taf.have_you_contemplated_harming_yourself_,
         taf.felt_weeks_past.1_.Wavebaseline = taf.weeks_past_felt.1, #renamed to same as follow up
         taf.pandemic_felt.1_.Wavebaseline = taf.pandemic_felt.1,
         taf.meant_life_end_weeks_.Wavebaseline = taf.meant_end_weeks_life, #renamed to same as follow up
         taf.meant_end_life_pandemic_.Wavebaseline = taf.meant_end_life_pandemic
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
 # mutate_if(is.numeric, ~na_if(., -99)) %>%
 # mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
 # mutate_if(is.factor, ~na_if(., "Don't know")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered"))  # Drop empty factor levels
#  mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
#  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) 
#  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(taf.edgi.coping.baseline.raw.id)
# Inspect colnames
colnames(taf.edgi.coping.baseline.raw.id)
#Differences
dim(taf.edgi.coping.baseline.raw)[1]-dim(taf.edgi.coping.baseline.raw.id)[1]
}
```

# TAF - baseline 
## NBR 
### Read in data
```{r Read in data NBR TAF baseline}
if(NBR == TRUE){
taf.nbr.baseline.raw <- readRDS(file = "../data_raw/nbr/taf_coping_nbr.rds")
dim(taf.nbr.baseline.raw)
colnames(taf.nbr.baseline.raw)
}

```

Select variables NBR TAF baseline
```{r Select variables NBR TAF baseline}
if(NBR == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate",
                  "endDate")

taf.nbr.baseline.raw.id <- taf.nbr.baseline.raw %>% #new dataset with ID
  drop_na(subjectid) %>% # Drop NAs
  distinct(subjectid, .keep_all = TRUE) %>% # Remove duplicates based on ID
  #separate(externalDataReference, into = c("Sample", "ID"), sep = 4) %>% # Split ID in Sample and Number
  #mutate(externalDataReference = as.numeric(externalDataReference)) %>%
  add_column(cohort_name = "nbr", .before = "startDate") %>% #create new column 
  select(
         ID = subjectid, # ID
         cohort_name, # Sample
         startDate_baseline = startDate,
         #endDate,
         taf.worth_living_life_people_.Wavebaseline = taf.worth_living_thoughts_life, #renamed to same as follow up
         taf.felt_weeks_past_.Wavebaseline = taf.past_felt_weeks,#renamed to same as follow up
         taf.pandemic_felt_.Wavebaseline = taf.pandemic_felt,
         taf.have_you_contemplated_harming_yourself_.Wavebaseline = taf.have_you_contemplated_harming_yourself_,
         taf.felt_weeks_past.1_.Wavebaseline = taf.past_felt_weeks.1, #renamed to same as follow up
         taf.pandemic_felt.1_.Wavebaseline = taf.pandemic_felt.1,
         taf.meant_life_end_weeks_.Wavebaseline = taf.meant_end_life_weeks, #renamed to same as follow up
         taf.meant_end_life_pandemic_.Wavebaseline = taf.meant_end_pandemic_life #renamed to same as follow up
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  #mutate_if(is.numeric, ~na_if(., -99)) %>%
  #mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  #mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  #mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
  #mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
  #mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
  #mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) 
  #mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(taf.nbr.baseline.raw.id)
# Inspect colnames
colnames(taf.nbr.baseline.raw.id)
#Differences
dim(taf.nbr.baseline.raw)[1]-dim(taf.nbr.baseline.raw.id)[1]
}
```

# TAF - baseline 
## RAMP
### Read in data
```{r Read in data RAMP TAF baseline}
if(RAMP == TRUE){
taf.ramp.baseline.raw <- readRDS(file = "../data_raw/ramp/taf_ramp.rds")
dim(taf.ramp.baseline.raw)
colnames(taf.ramp.baseline.raw)
}
```

Select variables RAMP TAF baseline
```{r Select variables RAMP TAF baseline}
if(RAMP == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate",
                  "endDate")

taf.ramp.baseline.raw.id <- taf.ramp.baseline.raw %>% #new dataset with ID
  drop_na(`Login ID`) %>% # Drop NAs
  distinct(`Login ID`, .keep_all = TRUE) %>% # Remove duplicates based on ID
  #separate(externalDataReference, into = c("Sample", "ID"), sep = 4) %>% # Split ID in Sample and Number
  #mutate(externalDataReference = as.numeric(externalDataReference)) %>%
  add_column(cohort_name = "ramp", .before = "startDate") %>% #create new column 
  select(
         ID = `Login ID`, # ID
         cohort_name, # Sample
         startDate_baseline = startDate,
         #endDate,
         taf.worth_living_life_people_.Wavebaseline = taf.worth_living_thoughts_life, #renamed to same as follow up
         taf.felt_weeks_past_.Wavebaseline = taf.past_felt_weeks,#renamed to same as follow up
         taf.pandemic_felt_.Wavebaseline = taf.pandemic_felt,
         taf.have_you_contemplated_harming_yourself_.Wavebaseline = taf.have_you_contemplated_harming_yourself_,
         taf.felt_weeks_past.1_.Wavebaseline = taf.past_felt_weeks.1, #renamed to same as follow up
         taf.pandemic_felt.1_.Wavebaseline = taf.pandemic_felt.1,
         taf.meant_life_end_weeks_.Wavebaseline = taf.meant_end_life_weeks, #renamed to same as follow up
         taf.meant_end_life_pandemic_.Wavebaseline = taf.meant_end_pandemic_life #renamed to same as follow up
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
 # mutate_if(is.numeric, ~na_if(., -99)) %>%
 # mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
 # mutate_if(is.factor, ~na_if(., "Don't know")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
#  mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
#  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(taf.ramp.baseline.raw.id)
# Inspect colnames
colnames(taf.ramp.baseline.raw.id)
#Differences
dim(taf.ramp.baseline.raw)[1]-dim(taf.ramp.baseline.raw.id)[1]
}
```

# TAF - follow up A
## COPING (first 2 phases)
### Read in data
```{r Read in data COPING follow up A TAF first two phases}
if(COPING == TRUE){
taf.coping.followupa.raw.1 <- readRDS(file = "../data_raw/coping/taf_coping_followupa.rds")
dim(taf.coping.followupa.raw.1)
colnames(taf.coping.followupa.raw.1)
}
```

Select variables COPING follow up A TAF first two phases
```{r Select variables COPING follow up A TAF first two phases}
if(COPING == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate_waves",
                  "endDate")

taf.coping.followupa.raw.id.1 <- taf.coping.followupa.raw.1 %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  #distinct(externalDataReference, .keep_all = TRUE) %>% # Remove duplicates based on ID
  #separate(externalDataReference, into = c("Sample", "ID"), sep = 4) %>% # Split ID in Sample and Number
  #mutate(externalDataReference = as.numeric(externalDataReference)) %>%
  add_column(cohort_name = "coping", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         startDate_waves = startDate,
         #endDate,
         taf.worth_living_life_people = taf.worth_living_life_people,
         taf.felt_weeks_past = taf.felt_weeks_past,
         taf.have_you_contemplated_harming_yourself = taf.have_you_contemplated_harming_yourself_,
         taf.felt_weeks_past.1 = taf.felt_weeks_past.1,
         taf.meant_life_end_weeks = taf.meant_life_end_weeks
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
 # mutate_if(is.numeric, ~na_if(., -99)) %>%
 # mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
 # mutate_if(is.factor, ~na_if(., "Don't know")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(taf.coping.followupa.raw.id.1)
# Inspect colnames
colnames(taf.coping.followupa.raw.id.1)
#Differences
dim(taf.coping.followupa.raw.1)[1]-dim(taf.coping.followupa.raw.id.1)[1]
}
```

# TAF - follow up A
## COPING (subsequent phases)
### Read in data
```{r Read in data COPING follow up A TAF first subsequent phases}
if(COPING == TRUE){
taf.coping.followupa.raw.2 <- readRDS(file = "../data_raw/coping/taf_coping_followupa_ongoing.rds")
dim(taf.coping.followupa.raw.2)
colnames(taf.coping.followupa.raw.2)
}
```

Select variables COPING follow up A TAF first subsequent phases
```{r Select variables COPING follow up A TAF first subsequent phases}
if(COPING == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate_waves",
                  "endDate")

taf.coping.followupa.raw.id.2 <- taf.coping.followupa.raw.2 %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  #distinct(externalDataReference, .keep_all = TRUE) %>% # Remove duplicates based on ID
  #separate(externalDataReference, into = c("Sample", "ID"), sep = 4) %>% # Split ID in Sample and Number
  #mutate(externalDataReference = as.numeric(externalDataReference)) %>%
  add_column(cohort_name = "coping", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         startDate_waves = startDate,
         #endDate,
         taf.worth_living_life_people = taf.worth_living_life_people,
         taf.felt_weeks_past = taf.felt_weeks_past,
         taf.have_you_contemplated_harming_yourself = taf.have_you_contemplated_harming_yourself_,
         taf.felt_weeks_past.1 = taf.felt_weeks_past.1,
         taf.meant_life_end_weeks = taf.meant_life_end_weeks
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
# mutate_if(is.numeric, ~na_if(., -99)) %>%
 # mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
 # mutate_if(is.factor, ~na_if(., "Don't know")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered"))  # Drop empty factor levels
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(taf.coping.followupa.raw.id.2)
# Inspect colnames
colnames(taf.coping.followupa.raw.id.2)
#Differences
dim(taf.coping.followupa.raw.2)[1]-dim(taf.coping.followupa.raw.id.2)[1]
}
```

Combine TAF COPING follow up A datasets 
```{r Combine COPING follow up A TAF datasets}
if(COPING == TRUE){
    taf.coping.followupa.raw.id <- rbind(taf.coping.followupa.raw.id.2, taf.coping.followupa.raw.id.1) # **Note that some people may be in both datasets, i.e. answered the questionnaire using the original link during the time period that is considered the start of the 'ongoing' dataset, before realising and answering through the correct link. Example - questionnaires answered on the 29th July are present in both datasets. This is fine - as long as it's different people. Will need to filter by duplicate ID and duplicate wave once wave variable is created.
  
# Inspect dimensions
  dim(taf.coping.followupa.raw.id)
# Inspect colnames
  colnames(taf.coping.followupa.raw.id)
}
```

# TAF - follow up b
## COPING
### Read in data
```{r Read in data COPING follow up B TAF}
if(COPING == TRUE){
taf.coping.followupb.raw <- readRDS(file = "../data_raw/coping/taf_coping_followupb.rds")
dim(taf.coping.followupb.raw)
colnames(taf.coping.followupb.raw)
}
```

Select variables COPING follow up B TAF
```{r Select variables COPING follow up B TAF}
if(COPING == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate_waves",
                  "endDate")

taf.coping.followupb.raw.id <- taf.coping.followupb.raw %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
 # distinct(externalDataReference, .keep_all = TRUE) %>% # Remove duplicates based on ID
  #separate(externalDataReference, into = c("Sample", "ID"), sep = 4) %>% # Split ID in Sample and Number
  #mutate(externalDataReference = as.numeric(externalDataReference)) %>%
  add_column(cohort_name = "coping", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         startDate_waves = startDate,
         #endDate,
         taf.worth_living_life_people = taf.worth_living_life_people,
         taf.felt_weeks_past = taf.weeks_past_felt, #renamed to same follow up a
         taf.have_you_contemplated_harming_yourself = taf.have_you_contemplated_harming_yourself_,
         taf.felt_weeks_past.1 = taf.weeks_past_felt.1, #renamed to same follow up a
         taf.meant_life_end_weeks = taf.deliberately_harmed_meant_end #renamed to same follow up a
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
 # mutate_if(is.numeric, ~na_if(., -99)) %>%
 # mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
 # mutate_if(is.factor, ~na_if(., "Don't know")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
  #mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered"))  # Drop empty factor levels
#  mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(taf.coping.followupb.raw.id)
# Inspect colnames
colnames(taf.coping.followupb.raw.id)
#Differences
dim(taf.coping.followupb.raw)[1]-dim(taf.coping.followupb.raw.id)[1]
}
```

# TAF - follow up A
## RAMP
### Read in data
```{r Read in data RAMP follow up A TAF}
if(RAMP == TRUE){
taf.ramp.followupa.raw <- readRDS(file = "../data_raw/ramp/NEW_taf_ramp_followupa.rds")
dim(taf.ramp.followupa.raw)
colnames(taf.ramp.followupa.raw)
}
```

Select variables RAMP follow up A TAF
```{r Select variables RAMP follow up A TAF}
if(RAMP == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate_waves",
                  "endDate")

taf.ramp.followupa.raw.id <- taf.ramp.followupa.raw %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  #distinct(externalDataReference, .keep_all = TRUE) %>% # Remove duplicates based on ID
  #separate(externalDataReference, into = c("Sample", "ID"), sep = 4) %>% # Split ID in Sample and Number
  #mutate(externalDataReference = as.numeric(externalDataReference)) %>%
  add_column(cohort_name = "ramp", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         startDate_waves = startDate,
         #endDate,
         taf.worth_living_life_people = taf.worth_living_life_people,
         taf.felt_weeks_past = taf.felt_weeks_past,
         taf.have_you_contemplated_harming_yourself = taf.have_you_contemplated_harming_yourself_,
         taf.felt_weeks_past.1 = taf.felt_weeks_past.1,
         taf.meant_life_end_weeks = taf.meant_life_end_weeks
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
 # mutate_if(is.numeric, ~na_if(., -99)) %>%
  #mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
 # mutate_if(is.factor, ~na_if(., "Don't know")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
#  mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
#  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(taf.ramp.followupa.raw.id)
# Inspect colnames
colnames(taf.ramp.followupa.raw.id)
#Differences
dim(taf.ramp.followupa.raw)[1]-dim(taf.ramp.followupa.raw.id)[1]
}
```

# TAF - follow up B
## RAMP
### Read in data
```{r Read in data RAMP follow up B TAF}
if(RAMP == TRUE){
taf.ramp.followupb.raw <- readRDS(file = "../data_raw/ramp/NEW_taf_ramp_followupb.rds")
dim(taf.ramp.followupb.raw)
colnames(taf.ramp.followupb.raw)
}
```

Select variables RAMP follow up B TAF
```{r Select variables RAMP follow up B TAF}
if(RAMP == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate_waves",
                  "endDate")

taf.ramp.followupb.raw.id <- taf.ramp.followupb.raw %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  #distinct(externalDataReference, .keep_all = TRUE) %>% # Remove duplicates based on ID
  #separate(externalDataReference, into = c("Sample", "ID"), sep = 4) %>% # Split ID in Sample and Number
  #mutate(externalDataReference = as.numeric(externalDataReference)) %>%
  add_column(cohort_name = "ramp", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         startDate_waves = startDate,
         #endDate,
         taf.worth_living_life_people = taf.worth_living_life_people,
         taf.felt_weeks_past = taf.weeks_past_felt, #renamed to match follow up a
         taf.have_you_contemplated_harming_yourself = taf.have_you_contemplated_harming_yourself_,
         taf.felt_weeks_past.1 = taf.weeks_past_felt.1, #renamed to match follow up a
         taf.meant_life_end_weeks = taf.deliberately_harmed_meant_end #renamed to match follow up a
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
 #mutate_if(is.numeric, ~na_if(., -99)) %>%
  #mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
 # mutate_if(is.factor, ~na_if(., "Don't know")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(taf.ramp.followupb.raw.id)
# Inspect colnames
colnames(taf.ramp.followupb.raw.id)
#Differences
dim(taf.ramp.followupb.raw)[1]-dim(taf.ramp.followupb.raw.id)[1]
}
```

# Demographics follow up A
## RAMP
### Read in data 
```{r Read in data RAMP follow up A demographics}
if(RAMP == TRUE) {
  dem.ramp.followupa.raw <- readRDS(file = "../data_raw/ramp/dem_ramp_followupa.rds")
dim(dem.ramp.followupa.raw)
colnames(dem.ramp.followupa.raw)
}
```

Select variables RAMP follow up A demographics
```{r Select variables RAMP follow up A demographics}
if(RAMP == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate_waves",
                  "endDate")

dem.ramp.followupa.raw.id <- dem.ramp.followupa.raw %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  #distinct(externalDataReference, .keep_all = TRUE) %>% # Remove duplicates based on ID
  #separate(externalDataReference, into = c("Sample", "ID"), sep = 4) %>% # Split ID in Sample and Number
  #mutate(externalDataReference = as.numeric(externalDataReference)) %>%
  add_column(cohort_name = "ramp", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         startDate_waves = startDate,
         #endDate,
         dem.nothing_has_changed,                                     
         dem.living_situation,
         dem.employment,
         dem.physical_health,
         dem.health_of_a_relative,
         dem.household_employment_status_key,
         dem.children__dependants_returning_to_school__other_education,
         dem.living_alone,
         dem.living_with_partner_or_spouse,
         dem.living_with_housemates,
         dem.age_children_living,
         dem.age_children_living.1,
         dem.living_with_other_members_of_my_family,
         dem.spouse_partner_members_living,
         dem.staying_live,
         dem.staying_live.1,
         dem.prefer_not_to_say,
         dem.made_redundant,
         dem.became_unemployed,
         dem.reduction_in_hours,
         dem.reduction_in_salary,
         dem.benefits_increased,
         dem.benefits_decreased,
         dem.change_in_duties_or_responsibilites,
         dem.became_employed,
         dem.increased_hours,
         dem.increased_salary,
         dem.furloughed_or_paid_leave_government_funded,
         dem.furloughed_or_paid_leave_company_funded,
         dem.paid_leave_furloughed,
         dem.paid_leave_returned_work,
         dem.retired,
        
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
 #mutate_if(is.numeric, ~na_if(., -99)) %>%
  #mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
 # mutate_if(is.factor, ~na_if(., "Don't know")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(dem.ramp.followupa.raw.id)
# Inspect colnames
colnames(dem.ramp.followupa.raw.id)
#Differences
dim(dem.ramp.followupa.raw.id)[1]-dim(dem.ramp.followupa.raw)[1]
}
```

# Demographics follow up B
## RAMP
### Read in data 
```{r Read in data RAMP follow up B demographics} 
if(RAMP == TRUE) {
  
dem.ramp.followupb.raw <- readRDS(file = "../data_raw/ramp/dem_ramp_followupb.rds")
dim(dem.ramp.followupb.raw)
colnames(dem.ramp.followupb.raw)
}
  
```

Select variables RAMP follow up B demographics
```{r Select variables RAMP follow up B demographics}
if(RAMP == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate_waves",
                  "endDate")

dem.ramp.followupb.raw.id <- dem.ramp.followupb.raw %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  #distinct(externalDataReference, .keep_all = TRUE) %>% # Remove duplicates based on ID
  #separate(externalDataReference, into = c("Sample", "ID"), sep = 4) %>% # Split ID in Sample and Number
  #mutate(externalDataReference = as.numeric(externalDataReference)) %>%
  add_column(cohort_name = "ramp", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         startDate_waves = startDate,
         #endDate,
         dem.nothing_has_changed,                                     
         dem.living_situation,
         dem.employment,
         dem.physical_health,
         dem.health_of_a_relative,
         dem.household_employment_status_key,
         dem.children__dependants_returning_to_school__other_education,
         dem.living_alone,
         dem.living_with_partner_or_spouse,
         dem.living_with_housemates,
         dem.age_children_living,
         dem.age_children_living.1,
         dem.living_with_other_members_of_my_family,
         dem.spouse_partner_members_living,
         dem.staying_live,
         dem.staying_live.1,
         dem.prefer_not_to_say,
         dem.made_redundant,
         dem.became_unemployed,
         dem.reduction_in_hours,
         dem.reduction_in_salary,
         dem.benefits_increased,
         dem.benefits_decreased,
         dem.change_in_duties_or_responsibilites,
         dem.became_employed,
         dem.increased_hours,
         dem.increased_salary,
         dem.furloughed_or_paid_leave_government_funded,
         dem.furloughed_or_paid_leave_company_funded,
         dem.paid_leave_furloughed,
         dem.paid_leave_returned_work,
         dem.retired,
        
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
 #mutate_if(is.numeric, ~na_if(., -99)) %>%
  #mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
 # mutate_if(is.factor, ~na_if(., "Don't know")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(dem.ramp.followupb.raw.id)
# Inspect colnames
colnames(dem.ramp.followupb.raw.id)
#Differences
dim(dem.ramp.followupb.raw)[1]-dim(dem.ramp.followupb.raw.id)[1]
}
```

# Demographics follow up A first two phases
## COPING
### Read in data 
```{r Read in data COPING follow up A demographics first two phases}
if(COPING == TRUE) {
  
coping.dem.followupa.raw <- readRDS(file = "../data_raw/coping/dem_coping_followupa.rds")
dim(coping.dem.followupa.raw)
colnames(coping.dem.followupa.raw)
}
  
```

Select variables COPING follow up A demographics
```{r Select variables COPING follow up A demographics first two phases}
if(COPING == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate_waves",
                  "endDate")

coping.dem.followupa.raw.id.1 <- coping.dem.followupa.raw %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  #distinct(externalDataReference, .keep_all = TRUE) %>% # Remove duplicates based on ID
  #separate(externalDataReference, into = c("Sample", "ID"), sep = 4) %>% # Split ID in Sample and Number
  #mutate(externalDataReference = as.numeric(externalDataReference)) %>%
  add_column(cohort_name = "coping", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         startDate_waves = startDate,
         #endDate,
         dem.nothing_has_changed,                                     
         dem.living_situation,
         dem.employment,
         dem.physical_health,
         dem.health_of_a_relative,
         dem.household_employment_status_key,
         dem.children__dependants_returning_to_school__other_education,
         dem.living_alone,
         dem.living_with_partner_or_spouse,
         dem.living_with_housemates,
         dem.age_children_living,
         dem.age_children_living.1,
         dem.living_with_other_members_of_my_family,
         dem.spouse_partner_members_living,
         dem.staying_live,
         dem.staying_live.1,
         dem.prefer_not_to_say,
         dem.made_redundant,
         dem.became_unemployed,
         dem.reduction_in_hours,
         dem.reduction_in_salary,
         dem.benefits_increased,
         dem.benefits_decreased,
         dem.change_in_duties_or_responsibilites,
         dem.became_employed,
         dem.increased_hours,
         dem.increased_salary,
         dem.furloughed_or_paid_leave_government_funded,
         dem.furloughed_or_paid_leave_company_funded,
         dem.paid_leave_furloughed,
         dem.paid_leave_returned_work,
         dem.retired,
        
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
 #mutate_if(is.numeric, ~na_if(., -99)) %>%
  #mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
 # mutate_if(is.factor, ~na_if(., "Don't know")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(coping.dem.followupa.raw.id.1)
# Inspect colnames
colnames(coping.dem.followupa.raw.id.1)
#Differences
dim(coping.dem.followupa.raw.id.1)[1]-dim(coping.dem.followupa.raw)[1]
}
```

# Demographics follow up A subsequent phases
## COPING
### Read in data 
```{r Read in data COPING follow up A demographics subsequent phases}
if(COPING == TRUE) {
  
coping.dem.followupa.ongoing.raw <- readRDS(file = "../data_raw/coping/dem_coping_followupa_ongoing.rds")
dim(coping.dem.followupa.ongoing.raw)
colnames(coping.dem.followupa.ongoing.raw)
}
  
```

Select variables COPING follow up B demographics
```{r Select variables COPING follow up A demographics subsequent phases}
if(COPING == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate_waves",
                  "endDate")

coping.dem.followupa.ongoing.raw.id <- coping.dem.followupa.ongoing.raw %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  #distinct(externalDataReference, .keep_all = TRUE) %>% # Remove duplicates based on ID
  #separate(externalDataReference, into = c("Sample", "ID"), sep = 4) %>% # Split ID in Sample and Number
  #mutate(externalDataReference = as.numeric(externalDataReference)) %>%
  add_column(cohort_name = "coping", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         startDate_waves = startDate,
         #endDate,
         dem.nothing_has_changed,                                     
         dem.living_situation,
         dem.employment,
         dem.physical_health,
         dem.health_of_a_relative,
         dem.household_employment_status_key,
         dem.children__dependants_returning_to_school__other_education,
         dem.living_alone,
         dem.living_with_partner_or_spouse,
         dem.living_with_housemates,
         dem.age_children_living,
         dem.age_children_living.1,
         dem.living_with_other_members_of_my_family,
         dem.spouse_partner_members_living,
         dem.staying_live,
         dem.staying_live.1,
         dem.prefer_not_to_say,
         dem.made_redundant,
         dem.became_unemployed,
         dem.reduction_in_hours,
         dem.reduction_in_salary,
         dem.benefits_increased,
         dem.benefits_decreased,
         dem.change_in_duties_or_responsibilites,
         dem.became_employed,
         dem.increased_hours,
         dem.increased_salary,
         dem.furloughed_or_paid_leave_government_funded,
         dem.furloughed_or_paid_leave_company_funded,
         dem.paid_leave_furloughed,
         dem.paid_leave_returned_work,
         dem.retired,
        
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
 #mutate_if(is.numeric, ~na_if(., -99)) %>%
  #mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
 # mutate_if(is.factor, ~na_if(., "Don't know")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(coping.dem.followupa.ongoing.raw.id)
# Inspect colnames
colnames(coping.dem.followupa.ongoing.raw.id)
#Differences
dim(coping.dem.followupa.ongoing.raw)[1]-dim(coping.dem.followupa.ongoing.raw.id)[1]
}
```

Combine demographics COPING follow up A datasets 
```{r Combine demographics COPING follow up A datasets}
if(COPING == TRUE){
    coping.dem.followupa.raw.id <- rbind(coping.dem.followupa.raw.id.1,
                                         coping.dem.followupa.ongoing.raw.id) 
# Inspect dimensions
  dim(coping.dem.followupa.raw.id)
# Inspect colnames
  colnames(coping.dem.followupa.raw.id)
}
```

# Demographics follow up B
## COPING
### Read in data 
```{r Read in data COPING follow up B demographics}
if(COPING == TRUE) {
  
coping.dem.followupb.raw <- readRDS(file = "../data_raw/coping/dem_coping_followupb.rds")
dim(coping.dem.followupb.raw)
colnames(coping.dem.followupb.raw)
}
  
```

Select variables COPING follow up B demographics
```{r Select variables COPING follow up B demographics}
if(COPING == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate_waves",
                  "endDate")

coping.dem.followupb.raw.id <- coping.dem.followupb.raw %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  #distinct(externalDataReference, .keep_all = TRUE) %>% # Remove duplicates based on ID
  #separate(externalDataReference, into = c("Sample", "ID"), sep = 4) %>% # Split ID in Sample and Number
  #mutate(externalDataReference = as.numeric(externalDataReference)) %>%
  add_column(cohort_name = "coping", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         startDate_waves = startDate,
         #endDate,
         dem.nothing_has_changed,                                     
         dem.living_situation,
         dem.employment,
         dem.physical_health,
         dem.health_of_a_relative,
         dem.household_employment_status_key,
         dem.children__dependants_returning_to_school__other_education,
         dem.living_alone,
         dem.living_with_partner_or_spouse,
         dem.living_with_housemates,
         dem.age_children_living,
         dem.age_children_living.1,
         dem.living_with_other_members_of_my_family,
         dem.spouse_partner_members_living,
         dem.staying_live,
         dem.staying_live.1,
         dem.prefer_not_to_say,
         dem.made_redundant,
         dem.became_unemployed,
         dem.reduction_in_hours,
         dem.reduction_in_salary,
         dem.benefits_increased,
         dem.benefits_decreased,
         dem.change_in_duties_or_responsibilites,
         dem.became_employed,
         dem.increased_hours,
         dem.increased_salary,
         dem.furloughed_or_paid_leave_government_funded,
         dem.furloughed_or_paid_leave_company_funded,
         dem.paid_leave_furloughed,
         dem.paid_leave_returned_work,
         dem.retired,
        
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
 #mutate_if(is.numeric, ~na_if(., -99)) %>%
  #mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
 # mutate_if(is.factor, ~na_if(., "Don't know")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(coping.dem.followupb.raw.id)
# Inspect colnames
colnames(coping.dem.followupb.raw.id)
#Differences
dim(coping.dem.followupb.raw)[1]-dim(coping.dem.followupb.raw.id)[1]
}
```

# Losing someone due to COVID 
## GLAD
### Read in data
```{r Read in data GLAD losing someone due to COVID}
if(GLAD == TRUE) {
glad.loss.baseline.raw <- readRDS(file = "../data_raw/glad/grief_coping_glad.rds")
dim(glad.loss.baseline.raw)
colnames(glad.loss.baseline.raw)
}
  
```

Select variables GLAD losing someone due to COVID
```{r Select variables GLAD losing someone due to COVID} 
if(GLAD == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "endDate")
glad.loss.baseline.raw.id <- glad.loss.baseline.raw %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  #distinct(externalDataReference, .keep_all = TRUE) %>% # Remove duplicates based on ID
  #separate(externalDataReference, into = c("Sample", "ID"), sep = 4) %>% # Split ID in Sample and Number
  #mutate(externalDataReference = as.numeric(externalDataReference)) %>%
  add_column(cohort_name = "coping_glad", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
       grief.covid_lost_due_close,
       grief.suffered_past_month_loss
       
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
 #mutate_if(is.numeric, ~na_if(., -99)) %>%
  #mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
 # mutate_if(is.factor, ~na_if(., "Don't know")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))
# Inspect dimensions
dim(glad.loss.baseline.raw.id)
# Inspect colnames
colnames(glad.loss.baseline.raw.id)
#Differences
dim(glad.loss.baseline.raw.id)[1]-dim(glad.loss.baseline.raw)[1]
}
```

# Losing someone due to COVID 
## EDGI
### Read in data
```{r Read in dat EDGI losing someone due to COVID}
if(EDGI == TRUE) {
edgi.loss.baseline.raw <- readRDS(file = "../data_raw/edgi/grief_coping_edgi.rds")
dim(edgi.loss.baseline.raw)
colnames(edgi.loss.baseline.raw)
}
```

Select variables
```{r Select variables EDGI losing someone due to COVID}
if(EDGI == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "endDate")
edgi.loss.baseline.raw.id <- edgi.loss.baseline.raw %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  #distinct(externalDataReference, .keep_all = TRUE) %>% # Remove duplicates based on ID
  #separate(externalDataReference, into = c("Sample", "ID"), sep = 4) %>% # Split ID in Sample and Number
  #mutate(externalDataReference = as.numeric(externalDataReference)) %>%
  add_column(cohort_name = "coping_edgi", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
       grief.covid_lost_due_close = grief.covid_due_lost_past,
       grief.suffered_past_month_loss = grief.significant_relationship_suffered_loss
       
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
 #mutate_if(is.numeric, ~na_if(., -99)) %>%
  #mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
 # mutate_if(is.factor, ~na_if(., "Don't know")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))
# Inspect dimensions
dim(edgi.loss.baseline.raw.id)
# Inspect colnames
colnames(edgi.loss.baseline.raw.id)
#Differences
dim(edgi.loss.baseline.raw.id)[1]-dim(edgi.loss.baseline.raw)[1]
}
```

# Losing someone due to COVID 
## NBR
### Read in data
```{r Read in dat NBR losing someone due to COVID}
if(NBR == TRUE) {
nbr.loss.baseline.raw<- readRDS(file = "../data_raw/nbr/grief_coping_nbr.rds")
dim(nbr.loss.baseline.raw)
colnames(nbr.loss.baseline.raw)
}
```

Select variables NBR losing someone due to COVID
```{r Select variables NBR losing someone due to COVID}
if(NBR == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "endDate")
nbr.loss.baseline.raw.id <- nbr.loss.baseline.raw %>% #new dataset with ID
  drop_na(subjectid) %>% # Drop NAs
  #distinct(externalDataReference, .keep_all = TRUE) %>% # Remove duplicates based on ID
  #separate(externalDataReference, into = c("Sample", "ID"), sep = 4) %>% # Split ID in Sample and Number
  #mutate(externalDataReference = as.numeric(externalDataReference)) %>%
  add_column(cohort_name = "nbr", .before = "startDate") %>% #create new column 
  select(
         ID = subjectid, # ID
         cohort_name, # Sample
       grief.covid_lost_due_close,
       grief.suffered_past_month_loss = grief.significant_relationship_suffered_past
       
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
 #mutate_if(is.numeric, ~na_if(., -99)) %>%
  #mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
 # mutate_if(is.factor, ~na_if(., "Don't know")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))
# Inspect dimensions
dim(nbr.loss.baseline.raw.id)
# Inspect colnames
colnames(nbr.loss.baseline.raw.id)
#Differences
dim(nbr.loss.baseline.raw.id)[1]-dim(nbr.loss.baseline.raw)[1]
}
```

# Losing someone due to COVID 
## RAMP
### Read in data
```{r Read in data RAMP losing someone due to COVID}
if(RAMP == TRUE) {
ramp.loss.baseline.raw<- readRDS(file = "../data_raw/ramp/grief_ramp.rds")
dim(ramp.loss.baseline.raw)
colnames(ramp.loss.baseline.raw)
}
```

Select variables RAMP losing someone due to COVID
```{r RAMP losing somone due to COVID baseline select variables}
if(RAMP == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "endDate")
ramp.loss.baseline.raw.id <- ramp.loss.baseline.raw %>% #new dataset with ID
  drop_na(`Login ID`) %>% # Drop NAs
  #distinct(externalDataReference, .keep_all = TRUE) %>% # Remove duplicates based on ID
  #separate(externalDataReference, into = c("Sample", "ID"), sep = 4) %>% # Split ID in Sample and Number
  #mutate(externalDataReference = as.numeric(externalDataReference)) %>%
  add_column(cohort_name = "ramp", .before = "startDate") %>% #create new column 
  select(
         ID = `Login ID`, # ID
         cohort_name, # Sample
       grief.covid_lost_due_close,
       grief.suffered_past_month_loss = grief.significant_relationship_suffered_past
       
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
 #mutate_if(is.numeric, ~na_if(., -99)) %>%
  #mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
 # mutate_if(is.factor, ~na_if(., "Don't know")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))
# Inspect dimensions
dim(ramp.loss.baseline.raw.id)
# Inspect colnames
colnames(ramp.loss.baseline.raw.id)
#Differences
dim(ramp.loss.baseline.raw.id)[1]-dim(ramp.loss.baseline.raw)[1]
}
```

# Losing someone due to COVID - follow up
## COPING 
### Read in data
```{r Read in data losing someone due to COVID COPING follow up}
if(COPING == TRUE) {
  coping.loss.followupb.raw <- readRDS(file = "../data_raw/coping/grief_coping_followupb.rds")
dim(coping.loss.followupb.raw)
colnames(coping.loss.followupb.raw)
}
  
```

Select variables losing someone due to COVID COPING follow up
```{r Select variables losing someone due to COVID COPING follow up}
if(COPING == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate_waves",
                  "endDate")
coping.loss.followupb.raw.id <- coping.loss.followupb.raw %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  #distinct(externalDataReference, .keep_all = TRUE) %>% # Remove duplicates based on ID
  #separate(externalDataReference, into = c("Sample", "ID"), sep = 4) %>% # Split ID in Sample and Number
  #mutate(externalDataReference = as.numeric(externalDataReference)) %>%
  add_column(cohort_name = "coping", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         startDate_waves = startDate,
         #endDate,
         grief.due_past_month_lost,
         grief.suffered_past_month_loss
        
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
 #mutate_if(is.numeric, ~na_if(., -99)) %>%
  #mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
 # mutate_if(is.factor, ~na_if(., "Don't know")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))
# Inspect dimensions
dim(coping.loss.followupb.raw.id)
# Inspect colnames
colnames(coping.loss.followupb.raw.id)
#Differences
dim(coping.loss.followupb.raw.id)[1]-dim(coping.loss.followupb.raw)[1]
}
```

# Losing someone due to COVID - follow up
## RAMP 
### Read in data
```{r Read in data losing someone due to RAMP COPING follow up}
if(RAMP == TRUE) {
  
ramp.loss.followupb.raw <- readRDS(file = "../data_raw/ramp/grief_ramp_followupb.rds")
dim(ramp.loss.followupb.raw)
colnames(ramp.loss.followupb.raw)
}
  
```

Select variables losing someone due to RAMP COPING follow up
```{r Select variables losing someone due to RAMP COPING follow up}
if(RAMP == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate_waves",
                  "endDate")
ramp.loss.followupb.raw.id <- ramp.loss.followupb.raw %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  #distinct(externalDataReference, .keep_all = TRUE) %>% # Remove duplicates based on ID
  #separate(externalDataReference, into = c("Sample", "ID"), sep = 4) %>% # Split ID in Sample and Number
  #mutate(externalDataReference = as.numeric(externalDataReference)) %>%
  add_column(cohort_name = "ramp", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
         startDate_waves = startDate,
         #endDate,
         grief.due_past_month_lost = grief.due_past_month_covid,
         grief.suffered_past_month_loss = grief.loss_suffered_past_month
        
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
 #mutate_if(is.numeric, ~na_if(., -99)) %>%
  #mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
 # mutate_if(is.factor, ~na_if(., "Don't know")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))
# Inspect dimensions
dim(ramp.loss.followupb.raw.id)
# Inspect colnames
colnames(ramp.loss.followupb.raw.id)
#Differences
dim(ramp.loss.followupb.raw.id)[1]-dim(ramp.loss.followupb.raw)[1]
}
```

# Loneliness at baseline
## GLAD
### Read in data
```{r Read in data GLAD loneliness at baseline}
if(GLAD == TRUE) {
glad.loneliness.baseline.raw <- readRDS(file = "../data_raw/glad/lone_coping_glad.rds")
dim(glad.loneliness.baseline.raw)
colnames(glad.loneliness.baseline.raw)
}
```

Select variables GLAD loneliness at baseline
```{r Select variables GLAD loneliness at baseline}
if(GLAD == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "endDate")
glad.loneliness.baseline.raw.id <- glad.loneliness.baseline.raw %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  #distinct(externalDataReference, .keep_all = TRUE) %>% # Remove duplicates based on ID
  #separate(externalDataReference, into = c("Sample", "ID"), sep = 4) %>% # Split ID in Sample and Number
  #mutate(externalDataReference = as.numeric(externalDataReference)) %>%
  add_column(cohort_name = "coping_glad", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
        lone.felt_that_you_lack_companionship,
        lone.felt_left_out,
        lone.felt_isolated_from_others,
        lone.felt_alone,lone.similar_felt_pandemic,
        lone.felt_that_you_lack_companionship.1,
        lone.felt_left_out.1,
        lone.felt_isolated_from_others.1,
        lone.felt_alone.1
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
 #mutate_if(is.numeric, ~na_if(., -99)) %>%
  #mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
 # mutate_if(is.factor, ~na_if(., "Don't know")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))
# Inspect dimensions
dim(glad.loneliness.baseline.raw.id)
# Inspect colnames
colnames(glad.loneliness.baseline.raw.id)
#Differences
dim(glad.loneliness.baseline.raw)[1]-dim(glad.loneliness.baseline.raw.id)[1]
}
```

# Loneliness at baseline
## EDGI
### Read in data
```{r Read in data EDGI loneliness at baseline}
if(EDGI == TRUE) {
edgi.loneliness.baseline.raw <- readRDS(file = "../data_raw/edgi/lone_coping_edgi.rds")
dim(edgi.loneliness.baseline.raw)
colnames(edgi.loneliness.baseline.raw)
}
  
```

Select variables EDGI loneliness at baseline
```{r Select variables EDGI loneliness at baseline}
if(EDGI == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "endDate")
edgi.loneliness.baseline.raw.id <- edgi.loneliness.baseline.raw %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  #distinct(externalDataReference, .keep_all = TRUE) %>% # Remove duplicates based on ID
  #separate(externalDataReference, into = c("Sample", "ID"), sep = 4) %>% # Split ID in Sample and Number
  #mutate(externalDataReference = as.numeric(externalDataReference)) %>%
  add_column(cohort_name = "coping_edgi", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
         cohort_name, # Sample
        lone.felt_that_you_lack_companionship,
        lone.felt_left_out,
        lone.felt_isolated_from_others,
        lone.felt_alone,lone.similar_felt_pandemic,
        lone.felt_that_you_lack_companionship.1,
        lone.felt_left_out.1,
        lone.felt_isolated_from_others.1,
        lone.felt_alone.1
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
 #mutate_if(is.numeric, ~na_if(., -99)) %>%
  #mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
 # mutate_if(is.factor, ~na_if(., "Don't know")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))
# Inspect dimensions
dim(edgi.loneliness.baseline.raw.id)
# Inspect colnames
colnames(edgi.loneliness.baseline.raw.id)
#Differences
dim(edgi.loneliness.baseline.raw.id)[1]-dim(edgi.loneliness.baseline.raw.id)[1]
}
```

# Loneliness at baseline
## RAMP
### Read in data
```{r Read in data RAMP loneliness at baseline}
if(RAMP == TRUE) {
  ramp.loneliness.baseline.raw <- readRDS(file = "../data_raw/ramp/lone_ramp.rds")
dim(ramp.loneliness.baseline.raw)
colnames(ramp.loneliness.baseline.raw)
}
  
```

Select variables RAMP loneliness at baseline
```{r Select variables RAMP loneliness at baseline}
if(RAMP == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "endDate")
ramp.loneliness.baseline.raw.id <- ramp.loneliness.baseline.raw %>% #new dataset with ID
  drop_na(`Login ID`) %>% # Drop NAs
  #distinct(externalDataReference, .keep_all = TRUE) %>% # Remove duplicates based on ID
  #separate(externalDataReference, into = c("Sample", "ID"), sep = 4) %>% # Split ID in Sample and Number
  #mutate(externalDataReference = as.numeric(externalDataReference)) %>%
  add_column(cohort_name = "ramp", .before = "startDate") %>% #create new column 
  select(
         ID = `Login ID`, # ID
         cohort_name, # Sample
        lone.felt_that_you_lack_companionship,
        lone.felt_left_out,
        lone.felt_isolated_from_others,
        lone.felt_alone,lone.similar_felt_pandemic,
        lone.felt_that_you_lack_companionship.1,
        lone.felt_left_out.1,
        lone.felt_isolated_from_others.1,
        lone.felt_alone.1
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
 #mutate_if(is.numeric, ~na_if(., -99)) %>%
  #mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
 # mutate_if(is.factor, ~na_if(., "Don't know")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))
# Inspect dimensions
dim(ramp.loneliness.baseline.raw.id)
# Inspect colnames
colnames(ramp.loneliness.baseline.raw.id)
#Differences
dim(ramp.loneliness.baseline.raw.id)[1]-dim(ramp.loneliness.baseline.raw)[1]
}
```

# Loneliness at baseline
## NBR
### Read in data
```{r Read in data NBR loneliness at baseline}
if(NBR == TRUE) {
  nbr.loneliness.baseline.raw <- readRDS(file = "../data_raw/nbr/lone_coping_nbr.rds")
dim(nbr.loneliness.baseline.raw)
colnames(nbr.loneliness.baseline.raw)
}
  
```

Select variables NBR loneliness at baseline
```{r Select variables NBR loneliness at baseline}
if(NBR == TRUE){
exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "endDate")
nbr.loneliness.baseline.raw.id <- nbr.loneliness.baseline.raw %>% #new dataset with ID
  drop_na(subjectid) %>% # Drop NAs
  #distinct(externalDataReference, .keep_all = TRUE) %>% # Remove duplicates based on ID
  #separate(externalDataReference, into = c("Sample", "ID"), sep = 4) %>% # Split ID in Sample and Number
  #mutate(externalDataReference = as.numeric(externalDataReference)) %>%
  add_column(cohort_name = "nbr", .before = "startDate") %>% #create new column 
  select(
         ID = subjectid, # ID
         cohort_name, # Sample
        lone.felt_that_you_lack_companionship,
        lone.felt_left_out,
        lone.felt_isolated_from_others,
        lone.felt_alone,lone.similar_felt_pandemic,
        lone.felt_that_you_lack_companionship.1,
        lone.felt_left_out.1,
        lone.felt_isolated_from_others.1,
        lone.felt_alone.1
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
 #mutate_if(is.numeric, ~na_if(., -99)) %>%
  #mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
 # mutate_if(is.factor, ~na_if(., "Don't know")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))
# Inspect dimensions
dim(nbr.loneliness.baseline.raw.id)
# Inspect colnames
colnames(nbr.loneliness.baseline.raw.id)
#Differences
dim(nbr.loneliness.baseline.raw)[1]-dim(nbr.loneliness.baseline.raw.id)[1]
}
```


# CLEANING DEMOGRAPHICS 

GENDER - Source script for synchronising gender categories - GLAD, EDGI, NBR
RAMP has the correct Gender categories so does not need editing.
```{r Gender source script}
if(GLAD == TRUE | EDGI == TRUE | NBR == TRUE) {
source("./gender_glad_edgi_nbr.R")
}
```

ETHNICITY
```{r Ethnicity source script}
if(GLAD == TRUE | EDGI == TRUE | NBR == TRUE | RAMP == TRUE) {
source("./ethnicity_ALLdatasets.R")
}
```

1. AGE AT SIGN UP (i.e., EDGI and GLAD signup not COPING questionnaire)

Source script for CREATING AGE variable in nbr (age_unc),cleaning it (in all datasets), and categorising it (nbr, edgi, glad - to match ramp)
```{r Age at sign-up source script}
if(NBR == TRUE | EDGI == TRUE | GLAD == TRUE | RAMP == TRUE) {
source("./age_signup_ALLdatasets.R")
}

```

2. AGE AT COVID ASSESSMENT (i.e., EDGI and GLAD COPING baseline questionnaire NOT GLAD/EDGI signup)
For RAMP and NBR, can just use age at signup (this is effectively their COVID baseline)
```{r Age at COVID assessment}
if(NBR == TRUE | EDGI == TRUE | GLAD == TRUE | RAMP == TRUE) {
source("./age_at_COVID_assessment_ALLdatasets.R")
}

```

EDUCATION
Script for recoding highest education received, prepandemic (EDGI, GLAD) and baseline (EDGI, GLAD, NBR, RAMP)
```{r Education source script}
if(NBR == TRUE | EDGI == TRUE | GLAD == TRUE | RAMP == TRUE) {
source("./education_ALLdatasets.R")
}

```

EMPLOYMENT
Script for recoding employment and key worker status
```{r Employment and key worker status source script}
if(NBR == TRUE | EDGI == TRUE | GLAD == TRUE | RAMP == TRUE) {
source("./employment_ALLdatasets.R")
}
```

MENTAL HEALTH DIAGNOSIS
Script for recoding/grouping mental health diagnoses
```{r Mental health diagnosis source script}
if(NBR == TRUE | EDGI == TRUE | GLAD == TRUE | RAMP == TRUE) {
source("./mental_health_diagnosis_ALLdatasets.R")
}
```

CONTROLS
Script for recoding/grouping controls
```{r Controls source script}
if(NBR == TRUE | EDGI == TRUE | GLAD == TRUE | RAMP == TRUE) {
source("./Controls.R")
}
```

# TIMEPOINTS / PHASES - RAMP Demographics

Create phase columns in follow up data - RAMP
```{r Identify phases source script RAMP}
if (RAMP ==TRUE) {
source("./timepoints_RAMP.R")
}
```

Join TAF follow ups (RAMP)
```{r Merge RAMP follow up data demographics}
if(RAMP == TRUE) {
dat.raw.dem.ramp.followup <- rbind(dem.ramp.followupa.raw.id,
    dem.ramp.followupb.raw.id)

#check column names
colnames(dat.raw.dem.ramp.followup)
}
```

Checking for number of entries per phase
```{r Check number of entries per phase RAMP demographics}
if(RAMP == TRUE) {

dat.raw.dem.ramp.followup %>%
  group_by(wave_dem) %>%
  count()

}
```

Identify duplicate IDs in a single timepoint
```{r Identify duplicate IDs in a single timepoint RAMP demographics}
if(RAMP == TRUE) {

##Identify dup IDs in a single wave 
dat.raw.dem.ramp.followup %>%
   group_by(wave_dem, ID) %>%
   summarize(N = n()) %>%
   filter(N > 1)
}
```


FOR NOW - Want the LATER data entry from people who answered twice within a single phase 

Later on - want to create variable with 'answered YES at least once' (i.e., include these entries)

[want ID AND wave to be unique]
```{r Later date entry twice in single phase RAMP demographics}
if(RAMP == TRUE) {

 ##FOLLOW UP A
##confirm number of rows in current dataset 
nrow(dat.raw.dem.ramp.followup)

#Filter out duplicated IDs AND wave, keeping the LAST entry
dat.raw.dem.ramp.followup <- dat.raw.dem.ramp.followup %>% 
    group_by(ID) %>% 
    filter(!duplicated(wave_dem,
                      fromLast = TRUE)
           )

##confirm number of rows in dataset after filtering 
nrow(dat.raw.dem.ramp.followup)
}
```

Change follow up RAMP demographics to wide format
```{r RAMP demographics wide format}
if(RAMP == TRUE) {
dat.raw.dem.ramp.followup <- dat.raw.dem.ramp.followup %>%
  group_by(wave_dem) %>%
  mutate(row = row_number()) %>%
  tidyr::pivot_wider(id_cols = ID,
    names_from = wave_dem, 
                     values_from = c(
                      dem.nothing_has_changed,                                     
         dem.living_situation,
         dem.employment,
         dem.physical_health,
         dem.health_of_a_relative,
         dem.household_employment_status_key,
         dem.children__dependants_returning_to_school__other_education,
         dem.living_alone,
         dem.living_with_partner_or_spouse,
         dem.living_with_housemates,
         dem.age_children_living,
         dem.age_children_living.1,
         dem.living_with_other_members_of_my_family,
         dem.spouse_partner_members_living,
         dem.staying_live,
         dem.staying_live.1,
         dem.prefer_not_to_say,
         dem.made_redundant,
         dem.became_unemployed,
         dem.reduction_in_hours,
         dem.reduction_in_salary,
         dem.benefits_increased,
         dem.benefits_decreased,
         dem.change_in_duties_or_responsibilites,
         dem.became_employed,
         dem.increased_hours,
         dem.increased_salary,
         dem.furloughed_or_paid_leave_government_funded,
         dem.furloughed_or_paid_leave_company_funded,
         dem.paid_leave_furloughed,
         dem.paid_leave_returned_work,
         dem.retired )) 
  
}

```

Select variables for dataset RAMP demographics
```{r Select variables for dataset RAMP demographics}
if(RAMP == TRUE) {
dat.raw.dem.ramp.followup <- dat.raw.dem.ramp.followup %>%
  select(ID,
         `dem.nothing_has_changed_.Wave_1a`,
         `dem.nothing_has_changed_.Wave_1b`,
         `dem.nothing_has_changed_.Wave_2a`,
         `dem.nothing_has_changed_.Wave_2b`,
         `dem.nothing_has_changed_.Wave_3a`,
         `dem.nothing_has_changed_.Wave_3b`,
         `dem.nothing_has_changed_.Wave_4a`,
         `dem.nothing_has_changed_.Wave_4b`,
         `dem.nothing_has_changed_.Wave_5a`,
         `dem.nothing_has_changed_.Wave_6b`,
         `dem.nothing_has_changed_.Wave_7a`,
         `dem.nothing_has_changed_.Wave_8b`,
         `dem.nothing_has_changed_.Wave_9a`,
         `dem.nothing_has_changed_.Wave_10b`,
         `dem.nothing_has_changed_.Wave_11a`,
         `dem.nothing_has_changed_.Wave_12b`,
         
         `dem.living_situation_.Wave_1a`,
         `dem.living_situation_.Wave_1b`,
         `dem.living_situation_.Wave_2a`,
         `dem.living_situation_.Wave_2b`,
         `dem.living_situation_.Wave_3a`,
         `dem.living_situation_.Wave_3b`,
         `dem.living_situation_.Wave_4a`,
         `dem.living_situation_.Wave_4b`,
         `dem.living_situation_.Wave_5a`,
         `dem.living_situation_.Wave_6b`,
         `dem.living_situation_.Wave_7a`,
         `dem.living_situation_.Wave_8b`,
         `dem.living_situation_.Wave_9a`,
         `dem.living_situation_.Wave_10b`,
         `dem.living_situation_.Wave_11a`,
         `dem.living_situation_.Wave_12b`,
         
          
         `dem.employment_.Wave_1a`,
         `dem.employment_.Wave_1b`,
         `dem.employment_.Wave_2a`,
         `dem.employment_.Wave_2b`,
         `dem.employment_.Wave_3a`,
         `dem.employment_.Wave_3b`,
         `dem.employment_.Wave_4a`,
         `dem.employment_.Wave_4b`,
         `dem.employment_.Wave_5a`,
         `dem.employment_.Wave_6b`,
         `dem.employment_.Wave_7a`,
         `dem.employment_.Wave_8b`,
         `dem.employment_.Wave_9a`,
         `dem.employment_.Wave_10b`,
         `dem.employment_.Wave_11a`,
         `dem.employment_.Wave_12b`,
         
         `dem.physical_health_.Wave_1a`,
         `dem.physical_health_.Wave_1b`,
         `dem.physical_health_.Wave_2a`,
         `dem.physical_health_.Wave_2b`,
         `dem.physical_health_.Wave_3a`,
         `dem.physical_health_.Wave_3b`,
         `dem.physical_health_.Wave_4a`,
         `dem.physical_health_.Wave_4b`,
         `dem.physical_health_.Wave_5a`,
         `dem.physical_health_.Wave_6b`,
         `dem.physical_health_.Wave_7a`,
         `dem.physical_health_.Wave_8b`,
         `dem.physical_health_.Wave_9a`,
         `dem.physical_health_.Wave_10b`,
         `dem.physical_health_.Wave_11a`,
         `dem.physical_health_.Wave_12b`,
         
         `dem.health_of_a_relative_.Wave_1a`,
         `dem.health_of_a_relative_.Wave_1b`,
         `dem.health_of_a_relative_.Wave_2a`,
         `dem.health_of_a_relative_.Wave_2b`,
         `dem.health_of_a_relative_.Wave_3a`,
         `dem.health_of_a_relative_.Wave_3b`,
         `dem.health_of_a_relative_.Wave_4a`,
         `dem.health_of_a_relative_.Wave_4b`,
         `dem.health_of_a_relative_.Wave_5a`,
         `dem.health_of_a_relative_.Wave_6b`,
         `dem.health_of_a_relative_.Wave_7a`,
         `dem.health_of_a_relative_.Wave_8b`,
         `dem.health_of_a_relative_.Wave_9a`,
         `dem.health_of_a_relative_.Wave_10b`,
         `dem.health_of_a_relative_.Wave_11a`,
         `dem.health_of_a_relative_.Wave_12b`,
         
         `dem.household_employment_status_key_.Wave_1a`,
         `dem.household_employment_status_key_.Wave_1b`,
         `dem.household_employment_status_key_.Wave_2a`,
         `dem.household_employment_status_key_.Wave_2b`,
         `dem.household_employment_status_key_.Wave_3a`,
         `dem.household_employment_status_key_.Wave_3b`,
         `dem.household_employment_status_key_.Wave_4a`,
         `dem.household_employment_status_key_.Wave_4b`,
         `dem.household_employment_status_key_.Wave_5a`,
         `dem.household_employment_status_key_.Wave_6b`,
         `dem.household_employment_status_key_.Wave_7a`,
         `dem.household_employment_status_key_.Wave_8b`,
         `dem.household_employment_status_key_.Wave_9a`,
         `dem.household_employment_status_key_.Wave_10b`,
         `dem.household_employment_status_key_.Wave_11a`,
         `dem.household_employment_status_key_.Wave_12b`,
         
         `dem.children__dependants_returning_to_school__other_education_.Wave_1a`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_1b`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_2a`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_2b`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_3a`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_3b`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_4a`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_4b`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_5a`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_6b`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_7a`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_8b`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_9a`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_10b`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_11a`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_12b`,
         
         `dem.living_alone_.Wave_1a`,
         `dem.living_alone_.Wave_1b`,
         `dem.living_alone_.Wave_2a`,
         `dem.living_alone_.Wave_2b`,
         `dem.living_alone_.Wave_3a`,
         `dem.living_alone_.Wave_3b`,
         `dem.living_alone_.Wave_4a`,
         `dem.living_alone_.Wave_4b`,
         `dem.living_alone_.Wave_5a`,
         `dem.living_alone_.Wave_6b`,
         `dem.living_alone_.Wave_7a`,
         `dem.living_alone_.Wave_8b`,
         `dem.living_alone_.Wave_9a`,
         `dem.living_alone_.Wave_10b`,
         `dem.living_alone_.Wave_11a`,
         `dem.living_alone_.Wave_12b`,
         
         `dem.living_with_partner_or_spouse_.Wave_1a`,
         `dem.living_with_partner_or_spouse_.Wave_1b`,
         `dem.living_with_partner_or_spouse_.Wave_2a`,
         `dem.living_with_partner_or_spouse_.Wave_2b`,
         `dem.living_with_partner_or_spouse_.Wave_3a`,
         `dem.living_with_partner_or_spouse_.Wave_3b`,
         `dem.living_with_partner_or_spouse_.Wave_4a`,
         `dem.living_with_partner_or_spouse_.Wave_4b`,
         `dem.living_with_partner_or_spouse_.Wave_5a`,
         `dem.living_with_partner_or_spouse_.Wave_6b`,
         `dem.living_with_partner_or_spouse_.Wave_7a`,
         `dem.living_with_partner_or_spouse_.Wave_8b`,
         `dem.living_with_partner_or_spouse_.Wave_9a`,
         `dem.living_with_partner_or_spouse_.Wave_10b`,
         `dem.living_with_partner_or_spouse_.Wave_11a`,
         `dem.living_with_partner_or_spouse_.Wave_12b`,
         
         `dem.living_with_housemates_.Wave_1a`,
         `dem.living_with_housemates_.Wave_1b`,
         `dem.living_with_housemates_.Wave_2a`,
         `dem.living_with_housemates_.Wave_2b`,
         `dem.living_with_housemates_.Wave_3a`,
         `dem.living_with_housemates_.Wave_3b`,
         `dem.living_with_housemates_.Wave_4a`,
         `dem.living_with_housemates_.Wave_4b`,
         `dem.living_with_housemates_.Wave_5a`,
         `dem.living_with_housemates_.Wave_6b`,
         `dem.living_with_housemates_.Wave_7a`,
         `dem.living_with_housemates_.Wave_8b`,
         `dem.living_with_housemates_.Wave_9a`,
         `dem.living_with_housemates_.Wave_10b`,
         `dem.living_with_housemates_.Wave_11a`,
         `dem.living_with_housemates_.Wave_12b`,
         
         `dem.age_children_living_.Wave_1a`,
         `dem.age_children_living_.Wave_1b`,
         `dem.age_children_living_.Wave_2a`,
         `dem.age_children_living_.Wave_2b`,
         `dem.age_children_living_.Wave_3a`,
         `dem.age_children_living_.Wave_3b`,
         `dem.age_children_living_.Wave_4a`,
         `dem.age_children_living_.Wave_4b`,
         `dem.age_children_living_.Wave_5a`,
         `dem.age_children_living_.Wave_6b`,
         `dem.age_children_living_.Wave_7a`,
         `dem.age_children_living_.Wave_8b`,
         `dem.age_children_living_.Wave_9a`,
         `dem.age_children_living_.Wave_10b`,
         `dem.age_children_living_.Wave_11a`,
         `dem.age_children_living_.Wave_12b`,
         
         `dem.age_children_living.1_.Wave_1a`,
         `dem.age_children_living.1_.Wave_1b`,
         `dem.age_children_living.1_.Wave_2a`,
         `dem.age_children_living.1_.Wave_2b`,
         `dem.age_children_living.1_.Wave_3a`,
         `dem.age_children_living.1_.Wave_3b`,
         `dem.age_children_living.1_.Wave_4a`,
         `dem.age_children_living.1_.Wave_4b`,
         `dem.age_children_living.1_.Wave_5a`,
         `dem.age_children_living.1_.Wave_6b`,
         `dem.age_children_living.1_.Wave_7a`,
         `dem.age_children_living.1_.Wave_8b`,
         `dem.age_children_living.1_.Wave_9a`,
         `dem.age_children_living.1_.Wave_10b`,
         `dem.age_children_living.1_.Wave_11a`,
         `dem.age_children_living.1_.Wave_12b`,
         
         `dem.living_with_other_members_of_my_family_.Wave_1a`,
         `dem.living_with_other_members_of_my_family_.Wave_1b`,
         `dem.living_with_other_members_of_my_family_.Wave_2a`,
         `dem.living_with_other_members_of_my_family_.Wave_2b`,
         `dem.living_with_other_members_of_my_family_.Wave_3a`,
         `dem.living_with_other_members_of_my_family_.Wave_3b`,
         `dem.living_with_other_members_of_my_family_.Wave_4a`,
         `dem.living_with_other_members_of_my_family_.Wave_4b`,
         `dem.living_with_other_members_of_my_family_.Wave_5a`,
         `dem.living_with_other_members_of_my_family_.Wave_6b`,
         `dem.living_with_other_members_of_my_family_.Wave_7a`,
         `dem.living_with_other_members_of_my_family_.Wave_8b`,
         `dem.living_with_other_members_of_my_family_.Wave_9a`,
         `dem.living_with_other_members_of_my_family_.Wave_10b`,
         `dem.living_with_other_members_of_my_family_.Wave_11a`,
         `dem.living_with_other_members_of_my_family_.Wave_12b`,
         
         `dem.spouse_partner_members_living_.Wave_1a`,
         `dem.spouse_partner_members_living_.Wave_1b`,
         `dem.spouse_partner_members_living_.Wave_2a`,
         `dem.spouse_partner_members_living_.Wave_2b`,
         `dem.spouse_partner_members_living_.Wave_3a`,
         `dem.spouse_partner_members_living_.Wave_3b`,
         `dem.spouse_partner_members_living_.Wave_4a`,
         `dem.spouse_partner_members_living_.Wave_4b`,
         `dem.spouse_partner_members_living_.Wave_5a`,
         `dem.spouse_partner_members_living_.Wave_6b`,
         `dem.spouse_partner_members_living_.Wave_7a`,
         `dem.spouse_partner_members_living_.Wave_8b`,
         `dem.spouse_partner_members_living_.Wave_9a`,
         `dem.spouse_partner_members_living_.Wave_10b`,
         `dem.spouse_partner_members_living_.Wave_11a`,
         `dem.spouse_partner_members_living_.Wave_12b`,
         
         `dem.staying_live_.Wave_1a`,
         `dem.staying_live_.Wave_1b`,
         `dem.staying_live_.Wave_2a`,
         `dem.staying_live_.Wave_2b`,
         `dem.staying_live_.Wave_3a`,
         `dem.staying_live_.Wave_3b`,
         `dem.staying_live_.Wave_4a`,
         `dem.staying_live_.Wave_4b`,
         `dem.staying_live_.Wave_5a`,
         `dem.staying_live_.Wave_6b`,
         `dem.staying_live_.Wave_7a`,
         `dem.staying_live_.Wave_8b`,
         `dem.staying_live_.Wave_9a`,
         `dem.staying_live_.Wave_10b`,
         `dem.staying_live_.Wave_11a`,
         `dem.staying_live_.Wave_12b`,
         
         `dem.staying_live.1_.Wave_1a`,
         `dem.staying_live.1_.Wave_1b`,
         `dem.staying_live.1_.Wave_2a`,
         `dem.staying_live.1_.Wave_2b`,
         `dem.staying_live.1_.Wave_3a`,
         `dem.staying_live.1_.Wave_3b`,
         `dem.staying_live.1_.Wave_4a`,
         `dem.staying_live.1_.Wave_4b`,
         `dem.staying_live.1_.Wave_5a`,
         `dem.staying_live.1_.Wave_6b`,
         `dem.staying_live.1_.Wave_7a`,
         `dem.staying_live.1_.Wave_8b`,
         `dem.staying_live.1_.Wave_9a`,
         `dem.staying_live.1_.Wave_10b`,
         `dem.staying_live.1_.Wave_11a`,
         `dem.staying_live.1_.Wave_12b`,
   
         `dem.prefer_not_to_say_.Wave_1a`,
         `dem.prefer_not_to_say_.Wave_1b`,
         `dem.prefer_not_to_say_.Wave_2a`,
         `dem.prefer_not_to_say_.Wave_2b`,
         `dem.prefer_not_to_say_.Wave_3a`,
         `dem.prefer_not_to_say_.Wave_3b`,
         `dem.prefer_not_to_say_.Wave_4a`,
         `dem.prefer_not_to_say_.Wave_4b`,
         `dem.prefer_not_to_say_.Wave_5a`,
         `dem.prefer_not_to_say_.Wave_6b`,
         `dem.prefer_not_to_say_.Wave_7a`,
         `dem.prefer_not_to_say_.Wave_8b`,
         `dem.prefer_not_to_say_.Wave_9a`,
         `dem.prefer_not_to_say_.Wave_10b`,
         `dem.prefer_not_to_say_.Wave_11a`,
         `dem.prefer_not_to_say_.Wave_12b`,
         
         
         `dem.made_redundant_.Wave_1a`,
         `dem.made_redundant_.Wave_1b`,
         `dem.made_redundant_.Wave_2a`,
         `dem.made_redundant_.Wave_2b`,
         `dem.made_redundant_.Wave_3a`,
         `dem.made_redundant_.Wave_3b`,
         `dem.made_redundant_.Wave_4a`,
         `dem.made_redundant_.Wave_4b`,
         `dem.made_redundant_.Wave_5a`,
         `dem.made_redundant_.Wave_6b`,
         `dem.made_redundant_.Wave_7a`,
         `dem.made_redundant_.Wave_8b`,
         `dem.made_redundant_.Wave_9a`,
         `dem.made_redundant_.Wave_10b`,
         `dem.made_redundant_.Wave_11a`,
         `dem.made_redundant_.Wave_12b`,
         
         `dem.became_unemployed_.Wave_1a`,
         `dem.became_unemployed_.Wave_1b`,
         `dem.became_unemployed_.Wave_2a`,
         `dem.became_unemployed_.Wave_2b`,
         `dem.became_unemployed_.Wave_3a`,
         `dem.became_unemployed_.Wave_3b`,
         `dem.became_unemployed_.Wave_4a`,
         `dem.became_unemployed_.Wave_4b`,
         `dem.became_unemployed_.Wave_5a`,
         `dem.became_unemployed_.Wave_6b`,
         `dem.became_unemployed_.Wave_7a`,
         `dem.became_unemployed_.Wave_8b`,
         `dem.became_unemployed_.Wave_9a`,
         `dem.became_unemployed_.Wave_10b`,
         `dem.became_unemployed_.Wave_11a`,
         `dem.became_unemployed_.Wave_12b`,
         
         `dem.reduction_in_hours_.Wave_1a`,
         `dem.reduction_in_hours_.Wave_1b`,
         `dem.reduction_in_hours_.Wave_2a`,
         `dem.reduction_in_hours_.Wave_2b`,
         `dem.reduction_in_hours_.Wave_3a`,
         `dem.reduction_in_hours_.Wave_3b`,
         `dem.reduction_in_hours_.Wave_4a`,
         `dem.reduction_in_hours_.Wave_4b`,
         `dem.reduction_in_hours_.Wave_5a`,
         `dem.reduction_in_hours_.Wave_6b`,
         `dem.reduction_in_hours_.Wave_7a`,
         `dem.reduction_in_hours_.Wave_8b`,
         `dem.reduction_in_hours_.Wave_9a`,
         `dem.reduction_in_hours_.Wave_10b`,
         `dem.reduction_in_hours_.Wave_11a`,
         `dem.reduction_in_hours_.Wave_12b`,
         
         `dem.reduction_in_salary_.Wave_1a`,
         `dem.reduction_in_salary_.Wave_1b`,
         `dem.reduction_in_salary_.Wave_2a`,
         `dem.reduction_in_salary_.Wave_2b`,
         `dem.reduction_in_salary_.Wave_3a`,
         `dem.reduction_in_salary_.Wave_3b`,
         `dem.reduction_in_salary_.Wave_4a`,
         `dem.reduction_in_salary_.Wave_4b`,
         `dem.reduction_in_salary_.Wave_5a`,
         `dem.reduction_in_salary_.Wave_6b`,
         `dem.reduction_in_salary_.Wave_7a`,
         `dem.reduction_in_salary_.Wave_8b`,
         `dem.reduction_in_salary_.Wave_9a`,
         `dem.reduction_in_salary_.Wave_10b`,
         `dem.reduction_in_salary_.Wave_11a`,
         `dem.reduction_in_salary_.Wave_12b`,
         
         `dem.benefits_increased_.Wave_1a`,
         `dem.benefits_increased_.Wave_1b`,
         `dem.benefits_increased_.Wave_2a`,
         `dem.benefits_increased_.Wave_2b`,
         `dem.benefits_increased_.Wave_3a`,
         `dem.benefits_increased_.Wave_3b`,
         `dem.benefits_increased_.Wave_4a`,
         `dem.benefits_increased_.Wave_4b`,
         `dem.benefits_increased_.Wave_5a`,
         `dem.benefits_increased_.Wave_6b`,
         `dem.benefits_increased_.Wave_7a`,
         `dem.benefits_increased_.Wave_8b`,
         `dem.benefits_increased_.Wave_9a`,
         `dem.benefits_increased_.Wave_10b`,
         `dem.benefits_increased_.Wave_11a`,
         `dem.benefits_increased_.Wave_12b`,
         
         `dem.benefits_decreased_.Wave_1a`,
         `dem.benefits_decreased_.Wave_1b`,
         `dem.benefits_decreased_.Wave_2a`,
         `dem.benefits_decreased_.Wave_2b`,
         `dem.benefits_decreased_.Wave_3a`,
         `dem.benefits_decreased_.Wave_3b`,
         `dem.benefits_decreased_.Wave_4a`,
         `dem.benefits_decreased_.Wave_4b`,
         `dem.benefits_decreased_.Wave_5a`,
         `dem.benefits_decreased_.Wave_6b`,
         `dem.benefits_decreased_.Wave_7a`,
         `dem.benefits_decreased_.Wave_8b`,
         `dem.benefits_decreased_.Wave_9a`,
         `dem.benefits_decreased_.Wave_10b`,
         `dem.benefits_decreased_.Wave_11a`,
         `dem.benefits_decreased_.Wave_12b`,
         
         `dem.change_in_duties_or_responsibilites_.Wave_1a`,
         `dem.change_in_duties_or_responsibilites_.Wave_1b`,
         `dem.change_in_duties_or_responsibilites_.Wave_2a`,
         `dem.change_in_duties_or_responsibilites_.Wave_2b`,
         `dem.change_in_duties_or_responsibilites_.Wave_3a`,
         `dem.change_in_duties_or_responsibilites_.Wave_3b`,
         `dem.change_in_duties_or_responsibilites_.Wave_4a`,
         `dem.change_in_duties_or_responsibilites_.Wave_4b`,
         `dem.change_in_duties_or_responsibilites_.Wave_5a`,
         `dem.change_in_duties_or_responsibilites_.Wave_6b`,
         `dem.change_in_duties_or_responsibilites_.Wave_7a`,
         `dem.change_in_duties_or_responsibilites_.Wave_8b`,
         `dem.change_in_duties_or_responsibilites_.Wave_9a`,
         `dem.change_in_duties_or_responsibilites_.Wave_10b`,
         `dem.change_in_duties_or_responsibilites_.Wave_11a`,
         `dem.change_in_duties_or_responsibilites_.Wave_12b`,
         
         `dem.became_employed_.Wave_1a`,
         `dem.became_employed_.Wave_1b`,
         `dem.became_employed_.Wave_2a`,
         `dem.became_employed_.Wave_2b`,
         `dem.became_employed_.Wave_3a`,
         `dem.became_employed_.Wave_3b`,
         `dem.became_employed_.Wave_4a`,
         `dem.became_employed_.Wave_4b`,
         `dem.became_employed_.Wave_5a`,
         `dem.became_employed_.Wave_6b`,
         `dem.became_employed_.Wave_7a`,
         `dem.became_employed_.Wave_8b`,
         `dem.became_employed_.Wave_9a`,
         `dem.became_employed_.Wave_10b`,
         `dem.became_employed_.Wave_11a`,
         `dem.became_employed_.Wave_12b`,
         
         `dem.increased_hours_.Wave_1a`,
         `dem.increased_hours_.Wave_1b`,
         `dem.increased_hours_.Wave_2a`,
         `dem.increased_hours_.Wave_2b`,
         `dem.increased_hours_.Wave_3a`,
         `dem.increased_hours_.Wave_3b`,
         `dem.increased_hours_.Wave_4a`,
         `dem.increased_hours_.Wave_4b`,
         `dem.increased_hours_.Wave_5a`,
         `dem.increased_hours_.Wave_6b`,
         `dem.increased_hours_.Wave_7a`,
         `dem.increased_hours_.Wave_8b`,
         `dem.increased_hours_.Wave_9a`,
         `dem.increased_hours_.Wave_10b`,
         `dem.increased_hours_.Wave_11a`,
         `dem.increased_hours_.Wave_12b`,
         
         `dem.furloughed_or_paid_leave_government_funded_.Wave_1a`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_1b`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_2a`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_2b`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_3a`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_3b`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_4a`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_4b`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_5a`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_6b`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_7a`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_8b`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_9a`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_10b`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_11a`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_12b`,
         
          `dem.furloughed_or_paid_leave_company_funded_.Wave_1a`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_1b`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_2a`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_2b`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_3a`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_3b`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_4a`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_4b`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_5a`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_6b`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_7a`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_8b`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_9a`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_10b`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_11a`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_12b`,
         
          `dem.paid_leave_furloughed_.Wave_1a`,
         `dem.paid_leave_furloughed_.Wave_1b`,
         `dem.paid_leave_furloughed_.Wave_2a`,
         `dem.paid_leave_furloughed_.Wave_2b`,
         `dem.paid_leave_furloughed_.Wave_3a`,
         `dem.paid_leave_furloughed_.Wave_3b`,
         `dem.paid_leave_furloughed_.Wave_4a`,
         `dem.paid_leave_furloughed_.Wave_4b`,
         `dem.paid_leave_furloughed_.Wave_5a`,
         `dem.paid_leave_furloughed_.Wave_6b`,
         `dem.paid_leave_furloughed_.Wave_7a`,
         `dem.paid_leave_furloughed_.Wave_8b`,
         `dem.paid_leave_furloughed_.Wave_9a`,
         `dem.paid_leave_furloughed_.Wave_10b`,
         `dem.paid_leave_furloughed_.Wave_11a`,
         `dem.paid_leave_furloughed_.Wave_12b`,
         
          `dem.paid_leave_returned_work_.Wave_1a`,
         `dem.paid_leave_returned_work_.Wave_1b`,
         `dem.paid_leave_returned_work_.Wave_2a`,
         `dem.paid_leave_returned_work_.Wave_2b`,
         `dem.paid_leave_returned_work_.Wave_3a`,
         `dem.paid_leave_returned_work_.Wave_3b`,
         `dem.paid_leave_returned_work_.Wave_4a`,
         `dem.paid_leave_returned_work_.Wave_4b`,
         `dem.paid_leave_returned_work_.Wave_5a`,
         `dem.paid_leave_returned_work_.Wave_6b`,
         `dem.paid_leave_returned_work_.Wave_7a`,
         `dem.paid_leave_returned_work_.Wave_8b`,
         `dem.paid_leave_returned_work_.Wave_9a`,
         `dem.paid_leave_returned_work_.Wave_10b`,
         `dem.paid_leave_returned_work_.Wave_11a`,
         `dem.paid_leave_returned_work_.Wave_12b`,
         
          `dem.retired_.Wave_1a`,
         `dem.retired_.Wave_1b`,
         `dem.retired_.Wave_2a`,
         `dem.retired_.Wave_2b`,
         `dem.retired_.Wave_3a`,
         `dem.retired_.Wave_3b`,
         `dem.retired_.Wave_4a`,
         `dem.retired_.Wave_4b`,
         `dem.retired_.Wave_5a`,
         `dem.retired_.Wave_6b`,
         `dem.retired_.Wave_7a`,
         `dem.retired_.Wave_8b`,
         `dem.retired_.Wave_9a`,
         `dem.retired_.Wave_10b`,
         `dem.retired_.Wave_11a`,
         `dem.retired_.Wave_12b`
         
         )
}
```

Remove duplicate IDs RAMP demographics
```{r Remove duplicate IDs RAMP demographics}
if(RAMP == TRUE) {
##Check col names
colnames(dat.raw.dem.ramp.followup)

##Remove dupilcate IDs (as each wave is now a column, there should be NO dup IDs)
dat.raw.dem.ramp.followup  <- dat.raw.dem.ramp.followup %>%
  filter(., !duplicated(ID)) 

##Check number of rows
nrow(dat.raw.dem.ramp.followup)
}

```

# TIMEPOINTS / PHASES - TAF RAMP

Create phase columns in follow up data - RAMP
```{r Identify phase datas RAMP TAF}
if (RAMP ==TRUE) {
source("./timepoints_RAMP.R")

}
```

Join TAF follow ups (RAMP)
```{r Merge follow up RAMP TAF}
if(RAMP == TRUE) {
dat.raw.taf.ramp <- rbind(taf.ramp.followupa.raw.id,
    taf.ramp.followupb.raw.id)

#check column names
colnames(dat.raw.taf.ramp)
}
```

Check for number of entries per wave
```{r Check number of entries per wave RAMP TAF}
if(RAMP == TRUE) {

dat.raw.taf.ramp %>%
  group_by(wave_taf) %>%
  count()

}
```

Identify duplicate IDs in a single timepoint
```{r Identify duplicate IDs in a single timepoint RAMP TAF}
if(RAMP == TRUE) {

##Identify dup IDs in a single wave 
dat.raw.taf.ramp %>%
   group_by(wave_taf, ID) %>%
   summarize(N = n()) %>%
   filter(N > 1)
}
```

(Again) FOR NOW - Want the LATER data entry from people who answered twice within a single wave 
Later on - want to create variable with 'answered YES at least once'
[want ID AND wave to be unique]
```{r Later data entry RAMP TAF}
if(RAMP == TRUE) {

 ##FOLLOW UP A
##confirm number of rows in current dataset 
nrow(dat.raw.taf.ramp)

#Filter out duplicated IDs AND wave, keeping the LAST entry
dat.raw.taf.ramp <- dat.raw.taf.ramp %>% 
    group_by(ID) %>% 
    filter(!duplicated(wave_taf,
                      fromLast = TRUE)
           )

##confirm number of rows in dataset after filtering 
nrow(dat.raw.taf.ramp)
}
```

Change follow up TAF RAMP to wide format
```{r TAF RAMP wide format}
if(RAMP == TRUE) {
dat.raw.taf.ramp <- dat.raw.taf.ramp %>%
  group_by(wave_taf) %>%
  mutate(row = row_number()) %>%
  tidyr::pivot_wider(id_cols = ID,
    names_from = wave_taf, 
                     values_from = c(taf.worth_living_life_people,
                              taf.felt_weeks_past,
                              taf.have_you_contemplated_harming_yourself,
                              taf.felt_weeks_past.1,
                              taf.meant_life_end_weeks)) 
  
}

```

Select variables for dataset TAF RAMP
```{r Select variables for dataset TAF RAMP}
if(RAMP == TRUE) {
dat.raw.taf.ramp <- dat.raw.taf.ramp %>%
  select(ID,
         `taf.worth_living_life_people_.Wave_1a`,
         `taf.worth_living_life_people_.Wave_1b`,
         `taf.worth_living_life_people_.Wave_2a`,
         `taf.worth_living_life_people_.Wave_2b`,
         `taf.worth_living_life_people_.Wave_3a`,
         `taf.worth_living_life_people_.Wave_3b`,
         `taf.worth_living_life_people_.Wave_4a`,
         `taf.worth_living_life_people_.Wave_4b`,
         `taf.worth_living_life_people_.Wave_5a`,
         `taf.worth_living_life_people_.Wave_6b`,
         `taf.worth_living_life_people_.Wave_7a`,
         `taf.worth_living_life_people_.Wave_8b`,
         `taf.worth_living_life_people_.Wave_9a`,
         `taf.worth_living_life_people_.Wave_10b`,
         `taf.worth_living_life_people_.Wave_11a`,
         `taf.worth_living_life_people_.Wave_12b`,
         
         
         `taf.felt_weeks_past_.Wave_1a`,
         `taf.felt_weeks_past_.Wave_1b`,
         `taf.felt_weeks_past_.Wave_2a`,
         `taf.felt_weeks_past_.Wave_2b`,
         `taf.felt_weeks_past_.Wave_3a`,
         `taf.felt_weeks_past_.Wave_3b`,
         `taf.felt_weeks_past_.Wave_4a`,
         `taf.felt_weeks_past_.Wave_4b`,
         `taf.felt_weeks_past_.Wave_5a`,
         `taf.felt_weeks_past_.Wave_6b`,
         `taf.felt_weeks_past_.Wave_7a`,
         `taf.felt_weeks_past_.Wave_8b`,
         `taf.felt_weeks_past_.Wave_9a`,
         `taf.felt_weeks_past_.Wave_10b`,
         `taf.felt_weeks_past_.Wave_11a`,
         `taf.felt_weeks_past_.Wave_12b`,
         
         `taf.have_you_contemplated_harming_yourself_.Wave_1a`,
         `taf.have_you_contemplated_harming_yourself_.Wave_1b`,
         `taf.have_you_contemplated_harming_yourself_.Wave_2a`,
         `taf.have_you_contemplated_harming_yourself_.Wave_2b`,
         `taf.have_you_contemplated_harming_yourself_.Wave_3a`,
         `taf.have_you_contemplated_harming_yourself_.Wave_3b`,
         `taf.have_you_contemplated_harming_yourself_.Wave_4a`,
         `taf.have_you_contemplated_harming_yourself_.Wave_4b`,
         `taf.have_you_contemplated_harming_yourself_.Wave_5a`,
         `taf.have_you_contemplated_harming_yourself_.Wave_6b`,
         `taf.have_you_contemplated_harming_yourself_.Wave_7a`,
         `taf.have_you_contemplated_harming_yourself_.Wave_8b`,
         `taf.have_you_contemplated_harming_yourself_.Wave_9a`,
         `taf.have_you_contemplated_harming_yourself_.Wave_10b`,
         `taf.have_you_contemplated_harming_yourself_.Wave_11a`,
         `taf.have_you_contemplated_harming_yourself_.Wave_12b`,
         
         `taf.felt_weeks_past.1_.Wave_1a`,
         `taf.felt_weeks_past.1_.Wave_1b`,
         `taf.felt_weeks_past.1_.Wave_2a`,
         `taf.felt_weeks_past.1_.Wave_2b`,
         `taf.felt_weeks_past.1_.Wave_3a`,
         `taf.felt_weeks_past.1_.Wave_3b`,
         `taf.felt_weeks_past.1_.Wave_4a`,
         `taf.felt_weeks_past.1_.Wave_4b`,
         `taf.felt_weeks_past.1_.Wave_5a`,
         `taf.felt_weeks_past.1_.Wave_6b`,
         `taf.felt_weeks_past.1_.Wave_7a`,
         `taf.felt_weeks_past.1_.Wave_8b`,
         `taf.felt_weeks_past.1_.Wave_9a`,
         `taf.felt_weeks_past.1_.Wave_10b`,
         `taf.felt_weeks_past.1_.Wave_11a`,
         `taf.felt_weeks_past.1_.Wave_12b`,
         
         `taf.meant_life_end_weeks_.Wave_1a`,
         `taf.meant_life_end_weeks_.Wave_1b`,
         `taf.meant_life_end_weeks_.Wave_2a`,
         `taf.meant_life_end_weeks_.Wave_2b`,
         `taf.meant_life_end_weeks_.Wave_3a`,
         `taf.meant_life_end_weeks_.Wave_3b`,
         `taf.meant_life_end_weeks_.Wave_4a`,
         `taf.meant_life_end_weeks_.Wave_4b`,
         `taf.meant_life_end_weeks_.Wave_5a`,
         `taf.meant_life_end_weeks_.Wave_6b`,
         `taf.meant_life_end_weeks_.Wave_7a`,
         `taf.meant_life_end_weeks_.Wave_8b`,
         `taf.meant_life_end_weeks_.Wave_9a`,
         `taf.meant_life_end_weeks_.Wave_10b`,
         `taf.meant_life_end_weeks_.Wave_11a`,
         `taf.meant_life_end_weeks_.Wave_12b`
         )
}
```

Remove duplicate IDs TAF RAMP
```{r Remove duplicate IDs TAF RAMP}
if(RAMP == TRUE) {
##Check col names
colnames(dat.raw.taf.ramp)

##Remove dupilcate IDs (as each wave is now a column, there should be NO dup IDs)
dat.raw.taf.ramp  <- dat.raw.taf.ramp %>%
  filter(., !duplicated(ID)) 

##Check number of rows
nrow(dat.raw.taf.ramp)
}

```

# TIMEPOINTS / PHASES - TAF RAMP - EDEQ SCREENER RAMP

**Need to think about people who answered EDEQ screener (which is only in follow up B) in an 'A' timepoint = 11 people
(think will just drop them for the plots, but for the regression should actually keep them)

Check number of entries per wave
```{r Check number of entries per wave RAMP EDEQ screener}
if(RAMP == TRUE) {

edeq.ramp.followupb.screener.raw.id %>%
  group_by(wave_edeq) %>%
  count()

}
```

Idenfity duplicate IDs in a single wave
```{r Idenfity duplicate IDs in a single wave RAMP EDEQ screener}
if(RAMP == TRUE) {

##Identify dup IDs in a single wave
edeq.ramp.followupb.screener.raw.id %>%
   group_by(wave_edeq, ID) %>%
   summarize(N = n()) %>%
   filter(N > 1)
}
```

Want the LATER data entry from people who answered twice within a single wave (again, for now!)
[want ID AND wave to be unique]
```{r Later date entry RAMP EDEQ screener}
if(RAMP == TRUE) {

 ##FOLLOW UP B EDEQ SCREENER
##confirm number of rows in current dataset (= 26411)
nrow(edeq.ramp.followupb.screener.raw.id)

#Filter out duplicated IDs AND wave, keeping the LAST entry
edeq.ramp.followupb.screener.raw.id <- edeq.ramp.followupb.screener.raw.id %>% 
    group_by(ID) %>% 
    filter(!duplicated(wave_edeq,
                      fromLast = TRUE)
           )

##confirm number of rows in dataset after filtering (should be 26411 - 41)
nrow(edeq.ramp.followupb.screener.raw.id)
}
```

Change follow up EDEQ RAMP screener to wide format
```{r RAMP EDEQ screener wide format}
if(RAMP == TRUE) {
edeq.ramp.followupb.screener.raw.id <- edeq.ramp.followupb.screener.raw.id %>%
  group_by(wave_edeq) %>%
  mutate(row = row_number()) %>%
  tidyr::pivot_wider(id_cols = ID,
    names_from = wave_edeq, 
                     values_from = c(ed_scid5.regular_episodes_eating_binges,
                                     ed_scid5.weigh_weighed_past_month,
                                     ed_scid5.regular_episodes_eating_binges_numeric,
                                     ed_scid5.weigh_weighed_past_month_numeric)) 
  
}
```

Select variables for dataset EDEQ RAMP screener
```{r Select variables for dataset RAMP EDEQ screener}
if(RAMP == TRUE) {
edeq.ramp.followupb.screener.raw.id <- edeq.ramp.followupb.screener.raw.id  %>%
  select(ID,
         `ed_scid5.regular_episodes_eating_binges_.Wave_1b`,
         `ed_scid5.regular_episodes_eating_binges_.Wave_2b` ,    
         `ed_scid5.regular_episodes_eating_binges_.Wave_3b` ,       
         `ed_scid5.regular_episodes_eating_binges_.Wave_4b`,
         `ed_scid5.regular_episodes_eating_binges_.Wave_6b`,
         `ed_scid5.regular_episodes_eating_binges_.Wave_8b`,
         `ed_scid5.regular_episodes_eating_binges_.Wave_10b`,
         `ed_scid5.regular_episodes_eating_binges_.Wave_12b`,
         
         `ed_scid5.weigh_weighed_past_month_.Wave_1b`,
         `ed_scid5.weigh_weighed_past_month_.Wave_2b` ,    
         `ed_scid5.weigh_weighed_past_month_.Wave_3b` ,       
         `ed_scid5.weigh_weighed_past_month_.Wave_4b`,
         `ed_scid5.weigh_weighed_past_month_.Wave_6b`,
         `ed_scid5.weigh_weighed_past_month_.Wave_8b`,
         `ed_scid5.weigh_weighed_past_month_.Wave_10b`,
         `ed_scid5.weigh_weighed_past_month_.Wave_12b`,
         
          `ed_scid5.regular_episodes_eating_binges_numeric_.Wave_1b`,
         `ed_scid5.regular_episodes_eating_binges_numeric_.Wave_2b` ,    
         `ed_scid5.regular_episodes_eating_binges_numeric_.Wave_3b` ,       
         `ed_scid5.regular_episodes_eating_binges_numeric_.Wave_4b`,
         `ed_scid5.regular_episodes_eating_binges_numeric_.Wave_6b`,
         `ed_scid5.regular_episodes_eating_binges_numeric_.Wave_8b`,
         `ed_scid5.regular_episodes_eating_binges_numeric_.Wave_10b`,
         `ed_scid5.regular_episodes_eating_binges_numeric_.Wave_12b`,
         
         `ed_scid5.weigh_weighed_past_month_numeric_.Wave_1b`,
         `ed_scid5.weigh_weighed_past_month_numeric_.Wave_2b` ,    
         `ed_scid5.weigh_weighed_past_month_numeric_.Wave_3b` ,       
         `ed_scid5.weigh_weighed_past_month_numeric_.Wave_4b`,
         `ed_scid5.weigh_weighed_past_month_numeric_.Wave_6b`,
         `ed_scid5.weigh_weighed_past_month_numeric_.Wave_8b`,
         `ed_scid5.weigh_weighed_past_month_numeric_.Wave_10b`,
         `ed_scid5.weigh_weighed_past_month_numeric_.Wave_12b`)
}
```

Remove duplicate IDs EDEQ RAMP screener
```{r Remove duplicate IDs RAMP EDEQ screener}
if(RAMP == TRUE) {
##Check col names
colnames(edeq.ramp.followupb.screener.raw.id)

##Remove dupilcate IDs (as each wave is now a column, there should be NO dup IDs)
edeq.ramp.followupb.screener.raw.id  <- edeq.ramp.followupb.screener.raw.id  %>%
  filter(., !duplicated(ID)) 

##Check number of rows
nrow(edeq.ramp.followupb.screener.raw.id)
}

```

# TIMEPOINTS / PHASES - loss of loved one due to COVID RAMP
```{r Check number of entries per phase loss of loved one due to COVID RAMP}
if(RAMP == TRUE) {
ramp.loss.followupb.raw.id %>%
  group_by(wave_loss) %>%
  count()
}
```

Identify duplicate IDs in a single timepoint
```{r Identify duplicate IDs in a single timepoint loss of loved one due to COVID RAMP}
if(RAMP == TRUE) {
##Identify dup IDs in a single wave 
ramp.loss.followupb.raw.id %>%
   group_by(wave_loss, ID) %>%
   summarize(N = n()) %>%
   filter(N > 1)
}
```

*FOR NOW - Want the LATER data entry from people who answered twice within a single wave 
Later on - want to create variable with 'answered YES at least once'
[want ID AND wave to be unique]
```{r Later date entry loss of loved one due to COVID RAMP}
if(RAMP == TRUE) {
 ##FOLLOW UP A
##confirm number of rows in current dataset 
nrow(ramp.loss.followupb.raw.id)
#Filter out duplicated IDs AND wave, keeping the LAST entry
ramp.loss.followupb.raw.id <- ramp.loss.followupb.raw.id %>% 
    group_by(ID) %>% 
    filter(!duplicated(wave_loss,
                      fromLast = TRUE)
           )
##confirm number of rows in dataset after filtering 
nrow(ramp.loss.followupb.raw.id)
}
```

Change follow up loss of loved one due to COVID RAMP to wide format
```{r Loss of loved one due to COVID RAMP wide format}
if(RAMP == TRUE) {
ramp.loss.followupb.raw.id <- ramp.loss.followupb.raw.id %>%
  group_by(wave_loss) %>%
  mutate(row = row_number()) %>%
  tidyr::pivot_wider(id_cols = ID,
    names_from = wave_loss, 
                     values_from = c( grief.due_past_month_lost,
                                      grief.suffered_past_month_loss
                       )) 
  
}
```

Select variables for dataset loss of loved one due to COVID RAMP
```{r Select variable loss of loved one due to COVID RAMP}
if(RAMP == TRUE) {
ramp.loss.followupb.raw.id <- ramp.loss.followupb.raw.id %>%
  select(ID,
         `grief.due_past_month_lost_.Wave_1b`,
         `grief.due_past_month_lost_.Wave_2b`,
         `grief.due_past_month_lost_.Wave_3b`,
         `grief.due_past_month_lost_.Wave_4b`,
         `grief.due_past_month_lost_.Wave_6b`,
         `grief.due_past_month_lost_.Wave_8b`,
       #  `grief.due_past_month_lost_.Wave_10b`,
        # `grief.due_past_month_lost_.Wave_12b`,
         
         `grief.suffered_past_month_loss_.Wave_1b`,
         `grief.suffered_past_month_loss_.Wave_2b`,
         `grief.suffered_past_month_loss_.Wave_3b`,
         `grief.suffered_past_month_loss_.Wave_4b`,
         `grief.suffered_past_month_loss_.Wave_6b`,
         `grief.suffered_past_month_loss_.Wave_8b`,
        # `grief.suffered_past_month_loss_.Wave_10b`,
        # `grief.suffered_past_month_loss_.Wave_12b`
         
         
         )
}
```

Remove duplicate IDs loss of loved one due to COVID RAMP
```{r Remove duplicate IDs loss of loved one due to COVID RAMP}
if(RAMP == TRUE) {
##Check col names
colnames(ramp.loss.followupb.raw.id)
##Remove dupilcate IDs (as each wave is now a column, there should be NO dup IDs)
ramp.loss.followupb.raw.id  <- ramp.loss.followupb.raw.id %>%
  filter(., !duplicated(ID)) 
##Check number of rows
nrow(ramp.loss.followupb.raw.id)
}
```

# TIMEPOINTS / PHASES - COPING demographics

Create a phase columns in follow up data
```{r Identify phase data COPING follow up demographics}
if (COPING ==TRUE) {
source("./timepoints_COPING.R")

}
```

Join COPING demographics datasets follow ups
```{r Merge COPING follow up demographics}
if(COPING == TRUE) {
dat.raw.dem.coping.followup <- rbind(coping.dem.followupb.raw.id,
    coping.dem.followupa.raw.id)

#check column names
colnames(dat.raw.dem.coping.followup)
}
```

Check for number of entries per wave
```{r Check for number of entries per wave COPING follow up demographics}
if(COPING == TRUE) {

dat.raw.dem.coping.followup %>%
  group_by(wave_dem) %>%
  count()

}
```

Identify duplicate IDs in a single timepoint
```{r Identify duplicate IDs in a single timepoint COPING follow up demographics}
if(COPING == TRUE) {

##Identify dup IDs in a single wave 
dat.raw.dem.coping.followup %>%
   group_by(wave_dem, ID) %>%
   summarize(N = n()) %>%
   filter(N > 1)
}
```

*FOR NOW - Want the LATER data entry from people who answered twice within a single wave (for now)
Later on - want to create variable with 'answered YES at least once'
[want ID AND wave to be unique]
```{r Later entry COPING follow up demographics}
if(COPING == TRUE) {

 ##FOLLOW UP A
##confirm number of rows in current dataset 
nrow(dat.raw.dem.coping.followup)

#Filter out duplicated IDs AND wave, keeping the LAST entry
dat.raw.dem.coping.followup <- dat.raw.dem.coping.followup %>% 
    group_by(ID) %>% 
    filter(!duplicated(wave_dem,
                      fromLast = TRUE)
           )

##confirm number of rows in dataset after filtering 
nrow(dat.raw.dem.coping.followup)
}
```

Change follow up COPING demographics to wide format
```{r COPING follow up demographics wide format}
if(COPING == TRUE) {
dat.raw.dem.coping.followup <- dat.raw.dem.coping.followup %>%
  group_by(wave_dem) %>%
  mutate(row = row_number()) %>%
  tidyr::pivot_wider(id_cols = ID,
    names_from = wave_dem, 
                     values_from = c(
                      dem.nothing_has_changed,                                     
         dem.living_situation,
         dem.employment,
         dem.physical_health,
         dem.health_of_a_relative,
         dem.household_employment_status_key,
         dem.children__dependants_returning_to_school__other_education,
         dem.living_alone,
         dem.living_with_partner_or_spouse,
         dem.living_with_housemates,
         dem.age_children_living,
         dem.age_children_living.1,
         dem.living_with_other_members_of_my_family,
         dem.spouse_partner_members_living,
         dem.staying_live,
         dem.staying_live.1,
         dem.prefer_not_to_say,
         dem.made_redundant,
         dem.became_unemployed,
         dem.reduction_in_hours,
         dem.reduction_in_salary,
         dem.benefits_increased,
         dem.benefits_decreased,
         dem.change_in_duties_or_responsibilites,
         dem.became_employed,
         dem.increased_hours,
         dem.increased_salary,
         dem.furloughed_or_paid_leave_government_funded,
         dem.furloughed_or_paid_leave_company_funded,
         dem.paid_leave_furloughed,
         dem.paid_leave_returned_work,
         dem.retired )) 
  
}

```

Select variables for dataset COPING follow up demographics
```{r Select variables COPING follow up demographics}
if(COPING == TRUE) {
dat.raw.dem.coping.followup <- dat.raw.dem.coping.followup %>%
  select(ID,
        # `dem.nothing_has_changed_.Wave_1a`,
        # `dem.nothing_has_changed_.Wave_1b`,
         `dem.nothing_has_changed_.Wave_2a`,
         `dem.nothing_has_changed_.Wave_2b`,
         `dem.nothing_has_changed_.Wave_3a`,
         `dem.nothing_has_changed_.Wave_3b`,
         `dem.nothing_has_changed_.Wave_4a`,
         `dem.nothing_has_changed_.Wave_4b`,
         `dem.nothing_has_changed_.Wave_5a`,
         `dem.nothing_has_changed_.Wave_6b`,
         `dem.nothing_has_changed_.Wave_7a`,
         `dem.nothing_has_changed_.Wave_8b`,
         `dem.nothing_has_changed_.Wave_9a`,
         `dem.nothing_has_changed_.Wave_10b`,
         `dem.nothing_has_changed_.Wave_11a`,
         `dem.nothing_has_changed_.Wave_12b`,
         
        # `dem.living_situation_.Wave_1a`,
        # `dem.living_situation_.Wave_1b`,
         `dem.living_situation_.Wave_2a`,
         `dem.living_situation_.Wave_2b`,
         `dem.living_situation_.Wave_3a`,
         `dem.living_situation_.Wave_3b`,
         `dem.living_situation_.Wave_4a`,
         `dem.living_situation_.Wave_4b`,
         `dem.living_situation_.Wave_5a`,
         `dem.living_situation_.Wave_6b`,
         `dem.living_situation_.Wave_7a`,
         `dem.living_situation_.Wave_8b`,
         `dem.living_situation_.Wave_9a`,
         `dem.living_situation_.Wave_10b`,
         `dem.living_situation_.Wave_11a`,
         `dem.living_situation_.Wave_12b`,
         
          
        # `dem.employment_.Wave_1a`,
        # `dem.employment_.Wave_1b`,
         `dem.employment_.Wave_2a`,
         `dem.employment_.Wave_2b`,
         `dem.employment_.Wave_3a`,
         `dem.employment_.Wave_3b`,
         `dem.employment_.Wave_4a`,
         `dem.employment_.Wave_4b`,
         `dem.employment_.Wave_5a`,
         `dem.employment_.Wave_6b`,
         `dem.employment_.Wave_7a`,
         `dem.employment_.Wave_8b`,
         `dem.employment_.Wave_9a`,
         `dem.employment_.Wave_10b`,
         `dem.employment_.Wave_11a`,
         `dem.employment_.Wave_12b`,
         
        # `dem.physical_health_.Wave_1a`,
        # `dem.physical_health_.Wave_1b`,
         `dem.physical_health_.Wave_2a`,
         `dem.physical_health_.Wave_2b`,
         `dem.physical_health_.Wave_3a`,
         `dem.physical_health_.Wave_3b`,
         `dem.physical_health_.Wave_4a`,
         `dem.physical_health_.Wave_4b`,
         `dem.physical_health_.Wave_5a`,
         `dem.physical_health_.Wave_6b`,
         `dem.physical_health_.Wave_7a`,
         `dem.physical_health_.Wave_8b`,
         `dem.physical_health_.Wave_9a`,
         `dem.physical_health_.Wave_10b`,
         `dem.physical_health_.Wave_11a`,
         `dem.physical_health_.Wave_12b`,
         
        # `dem.health_of_a_relative_.Wave_1a`,
        # `dem.health_of_a_relative_.Wave_1b`,
         `dem.health_of_a_relative_.Wave_2a`,
         `dem.health_of_a_relative_.Wave_2b`,
         `dem.health_of_a_relative_.Wave_3a`,
         `dem.health_of_a_relative_.Wave_3b`,
         `dem.health_of_a_relative_.Wave_4a`,
         `dem.health_of_a_relative_.Wave_4b`,
         `dem.health_of_a_relative_.Wave_5a`,
         `dem.health_of_a_relative_.Wave_6b`,
         `dem.health_of_a_relative_.Wave_7a`,
         `dem.health_of_a_relative_.Wave_8b`,
         `dem.health_of_a_relative_.Wave_9a`,
         `dem.health_of_a_relative_.Wave_10b`,
         `dem.health_of_a_relative_.Wave_11a`,
         `dem.health_of_a_relative_.Wave_12b`,
         
        # `dem.household_employment_status_key_.Wave_1a`,
        # `dem.household_employment_status_key_.Wave_1b`,
         `dem.household_employment_status_key_.Wave_2a`,
         `dem.household_employment_status_key_.Wave_2b`,
         `dem.household_employment_status_key_.Wave_3a`,
         `dem.household_employment_status_key_.Wave_3b`,
         `dem.household_employment_status_key_.Wave_4a`,
         `dem.household_employment_status_key_.Wave_4b`,
         `dem.household_employment_status_key_.Wave_5a`,
         `dem.household_employment_status_key_.Wave_6b`,
         `dem.household_employment_status_key_.Wave_7a`,
         `dem.household_employment_status_key_.Wave_8b`,
         `dem.household_employment_status_key_.Wave_9a`,
         `dem.household_employment_status_key_.Wave_10b`,
         `dem.household_employment_status_key_.Wave_11a`,
         `dem.household_employment_status_key_.Wave_12b`,
         
        # `dem.children__dependants_returning_to_school__other_education_.Wave_1a`,
        # `dem.children__dependants_returning_to_school__other_education_.Wave_1b`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_2a`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_2b`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_3a`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_3b`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_4a`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_4b`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_5a`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_6b`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_7a`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_8b`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_9a`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_10b`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_11a`,
         `dem.children__dependants_returning_to_school__other_education_.Wave_12b`,
         
        # `dem.living_alone_.Wave_1a`,
        # `dem.living_alone_.Wave_1b`,
         `dem.living_alone_.Wave_2a`,
         `dem.living_alone_.Wave_2b`,
         `dem.living_alone_.Wave_3a`,
         `dem.living_alone_.Wave_3b`,
         `dem.living_alone_.Wave_4a`,
         `dem.living_alone_.Wave_4b`,
         `dem.living_alone_.Wave_5a`,
         `dem.living_alone_.Wave_6b`,
         `dem.living_alone_.Wave_7a`,
         `dem.living_alone_.Wave_8b`,
         `dem.living_alone_.Wave_9a`,
         `dem.living_alone_.Wave_10b`,
         `dem.living_alone_.Wave_11a`,
         `dem.living_alone_.Wave_12b`,
         
        # `dem.living_with_partner_or_spouse_.Wave_1a`,
        # `dem.living_with_partner_or_spouse_.Wave_1b`,
         `dem.living_with_partner_or_spouse_.Wave_2a`,
         `dem.living_with_partner_or_spouse_.Wave_2b`,
         `dem.living_with_partner_or_spouse_.Wave_3a`,
         `dem.living_with_partner_or_spouse_.Wave_3b`,
         `dem.living_with_partner_or_spouse_.Wave_4a`,
         `dem.living_with_partner_or_spouse_.Wave_4b`,
         `dem.living_with_partner_or_spouse_.Wave_5a`,
         `dem.living_with_partner_or_spouse_.Wave_6b`,
         `dem.living_with_partner_or_spouse_.Wave_7a`,
         `dem.living_with_partner_or_spouse_.Wave_8b`,
         `dem.living_with_partner_or_spouse_.Wave_9a`,
         `dem.living_with_partner_or_spouse_.Wave_10b`,
         `dem.living_with_partner_or_spouse_.Wave_11a`,
         `dem.living_with_partner_or_spouse_.Wave_12b`,
         
        # `dem.living_with_housemates_.Wave_1a`,
        # `dem.living_with_housemates_.Wave_1b`,
         `dem.living_with_housemates_.Wave_2a`,
         `dem.living_with_housemates_.Wave_2b`,
         `dem.living_with_housemates_.Wave_3a`,
         `dem.living_with_housemates_.Wave_3b`,
         `dem.living_with_housemates_.Wave_4a`,
         `dem.living_with_housemates_.Wave_4b`,
         `dem.living_with_housemates_.Wave_5a`,
         `dem.living_with_housemates_.Wave_6b`,
         `dem.living_with_housemates_.Wave_7a`,
         `dem.living_with_housemates_.Wave_8b`,
         `dem.living_with_housemates_.Wave_9a`,
         `dem.living_with_housemates_.Wave_10b`,
         `dem.living_with_housemates_.Wave_11a`,
         `dem.living_with_housemates_.Wave_12b`,
         
        # `dem.age_children_living_.Wave_1a`,
        # `dem.age_children_living_.Wave_1b`,
         `dem.age_children_living_.Wave_2a`,
         `dem.age_children_living_.Wave_2b`,
         `dem.age_children_living_.Wave_3a`,
         `dem.age_children_living_.Wave_3b`,
         `dem.age_children_living_.Wave_4a`,
         `dem.age_children_living_.Wave_4b`,
         `dem.age_children_living_.Wave_5a`,
         `dem.age_children_living_.Wave_6b`,
         `dem.age_children_living_.Wave_7a`,
         `dem.age_children_living_.Wave_8b`,
         `dem.age_children_living_.Wave_9a`,
         `dem.age_children_living_.Wave_10b`,
         `dem.age_children_living_.Wave_11a`,
         `dem.age_children_living_.Wave_12b`,
         
       #  `dem.age_children_living.1_.Wave_1a`,
       #  `dem.age_children_living.1_.Wave_1b`,
         `dem.age_children_living.1_.Wave_2a`,
         `dem.age_children_living.1_.Wave_2b`,
         `dem.age_children_living.1_.Wave_3a`,
         `dem.age_children_living.1_.Wave_3b`,
         `dem.age_children_living.1_.Wave_4a`,
         `dem.age_children_living.1_.Wave_4b`,
         `dem.age_children_living.1_.Wave_5a`,
         `dem.age_children_living.1_.Wave_6b`,
         `dem.age_children_living.1_.Wave_7a`,
         `dem.age_children_living.1_.Wave_8b`,
         `dem.age_children_living.1_.Wave_9a`,
         `dem.age_children_living.1_.Wave_10b`,
         `dem.age_children_living.1_.Wave_11a`,
         `dem.age_children_living.1_.Wave_12b`,
         
       #  `dem.living_with_other_members_of_my_family_.Wave_1a`,
       #  `dem.living_with_other_members_of_my_family_.Wave_1b`,
         `dem.living_with_other_members_of_my_family_.Wave_2a`,
         `dem.living_with_other_members_of_my_family_.Wave_2b`,
         `dem.living_with_other_members_of_my_family_.Wave_3a`,
         `dem.living_with_other_members_of_my_family_.Wave_3b`,
         `dem.living_with_other_members_of_my_family_.Wave_4a`,
         `dem.living_with_other_members_of_my_family_.Wave_4b`,
         `dem.living_with_other_members_of_my_family_.Wave_5a`,
         `dem.living_with_other_members_of_my_family_.Wave_6b`,
         `dem.living_with_other_members_of_my_family_.Wave_7a`,
         `dem.living_with_other_members_of_my_family_.Wave_8b`,
         `dem.living_with_other_members_of_my_family_.Wave_9a`,
         `dem.living_with_other_members_of_my_family_.Wave_10b`,
         `dem.living_with_other_members_of_my_family_.Wave_11a`,
         `dem.living_with_other_members_of_my_family_.Wave_12b`,
         
        # `dem.spouse_partner_members_living_.Wave_1a`,
        # `dem.spouse_partner_members_living_.Wave_1b`,
         `dem.spouse_partner_members_living_.Wave_2a`,
         `dem.spouse_partner_members_living_.Wave_2b`,
         `dem.spouse_partner_members_living_.Wave_3a`,
         `dem.spouse_partner_members_living_.Wave_3b`,
         `dem.spouse_partner_members_living_.Wave_4a`,
         `dem.spouse_partner_members_living_.Wave_4b`,
         `dem.spouse_partner_members_living_.Wave_5a`,
         `dem.spouse_partner_members_living_.Wave_6b`,
         `dem.spouse_partner_members_living_.Wave_7a`,
         `dem.spouse_partner_members_living_.Wave_8b`,
         `dem.spouse_partner_members_living_.Wave_9a`,
         `dem.spouse_partner_members_living_.Wave_10b`,
         `dem.spouse_partner_members_living_.Wave_11a`,
         `dem.spouse_partner_members_living_.Wave_12b`,
         
        # `dem.staying_live_.Wave_1a`,
        # `dem.staying_live_.Wave_1b`,
         `dem.staying_live_.Wave_2a`,
         `dem.staying_live_.Wave_2b`,
         `dem.staying_live_.Wave_3a`,
         `dem.staying_live_.Wave_3b`,
         `dem.staying_live_.Wave_4a`,
         `dem.staying_live_.Wave_4b`,
         `dem.staying_live_.Wave_5a`,
         `dem.staying_live_.Wave_6b`,
         `dem.staying_live_.Wave_7a`,
         `dem.staying_live_.Wave_8b`,
         `dem.staying_live_.Wave_9a`,
         `dem.staying_live_.Wave_10b`,
         `dem.staying_live_.Wave_11a`,
         `dem.staying_live_.Wave_12b`,
         
        # `dem.staying_live.1_.Wave_1a`,
        # `dem.staying_live.1_.Wave_1b`,
         `dem.staying_live.1_.Wave_2a`,
         `dem.staying_live.1_.Wave_2b`,
         `dem.staying_live.1_.Wave_3a`,
         `dem.staying_live.1_.Wave_3b`,
         `dem.staying_live.1_.Wave_4a`,
         `dem.staying_live.1_.Wave_4b`,
         `dem.staying_live.1_.Wave_5a`,
         `dem.staying_live.1_.Wave_6b`,
         `dem.staying_live.1_.Wave_7a`,
         `dem.staying_live.1_.Wave_8b`,
         `dem.staying_live.1_.Wave_9a`,
         `dem.staying_live.1_.Wave_10b`,
         `dem.staying_live.1_.Wave_11a`,
         `dem.staying_live.1_.Wave_12b`,
   
        # `dem.prefer_not_to_say_.Wave_1a`,
        # `dem.prefer_not_to_say_.Wave_1b`,
         `dem.prefer_not_to_say_.Wave_2a`,
         `dem.prefer_not_to_say_.Wave_2b`,
         `dem.prefer_not_to_say_.Wave_3a`,
         `dem.prefer_not_to_say_.Wave_3b`,
         `dem.prefer_not_to_say_.Wave_4a`,
         `dem.prefer_not_to_say_.Wave_4b`,
         `dem.prefer_not_to_say_.Wave_5a`,
         `dem.prefer_not_to_say_.Wave_6b`,
         `dem.prefer_not_to_say_.Wave_7a`,
         `dem.prefer_not_to_say_.Wave_8b`,
         `dem.prefer_not_to_say_.Wave_9a`,
         `dem.prefer_not_to_say_.Wave_10b`,
         `dem.prefer_not_to_say_.Wave_11a`,
         `dem.prefer_not_to_say_.Wave_12b`,
         
         
        # `dem.made_redundant_.Wave_1a`,
        # `dem.made_redundant_.Wave_1b`,
         `dem.made_redundant_.Wave_2a`,
         `dem.made_redundant_.Wave_2b`,
         `dem.made_redundant_.Wave_3a`,
         `dem.made_redundant_.Wave_3b`,
         `dem.made_redundant_.Wave_4a`,
         `dem.made_redundant_.Wave_4b`,
         `dem.made_redundant_.Wave_5a`,
         `dem.made_redundant_.Wave_6b`,
         `dem.made_redundant_.Wave_7a`,
         `dem.made_redundant_.Wave_8b`,
         `dem.made_redundant_.Wave_9a`,
         `dem.made_redundant_.Wave_10b`,
         `dem.made_redundant_.Wave_11a`,
         `dem.made_redundant_.Wave_12b`,
         
        # `dem.became_unemployed_.Wave_1a`,
        # `dem.became_unemployed_.Wave_1b`,
         `dem.became_unemployed_.Wave_2a`,
         `dem.became_unemployed_.Wave_2b`,
         `dem.became_unemployed_.Wave_3a`,
         `dem.became_unemployed_.Wave_3b`,
         `dem.became_unemployed_.Wave_4a`,
         `dem.became_unemployed_.Wave_4b`,
         `dem.became_unemployed_.Wave_5a`,
         `dem.became_unemployed_.Wave_6b`,
         `dem.became_unemployed_.Wave_7a`,
         `dem.became_unemployed_.Wave_8b`,
         `dem.became_unemployed_.Wave_9a`,
         `dem.became_unemployed_.Wave_10b`,
         `dem.became_unemployed_.Wave_11a`,
         `dem.became_unemployed_.Wave_12b`,
         
         #`dem.reduction_in_hours_.Wave_1a`,
         #`dem.reduction_in_hours_.Wave_1b`,
         `dem.reduction_in_hours_.Wave_2a`,
         `dem.reduction_in_hours_.Wave_2b`,
         `dem.reduction_in_hours_.Wave_3a`,
         `dem.reduction_in_hours_.Wave_3b`,
         `dem.reduction_in_hours_.Wave_4a`,
         `dem.reduction_in_hours_.Wave_4b`,
         `dem.reduction_in_hours_.Wave_5a`,
         `dem.reduction_in_hours_.Wave_6b`,
         `dem.reduction_in_hours_.Wave_7a`,
         `dem.reduction_in_hours_.Wave_8b`,
         `dem.reduction_in_hours_.Wave_9a`,
         `dem.reduction_in_hours_.Wave_10b`,
         `dem.reduction_in_hours_.Wave_11a`,
         `dem.reduction_in_hours_.Wave_12b`,
         
         #`dem.reduction_in_salary_.Wave_1a`,
         #`dem.reduction_in_salary_.Wave_1b`,
         `dem.reduction_in_salary_.Wave_2a`,
         `dem.reduction_in_salary_.Wave_2b`,
         `dem.reduction_in_salary_.Wave_3a`,
         `dem.reduction_in_salary_.Wave_3b`,
         `dem.reduction_in_salary_.Wave_4a`,
         `dem.reduction_in_salary_.Wave_4b`,
         `dem.reduction_in_salary_.Wave_5a`,
         `dem.reduction_in_salary_.Wave_6b`,
         `dem.reduction_in_salary_.Wave_7a`,
         `dem.reduction_in_salary_.Wave_8b`,
         `dem.reduction_in_salary_.Wave_9a`,
         `dem.reduction_in_salary_.Wave_10b`,
         `dem.reduction_in_salary_.Wave_11a`,
         `dem.reduction_in_salary_.Wave_12b`,
         
        # `dem.benefits_increased_.Wave_1a`,
        # `dem.benefits_increased_.Wave_1b`,
         `dem.benefits_increased_.Wave_2a`,
         `dem.benefits_increased_.Wave_2b`,
         `dem.benefits_increased_.Wave_3a`,
         `dem.benefits_increased_.Wave_3b`,
         `dem.benefits_increased_.Wave_4a`,
         `dem.benefits_increased_.Wave_4b`,
         `dem.benefits_increased_.Wave_5a`,
         `dem.benefits_increased_.Wave_6b`,
         `dem.benefits_increased_.Wave_7a`,
         `dem.benefits_increased_.Wave_8b`,
         `dem.benefits_increased_.Wave_9a`,
         `dem.benefits_increased_.Wave_10b`,
         `dem.benefits_increased_.Wave_11a`,
         `dem.benefits_increased_.Wave_12b`,
         
        # `dem.benefits_decreased_.Wave_1a`,
        # `dem.benefits_decreased_.Wave_1b`,
         `dem.benefits_decreased_.Wave_2a`,
         `dem.benefits_decreased_.Wave_2b`,
         `dem.benefits_decreased_.Wave_3a`,
         `dem.benefits_decreased_.Wave_3b`,
         `dem.benefits_decreased_.Wave_4a`,
         `dem.benefits_decreased_.Wave_4b`,
         `dem.benefits_decreased_.Wave_5a`,
         `dem.benefits_decreased_.Wave_6b`,
         `dem.benefits_decreased_.Wave_7a`,
         `dem.benefits_decreased_.Wave_8b`,
         `dem.benefits_decreased_.Wave_9a`,
         `dem.benefits_decreased_.Wave_10b`,
         `dem.benefits_decreased_.Wave_11a`,
         `dem.benefits_decreased_.Wave_12b`,
         
        # `dem.change_in_duties_or_responsibilites_.Wave_1a`,
        # `dem.change_in_duties_or_responsibilites_.Wave_1b`,
         `dem.change_in_duties_or_responsibilites_.Wave_2a`,
         `dem.change_in_duties_or_responsibilites_.Wave_2b`,
         `dem.change_in_duties_or_responsibilites_.Wave_3a`,
         `dem.change_in_duties_or_responsibilites_.Wave_3b`,
         `dem.change_in_duties_or_responsibilites_.Wave_4a`,
         `dem.change_in_duties_or_responsibilites_.Wave_4b`,
         `dem.change_in_duties_or_responsibilites_.Wave_5a`,
         `dem.change_in_duties_or_responsibilites_.Wave_6b`,
         `dem.change_in_duties_or_responsibilites_.Wave_7a`,
         `dem.change_in_duties_or_responsibilites_.Wave_8b`,
         `dem.change_in_duties_or_responsibilites_.Wave_9a`,
         `dem.change_in_duties_or_responsibilites_.Wave_10b`,
         `dem.change_in_duties_or_responsibilites_.Wave_11a`,
         `dem.change_in_duties_or_responsibilites_.Wave_12b`,
         
       #  `dem.became_employed_.Wave_1a`,
       #  `dem.became_employed_.Wave_1b`,
         `dem.became_employed_.Wave_2a`,
         `dem.became_employed_.Wave_2b`,
         `dem.became_employed_.Wave_3a`,
         `dem.became_employed_.Wave_3b`,
         `dem.became_employed_.Wave_4a`,
         `dem.became_employed_.Wave_4b`,
         `dem.became_employed_.Wave_5a`,
         `dem.became_employed_.Wave_6b`,
         `dem.became_employed_.Wave_7a`,
         `dem.became_employed_.Wave_8b`,
         `dem.became_employed_.Wave_9a`,
         `dem.became_employed_.Wave_10b`,
         `dem.became_employed_.Wave_11a`,
         `dem.became_employed_.Wave_12b`,
         
       #  `dem.increased_hours_.Wave_1a`,
       #  `dem.increased_hours_.Wave_1b`,
         `dem.increased_hours_.Wave_2a`,
         `dem.increased_hours_.Wave_2b`,
         `dem.increased_hours_.Wave_3a`,
         `dem.increased_hours_.Wave_3b`,
         `dem.increased_hours_.Wave_4a`,
         `dem.increased_hours_.Wave_4b`,
         `dem.increased_hours_.Wave_5a`,
         `dem.increased_hours_.Wave_6b`,
         `dem.increased_hours_.Wave_7a`,
         `dem.increased_hours_.Wave_8b`,
         `dem.increased_hours_.Wave_9a`,
         `dem.increased_hours_.Wave_10b`,
         `dem.increased_hours_.Wave_11a`,
         `dem.increased_hours_.Wave_12b`,
         
        # `dem.furloughed_or_paid_leave_government_funded_.Wave_1a`,
        # `dem.furloughed_or_paid_leave_government_funded_.Wave_1b`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_2a`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_2b`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_3a`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_3b`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_4a`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_4b`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_5a`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_6b`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_7a`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_8b`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_9a`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_10b`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_11a`,
         `dem.furloughed_or_paid_leave_government_funded_.Wave_12b`,
         
         # `dem.furloughed_or_paid_leave_company_funded_.Wave_1a`,
         #`dem.furloughed_or_paid_leave_company_funded_.Wave_1b`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_2a`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_2b`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_3a`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_3b`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_4a`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_4b`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_5a`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_6b`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_7a`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_8b`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_9a`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_10b`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_11a`,
         `dem.furloughed_or_paid_leave_company_funded_.Wave_12b`,
         
         # `dem.paid_leave_furloughed_.Wave_1a`,
         #`dem.paid_leave_furloughed_.Wave_1b`,
         `dem.paid_leave_furloughed_.Wave_2a`,
         `dem.paid_leave_furloughed_.Wave_2b`,
         `dem.paid_leave_furloughed_.Wave_3a`,
         `dem.paid_leave_furloughed_.Wave_3b`,
         `dem.paid_leave_furloughed_.Wave_4a`,
         `dem.paid_leave_furloughed_.Wave_4b`,
         `dem.paid_leave_furloughed_.Wave_5a`,
         `dem.paid_leave_furloughed_.Wave_6b`,
         `dem.paid_leave_furloughed_.Wave_7a`,
         `dem.paid_leave_furloughed_.Wave_8b`,
         `dem.paid_leave_furloughed_.Wave_9a`,
         `dem.paid_leave_furloughed_.Wave_10b`,
         `dem.paid_leave_furloughed_.Wave_11a`,
         `dem.paid_leave_furloughed_.Wave_12b`,
         
       #  `dem.paid_leave_returned_work_.Wave_1b`,
        #  `dem.paid_leave_returned_work_.Wave_1a`,
         `dem.paid_leave_returned_work_.Wave_2a`,
         `dem.paid_leave_returned_work_.Wave_2b`,
         `dem.paid_leave_returned_work_.Wave_3a`,
         `dem.paid_leave_returned_work_.Wave_3b`,
         `dem.paid_leave_returned_work_.Wave_4a`,
         `dem.paid_leave_returned_work_.Wave_4b`,
         `dem.paid_leave_returned_work_.Wave_5a`,
         `dem.paid_leave_returned_work_.Wave_6b`,
         `dem.paid_leave_returned_work_.Wave_7a`,
         `dem.paid_leave_returned_work_.Wave_8b`,
         `dem.paid_leave_returned_work_.Wave_9a`,
         `dem.paid_leave_returned_work_.Wave_10b`,
         `dem.paid_leave_returned_work_.Wave_11a`,
         `dem.paid_leave_returned_work_.Wave_12b`,
         
        #  `dem.retired_.Wave_1a`,
        # `dem.retired_.Wave_1b`,
        `dem.retired_.Wave_2a`,
         `dem.retired_.Wave_2b`,
         `dem.retired_.Wave_3a`,
         `dem.retired_.Wave_3b`,
         `dem.retired_.Wave_4a`,
         `dem.retired_.Wave_4b`,
         `dem.retired_.Wave_5a`,
         `dem.retired_.Wave_6b`,
         `dem.retired_.Wave_7a`,
         `dem.retired_.Wave_8b`,
         `dem.retired_.Wave_9a`,
         `dem.retired_.Wave_10b`,
         `dem.retired_.Wave_11a`,
         `dem.retired_.Wave_12b`
         
         )
}
```

Remove duplicate IDs COPING follow up demographics
```{r Remove duplicate IDs COPING follow up demographics}
if(COPING == TRUE) {
##Check col names
colnames(dat.raw.dem.coping.followup)

##Remove dupilcate IDs (as each wave is now a column, there should be NO dup IDs)
dat.raw.dem.coping.followup  <- dat.raw.dem.coping.followup %>%
  filter(., !duplicated(ID)) 

##Check number of rows
nrow(dat.raw.dem.coping.followup)
}

```

# TIMEPOINTS / PHASES - COPING TAF

Create a phase columns in follow up data 
```{r Identify phases COPING follow up TAF}
if (COPING ==TRUE) {
source("./timepoints_COPING.R")

}

```

Join TAF COPING follow ups 
```{r Merge COPING follow ups TAF}
if(COPING == TRUE) {
dat.raw.taf.coping <- rbind(taf.coping.followupa.raw.id,
    taf.coping.followupb.raw.id)


##Check col names
colnames(dat.raw.taf.coping)

##Check number of rows
nrow(dat.raw.taf.coping)

}
```

Check for number of entries per wave
```{r Check for number of entries per wave COPING follow up TAF}
if(COPING == TRUE) {

dat.raw.taf.coping %>%
  group_by(wave_taf) %>%
  count()

}
```

Identify duplicate IDs in a single wave
```{r Identify duplicate IDs in a single wave COPING follow up TAF}
if(COPING == TRUE) {

##Identify dup IDs in a single wave
dat.raw.taf.coping %>%
   group_by(wave_taf, ID) %>%
   summarize(N = n()) %>%
   filter(N > 1)
}
```

Want the LATER data entry from people who answered twice within a single wave (for now!)
[want ID AND wave to be unique]
```{r Later entry COPING follow up TAF}
if(COPING == TRUE) {

 ##FOLLOW UP B EDEQ SCREENER
##confirm number of rows in current dataset
nrow(dat.raw.taf.coping)

#Filter out duplicated IDs AND wave, keeping the LAST entry
dat.raw.taf.coping <- dat.raw.taf.coping %>% 
    group_by(ID) %>% 
    filter(!duplicated(wave_taf,
                      fromLast = TRUE)
           )

##confirm number of rows in dataset after filtering 
nrow(dat.raw.taf.coping)
}
```

Change follow up TAF COPING to wide format
```{r TAF COPING wide format}
if(COPING == TRUE) {
dat.raw.taf.coping.wide <- dat.raw.taf.coping %>%
  group_by(wave_taf) %>%
  mutate(row = row_number()) %>%
  tidyr::pivot_wider(id_cols = ID,
                     names_from = wave_taf,
                     values_from = c(taf.worth_living_life_people,
                              taf.felt_weeks_past,
                              taf.have_you_contemplated_harming_yourself,
                              taf.felt_weeks_past.1,
                              taf.meant_life_end_weeks))

  
}


```

Select variables for dataset TAF COPING
```{r Select variables COPING follow up TAF}
if(COPING == TRUE) {
dat.raw.taf.coping <- dat.raw.taf.coping.wide %>%
  select(ID,
          #`taf.worth_living_life_people_.Wave_1a`,
        # `taf.worth_living_life_people_.Wave_1b`,
         `taf.worth_living_life_people_.Wave_2a`,
         `taf.worth_living_life_people_.Wave_2b`,
         `taf.worth_living_life_people_.Wave_3a`,
         `taf.worth_living_life_people_.Wave_3b`,
         `taf.worth_living_life_people_.Wave_4a`,
        `taf.worth_living_life_people_.Wave_4b`,
         `taf.worth_living_life_people_.Wave_5a`,
         `taf.worth_living_life_people_.Wave_6b`,
         `taf.worth_living_life_people_.Wave_7a`,
         `taf.worth_living_life_people_.Wave_8b`,
         `taf.worth_living_life_people_.Wave_9a`,
         `taf.worth_living_life_people_.Wave_10b`,
         `taf.worth_living_life_people_.Wave_11a`,
         `taf.worth_living_life_people_.Wave_12b`,
         
         
       #  `taf.felt_weeks_past_.Wave_1a`,
        # `taf.felt_weeks_past_.Wave_1b`,
         `taf.felt_weeks_past_.Wave_2a`,
         `taf.felt_weeks_past_.Wave_2b`,
         `taf.felt_weeks_past_.Wave_3a`,
         `taf.felt_weeks_past_.Wave_3b`,
         `taf.felt_weeks_past_.Wave_4a`,
       `taf.felt_weeks_past_.Wave_4b`,
         `taf.felt_weeks_past_.Wave_5a`,
         `taf.felt_weeks_past_.Wave_6b`,
         `taf.felt_weeks_past_.Wave_7a`,
         `taf.felt_weeks_past_.Wave_8b`,
         `taf.felt_weeks_past_.Wave_9a`,
         `taf.felt_weeks_past_.Wave_10b`,
         `taf.felt_weeks_past_.Wave_11a`,
         `taf.felt_weeks_past_.Wave_12b`,
         
        # `taf.have_you_contemplated_harming_yourself_.Wave_1a`,
        # `taf.have_you_contemplated_harming_yourself_.Wave_1b`,
         `taf.have_you_contemplated_harming_yourself_.Wave_2a`,
         `taf.have_you_contemplated_harming_yourself_.Wave_2b`,
         `taf.have_you_contemplated_harming_yourself_.Wave_3a`,
         `taf.have_you_contemplated_harming_yourself_.Wave_3b`,
         `taf.have_you_contemplated_harming_yourself_.Wave_4a`,
       `taf.have_you_contemplated_harming_yourself_.Wave_4b`,
         `taf.have_you_contemplated_harming_yourself_.Wave_5a`,
         `taf.have_you_contemplated_harming_yourself_.Wave_6b`,
         `taf.have_you_contemplated_harming_yourself_.Wave_7a`,
         `taf.have_you_contemplated_harming_yourself_.Wave_8b`,
         `taf.have_you_contemplated_harming_yourself_.Wave_9a`,
         `taf.have_you_contemplated_harming_yourself_.Wave_10b`,
         `taf.have_you_contemplated_harming_yourself_.Wave_11a`,
         `taf.have_you_contemplated_harming_yourself_.Wave_12b`,
         
        # `taf.felt_weeks_past.1_.Wave_1a`,
        # `taf.felt_weeks_past.1_.Wave_1b`,
         `taf.felt_weeks_past.1_.Wave_2a`,
         `taf.felt_weeks_past.1_.Wave_2b`,
         `taf.felt_weeks_past.1_.Wave_3a`,
         `taf.felt_weeks_past.1_.Wave_3b`,
         `taf.felt_weeks_past.1_.Wave_4a`,
        `taf.felt_weeks_past.1_.Wave_4b`,
         `taf.felt_weeks_past.1_.Wave_5a`,
         `taf.felt_weeks_past.1_.Wave_6b`,
         `taf.felt_weeks_past.1_.Wave_7a`,
         `taf.felt_weeks_past.1_.Wave_8b`,
         `taf.felt_weeks_past.1_.Wave_9a`,
         `taf.felt_weeks_past.1_.Wave_10b`,
         `taf.felt_weeks_past.1_.Wave_11a`,
         `taf.felt_weeks_past.1_.Wave_12b`,
         
        # `taf.meant_life_end_weeks_.Wave_1a`,
        # `taf.meant_life_end_weeks_.Wave_1b`,
         `taf.meant_life_end_weeks_.Wave_2a`,
         `taf.meant_life_end_weeks_.Wave_2b`,
         `taf.meant_life_end_weeks_.Wave_3a`,
         `taf.meant_life_end_weeks_.Wave_3b`,
         `taf.meant_life_end_weeks_.Wave_4a`,
       `taf.meant_life_end_weeks_.Wave_4b`,
         `taf.meant_life_end_weeks_.Wave_5a`,
         `taf.meant_life_end_weeks_.Wave_6b`,
         `taf.meant_life_end_weeks_.Wave_7a`,
         `taf.meant_life_end_weeks_.Wave_8b`,
         `taf.meant_life_end_weeks_.Wave_9a`,
         `taf.meant_life_end_weeks_.Wave_10b`,
         `taf.meant_life_end_weeks_.Wave_11a`,
         `taf.meant_life_end_weeks_.Wave_12b`
         )
}
```

Remove duplicate IDs TAF COPING
```{r Remove duplicate IDs TAF COPING}
if(COPING == TRUE) {
##Check col names
colnames(dat.raw.taf.coping)

##Remove dupilcate IDs (as each wave is now a column, there should be NO dup IDs)
dat.raw.taf.coping  <- dat.raw.taf.coping  %>%
  filter(., !duplicated(ID)) 

##Check number of rows
nrow(dat.raw.taf.coping)
}

```

# TIMEPOINTS / PHASES - loss of a loved one due to COVID COPING
```{r Identify phase dates loss of a loved one due to COVID COPING}
if (COPING ==TRUE) {
source("./timepoints_COPING.R")
}
```

Count number of entries per phase loss of a loved one due to COVID COPING
```{r Count entries per phase loss of a loved one due to COVID COPING}
if(COPING == TRUE) {
coping.loss.followupb.raw.id %>%
  group_by(wave_loss) %>%
  count()
}
```

Identify duplicate IDs in a single timepoint
```{r Identify duplicate IDs in a single timepoint loss of a loved one due to COVID COPING}
if(COPING == TRUE) {
##Identify dup IDs in a single wave 
coping.loss.followupb.raw.id %>%
   group_by(wave_loss, ID) %>%
   summarize(N = n()) %>%
   filter(N > 1)
}
```

*FOR NOW - Want the LATER data entry from people who answered twice within a single wave 
Later on - want to create variable with 'answered YES at least once'
[want ID AND wave to be unique]
```{r Late entry loss of a loved one due to COVID COPING}
if(COPING == TRUE) {
 ##FOLLOW UP B
##confirm number of rows in current dataset 
nrow(coping.loss.followupb.raw.id)
#Filter out duplicated IDs AND wave, keeping the LAST entry
coping.loss.followupb.raw.id <- coping.loss.followupb.raw.id %>% 
    group_by(ID) %>% 
    filter(!duplicated(wave_loss,
                      fromLast = TRUE)
           )
##confirm number of rows in dataset after filtering 
nrow(coping.loss.followupb.raw.id)
}
```

Change follow up loss of a loved one due to COVID COPING to wide format
```{r Loss of a loved one due to COVID COPING wide format}
if(COPING == TRUE) {
coping.loss.followupb.raw.id <- coping.loss.followupb.raw.id %>%
  group_by(wave_loss) %>%
  mutate(row = row_number()) %>%
  tidyr::pivot_wider(id_cols = ID,
    names_from = wave_loss, 
                     values_from = c( grief.due_past_month_lost,
                                      grief.suffered_past_month_loss
                       )) 
  
}
```

Select variables for dataset loss of a loved one due to COVID COPING
```{r Select variables loss of a loved one due to COVID COPING}
if(COPING == TRUE) {
coping.loss.followupb.raw.id <- coping.loss.followupb.raw.id %>%
  select(ID,
        # `grief.due_past_month_lost_.Wave_1a`,
        # `grief.due_past_month_lost_.Wave_1b`,
         `grief.due_past_month_lost_.Wave_2b`,
         `grief.due_past_month_lost_.Wave_3b`,
         `grief.due_past_month_lost_.Wave_4b`,
         `grief.due_past_month_lost_.Wave_6b`,
         `grief.due_past_month_lost_.Wave_8b`,
         `grief.due_past_month_lost_.Wave_10b`,
         `grief.due_past_month_lost_.Wave_12b`,
         
       #   `grief.suffered_past_month_loss_.Wave_1a`,
       #  `grief.suffered_past_month_loss_.Wave_1b`,
         `grief.suffered_past_month_loss_.Wave_2b`,
         `grief.suffered_past_month_loss_.Wave_3b`,
         `grief.suffered_past_month_loss_.Wave_4b`,
         `grief.suffered_past_month_loss_.Wave_6b`,
         `grief.suffered_past_month_loss_.Wave_8b`,
         `grief.suffered_past_month_loss_.Wave_10b`,
         `grief.suffered_past_month_loss_.Wave_12b`
         
         )
}
```

Remove duplicate IDs loss of a loved one due to COVID COPING
```{r Remove duplicate IDs loss of a loved one due to COVID COPING}
if(COPING == TRUE) {
##Check col names
colnames(coping.loss.followupb.raw.id)
##Remove dupilcate IDs (as each wave is now a column, there should be NO dup IDs)
coping.loss.followupb.raw.id  <- coping.loss.followupb.raw.id %>%
  filter(., !duplicated(ID)) 
##Check number of rows
nrow(coping.loss.followupb.raw.id)
}
```

# TIMEPOINTS / PHASES - COPING EDEQ SCREENER 

```{r Check number of entries per phase COPING EDEQ screener}
if(COPING == TRUE) {
edeq.coping.followupb.screener.raw.id %>%
  group_by(wave_edeq) %>%
  count()

}
```

Idenfity duplicate IDs in a single phase COPING EDEQ screener 
```{r Idenfity duplicate IDs in a single phase COPING EDEQ screener }
if(COPING == TRUE) {

##Identify dup IDs in a single wave
edeq.coping.followupb.screener.raw.id %>%
   group_by(wave_edeq, ID) %>%
   summarize(N = n()) %>%
   filter(N > 1)
}
```

Want the LATER data entry from people who answered twice within a single wave (for now)
[want ID AND wave to be unique]
```{r Later date entry COPING EDEQ screener }
if(COPING == TRUE) {

 ##FOLLOW UP B EDEQ SCREENER
##confirm number of rows in current dataset
nrow(edeq.coping.followupb.screener.raw.id)

#Filter out duplicated IDs AND wave, keeping the LAST entry
edeq.coping.followupb.screener.raw.id <- edeq.coping.followupb.screener.raw.id %>% 
    group_by(ID) %>% 
    filter(!duplicated(wave_edeq,
                      fromLast = TRUE)
           )

##confirm number of rows in dataset after filtering (84728 - 206)
nrow(edeq.coping.followupb.screener.raw.id)
}
```

Change follow up EDEQ COPING screener to wide format 
```{r COPING EDEQ screener wide format}
if(COPING == TRUE) {
edeq.coping.followupb.screener.raw.id <- edeq.coping.followupb.screener.raw.id %>%
  group_by(wave_edeq) %>%
  mutate(row = row_number()) %>%
  tidyr::pivot_wider(id_cols = ID,
    names_from = wave_edeq,
                     values_from = c(ed_scid5.regular_episodes_eating_binges,
                     ed_scid5.weigh_weighed_past_month,
                     ed_scid5.regular_episodes_eating_binges_numeric,
                     ed_scid5.weigh_weighed_past_month_numeric))
  
}

```

Select variables for dataset EDEQ COPING screener
```{r Select variables EDEQ COPING screener}
if(COPING == TRUE) {
edeq.coping.followupb.screener.raw.id <- edeq.coping.followupb.screener.raw.id  %>%
  select(ID,
         #`ed_scid5.regular_episodes_eating_binges_.Wave_1b`,
         `ed_scid5.regular_episodes_eating_binges_.Wave_2b` ,    
         `ed_scid5.regular_episodes_eating_binges_.Wave_3b` ,       
         `ed_scid5.regular_episodes_eating_binges_.Wave_4b`,
         `ed_scid5.regular_episodes_eating_binges_.Wave_6b`,
         `ed_scid5.regular_episodes_eating_binges_.Wave_8b`,
         `ed_scid5.regular_episodes_eating_binges_.Wave_10b`,
         `ed_scid5.regular_episodes_eating_binges_.Wave_12b`,
         
        # `ed_scid5.weigh_weighed_past_month_.Wave_1b`,
         `ed_scid5.weigh_weighed_past_month_.Wave_2b` ,    
         `ed_scid5.weigh_weighed_past_month_.Wave_3b` ,       
         `ed_scid5.weigh_weighed_past_month_.Wave_4b`,
         `ed_scid5.weigh_weighed_past_month_.Wave_6b`,
         `ed_scid5.weigh_weighed_past_month_.Wave_8b`,
         `ed_scid5.weigh_weighed_past_month_.Wave_10b`,
         `ed_scid5.weigh_weighed_past_month_.Wave_12b`,
         
         # `ed_scid5.regular_episodes_eating_binges_numeric_.Wave_1b`,
         `ed_scid5.regular_episodes_eating_binges_numeric_.Wave_2b` ,    
         `ed_scid5.regular_episodes_eating_binges_numeric_.Wave_3b` ,       
         `ed_scid5.regular_episodes_eating_binges_numeric_.Wave_4b`,
         `ed_scid5.regular_episodes_eating_binges_numeric_.Wave_6b`,
         `ed_scid5.regular_episodes_eating_binges_numeric_.Wave_8b`,
         `ed_scid5.regular_episodes_eating_binges_numeric_.Wave_10b`,
         `ed_scid5.regular_episodes_eating_binges_numeric_.Wave_12b`,
         
        # `ed_scid5.weigh_weighed_past_month_numeric_.Wave_1b`,
         `ed_scid5.weigh_weighed_past_month_numeric_.Wave_2b` ,    
         `ed_scid5.weigh_weighed_past_month_numeric_.Wave_3b` ,       
         `ed_scid5.weigh_weighed_past_month_numeric_.Wave_4b`,
         `ed_scid5.weigh_weighed_past_month_numeric_.Wave_6b`,
         `ed_scid5.weigh_weighed_past_month_numeric_.Wave_8b`,
         `ed_scid5.weigh_weighed_past_month_numeric_.Wave_10b`,
         `ed_scid5.weigh_weighed_past_month_numeric_.Wave_12b`)
}
```

Remove duplicate IDs EDEQ COPING screener
```{r Remove duplicate IDs EDEQ COPING screener}
if(COPING == TRUE) {
##Check col names
colnames(edeq.coping.followupb.screener.raw.id)

##Remove dupilcate IDs (as each wave is now a column, there should be NO dup IDs)
edeq.coping.followupb.screener.raw.id  <- edeq.coping.followupb.screener.raw.id  %>%
  filter(., !duplicated(ID)) 

##Check number of rows
nrow(edeq.coping.followupb.screener.raw.id)
}

```


##VIRUS INFO 

#Want the LATER data entry from people who answered twice within a single wave 
[want ID AND wave to be unique]
```{r}
if(COPING == TRUE) {

 ##FOLLOW UP B virus
##confirm number of rows in current dataset
nrow(coping.followupb.virus.id)

#Filter out duplicated IDs AND wave, keeping the LAST entry
coping.followupb.virus.id <- coping.followupb.virus.id %>% 
    group_by(ID) %>% 
    filter(!duplicated(wave_virus,
                      fromLast = TRUE)
           )

##confirm number of rows in dataset after filtering
nrow(coping.followupb.virus.id)
}
```

## 6. Change follow up COPING VIRUS to long format 
```{r TAF COPING long format}
if(COPING == TRUE) {
coping.followupb.virus.id <- coping.followupb.virus.id %>%
  group_by(wave_virus) %>%
  mutate(row = row_number()) %>%
  tidyr::pivot_wider(id_cols = ID,
    names_from = wave_virus,
                     values_from = c(virus.back_positive_antibodies_covid,
                     virus.back_positive_antibodies_covid_numeric,
                     virus.past_surveys_include_reported,
                     virus.past_surveys_include_reported_numeric))
  
}

```


##7. Select variables for dataset EDEQ RAMP screener
```{r}
if(COPING == TRUE) {
coping.followupb.virus.id <- coping.followupb.virus.id  %>%
  select(ID,
         `virus.back_positive_antibodies_covid_.Wave_2b` ,    
         `virus.back_positive_antibodies_covid_.Wave_3b` ,       
         `virus.back_positive_antibodies_covid_.Wave_4b`,
         `virus.back_positive_antibodies_covid_.Wave_6b`,
         `virus.back_positive_antibodies_covid_.Wave_8b`,
         `virus.back_positive_antibodies_covid_.Wave_10b`,
         `virus.back_positive_antibodies_covid_.Wave_12b`,

         `virus.back_positive_antibodies_covid_numeric_.Wave_2b` ,    
         `virus.back_positive_antibodies_covid_numeric_.Wave_3b` ,       
         `virus.back_positive_antibodies_covid_numeric_.Wave_4b`,
         `virus.back_positive_antibodies_covid_numeric_.Wave_6b`,
         `virus.back_positive_antibodies_covid_numeric_.Wave_8b`,
         `virus.back_positive_antibodies_covid_numeric_.Wave_10b`,
         `virus.back_positive_antibodies_covid_numeric_.Wave_12b`,
         
         `virus.past_surveys_include_reported_.Wave_2b` ,    
         `virus.past_surveys_include_reported_.Wave_3b` ,       
         `virus.past_surveys_include_reported_.Wave_4b`,
         `virus.past_surveys_include_reported_.Wave_6b`,
         `virus.past_surveys_include_reported_.Wave_8b`,
         `virus.past_surveys_include_reported_.Wave_10b`,
         `virus.past_surveys_include_reported_.Wave_12b`,
         
         `virus.past_surveys_include_reported_numeric_.Wave_2b` ,    
         `virus.past_surveys_include_reported_numeric_.Wave_3b` ,       
         `virus.past_surveys_include_reported_numeric_.Wave_4b`,
         `virus.past_surveys_include_reported_numeric_.Wave_6b`,
         `virus.past_surveys_include_reported_numeric_.Wave_8b`,
         `virus.past_surveys_include_reported_numeric_.Wave_10b`,
         `virus.past_surveys_include_reported_numeric_.Wave_12b`

         
        )
}
```

##8. Remove duplicate IDs EDEQ COPING
```{r}
if(COPING == TRUE) {
##Check col names
colnames(coping.followupb.virus.id)

##Remove dupilcate IDs (as each wave is now a column, there should be NO dup IDs)
coping.followupb.virus.id  <- coping.followupb.virus.id  %>%
  filter(., !duplicated(ID)) 

##Check number of rows
nrow(coping.followupb.virus.id)
}

```

# TIMEPOINTS / PHASES - Virus info COPING
[want ID AND wave to be unique]
```{r Last entry Virus info COPING}
if(COPING == TRUE) {
 ##FOLLOW UP B virus
##confirm number of rows in current dataset
nrow(coping.followupb.virus.id)
#Filter out duplicated IDs AND wave, keeping the LAST entry
coping.followupb.virus.id <- coping.followupb.virus.id %>% 
    group_by(ID) %>% 
    filter(!duplicated(wave_virus,
                      fromLast = TRUE)
           )
##confirm number of rows in dataset after filtering
nrow(coping.followupb.virus.id)
}
```

Change follow up COPING VIRUS to wide format 
```{r Virus info COPING wide format}
if(COPING == TRUE) {
coping.followupb.virus.id <- coping.followupb.virus.id %>%
  group_by(wave_virus) %>%
  mutate(row = row_number()) %>%
  tidyr::pivot_wider(id_cols = ID,
    names_from = wave_virus,
                     values_from = c(virus.back_positive_antibodies_covid,
                     virus.back_positive_antibodies_covid_numeric,
                     virus.past_surveys_include_reported,
                     virus.past_surveys_include_reported_numeric))
  
}
```

Select variables for dataset COPING VIRUS
```{r Select variables COPING VIRUS}
if(COPING == TRUE) {
coping.followupb.virus.id <- coping.followupb.virus.id  %>%
  select(ID,
         `virus.back_positive_antibodies_covid_.Wave_2b` ,    
         `virus.back_positive_antibodies_covid_.Wave_3b` ,       
         `virus.back_positive_antibodies_covid_.Wave_4b`,
         `virus.back_positive_antibodies_covid_.Wave_6b`,
         `virus.back_positive_antibodies_covid_.Wave_8b`,
         `virus.back_positive_antibodies_covid_.Wave_10b`,
         `virus.back_positive_antibodies_covid_.Wave_12b`,
         `virus.back_positive_antibodies_covid_numeric_.Wave_2b` ,    
         `virus.back_positive_antibodies_covid_numeric_.Wave_3b` ,       
         `virus.back_positive_antibodies_covid_numeric_.Wave_4b`,
         `virus.back_positive_antibodies_covid_numeric_.Wave_6b`,
         `virus.back_positive_antibodies_covid_numeric_.Wave_8b`,
         `virus.back_positive_antibodies_covid_numeric_.Wave_10b`,
         `virus.back_positive_antibodies_covid_numeric_.Wave_12b`,
         
         `virus.past_surveys_include_reported_.Wave_2b` ,    
         `virus.past_surveys_include_reported_.Wave_3b` ,       
         `virus.past_surveys_include_reported_.Wave_4b`,
         `virus.past_surveys_include_reported_.Wave_6b`,
         `virus.past_surveys_include_reported_.Wave_8b`,
         `virus.past_surveys_include_reported_.Wave_10b`,
         `virus.past_surveys_include_reported_.Wave_12b`,
         
         `virus.past_surveys_include_reported_numeric_.Wave_2b` ,    
         `virus.past_surveys_include_reported_numeric_.Wave_3b` ,       
         `virus.past_surveys_include_reported_numeric_.Wave_4b`,
         `virus.past_surveys_include_reported_numeric_.Wave_6b`,
         `virus.past_surveys_include_reported_numeric_.Wave_8b`,
         `virus.past_surveys_include_reported_numeric_.Wave_10b`,
         `virus.past_surveys_include_reported_numeric_.Wave_12b`
         
        )
}
```

Remove duplicate IDs COPING VIRUS
```{r}
if(COPING == TRUE) {
##Check col names
colnames(coping.followupb.virus.id)
##Remove dupilcate IDs (as each wave is now a column, there should be NO dup IDs)
coping.followupb.virus.id  <- coping.followupb.virus.id  %>%
  filter(., !duplicated(ID)) 
##Check number of rows
nrow(coping.followupb.virus.id)
}
```

# TIMEPOINTS / PHASES - Virus info RAMP
[want ID AND wave to be unique]
```{r  Last entry Virus info RAMP}
if(RAMP == TRUE) {
 ##FOLLOW UP B virus
##confirm number of rows in current dataset
nrow(ramp.followupb.virus.id)
#Filter out duplicated IDs AND wave, keeping the LAST entry
ramp.followupb.virus.id <- ramp.followupb.virus.id %>% 
    group_by(ID) %>% 
    filter(!duplicated(wave_virus,
                      fromLast = TRUE)
           )
##confirm number of rows in dataset after filtering
nrow(ramp.followupb.virus.id)
}
```

Change follow up COPING VIRUS RAMP to wide format 
```{r RAMP VIRUS info wide format}
if(RAMP == TRUE) {
ramp.followupb.virus.id <- ramp.followupb.virus.id %>%
  group_by(wave_virus) %>%
  mutate(row = row_number()) %>%
  tidyr::pivot_wider(id_cols = ID,
    names_from = wave_virus,
                     values_from = c(virus.back_positive_antibodies_covid,
                     virus.back_positive_antibodies_covid_numeric,
                     virus.past_surveys_include_reported,
                     virus.past_surveys_include_reported_numeric))
  
}
```

Select variables for dataset RAMP VIRUS
```{r Select variables for RAMP VIRUS}
if(RAMP == TRUE) {
ramp.followupb.virus.id <- ramp.followupb.virus.id  %>%
  select(ID,
         `virus.back_positive_antibodies_covid_.Wave_1b`,
         `virus.back_positive_antibodies_covid_.Wave_2b` ,    
         `virus.back_positive_antibodies_covid_.Wave_3b` ,       
         `virus.back_positive_antibodies_covid_.Wave_4b`,
         `virus.back_positive_antibodies_covid_.Wave_6b`,
         `virus.back_positive_antibodies_covid_.Wave_8b`,
         `virus.back_positive_antibodies_covid_.Wave_10b`,
         `virus.back_positive_antibodies_covid_.Wave_12b`,
         `virus.back_positive_antibodies_covid_numeric_.Wave_1b`,
         `virus.back_positive_antibodies_covid_numeric_.Wave_2b` ,    
         `virus.back_positive_antibodies_covid_numeric_.Wave_3b` ,       
         `virus.back_positive_antibodies_covid_numeric_.Wave_4b`,
         `virus.back_positive_antibodies_covid_numeric_.Wave_6b`,
         `virus.back_positive_antibodies_covid_numeric_.Wave_8b`,
         `virus.back_positive_antibodies_covid_numeric_.Wave_10b`,
         `virus.back_positive_antibodies_covid_numeric_.Wave_12b`,
       
        `virus.past_surveys_include_reported_.Wave_1b`,
         `virus.past_surveys_include_reported_.Wave_2b` ,    
         `virus.past_surveys_include_reported_.Wave_3b` ,       
         `virus.past_surveys_include_reported_.Wave_4b`,
         `virus.past_surveys_include_reported_.Wave_6b`,
         `virus.past_surveys_include_reported_.Wave_8b`,
         `virus.past_surveys_include_reported_.Wave_10b`,
         `virus.past_surveys_include_reported_.Wave_12b`,
         
         `virus.past_surveys_include_reported_numeric_.Wave_1b`,
         `virus.past_surveys_include_reported_numeric_.Wave_2b` ,    
         `virus.past_surveys_include_reported_numeric_.Wave_3b` ,       
         `virus.past_surveys_include_reported_numeric_.Wave_4b`,
         `virus.past_surveys_include_reported_numeric_.Wave_6b`,
         `virus.past_surveys_include_reported_numeric_.Wave_8b`,
         `virus.past_surveys_include_reported_numeric_.Wave_10b`,
         `virus.past_surveys_include_reported_numeric_.Wave_12b`)
}
```

Remove duplicate IDs RAMP VIRUS
```{r}
if(RAMP == TRUE) {
##Check col names
colnames(ramp.followupb.virus.id)
##Remove dupilcate IDs (as each wave is now a column, there should be NO dup IDs)
ramp.followupb.virus.id  <- ramp.followupb.virus.id  %>%
  filter(., !duplicated(ID)) 
##Check number of rows
nrow(ramp.followupb.virus.id)
}
```

Remove duplicate IDs RAMP VIRUS
```{r Remove dup IDs RAMP VIRUS}
if(RAMP == TRUE) {
##Check col names
colnames(ramp.followupb.virus.id)

##Remove dupilcate IDs (as each wave is now a column, there should be NO dup IDs)
ramp.followupb.virus.id  <- ramp.followupb.virus.id  %>%
  filter(., !duplicated(ID)) 

##Check number of rows
nrow(ramp.followupb.virus.id)
}

```

# Export all follow up data
```{r Export follow up data}
if(COPING == TRUE) {

saveRDS(object = dat.raw.taf.coping, file = paste0("/Users/helenadavies/King's College London/MT-Translational Neuropsychiatric Genomics - Helena_Davies_PhD - Helena_Davies_PhD/EDBeh_SelfHarm/data_cleaned/TAF_coping", date, ".rds"))
  
  saveRDS(object = edeq.coping.followupb.screener.raw.id, file = paste0("/Users/helenadavies/King's College London/MT-Translational Neuropsychiatric Genomics - Helena_Davies_PhD - Helena_Davies_PhD/EDBeh_SelfHarm/data_cleaned/EDEQ_screener_coping", date, ".rds"))
  
  saveRDS(object = dat.raw.dem.coping.followup, file = paste0("/Users/helenadavies/King's College London/MT-Translational Neuropsychiatric Genomics - Helena_Davies_PhD - Helena_Davies_PhD/EDBeh_SelfHarm/data_cleaned/DEM_followup_coping", date, ".rds"))
  
  saveRDS(object = coping.loss.followupb.raw.id, file = paste0("/Users/helenadavies/King's College London/MT-Translational Neuropsychiatric Genomics - Helena_Davies_PhD - Helena_Davies_PhD/EDBeh_SelfHarm/data_cleaned/LOSS_coping_followup", date, ".rds"))

  saveRDS(object = coping.followupb.virus.id, file = "../data_cleaned/virus_coping_followup.rds")
}

if(RAMP == TRUE) {

  saveRDS(object = dat.raw.taf.ramp, file = paste0("/Users/helenadavies/King's College London/MT-Translational Neuropsychiatric Genomics - Helena_Davies_PhD - Helena_Davies_PhD/EDBeh_SelfHarm/data_cleaned/TAF_ramp", date, ".rds"))
  
  saveRDS(object = edeq.ramp.followupb.screener.raw.id, file = paste0("/Users/helenadavies/King's College London/MT-Translational Neuropsychiatric Genomics - Helena_Davies_PhD - Helena_Davies_PhD/EDBeh_SelfHarm/data_cleaned/EDEQ_screener_ramp", date, ".rds"))
  
   saveRDS(object = dat.raw.dem.ramp.followup, file = paste0("/Users/helenadavies/King's College London/MT-Translational Neuropsychiatric Genomics - Helena_Davies_PhD - Helena_Davies_PhD/EDBeh_SelfHarm/data_cleaned/DEM_followup_ramp", date, ".rds"))

   saveRDS(object = ramp.loss.followupb.raw.id, file = paste0("/Users/helenadavies/King's College London/MT-Translational Neuropsychiatric Genomics - Helena_Davies_PhD - Helena_Davies_PhD/EDBeh_SelfHarm/data_cleaned/LOSS_ramp_followup", date, ".rds"))
   
   saveRDS(object = ramp.followupb.virus.id, file = "../data_cleaned/virus_ramp_followup.rds")

}

```

# JOINING DATASETS - baseline 

## Select same variables from each dataset

EDGI select variables from each dataset
```{r EDGI select variables for final dataset}
if(EDGI == TRUE) {
  
  # Temporary solution - Drop one dup cohort name columns
edgi.coping.dem.raw.id$cohort_name.y <- NULL
edgi.coping.dem.raw.id <- edgi.coping.dem.raw.id %>% 
  rename(
    cohort_name = cohort_name.x
    )

edgi.1 <- edgi.coping.dem.raw.id %>% 
  select(ID,
  cohort_name,
  gender_unc,
  sex,
  uk_location,
  current_country,
  age_category_COPING)
  
edgi.2 <- edgi.dem3.raw.id %>% 
  select(ID,
  cohort_name,
  age_category_numeric,
  age_category,
  highest_education_prepan_numeric,
  highest_education_prepan,
  ethnicity, 
  transgender)
  
edgi.3 <- edgi.coping.dem4.employ.raw.id %>% 
  select(ID,
  cohort_name,
  highest_education_numeric,
  highest_education,
  employment_prior_covid_numeric,
  employment_prior_covid,
  employment_change_numeric,
  employment_change,
  key_worker,
  employed,
  employ.government_work_key_workers_numeric,
  employ.government_work_key_workers,
  key_worker_numeric,
  employ.fulltime_employed,
  employ.parttime_employed,
  employ.unemployed,
  employ.zerohours_contract,
  employ.stayathome_parent_or_carer,
  employ.selfemployed,
  employ.contract_or_freelance_work,
  employ.small_business_owner,
  employ.receiving_state_income,
  employ.retired,
  employ.student_gcse_or_a_level,
  employ.student_university,
  employ.my_employment_status_has_not_changed,
  employ.became_unemployed,
  employ.reduction_in_hours,
  employ.reduction_in_salary,
  employ.benefits_increased,
  employ.benefits_decreased,
  employ.change_in_duties_or_responsibilities,
  employ.became_employed,
  employ.increased_hours,
  employ.increased_salary,
  employ.furloughed_or_paid_leave_government_funded,
  employ.furloughed_or_paid_leave_company_funded,
  employ.paid_leave_furloughed,
  employ.taking_unpaid_leave,
  employ.other,
  employ.other_text.txt,
  employ.no_impact,
  employ.cancelled_exams,
  employ.change_in_format_of_exams,
  employ.automatic_pass,
  employ.change_in_deadlines,
  employ.change_in_lesson_delivery,
  employ.past_performance_grade_decided,
  employ.cancelled_classes,
  employ.cannot_complete_degree,
  employ.impact_on_studies_still_unknown,
  employ.other.1,
  employ.other_text.txt.1,
  employ.losing_job_due_risk,
  employ.increased_due_job_pandemic)
  
edgi.4 <- taf.edgi.coping.baseline.raw.id %>% 
  select(ID,
  cohort_name,
  taf.worth_living_life_people_.Wavebaseline,
  taf.felt_weeks_past_.Wavebaseline,
  taf.have_you_contemplated_harming_yourself_.Wavebaseline,
  taf.felt_weeks_past.1_.Wavebaseline,
  taf.meant_life_end_weeks_.Wavebaseline,
   taf.pandemic_felt_.Wavebaseline,
  taf.pandemic_felt.1_.Wavebaseline,
  taf.meant_end_life_pandemic_.Wavebaseline)

edgi.5 <- mhd.raw.id %>% #3251
  select(ID,
         cohort_name,
         control,
         control_numeric,
         depressive_disorders_numeric,
         anxiety_disorders_numeric,
         eating_disorders_diagnosed_numeric,
         obsessive_compulsive_disorders_numeric,
         psychotic_disorders_numeric,
         PERSONALITY_DISORDER_NUMERIC,
         agoraphobia_panic_disorder_numeric,
         depression_and_anxiety_numeric,
         bipolar_and_schizophrenia_numeric,
         mhd.mania_hypomania_bipolar_or_manicdepression_numeric,
         mhd.posttraumatic_stress_disorder_ptsd_numeric, 
         autism_spectrum_disorder_numeric,
         mhd.attention_deficit_hyperactivity_disorder_numeric,
         mhd.personality_disorder_numeric,
         mhd.suspected_eating_disorder_diagnosed_numeric,
         mhd.body_dysmorphic_disorder_bdd_numeric,
         mhd.anorexia_nervosa_numeric,
          mhd.atypical_anorexia_nervosa_numeric,
          mhd.bulimia_nervosa_numeric, 
          mhd.atypical_bulimia_nervosa_numeric,  
          mhd.bingeeating_disorder_numeric, 
          mhd.atypical_bingeeating_disorder_numeric, 
          mhd.purging_disorder_numeric, 
          mhd.night_eating_syndrome_numeric,  
          mhd.pica_numeric, 
          mhd.avoidantrestrictive_food_intake_disorder_numeric,
          mhd.rumination_disorder_numeric, 
          mhd.feeding_eating_disorder_numeric, 
          mhd.other_eating_disorder_numeric)

edgi.6 <- taf.edgi.coping.baseline.raw.id %>% 
  select(ID,
  cohort_name,
  taf.pandemic_felt_.Wavebaseline,
  taf.pandemic_felt.1_.Wavebaseline,
  taf.meant_end_life_pandemic_.Wavebaseline)

edgi.7 <- edgi.coping.dem2.raw.id %>%
  select(ID,
         cohort_name,
         dem2.living_with_partner_or_spouse,
         dem2.living_alone,
         dem2.living_with_partner_or_spouse,
         dem2.living_with_housemates,
         dem2.age_children_living,
         dem2.age_children_living.1,
         dem2.living_with_other_members_of_my_family,
         dem2.spouse_partner_members_living,
         dem2.staying_live,
         dem2.staying_live.1,
         dem2.prefer_not_to_say,
         dem2.living_situation_change_pandemic,
         dem2.living_alone.1,
         dem2.living_with_partner_or_spouse.1,
         dem2.living_with_housemates.1,
         dem2.age_children_living.2,
         dem2.age_children_living.3,
         dem2.living_with_other_members_of_my_family.1,
         dem2.spouse_partner_members_living.1,
         dem2.staying_live.2,
         dem2.staying_live.3,
         dem2.prefer_not_to_say.1,
          dem2.member_vulnerable_group,
         dem2.solid_organ_transplant_recipient,
         dem2.lung_cancer_radical_radiotherapy,
         dem2.bone_marrow_blood_leukaemia,
         dem2.immunotherapy_cancer_continuing_antibody,
         dem2.parp_inhibitors_affect_immune,
         dem2.stem_cell_transplants_bone,
         dem2.severe_copd_cystic_fibrosis,
         dem2.inborn_errors_rare_diseases,
         dem2.taking_medicine_that_weakens_your_immune_system,
         dem2.condition_infections_makes,
         dem2.congenital_pregnant_acquired_significant,
         dem2.pregnant,
         dem2.over_70_years_old,
         dem2.prefer_not_to_say.2,
         dem2.unsure)
  
edgi.8 <- edgi_pan_worry.id %>%
  select(ID,
         cohort_name,
         panworry.impact_on_your_employment_status,                                    
         panworry.employment_status_household_key,              
         panworry.impact_on_your_education_or_exams,            
         panworry.exams_impact_education_children,              
         panworry.financial_impact,                           
         panworry.contracting_the_virus,                       
         panworry.people_you_know_contracting_the_virus,       
         panworry.people_you_dont_know_contracting_the_virus,   
         panworry.impact_mental_health_wellbeing,               
         panworry.impact_mental_health_childrens,               
         panworry.impact_relatives_mental_health,           
         panworry.being_socially_isolated,                    
         panworry.people_you_know_being_socially_isolated,      
         panworry.shortage_of_essential_supplies,                
         panworry.shortage_of_medication_or_access_to_healthcare,
         panworry.healthcare_people_essential_supplies,          
         panworry.information_virus_government_accuracy,         
         panworry.the_governments_response_to_the_pandemic,      
         panworry.separation_from_family_members,         
         panworry.standing_impact_global_recession,
         panworry.other_,
         
         panworry.impact_on_your_employment_status_numeric,                                    
         panworry.employment_status_household_key_numeric,              
         panworry.impact_on_your_education_or_exams_numeric,            
         panworry.exams_impact_education_children_numeric,              
         panworry.financial_impact_numeric,                           
         panworry.contracting_the_virus_numeric,                       
         panworry.people_you_know_contracting_the_virus_numeric,       
         panworry.people_you_dont_know_contracting_the_virus_numeric,   
         panworry.impact_mental_health_wellbeing_numeric,               
         panworry.impact_mental_health_childrens_numeric,               
         panworry.impact_relatives_mental_health_numeric,           
         panworry.being_socially_isolated_numeric,                    
         panworry.people_you_know_being_socially_isolated_numeric,      
         panworry.shortage_of_essential_supplies_numeric,                
         panworry.shortage_of_medication_or_access_to_healthcare_numeric,
         panworry.healthcare_people_essential_supplies_numeric,          
         panworry.information_virus_government_accuracy_numeric,         
         panworry.the_governments_response_to_the_pandemic_numeric,      
         panworry.separation_from_family_members_numeric,         
         panworry.standing_impact_global_recession_numeric,
         panworry.other__numeric)
  
edgi.9 <- edgi.loneliness.baseline.raw.id %>%
  select(ID,
         cohort_name,
         lone.felt_that_you_lack_companionship,
        lone.felt_left_out,
        lone.felt_isolated_from_others,
        lone.felt_alone,lone.similar_felt_pandemic,
        lone.felt_that_you_lack_companionship.1,
        lone.felt_left_out.1,
        lone.felt_isolated_from_others.1,
        lone.felt_alone.1
  )
edgi.10 <- edgi.loss.baseline.raw.id %>%
  select(ID, 
         cohort_name,
         grief.covid_lost_due_close,
         grief.suffered_past_month_loss)
  
       
##See if IDs match with edgi.5
x <- edgi.5[edgi.5$ID %in% edgi.4$ID,]
length(unique(x$ID))
x <- edgi.5[edgi.5$ID %in% edgi.3$ID,]
length(unique(x$ID))
x <- edgi.5[edgi.5$ID %in% edgi.2$ID,]
length(unique(x$ID))
x <- edgi.5[edgi.5$ID %in% edgi.1$ID,]
length(unique(x$ID))
}
# NB: No EDEQ baseline (only in ramp)
```

EDGI data frame list
```{r EDGI data frame list}
if(EDGI == TRUE) {
dfs.list <- list(
  edgi.1,
  edgi.2,
  edgi.3,
  edgi.4,
  edgi.5,
  edgi.7,
  edgi.8,
  edgi.9, 
  edgi.10
)
}
```

Join all EDGI
```{r Join all EDGI questionnaires}
if(EDGI == TRUE) {
dat.raw.edgi <- plyr::join_all(
  dfs.list,
  by = c("ID", "cohort_name") # Alternatively you can join by several columns EDGI -> "Age", "Sex", "Birthyear"
  )
#look at the data
colnames(dat.raw.edgi)
}
```

Get rid of duplicates in EDGI
```{r Check duplicates EDGI final dataset}
if(EDGI == TRUE) {
dat.raw.edgi$ID.dup <- duplicated(dat.raw.edgi$ID)
summary(as.factor(dat.raw.edgi$ID.dup))
select(dat.raw.edgi)
 #Check for duplicate names of columns
names_freq <- as.data.frame(table(names(dat.raw.edgi)))
names_freq[names_freq$Freq > 1, ]
##Filter out duplicate column names
 dat.dup <- dat.raw.edgi %>%
  filter(ID.dup == TRUE)
dat.raw.edgi <- dat.raw.edgi %>%
  filter(ID.dup == FALSE)
colnames(dat.raw.edgi)
}
```

GLAD data frame list
```{r GLAD data frame list}
if(GLAD == TRUE) {
  
  #Temporary solution - Drop one dup cohort name columns
glad.coping.dem.raw.id$cohort_name.y <- NULL
glad.coping.dem.raw.id <- glad.coping.dem.raw.id %>% 
  rename(
    cohort_name = cohort_name.x
    )

glad.1 <-  glad.coping.dem.raw.id %>%
     select(ID,
            cohort_name,
            sex,
            gender_unc,
            uk_location,
            current_country,
            age_category_COPING
            )

glad.2 <- glad.dem3.raw.id %>%
  select(ID,
         cohort_name,
         age_category_numeric,
         age_category,
         ethnicity,
         highest_education_prepan_numeric,
         highest_education_prepan,
         transgender)

glad.3 <- glad.coping.dem4.employ.raw.id %>% 
  select(ID,
         cohort_name,
         highest_education_numeric,
         highest_education,
         employment_prior_covid,
         employment_prior_covid_numeric,
         employment_change,
         employment_change_numeric,
         key_worker,
         key_worker_numeric,
         employed,
         employ.government_work_key_workers_numeric,
           employ.government_work_key_workers,
         employ.fulltime_employed,
  employ.parttime_employed,
  employ.unemployed,
  employ.zerohours_contract,
  employ.stayathome_parent_or_carer,
  employ.selfemployed,
  employ.contract_or_freelance_work,
  employ.small_business_owner,
  employ.receiving_state_income,
  employ.retired,
  employ.student_gcse_or_a_level,
  employ.student_university,
  employ.my_employment_status_has_not_changed,
  employ.became_unemployed,
  employ.reduction_in_hours,
  employ.reduction_in_salary,
  employ.benefits_increased,
  employ.benefits_decreased,
  employ.change_in_duties_or_responsibilities,
  employ.became_employed,
  employ.increased_hours,
  employ.increased_salary,
  employ.furloughed_or_paid_leave_government_funded,
  employ.furloughed_or_paid_leave_company_funded,
  employ.paid_leave_furloughed,
  employ.taking_unpaid_leave,
  employ.other,
  employ.other_text.txt,
  employ.no_impact,
  employ.cancelled_exams,
  employ.change_in_format_of_exams,
  employ.automatic_pass,
  employ.change_in_deadlines,
  employ.change_in_lesson_delivery,
  employ.past_performance_grade_decided,
  employ.cancelled_classes,
  employ.cannot_complete_degree,
  employ.impact_on_studies_still_unknown,
  employ.other.1,
  employ.other_text.txt.1,
  employ.losing_job_due_risk,
  employ.increased_due_job_pandemic)

glad.4 <- taf.glad.coping.baseline.raw.id%>%
  select(ID,
  cohort_name,
  taf.worth_living_life_people_.Wavebaseline,
  taf.felt_weeks_past_.Wavebaseline,
  taf.have_you_contemplated_harming_yourself_.Wavebaseline,
  taf.felt_weeks_past.1_.Wavebaseline,
  taf.meant_life_end_weeks_.Wavebaseline,
   taf.pandemic_felt_.Wavebaseline,
  taf.pandemic_felt.1_.Wavebaseline,
  taf.meant_end_life_pandemic_.Wavebaseline)

glad.5 <- mhd.raw.id %>%
  select(ID,
         cohort_name,
         control,
         control_numeric,
         depressive_disorders_numeric,
         anxiety_disorders_numeric,
         eating_disorders_diagnosed_numeric,
         obsessive_compulsive_disorders_numeric,
         psychotic_disorders_numeric,
         PERSONALITY_DISORDER_NUMERIC,
         agoraphobia_panic_disorder_numeric,
         depression_and_anxiety_numeric,
         bipolar_and_schizophrenia_numeric,
         mhd.mania_hypomania_bipolar_or_manicdepression_numeric,
        mhd.posttraumatic_stress_disorder_ptsd_numeric, 
        autism_spectrum_disorder_numeric,
        mhd.attention_deficit_hyperactivity_disorder_numeric,
        mhd.personality_disorder_numeric,
        mhd.suspected_eating_disorder_diagnosed_numeric,
        mhd.body_dysmorphic_disorder_bdd_numeric,
        mhd.anorexia_nervosa_numeric,
          mhd.atypical_anorexia_nervosa_numeric,
          mhd.bulimia_nervosa_numeric, 
          mhd.atypical_bulimia_nervosa_numeric,  
          mhd.bingeeating_disorder_numeric, 
          mhd.atypical_bingeeating_disorder_numeric, 
          mhd.purging_disorder_numeric, 
          mhd.night_eating_syndrome_numeric,  
          mhd.pica_numeric, 
          mhd.avoidantrestrictive_food_intake_disorder_numeric,
          mhd.rumination_disorder_numeric, 
          mhd.feeding_eating_disorder_numeric, 
          mhd.other_eating_disorder_numeric)

glad.6 <- glad.coping.dem2.raw.id %>%
  select(ID,
         cohort_name,
         dem2.living_with_partner_or_spouse,
         dem2.living_alone,
         dem2.living_with_partner_or_spouse,
         dem2.living_with_housemates,
         dem2.age_children_living,
         dem2.age_children_living.1,
         dem2.living_with_other_members_of_my_family,
         dem2.spouse_partner_members_living,
         dem2.staying_live,
         dem2.staying_live.1,
         dem2.prefer_not_to_say,
         dem2.living_situation_change_pandemic,
         dem2.living_alone.1,
         dem2.living_with_partner_or_spouse.1,
         dem2.living_with_housemates.1,
         dem2.age_children_living.2,
         dem2.age_children_living.3,
         dem2.living_with_other_members_of_my_family.1,
         dem2.spouse_partner_members_living.1,
         dem2.staying_live.2,
         dem2.staying_live.3,
         dem2.prefer_not_to_say.1,
         
         dem2.member_vulnerable_group,
         dem2.solid_organ_transplant_recipient,
         dem2.lung_cancer_radical_radiotherapy,
         dem2.bone_marrow_blood_leukaemia,
         dem2.immunotherapy_cancer_continuing_antibody,
         dem2.parp_inhibitors_affect_immune,
         dem2.stem_cell_transplants_bone,
         dem2.severe_copd_cystic_fibrosis,
         dem2.inborn_errors_rare_diseases,
         dem2.taking_medicine_that_weakens_your_immune_system,
         dem2.condition_infections_makes,
         dem2.congenital_pregnant_acquired_significant,
         dem2.pregnant,
         dem2.over_70_years_old,
         dem2.prefer_not_to_say.2,
         dem2.unsure)
  
glad.7 <- glad_pan_worry.id %>%
  select(ID,
         cohort_name,
         panworry.impact_on_your_employment_status,                                    
         panworry.employment_status_household_key,              
         panworry.impact_on_your_education_or_exams,            
         panworry.exams_impact_education_children,              
         panworry.financial_impact,                           
         panworry.contracting_the_virus,                       
         panworry.people_you_know_contracting_the_virus,       
         panworry.people_you_dont_know_contracting_the_virus,   
         panworry.impact_mental_health_wellbeing,               
         panworry.impact_mental_health_childrens,               
         panworry.impact_relatives_mental_health,           
         panworry.being_socially_isolated,                    
         panworry.people_you_know_being_socially_isolated,      
         panworry.shortage_of_essential_supplies,                
         panworry.shortage_of_medication_or_access_to_healthcare,
         panworry.healthcare_people_essential_supplies,          
         panworry.information_virus_government_accuracy,         
         panworry.the_governments_response_to_the_pandemic,      
         panworry.separation_from_family_members,         
         panworry.standing_impact_global_recession,
         panworry.other_,
         
         panworry.impact_on_your_employment_status_numeric,                                    
         panworry.employment_status_household_key_numeric,              
         panworry.impact_on_your_education_or_exams_numeric,            
         panworry.exams_impact_education_children_numeric,              
         panworry.financial_impact_numeric,                           
         panworry.contracting_the_virus_numeric,                       
         panworry.people_you_know_contracting_the_virus_numeric,       
         panworry.people_you_dont_know_contracting_the_virus_numeric,   
         panworry.impact_mental_health_wellbeing_numeric,               
         panworry.impact_mental_health_childrens_numeric,               
         panworry.impact_relatives_mental_health_numeric,           
         panworry.being_socially_isolated_numeric,                    
         panworry.people_you_know_being_socially_isolated_numeric,      
         panworry.shortage_of_essential_supplies_numeric,                
         panworry.shortage_of_medication_or_access_to_healthcare_numeric,
         panworry.healthcare_people_essential_supplies_numeric,          
         panworry.information_virus_government_accuracy_numeric,         
         panworry.the_governments_response_to_the_pandemic_numeric,      
         panworry.separation_from_family_members_numeric,         
         panworry.standing_impact_global_recession_numeric,
         panworry.other__numeric)

glad.8 <- glad.loneliness.baseline.raw.id %>%
  select(ID,
         cohort_name,
         lone.felt_that_you_lack_companionship,
        lone.felt_left_out,
        lone.felt_isolated_from_others,
        lone.felt_alone,lone.similar_felt_pandemic,
        lone.felt_that_you_lack_companionship.1,
        lone.felt_left_out.1,
        lone.felt_isolated_from_others.1,
        lone.felt_alone.1
  )

glad.9 <- glad.loss.baseline.raw.id %>%
  select(ID, 
         cohort_name,
         grief.covid_lost_due_close,
         grief.suffered_past_month_loss)
  
##See if IDs match with glad.3
x <- glad.3[glad.3$ID %in% glad.1$ID,]
length(unique(x$ID))
x <- glad.3[glad.3$ID %in% glad.2$ID,]
length(unique(x$ID))
x <- glad.3[glad.3$ID %in% glad.4$ID,]
length(unique(x$ID))
x <- glad.3[glad.3$ID %in% glad.5$ID,]
length(unique(x$ID))
}
```

GLAD data frame list
```{r GLAD data frame list}
if(GLAD == TRUE) {
dfs.list <- list(
  glad.1,
  glad.2,
  glad.3,
  glad.4,
  glad.5,
  glad.6,
  glad.7,
  glad.8,
  glad.9
  )
}
```

Join all GLAD
```{r Join all GLAD questionnaires}
if(GLAD == TRUE) {
dat.raw.glad <- plyr::join_all(
  dfs.list,
  by = c("ID", "cohort_name")
  )
#look at the data
colnames(dat.raw.glad)
}
```

Get rid of duplicates in GLAD
```{r Check duplicates GLAD final dataset}
if(GLAD == TRUE) {
  dat.raw.glad$ID.dup <- duplicated(dat.raw.glad$ID)
summary(as.factor(dat.raw.glad$ID.dup))
select(dat.raw.glad)
#Check for duplicate names of columns
names_freq <- as.data.frame(table(names(dat.raw.glad)))
names_freq[names_freq$Freq > 1, ]
##Filter out duplicate column names
 #dat.dup <- dat.raw.glad %>%
 # filter(ID.dup == TRUE)
#dat.raw.glad <- dat.raw.glad %>%
#  filter(ID.dup == FALSE)
colnames(dat.raw.glad)
}
```

NBR selected variables
```{r NBR selected variables final dataset}
if(NBR == TRUE) {
  nbr.1 <- nbr.dem.employ.raw.id %>%
    select(ID,
           cohort_name,
           highest_education_numeric,
           highest_education,
           employment_change_numeric,
           employment_change,
           employment_prior_covid,
           employment_prior_covid_numeric,
           key_worker,
           key_worker_numeric,
           employed,
           employ.government_work_key_workers_numeric,
           employ.government_work_key_workers,
           employ.fulltime_employed,
           employ.parttime_employed,
employ.unemployed,
employ.zerohours_contract,
employ.stayathome_parent_or_carer,
employ.selfemployed,
employ.contract_or_freelance_work,
employ.small_business_owner,
employ.receiving_state_income,
employ.retired,
employ.student_gcse_or_a_level,
employ.student_university,
employ.my_employment_status_has_not_changed,
employ.became_unemployed,
employ.reduction_in_hours,
employ.reduction_in_salary,
employ.benefits_increased,
employ.benefits_decreased,
employ.change_in_duties_or_responsibilities,
employ.became_employed,
employ.increased_hours,
employ.increased_salary,
employ.furloughed_or_paid_leave_government_funded,
employ.furloughed_or_paid_leave_company_funded,
employ.paid_leave_furloughed,
employ.taking_unpaid_leave,
employ.other,
employ.other_text.txt,
employ.no_impact,
employ.cancelled_exams,
employ.change_in_format_of_exams,
employ.automatic_pass,
employ.change_in_deadlines,
employ.change_in_lesson_delivery,
employ.past_performance_grade_decided,
employ.cancelled_classes,
employ.cannot_complete_degree,
employ.impact_on_studies_still_unknown,
employ.other.1,
employ.other_text.txt.1,
employ.losing_job_due_risk,
employ.increased_due_job_pandemic,)
  
nbr.2 <- nbr.dem.raw.id.complete %>%
  select(ID,
         cohort_name,
         sex,
         gender_unc,
         ethnicity,
         current_country,
         uk_location)

nbr.3 <- nbr.dem.raw.id %>%
    select(ID,
           cohort_name,
           age_category,
           age_category_numeric)

nbr.4 <- taf.nbr.baseline.raw.id %>%
  select(ID,
  cohort_name,
  taf.worth_living_life_people_.Wavebaseline,
  taf.felt_weeks_past_.Wavebaseline,
  taf.have_you_contemplated_harming_yourself_.Wavebaseline,
  taf.felt_weeks_past.1_.Wavebaseline,
  taf.meant_life_end_weeks_.Wavebaseline,
  taf.pandemic_felt_.Wavebaseline,
  taf.pandemic_felt.1_.Wavebaseline,
  taf.meant_end_life_pandemic_.Wavebaseline)

nbr.5 <- mhd.raw.id %>% 
  select(ID,
         cohort_name,
         control,
         control_numeric,
         depressive_disorders_numeric,
         anxiety_disorders_numeric,
         eating_disorders_diagnosed_numeric,
         obsessive_compulsive_disorders_numeric,
         psychotic_disorders_numeric,
         PERSONALITY_DISORDER_NUMERIC,
         agoraphobia_panic_disorder_numeric,
         depression_and_anxiety_numeric,
         bipolar_and_schizophrenia_numeric,
         mhd.mania_hypomania_bipolar_or_manicdepression_numeric,
        mhd.posttraumatic_stress_disorder_ptsd_numeric, 
        autism_spectrum_disorder_numeric,
        mhd.attention_deficit_hyperactivity_disorder_numeric,
        mhd.personality_disorder_numeric,
        mhd.suspected_eating_disorder_diagnosed_numeric,
        mhd.body_dysmorphic_disorder_bdd_numeric,
        mhd.anorexia_nervosa_numeric,
          mhd.atypical_anorexia_nervosa_numeric,
          mhd.bulimia_nervosa_numeric, 
          mhd.atypical_bulimia_nervosa_numeric,  
          mhd.bingeeating_disorder_numeric, 
          mhd.atypical_bingeeating_disorder_numeric, 
          mhd.purging_disorder_numeric, 
          mhd.night_eating_syndrome_numeric,  
          mhd.pica_numeric, 
          mhd.avoidantrestrictive_food_intake_disorder_numeric,
          mhd.rumination_disorder_numeric, 
          mhd.feeding_eating_disorder_numeric, 
          mhd.other_eating_disorder_numeric)

nbr.6 <- nbr.dem2.raw.id %>%
  select(ID,
         cohort_name,
         dem2.living_with_partner_or_spouse,
         dem2.living_alone,
         dem2.living_with_partner_or_spouse,
         dem2.living_with_housemates,
         dem2.age_children_living,
         dem2.age_children_living.1,
         dem2.living_with_other_members_of_my_family,
         dem2.spouse_partner_members_living, 
         dem2.staying_live,
         dem2.staying_live.1,
         dem2.prefer_not_to_say,
         dem2.living_situation_change_pandemic,
         dem2.living_alone.1,
         dem2.living_with_partner_or_spouse.1,
         dem2.living_with_housemates.1,
         dem2.age_children_living.2,
         dem2.age_children_living.3,
         dem2.living_with_other_members_of_my_family.1,
         dem2.spouse_partner_members_living.1, 
         dem2.staying_live.2,
         dem2.staying_live.3,
         dem2.prefer_not_to_say.1,
         
         dem2.member_vulnerable_group,
         dem2.solid_organ_transplant_recipient,
         dem2.lung_cancer_radical_radiotherapy,
         dem2.bone_marrow_blood_leukaemia,
         dem2.immunotherapy_cancer_continuing_antibody,
         dem2.parp_inhibitors_affect_immune,
         dem2.stem_cell_transplants_bone,
         dem2.severe_copd_cystic_fibrosis,
         dem2.inborn_errors_rare_diseases,
         dem2.taking_medicine_that_weakens_your_immune_system,
         dem2.condition_infections_makes,
         dem2.congenital_pregnant_acquired_significant,
         dem2.pregnant,
         dem2.over_70_years_old,
         dem2.prefer_not_to_say.2,
         dem2.unsure)

nbr.7 <- nbr_pan_worry.id %>%
  select(ID,
         cohort_name,
         panworry.impact_on_your_employment_status,                                    
         panworry.employment_status_household_key,              
         panworry.impact_on_your_education_or_exams,            
         panworry.exams_impact_education_children,              
         panworry.financial_impact,                           
         panworry.contracting_the_virus,                       
         panworry.people_you_know_contracting_the_virus,       
         panworry.people_you_dont_know_contracting_the_virus,   
         panworry.impact_mental_health_wellbeing,               
         panworry.impact_mental_health_childrens,               
         panworry.impact_relatives_mental_health,           
         panworry.being_socially_isolated,                    
         panworry.people_you_know_being_socially_isolated,      
         panworry.shortage_of_essential_supplies,                
         panworry.shortage_of_medication_or_access_to_healthcare,
         panworry.healthcare_people_essential_supplies,          
         panworry.information_virus_government_accuracy,         
         panworry.the_governments_response_to_the_pandemic,      
         panworry.separation_from_family_members,         
         panworry.standing_impact_global_recession,
         
         panworry.other_,
        panworry.impact_on_your_employment_status_numeric,                                    
         panworry.employment_status_household_key_numeric,              
         panworry.impact_on_your_education_or_exams_numeric,            
         panworry.exams_impact_education_children_numeric,              
         panworry.financial_impact_numeric,                           
         panworry.contracting_the_virus_numeric,                       
         panworry.people_you_know_contracting_the_virus_numeric,       
         panworry.people_you_dont_know_contracting_the_virus_numeric,   
         panworry.impact_mental_health_wellbeing_numeric,               
         panworry.impact_mental_health_childrens_numeric,               
         panworry.impact_relatives_mental_health_numeric,           
         panworry.being_socially_isolated_numeric,                    
         panworry.people_you_know_being_socially_isolated_numeric,      
         panworry.shortage_of_essential_supplies_numeric,                
         panworry.shortage_of_medication_or_access_to_healthcare_numeric,
         panworry.healthcare_people_essential_supplies_numeric,          
         panworry.information_virus_government_accuracy_numeric,         
         panworry.the_governments_response_to_the_pandemic_numeric,      
         panworry.separation_from_family_members_numeric,         
         panworry.standing_impact_global_recession_numeric,
         panworry.other__numeric)

nbr.8 <- nbr.loneliness.baseline.raw.id %>%
  select(ID,
         cohort_name,
         lone.felt_that_you_lack_companionship,
        lone.felt_left_out,
        lone.felt_isolated_from_others,
        lone.felt_alone,lone.similar_felt_pandemic,
        lone.felt_that_you_lack_companionship.1,
        lone.felt_left_out.1,
        lone.felt_isolated_from_others.1,
        lone.felt_alone.1
  )

nbr.9 <- nbr.loss.baseline.raw.id %>%
  select(ID, 
         cohort_name,
         grief.covid_lost_due_close,
         grief.suffered_past_month_loss)
  
#Check nbr mhd data IDs
x <- nbr.5[nbr.5$ID %in% nbr.1$ID,]
length(unique(x$ID))
x <- nbr.5[nbr.5$ID %in% nbr.2$ID,]
length(unique(x$ID))
x <- nbr.5[nbr.5$ID %in% nbr.3$ID,]
length(unique(x$ID))
x <- nbr.5[nbr.5$ID %in% nbr.4$ID,]
length(unique(x$ID))
x <- nbr.9[nbr.9$ID %in% nbr.1$ID,]
length(unique(x$ID))    
nrow(nbr.5)
nrow(nbr.4)
nrow(nbr.3)
nrow(nbr.2)
nrow(nbr.1)
nrow(nbr.9)
}
```

NBR  data frame list
```{r NBR data frame list for final dataset}
if(NBR == TRUE) {
dfs.list <- list(
  nbr.1,
  nbr.2,
  nbr.3,
  nbr.4,
  nbr.5,
  nbr.6,
  nbr.7,
  nbr.8,
  nbr.9
)
}
```

Join all NBR 
```{r Join all NBR questionnaires for final dataset}
if(NBR == TRUE) {
dat.raw.nbr <- plyr::join_all(
  dfs.list,
  by = c("ID", "cohort_name") # Alternatively you can join by several columns EDGI -> "Age", "Sex", "Birthyear"
  )
#look at the data
colnames(dat.raw.nbr)
}
```

Get rid of duplicates in NBR
```{r Check duplicates NBR final dataset}
if(NBR == TRUE) {
dat.raw.nbr$ID.dup <- duplicated(dat.raw.nbr$ID)
summary(as.factor(dat.raw.nbr$ID.dup))
select(dat.raw.nbr)
 #Check for duplicate names of columns
names_freq <- as.data.frame(table(names(dat.raw.nbr)))
names_freq[names_freq$Freq > 1, ]
##Filter out duplicate column names
 dat.dup <- dat.raw.nbr %>%
  filter(ID.dup == TRUE)
dat.raw.nbr <- dat.raw.nbr %>%
  filter(ID.dup == FALSE)
colnames(dat.raw.nbr)
}
```

RAMP variable list
```{r RAMP variable list}
if(RAMP == TRUE) {
  
 
  ramp.1 <- ramp.dem.raw.id %>%
    select(ID,
           cohort_name,
           gender_unc,
           ethnicity,
           age_unc,
           dem2.member_vulnerable_group,
           dem2.solid_organ_transplant_recipient,
           dem2.lung_cancer_radical_radiotherapy,
           dem2.bone_marrow_blood_leukaemia,
           dem2.immunotherapy_cancer_continuing_antibody,
           dem2.parp_inhibitors_affect_immune,
           dem2.stem_cell_transplants_bone,
           dem2.severe_copd_cystic_fibrosis, #= dem2.cystic_fibrosis_severe_asthma,
           dem2.inborn_errors_rare_diseases, # = dem2.inborn_errors_metabolism_infections,
           dem2.taking_medicine_that_weakens_your_immune_system,
           dem2.congenital_pregnant_acquired_significant, # = dem2.condition_infections_makes,
           dem2.pregnant,
           dem2.over_70_years_old,
           dem2.prefer_not_to_say.2, # = dem2.prefer_not_to_say.1,
           dem2.unsure,
           transgender,
           
            dem2.living_with_partner_or_spouse,
         dem2.living_alone,
         dem2.living_with_partner_or_spouse,
         dem2.living_with_housemates,
         dem2.age_children_living,
         dem2.age_children_living.1,
         dem2.living_with_other_members_of_my_family,
         dem2.spouse_partner_members_living,
         dem2.staying_live,
         dem2.staying_live.1,
         dem2.prefer_not_to_say,
         dem2.living_situation_change_pandemic,
         dem2.living_alone.1,
         dem2.living_with_partner_or_spouse.1,
         dem2.living_with_housemates.1,
         dem2.age_children_living.2,
         dem2.age_children_living.3,
         dem2.living_with_other_members_of_my_family.1,
         dem2.spouse_partner_members_living.1,
         dem2.staying_live.2,
         dem2.staying_live.3,
         dem2.prefer_not_to_say.1)

  ramp.2 <- ramp.dem.employ.raw.id %>%
    select(ID,
           cohort_name,
           highest_education,
           highest_education_numeric,
           employment_prior_covid,
           employment_prior_covid_numeric,
           employment_change,
           employment_change_numeric,
           key_worker,
           key_worker_numeric,
           employed,
           employ.government_work_key_workers_numeric,
           employ.government_work_key_workers,
           employ.fulltime_employed,
  employ.parttime_employed,
  employ.unemployed,
  employ.zerohours_contract,
  employ.stayathome_parent_or_carer,
  employ.selfemployed,
  employ.contract_or_freelance_work,
  employ.small_business_owner,
  employ.receiving_state_income,
  employ.retired,
  employ.student_gcse_or_a_level,
  employ.student_university,
  employ.my_employment_status_has_not_changed,
  employ.became_unemployed,
  employ.reduction_in_hours,
  employ.reduction_in_salary,
  employ.benefits_increased,
  employ.benefits_decreased,
  employ.change_in_duties_or_responsibilities,
  employ.became_employed,
  employ.increased_hours,
  employ.increased_salary,
  employ.furloughed_or_paid_leave_government_funded,
  employ.furloughed_or_paid_leave_company_funded,
  employ.paid_leave_furloughed,
  #employ.taking_unpaid_leave,
  employ.other,
  employ.other_text.txt,
  employ.no_impact,
  employ.cancelled_exams,
  employ.change_in_format_of_exams,
  employ.automatic_pass,
  employ.change_in_deadlines,
  employ.change_in_lesson_delivery,
  employ.past_performance_grade_decided,
  employ.cancelled_classes,
  employ.cannot_complete_degree,
  employ.impact_on_studies_still_unknown,
  employ.other.1,
  employ.other_text.txt.1,
  employ.losing_job_due_risk,
  employ.increased_due_job_pandemic)

  ramp.3 <- edeq.ramp.baseline.raw.id %>%
    select(ID,
           cohort_name,
           edeq.deliberately_limit_amount_influence.1_.Wavebaseline,
           edeq.calories_made_body_shape.1_.Wavebaseline,
           edeq.weight_influenced_person.1_.Wavebaseline,
           edeq.dissatisfied_shape_weight.1_.Wavebaseline,
           edeq.eating_behaviours_concerns_distressed.1_.Wavebaseline,
           edeq.nibbled_picked_snacks_grazed.1_.Wavebaseline,
           edeq.felt_anxious_blue_bored.2_.Wavebaseline,
           edeq.felt_anxious_blue_bored.3_.Wavebaseline,
           edeq.actively_been_monitoring_your_shape_or_weight_.1_.Wavebaseline,
           edeq.regard_lost_control_eaten.1_.Wavebaseline,
           edeq.sick_means_made_shape.1_.Wavebaseline,
           edeq.diuretics_laxatives_means_shape.1_.Wavebaseline,
           edeq.compulsive_driven_burn_calories.1_.Wavebaseline,
           edeq.deliberately_limit_amount_influence.1_.Wavebaseline_numeric,
           edeq.calories_made_body_shape.1_.Wavebaseline_numeric,
           edeq.weight_influenced_person.1_.Wavebaseline_numeric,
           edeq.dissatisfied_shape_weight.1_.Wavebaseline_numeric,
           edeq.eating_behaviours_concerns_distressed.1_.Wavebaseline_numeric,
           edeq.nibbled_picked_snacks_grazed.1_.Wavebaseline_numeric,
           edeq.felt_anxious_blue_bored.2_.Wavebaseline_numeric,
           edeq.felt_anxious_blue_bored.3_.Wavebaseline_numeric,
           edeq.actively_been_monitoring_your_shape_or_weight_.1_.Wavebaseline_numeric,
           edeq.regard_lost_control_eaten.1_.Wavebaseline_numeric,
           edeq.sick_means_made_shape.1_.Wavebaseline_numeric,
           edeq.diuretics_laxatives_means_shape.1_.Wavebaseline_numeric,
           edeq.compulsive_driven_burn_calories.1_.Wavebaseline_numeric,
           edeq.deliberately_limit_amount_influence_.Wavebaseline,
          edeq.calories_made_body_shape_.Wavebaseline ,
          edeq.weight_influenced_person_.Wavebaseline,
          edeq.dissatisfied_shape_weight_.Wavebaseline ,
         edeq.nibbled_picked_snacks_grazed_.Wavebaseline ,
         edeq.felt_anxious_blue_bored_.Wavebaseline ,
         edeq.felt_anxious_blue_bored.1_.Wavebaseline ,
         edeq.eating_behaviours_concerns_distressed_.Wavebaseline,
         edeq.actively_been_monitoring_your_shape_or_weight_.Wavebaseline,
         edeq.regard_lost_control_eaten_.Wavebaseline,
         edeq.sick_means_made_shape_.Wavebaseline,
         edeq.diuretics_laxatives_means_shape_.Wavebaseline,
         edeq.compulsive_driven_burn_calories_.Wavebaseline,
         edeq.deliberately_limit_amount_influence_.Wavebaseline_numeric,
         edeq.calories_made_body_shape_.Wavebaseline_numeric,
         edeq.weight_influenced_person_.Wavebaseline_numeric,
         edeq.dissatisfied_shape_weight_.Wavebaseline_numeric ,
         edeq.nibbled_picked_snacks_grazed_.Wavebaseline_numeric ,
         edeq.felt_anxious_blue_bored_.Wavebaseline_numeric ,
         edeq.felt_anxious_blue_bored.1_.Wavebaseline_numeric ,
         edeq.eating_behaviours_concerns_distressed_.Wavebaseline_numeric ,
         edeq.actively_been_monitoring_your_shape_or_weight_.Wavebaseline_numeric,
         edeq.regard_lost_control_eaten_.Wavebaseline_numeric,
         edeq.sick_means_made_shape_.Wavebaseline_numeric,
         edeq.diuretics_laxatives_means_shape_.Wavebaseline_numeric ,
         edeq.compulsive_driven_burn_calories_.Wavebaseline_numeric 
  )
  
ramp.4 <- mhd.raw.id %>% 
  select(ID,
         cohort_name,
         control,
         control_numeric,
         depressive_disorders_numeric,
         anxiety_disorders_numeric,
         eating_disorders_diagnosed_numeric,
         obsessive_compulsive_disorders_numeric,
         psychotic_disorders_numeric,
         PERSONALITY_DISORDER_NUMERIC,
         agoraphobia_panic_disorder_numeric,
         depression_and_anxiety_numeric,
         bipolar_and_schizophrenia_numeric,
         mhd.mania_hypomania_bipolar_or_manicdepression_numeric,
         mhd.posttraumatic_stress_disorder_ptsd_numeric, 
         autism_spectrum_disorder_numeric,
         mhd.attention_deficit_hyperactivity_disorder_numeric,
         mhd.personality_disorder_numeric,
         mhd.body_dysmorphic_disorder_bdd_numeric,
         mhd.anorexia_nervosa_numeric,
         mhd.atypical_anorexia_nervosa_numeric,
         mhd.bulimia_nervosa_numeric,
         mhd.bingeeating_disorder_numeric)

ramp.5 <- taf.ramp.baseline.raw.id  %>% 
  select(ID,
         cohort_name,
         taf.worth_living_life_people_.Wavebaseline,
         taf.felt_weeks_past_.Wavebaseline,
         taf.have_you_contemplated_harming_yourself_.Wavebaseline,
         taf.felt_weeks_past.1_.Wavebaseline,
         taf.meant_life_end_weeks_.Wavebaseline)

ramp.6 <- taf.ramp.baseline.raw.id %>% #for retro prepan
  select(ID,
  cohort_name,
  taf.pandemic_felt_.Wavebaseline,
  taf.pandemic_felt.1_.Wavebaseline,
  taf.meant_end_life_pandemic_.Wavebaseline)

ramp.7 <- ramp_pan_worry.id %>%
  select(ID,
         cohort_name,
         panworry.impact_on_your_employment_status,                                    
         panworry.employment_status_household_key,              
         panworry.impact_on_your_education_or_exams,            
         panworry.exams_impact_education_children,              
         panworry.financial_impact,                           
         panworry.contracting_the_virus,                       
         panworry.people_you_know_contracting_the_virus,       
         panworry.people_you_dont_know_contracting_the_virus,   
         panworry.impact_mental_health_wellbeing,               
         panworry.impact_mental_health_childrens,               
         panworry.impact_relatives_mental_health,           
         panworry.being_socially_isolated,                    
         panworry.people_you_know_being_socially_isolated,      
         panworry.shortage_of_essential_supplies,                
         panworry.shortage_of_medication_or_access_to_healthcare,
         panworry.healthcare_people_essential_supplies,          
         panworry.information_virus_government_accuracy,         
         panworry.the_governments_response_to_the_pandemic,      
         panworry.separation_from_family_members,         
         panworry.standing_impact_global_recession,
         
         panworry.other_,
         
         panworry.impact_on_your_employment_status_numeric,                                    
         panworry.employment_status_household_key_numeric,              
         panworry.impact_on_your_education_or_exams_numeric,            
         panworry.exams_impact_education_children_numeric,              
         panworry.financial_impact_numeric,                           
         panworry.contracting_the_virus_numeric,                       
         panworry.people_you_know_contracting_the_virus_numeric,       
         panworry.people_you_dont_know_contracting_the_virus_numeric,   
         panworry.impact_mental_health_wellbeing_numeric,               
         panworry.impact_mental_health_childrens_numeric,               
         panworry.impact_relatives_mental_health_numeric,           
         panworry.being_socially_isolated_numeric,                    
         panworry.people_you_know_being_socially_isolated_numeric,      
         panworry.shortage_of_essential_supplies_numeric,                
         panworry.shortage_of_medication_or_access_to_healthcare_numeric,
         panworry.healthcare_people_essential_supplies_numeric,          
         panworry.information_virus_government_accuracy_numeric,         
         panworry.the_governments_response_to_the_pandemic_numeric,      
         panworry.separation_from_family_members_numeric,         
         panworry.standing_impact_global_recession_numeric,
         panworry.other__numeric)

ramp.8 <- ramp.loneliness.baseline.raw.id %>%
  select(ID,
         cohort_name,
         lone.felt_that_you_lack_companionship,
        lone.felt_left_out,
        lone.felt_isolated_from_others,
        lone.felt_alone,lone.similar_felt_pandemic,
        lone.felt_that_you_lack_companionship.1,
        lone.felt_left_out.1,
        lone.felt_isolated_from_others.1,
        lone.felt_alone.1
  )

ramp.9 <- ramp.loss.baseline.raw.id %>%
  select(ID, 
         cohort_name,
         grief.covid_lost_due_close,
         grief.suffered_past_month_loss)
  
#Check ramp.4 has same IDs as other datasets
x <- ramp.4[ramp.4$ID %in% ramp.1$ID,]
length(unique(x$ID))
x <- ramp.4[ramp.4$ID %in% ramp.2$ID,]
length(unique(x$ID))
x <- ramp.4[ramp.4$ID %in% ramp.3$ID,]
length(unique(x$ID))
x <- ramp.4[ramp.4$ID %in% ramp.5$ID,]
length(unique(x$ID))    
}
```

RAMP  data frame list
```{r RAMP data frame list}
if(RAMP == TRUE) {
dfs.list <- list(
  ramp.1,
  ramp.2,
  ramp.3,
  ramp.4,
  ramp.5,
  ramp.6,
  ramp.7,
  ramp.8,
  ramp.9
  
)
}
```

Join all RAMP 
```{r Join all RAMP questionnaires final dataset}
if(RAMP == TRUE) {
dat.raw.ramp <- plyr::join_all(
  dfs.list,
  by = c("ID", "cohort_name") # Alternatively you can join by several columns EDGI -> "Age", "Sex", "Birthyear"
  )
#look at the data
colnames(dat.raw.ramp)
}
```

Get rid of duplicates in RAMP
```{r Check duplicates RAMP final dataset}
if(RAMP == TRUE) {
dat.raw.ramp$ID.dup <- duplicated(dat.raw.ramp$ID)
summary(as.factor(dat.raw.ramp$ID.dup))
 #Check for duplicate names of columns
names_freq <- as.data.frame(table(names(dat.raw.ramp)))
names_freq[names_freq$Freq > 1, ]
##Filter out duplicate column names
 dat.dup <- dat.raw.ramp %>%
  filter(ID.dup == TRUE)
dat.raw.ramp <- dat.raw.ramp %>%
  filter(ID.dup == FALSE)
}
```

# Export baseline data
```{r export data}
if(GLAD == TRUE) {
saveRDS(object = dat.raw.glad, file = paste0("/Users/helenadavies/King's College London/MT-Translational Neuropsychiatric Genomics - Helena_Davies_PhD - Helena_Davies_PhD/EDBeh_SelfHarm/data_cleaned/BASELINE_glad", date, ".rds"))
}
if(EDGI == TRUE) {
saveRDS(object = dat.raw.edgi, file = paste0("/Users/helenadavies/King's College London/MT-Translational Neuropsychiatric Genomics - Helena_Davies_PhD - Helena_Davies_PhD/EDBeh_SelfHarm/data_cleaned/BASELINE_edgi", date, ".rds"))
  
}
if(RAMP == TRUE) {
  saveRDS(object = dat.raw.ramp, file = paste0("/Users/helenadavies/King's College London/MT-Translational Neuropsychiatric Genomics - Helena_Davies_PhD - Helena_Davies_PhD/EDBeh_SelfHarm/data_cleaned/BASELINE_ramp", date, ".rds"))
}
if(NBR == TRUE) {
  saveRDS(object = dat.raw.nbr, file = paste0("/Users/helenadavies/King's College London/MT-Translational Neuropsychiatric Genomics - Helena_Davies_PhD - Helena_Davies_PhD/EDBeh_SelfHarm/data_cleaned/BASELINE_nbr", date, ".rds"))
}
```

























----
```{r EDGI select variables}
if(EDGI == TRUE) {
  
    
  #Drop one dup cohort name columns
edgi.coping.dem.raw.id$cohort_name.y <- NULL

edgi.coping.dem.raw.id <- edgi.coping.dem.raw.id %>% 
  rename(
    cohort_name = cohort_name.x
    )

edgi.1 <- edgi.coping.dem.raw.id %>% 
  select(ID,
  cohort_name,
  gender_unc,
  sex,
  uk_location,
  current_country,
  age_category_COPING)
  
edgi.2 <- edgi.dem3.raw.id %>% 
  select(ID,
  cohort_name,
  age_category_numeric,
  age_category,
  highest_education_prepan_numeric,
  highest_education_prepan,
  ethnicity, 
  transgender)
  
edgi.3 <- edgi.coping.dem4.employ.raw.id %>% 
  select(ID,
  cohort_name,
  highest_education_numeric,
  highest_education,
  employment_prior_covid_numeric,
  employment_prior_covid,
  employment_change_numeric,
  employment_change,
  key_worker,
  key_worker_numeric,
  employ.fulltime_employed,
  employ.parttime_employed,
  employ.unemployed,
  employ.zerohours_contract,
  employ.stayathome_parent_or_carer,
  employ.selfemployed,
  employ.contract_or_freelance_work,
  employ.small_business_owner,
  employ.receiving_state_income,
  employ.retired,
  employ.student_gcse_or_a_level,
  employ.student_university,
  employ.my_employment_status_has_not_changed,
  employ.became_unemployed,
  employ.reduction_in_hours,
  employ.reduction_in_salary,
  employ.benefits_increased,
  employ.benefits_decreased,
  employ.change_in_duties_or_responsibilities,
  employ.became_employed,
  employ.increased_hours,
  employ.increased_salary,
  employ.furloughed_or_paid_leave_government_funded,
  employ.furloughed_or_paid_leave_company_funded,
  employ.paid_leave_furloughed,
  employ.taking_unpaid_leave,
  employ.other,
  employ.other_text.txt,
  employ.no_impact,
  employ.cancelled_exams,
  employ.change_in_format_of_exams,
  employ.automatic_pass,
  employ.change_in_deadlines,
  employ.change_in_lesson_delivery,
  employ.past_performance_grade_decided,
  employ.cancelled_classes,
  employ.cannot_complete_degree,
  employ.impact_on_studies_still_unknown,
  employ.other.1,
  employ.other_text.txt.1,
  employ.losing_job_due_risk,
  employ.increased_due_job_pandemic)
  
edgi.4 <- taf.edgi.coping.baseline.raw.id %>% 
  select(ID,
  cohort_name,
  taf.worth_living_life_people_.Wavebaseline,
  taf.felt_weeks_past_.Wavebaseline,
  taf.have_you_contemplated_harming_yourself_.Wavebaseline,
  taf.felt_weeks_past.1_.Wavebaseline,
  taf.meant_life_end_weeks_.Wavebaseline,
   taf.pandemic_felt_.Wavebaseline,
  taf.pandemic_felt.1_.Wavebaseline,
  taf.meant_end_life_pandemic_.Wavebaseline)


edgi.5 <- mhd.raw.id %>% #3251
  select(ID,
         cohort_name,
         control,
         control_numeric,
         depressive_disorders_numeric,
         anxiety_disorders_numeric,
         eating_disorders_diagnosed_numeric,
         obsessive_compulsive_disorders_numeric,
         psychotic_disorders_numeric,
         PERSONALITY_DISORDER_NUMERIC,
         agoraphobia_panic_disorder_numeric,
         depression_and_anxiety_numeric,
         bipolar_and_schizophrenia_numeric,
         mhd.mania_hypomania_bipolar_or_manicdepression_numeric,
         mhd.posttraumatic_stress_disorder_ptsd_numeric, 
         autism_spectrum_disorder_numeric,
         mhd.attention_deficit_hyperactivity_disorder_numeric,
         mhd.personality_disorder_numeric,
         mhd.suspected_eating_disorder_diagnosed_numeric,
         mhd.body_dysmorphic_disorder_bdd_numeric,
         mhd.anorexia_nervosa_numeric,
          mhd.atypical_anorexia_nervosa_numeric,
          mhd.bulimia_nervosa_numeric, 
          mhd.atypical_bulimia_nervosa_numeric,  
          mhd.bingeeating_disorder_numeric, 
          mhd.atypical_bingeeating_disorder_numeric, 
          mhd.purging_disorder_numeric, 
          mhd.night_eating_syndrome_numeric,  
          mhd.pica_numeric, 
          mhd.avoidantrestrictive_food_intake_disorder_numeric,
          mhd.rumination_disorder_numeric, 
          mhd.feeding_eating_disorder_numeric, 
          mhd.other_eating_disorder_numeric)


edgi.6 <- taf.edgi.coping.baseline.raw.id %>% 
  select(ID,
  cohort_name,
  taf.pandemic_felt_.Wavebaseline,
  taf.pandemic_felt.1_.Wavebaseline,
  taf.meant_end_life_pandemic_.Wavebaseline)


edgi.7 <- edgi.coping.dem2.raw.id %>%
  select(ID,
         cohort_name,
         
         dem2.living_with_partner_or_spouse,
         dem2.living_alone,
         dem2.living_with_partner_or_spouse,
         dem2.living_with_housemates,
         dem2.age_children_living,
         dem2.age_children_living.1,
         dem2.living_with_other_members_of_my_family,
         dem2.spouse_partner_members_living,
         dem2.staying_live,
         dem2.staying_live.1,
         dem2.prefer_not_to_say,
         dem2.living_situation_change_pandemic,
         dem2.living_alone.1,
         dem2.living_with_partner_or_spouse.1,
         dem2.living_with_housemates.1,
         dem2.age_children_living.2,
         dem2.age_children_living.3,
         dem2.living_with_other_members_of_my_family.1,
         dem2.spouse_partner_members_living.1,
         dem2.staying_live.2,
         dem2.staying_live.3,
         dem2.prefer_not_to_say.1,
         
         
         dem2.member_vulnerable_group,
         dem2.solid_organ_transplant_recipient,
         dem2.lung_cancer_radical_radiotherapy,
         dem2.bone_marrow_blood_leukaemia,
         dem2.immunotherapy_cancer_continuing_antibody,
         dem2.parp_inhibitors_affect_immune,
         dem2.stem_cell_transplants_bone,
         dem2.severe_copd_cystic_fibrosis,
         dem2.inborn_errors_rare_diseases,
         dem2.taking_medicine_that_weakens_your_immune_system,
         dem2.condition_infections_makes,
         dem2.congenital_pregnant_acquired_significant,
         dem2.pregnant,
         dem2.over_70_years_old,
         dem2.prefer_not_to_say.2,
         dem2.unsure)
  
edgi.8 <- edgi_pan_worry.id %>%
  select(ID,
         cohort_name,
         panworry.impact_on_your_employment_status,                                    
         panworry.employment_status_household_key,              
         panworry.impact_on_your_education_or_exams,            
         panworry.exams_impact_education_children,              
         panworry.financial_impact,                           
         panworry.contracting_the_virus,                       
         panworry.people_you_know_contracting_the_virus,       
         panworry.people_you_dont_know_contracting_the_virus,   
         panworry.impact_mental_health_wellbeing,               
         panworry.impact_mental_health_childrens,               
         panworry.impact_relatives_mental_health,           
         panworry.being_socially_isolated,                    
         panworry.people_you_know_being_socially_isolated,      
         panworry.shortage_of_essential_supplies,                
         panworry.shortage_of_medication_or_access_to_healthcare,
         panworry.healthcare_people_essential_supplies,          
         panworry.information_virus_government_accuracy,         
         panworry.the_governments_response_to_the_pandemic,      
         panworry.separation_from_family_members,         
         panworry.standing_impact_global_recession,
         panworry.other_,
         
         panworry.impact_on_your_employment_status_numeric,                                    
         panworry.employment_status_household_key_numeric,              
         panworry.impact_on_your_education_or_exams_numeric,            
         panworry.exams_impact_education_children_numeric,              
         panworry.financial_impact_numeric,                           
         panworry.contracting_the_virus_numeric,                       
         panworry.people_you_know_contracting_the_virus_numeric,       
         panworry.people_you_dont_know_contracting_the_virus_numeric,   
         panworry.impact_mental_health_wellbeing_numeric,               
         panworry.impact_mental_health_childrens_numeric,               
         panworry.impact_relatives_mental_health_numeric,           
         panworry.being_socially_isolated_numeric,                    
         panworry.people_you_know_being_socially_isolated_numeric,      
         panworry.shortage_of_essential_supplies_numeric,                
         panworry.shortage_of_medication_or_access_to_healthcare_numeric,
         panworry.healthcare_people_essential_supplies_numeric,          
         panworry.information_virus_government_accuracy_numeric,         
         panworry.the_governments_response_to_the_pandemic_numeric,      
         panworry.separation_from_family_members_numeric,         
         panworry.standing_impact_global_recession_numeric,
         panworry.other__numeric)
  

##See if IDs match with edgi.5
x <- edgi.5[edgi.5$ID %in% edgi.4$ID,]

length(unique(x$ID))

x <- edgi.5[edgi.5$ID %in% edgi.3$ID,]

length(unique(x$ID))

x <- edgi.5[edgi.5$ID %in% edgi.2$ID,]

length(unique(x$ID))

x <- edgi.5[edgi.5$ID %in% edgi.1$ID,]

length(unique(x$ID))

}

#no edeq baseline (only in ramp)
```

##EDGI data frame list
```{r EDGI data frame list}
if(EDGI == TRUE) {
dfs.list <- list(
  edgi.1,
  edgi.2,
  edgi.3,
  edgi.4,
  edgi.5,
  edgi.7,
  edgi.8
)
}

```

##Join all EDGI
```{r Join all EDGI questionnaires}
if(EDGI == TRUE) {
dat.raw.edgi <- plyr::join_all(
  dfs.list,
  by = c("ID", "cohort_name") # Alternatively you can join by several columns EDGI -> "Age", "Sex", "Birthyear"
  )

#look at the data
colnames(dat.raw.edgi)
}

```

#Get rid of duplicates in EDGI
```{r Check duplicates}
if(EDGI == TRUE) {
dat.raw.edgi$ID.dup <- duplicated(dat.raw.edgi$ID)

summary(as.factor(dat.raw.edgi$ID.dup))

select(dat.raw.edgi)

 #Check for duplicate names of columns
names_freq <- as.data.frame(table(names(dat.raw.edgi)))
names_freq[names_freq$Freq > 1, ]

##Filter out duplicate column names
 dat.dup <- dat.raw.edgi %>%
  filter(ID.dup == TRUE)

dat.raw.edgi <- dat.raw.edgi %>%
  filter(ID.dup == FALSE)

colnames(dat.raw.edgi)

}

```

##GLAD data frame list
```{r GLAD data frame list}
if(GLAD == TRUE) {

  
  #Drop one dup cohort name columns
glad.coping.dem.raw.id$cohort_name.y <- NULL

glad.coping.dem.raw.id <- glad.coping.dem.raw.id %>% 
  rename(
    cohort_name = cohort_name.x
    )

glad.1 <-  glad.coping.dem.raw.id %>%
     select(ID,
            cohort_name,
            sex,
            gender_unc,
            uk_location,
            current_country,
            age_category_COPING
            )


glad.coping.dem.raw.id$cohort_name.x
   
glad.2 <- glad.dem3.raw.id %>%
  select(ID,
         cohort_name,
         age_category_numeric,
         age_category,
         ethnicity,
         highest_education_prepan_numeric,
         highest_education_prepan,
         transgender)

glad.3 <- glad.coping.dem4.employ.raw.id %>% 
  select(ID,
         cohort_name,
         highest_education_numeric,
         highest_education,
         employment_prior_covid,
         employment_prior_covid_numeric,
         employment_change,
         employment_change_numeric,
         key_worker,
         key_worker_numeric,
         
         employ.fulltime_employed,
  employ.parttime_employed,
  employ.unemployed,
  employ.zerohours_contract,
  employ.stayathome_parent_or_carer,
  employ.selfemployed,
  employ.contract_or_freelance_work,
  employ.small_business_owner,
  employ.receiving_state_income,
  employ.retired,
  employ.student_gcse_or_a_level,
  employ.student_university,
  employ.my_employment_status_has_not_changed,
  employ.became_unemployed,
  employ.reduction_in_hours,
  employ.reduction_in_salary,
  employ.benefits_increased,
  employ.benefits_decreased,
  employ.change_in_duties_or_responsibilities,
  employ.became_employed,
  employ.increased_hours,
  employ.increased_salary,
  employ.furloughed_or_paid_leave_government_funded,
  employ.furloughed_or_paid_leave_company_funded,
  employ.paid_leave_furloughed,
  employ.taking_unpaid_leave,
  employ.other,
  employ.other_text.txt,
  employ.no_impact,
  employ.cancelled_exams,
  employ.change_in_format_of_exams,
  employ.automatic_pass,
  employ.change_in_deadlines,
  employ.change_in_lesson_delivery,
  employ.past_performance_grade_decided,
  employ.cancelled_classes,
  employ.cannot_complete_degree,
  employ.impact_on_studies_still_unknown,
  employ.other.1,
  employ.other_text.txt.1,
  employ.losing_job_due_risk,
  employ.increased_due_job_pandemic)

glad.4 <- taf.glad.coping.baseline.raw.id%>%
  select(ID,
  cohort_name,
  taf.worth_living_life_people_.Wavebaseline,
  taf.felt_weeks_past_.Wavebaseline,
  taf.have_you_contemplated_harming_yourself_.Wavebaseline,
  taf.felt_weeks_past.1_.Wavebaseline,
  taf.meant_life_end_weeks_.Wavebaseline,
   taf.pandemic_felt_.Wavebaseline,
  taf.pandemic_felt.1_.Wavebaseline,
  taf.meant_end_life_pandemic_.Wavebaseline)

glad.5 <- mhd.raw.id %>%
  select(ID,
         cohort_name,
         control,
         control_numeric,
         depressive_disorders_numeric,
         anxiety_disorders_numeric,
         eating_disorders_diagnosed_numeric,
         obsessive_compulsive_disorders_numeric,
         psychotic_disorders_numeric,
         PERSONALITY_DISORDER_NUMERIC,
         agoraphobia_panic_disorder_numeric,
         depression_and_anxiety_numeric,
         bipolar_and_schizophrenia_numeric,
         mhd.mania_hypomania_bipolar_or_manicdepression_numeric,
        mhd.posttraumatic_stress_disorder_ptsd_numeric, 
        autism_spectrum_disorder_numeric,
        mhd.attention_deficit_hyperactivity_disorder_numeric,
        mhd.personality_disorder_numeric,
        mhd.suspected_eating_disorder_diagnosed_numeric,
        mhd.body_dysmorphic_disorder_bdd_numeric,
        mhd.anorexia_nervosa_numeric,
          mhd.atypical_anorexia_nervosa_numeric,
          mhd.bulimia_nervosa_numeric, 
          mhd.atypical_bulimia_nervosa_numeric,  
          mhd.bingeeating_disorder_numeric, 
          mhd.atypical_bingeeating_disorder_numeric, 
          mhd.purging_disorder_numeric, 
          mhd.night_eating_syndrome_numeric,  
          mhd.pica_numeric, 
          mhd.avoidantrestrictive_food_intake_disorder_numeric,
          mhd.rumination_disorder_numeric, 
          mhd.feeding_eating_disorder_numeric, 
          mhd.other_eating_disorder_numeric)

glad.6 <- glad.coping.dem2.raw.id %>%
  select(ID,
         cohort_name,
         
         dem2.living_with_partner_or_spouse,
         dem2.living_alone,
         dem2.living_with_partner_or_spouse,
         dem2.living_with_housemates,
         dem2.age_children_living,
         dem2.age_children_living.1,
         dem2.living_with_other_members_of_my_family,
         dem2.spouse_partner_members_living,
         dem2.staying_live,
         dem2.staying_live.1,
         dem2.prefer_not_to_say,
         dem2.living_situation_change_pandemic,
         dem2.living_alone.1,
         dem2.living_with_partner_or_spouse.1,
         dem2.living_with_housemates.1,
         dem2.age_children_living.2,
         dem2.age_children_living.3,
         dem2.living_with_other_members_of_my_family.1,
         dem2.spouse_partner_members_living.1,
         dem2.staying_live.2,
         dem2.staying_live.3,
         dem2.prefer_not_to_say.1,
         
         dem2.member_vulnerable_group,
         dem2.solid_organ_transplant_recipient,
         dem2.lung_cancer_radical_radiotherapy,
         dem2.bone_marrow_blood_leukaemia,
         dem2.immunotherapy_cancer_continuing_antibody,
         dem2.parp_inhibitors_affect_immune,
         dem2.stem_cell_transplants_bone,
         dem2.severe_copd_cystic_fibrosis,
         dem2.inborn_errors_rare_diseases,
         dem2.taking_medicine_that_weakens_your_immune_system,
         dem2.condition_infections_makes,
         dem2.congenital_pregnant_acquired_significant,
         dem2.pregnant,
         dem2.over_70_years_old,
         dem2.prefer_not_to_say.2,
         dem2.unsure)
  
glad.7 <- glad_pan_worry.id %>%
  select(ID,
         cohort_name,
         panworry.impact_on_your_employment_status,                                    
         panworry.employment_status_household_key,              
         panworry.impact_on_your_education_or_exams,            
         panworry.exams_impact_education_children,              
         panworry.financial_impact,                           
         panworry.contracting_the_virus,                       
         panworry.people_you_know_contracting_the_virus,       
         panworry.people_you_dont_know_contracting_the_virus,   
         panworry.impact_mental_health_wellbeing,               
         panworry.impact_mental_health_childrens,               
         panworry.impact_relatives_mental_health,           
         panworry.being_socially_isolated,                    
         panworry.people_you_know_being_socially_isolated,      
         panworry.shortage_of_essential_supplies,                
         panworry.shortage_of_medication_or_access_to_healthcare,
         panworry.healthcare_people_essential_supplies,          
         panworry.information_virus_government_accuracy,         
         panworry.the_governments_response_to_the_pandemic,      
         panworry.separation_from_family_members,         
         panworry.standing_impact_global_recession,
         panworry.other_,
         
         panworry.impact_on_your_employment_status_numeric,                                    
         panworry.employment_status_household_key_numeric,              
         panworry.impact_on_your_education_or_exams_numeric,            
         panworry.exams_impact_education_children_numeric,              
         panworry.financial_impact_numeric,                           
         panworry.contracting_the_virus_numeric,                       
         panworry.people_you_know_contracting_the_virus_numeric,       
         panworry.people_you_dont_know_contracting_the_virus_numeric,   
         panworry.impact_mental_health_wellbeing_numeric,               
         panworry.impact_mental_health_childrens_numeric,               
         panworry.impact_relatives_mental_health_numeric,           
         panworry.being_socially_isolated_numeric,                    
         panworry.people_you_know_being_socially_isolated_numeric,      
         panworry.shortage_of_essential_supplies_numeric,                
         panworry.shortage_of_medication_or_access_to_healthcare_numeric,
         panworry.healthcare_people_essential_supplies_numeric,          
         panworry.information_virus_government_accuracy_numeric,         
         panworry.the_governments_response_to_the_pandemic_numeric,      
         panworry.separation_from_family_members_numeric,         
         panworry.standing_impact_global_recession_numeric,
         panworry.other__numeric)


##See if IDs match with glad.3
x <- glad.3[glad.3$ID %in% glad.1$ID,]

length(unique(x$ID))

x <- glad.3[glad.3$ID %in% glad.2$ID,]

length(unique(x$ID))

x <- glad.3[glad.3$ID %in% glad.4$ID,]

length(unique(x$ID))

x <- glad.3[glad.3$ID %in% glad.5$ID,]

length(unique(x$ID))

}
```

##GLAD data frame list
```{r GLAD data frame list}
if(GLAD == TRUE) {
dfs.list <- list(
  glad.1,
  glad.2,
  glad.3,
  glad.4,
  glad.5,
  glad.6,
  glad.7
  )
}

```


##Join all GLAD
```{r Join all GLAD questionnaires}
if(GLAD == TRUE) {
dat.raw.glad <- plyr::join_all(
  dfs.list,
  by = c("ID", "cohort_name")
  )
#look at the data
colnames(dat.raw.glad)
}

```

#Get rid of duplicates in GLAD
```{r Check duplicates}
if(GLAD == TRUE) {
dat.raw.glad$ID.dup <- duplicated(dat.raw.glad$ID)

summary(as.factor(dat.raw.glad$ID.dup))

select(dat.raw.glad)

#Check for duplicate names of columns
names_freq <- as.data.frame(table(names(dat.raw.glad)))
names_freq[names_freq$Freq > 1, ]

##Filter out duplicate column names
 #dat.dup <- dat.raw.glad %>%
 # filter(ID.dup == TRUE)

#dat.raw.glad <- dat.raw.glad %>%
#  filter(ID.dup == FALSE)

colnames(dat.raw.glad)
}

```

##NBR selected variables
```{r NBR selected variables}
if(NBR == TRUE) {

  nbr.1 <- nbr.dem.employ.raw.id %>%
    select(ID,
           cohort_name,
           highest_education_numeric,
           highest_education,
           employment_change_numeric,
           employment_change,
           employment_prior_covid,
           employment_prior_covid_numeric,
           key_worker,
           key_worker_numeric,
           
           employ.fulltime_employed,
  employ.parttime_employed,
  employ.unemployed,
  employ.zerohours_contract,
  employ.stayathome_parent_or_carer,
  employ.selfemployed,
  employ.contract_or_freelance_work,
  employ.small_business_owner,
  employ.receiving_state_income,
  employ.retired,
  employ.student_gcse_or_a_level,
  employ.student_university,
  employ.my_employment_status_has_not_changed,
  employ.became_unemployed,
  employ.reduction_in_hours,
  employ.reduction_in_salary,
  employ.benefits_increased,
  employ.benefits_decreased,
  employ.change_in_duties_or_responsibilities,
  employ.became_employed,
  employ.increased_hours,
  employ.increased_salary,
  employ.furloughed_or_paid_leave_government_funded,
  employ.furloughed_or_paid_leave_company_funded,
  employ.paid_leave_furloughed,
  employ.taking_unpaid_leave,
  employ.other,
  employ.other_text.txt,
  employ.no_impact,
  employ.cancelled_exams,
  employ.change_in_format_of_exams,
  employ.automatic_pass,
  employ.change_in_deadlines,
  employ.change_in_lesson_delivery,
  employ.past_performance_grade_decided,
  employ.cancelled_classes,
  employ.cannot_complete_degree,
  employ.impact_on_studies_still_unknown,
  employ.other.1,
  employ.other_text.txt.1,
  employ.losing_job_due_risk,
  employ.increased_due_job_pandemic,)
  
nbr.2 <- nbr.dem.raw.id.complete %>%
  select(ID,
         cohort_name,
         sex,
         gender_unc,
         ethnicity,
         current_country,
         uk_location)


  nbr.3 <- nbr.dem.raw.id %>%
    select(ID,
           cohort_name,
           age_category,
           age_category_numeric)

nbr.4 <- taf.nbr.baseline.raw.id %>%
  select(ID,
  cohort_name,
  taf.worth_living_life_people_.Wavebaseline,
  taf.felt_weeks_past_.Wavebaseline,
  taf.have_you_contemplated_harming_yourself_.Wavebaseline,
  taf.felt_weeks_past.1_.Wavebaseline,
  taf.meant_life_end_weeks_.Wavebaseline,
  taf.pandemic_felt_.Wavebaseline,
  taf.pandemic_felt.1_.Wavebaseline,
  taf.meant_end_life_pandemic_.Wavebaseline)


nbr.5 <- mhd.raw.id %>% 
  select(ID,
         cohort_name,
         control,
         control_numeric,
         depressive_disorders_numeric,
         anxiety_disorders_numeric,
         eating_disorders_diagnosed_numeric,
         obsessive_compulsive_disorders_numeric,
         psychotic_disorders_numeric,
         PERSONALITY_DISORDER_NUMERIC,
         agoraphobia_panic_disorder_numeric,
         depression_and_anxiety_numeric,
         bipolar_and_schizophrenia_numeric,
         mhd.mania_hypomania_bipolar_or_manicdepression_numeric,
        mhd.posttraumatic_stress_disorder_ptsd_numeric, 
        autism_spectrum_disorder_numeric,
        mhd.attention_deficit_hyperactivity_disorder_numeric,
        mhd.personality_disorder_numeric,
        mhd.suspected_eating_disorder_diagnosed_numeric,
        mhd.body_dysmorphic_disorder_bdd_numeric,
        mhd.anorexia_nervosa_numeric,
          mhd.atypical_anorexia_nervosa_numeric,
          mhd.bulimia_nervosa_numeric, 
          mhd.atypical_bulimia_nervosa_numeric,  
          mhd.bingeeating_disorder_numeric, 
          mhd.atypical_bingeeating_disorder_numeric, 
          mhd.purging_disorder_numeric, 
          mhd.night_eating_syndrome_numeric,  
          mhd.pica_numeric, 
          mhd.avoidantrestrictive_food_intake_disorder_numeric,
          mhd.rumination_disorder_numeric, 
          mhd.feeding_eating_disorder_numeric, 
          mhd.other_eating_disorder_numeric)


nbr.6 <- nbr.dem2.raw.id %>%
  select(ID,
         cohort_name,
         
         dem2.living_with_partner_or_spouse,
         dem2.living_alone,
         dem2.living_with_partner_or_spouse,
         dem2.living_with_housemates,
         dem2.age_children_living,
         dem2.age_children_living.1,
         dem2.living_with_other_members_of_my_family,
         dem2.spouse_partner_members_living = dem2.spouse_members_partner_living, #Renamed to be same as edgi/glad
         dem2.staying_live,
         dem2.staying_live.1,
         dem2.prefer_not_to_say,
         dem2.living_situation_change_pandemic,
         dem2.living_alone.1,
         dem2.living_with_partner_or_spouse.1,
         dem2.living_with_housemates.1,
         dem2.age_children_living.2,
         dem2.age_children_living.3,
         dem2.living_with_other_members_of_my_family.1,
         dem2.spouse_partner_members_living.1 = dem2.spouse_members_partner_living.1, #Renamed to be same as edgi/glad
         dem2.staying_live.2,
         dem2.staying_live.3,
         dem2.prefer_not_to_say.1,
         
         dem2.member_vulnerable_group,
         dem2.solid_organ_transplant_recipient,
         dem2.lung_cancer_radical_radiotherapy,
         dem2.bone_marrow_blood_leukaemia,
         dem2.immunotherapy_cancer_continuing_antibody,
         dem2.parp_inhibitors_affect_immune,
         dem2.stem_cell_transplants_bone,
         dem2.severe_copd_cystic_fibrosis,
         dem2.inborn_errors_rare_diseases,
         dem2.taking_medicine_that_weakens_your_immune_system,
         dem2.condition_infections_makes,
         dem2.congenital_pregnant_acquired_significant,
         dem2.pregnant,
         dem2.over_70_years_old,
         dem2.prefer_not_to_say.2,
         dem2.unsure)


nbr.7 <- nbr_pan_worry.id %>%
  select(ID,
         cohort_name,
         panworry.impact_on_your_employment_status,                                    
         panworry.employment_status_household_key,              
         panworry.impact_on_your_education_or_exams,            
         panworry.exams_impact_education_children,              
         panworry.financial_impact,                           
         panworry.contracting_the_virus,                       
         panworry.people_you_know_contracting_the_virus,       
         panworry.people_you_dont_know_contracting_the_virus,   
         panworry.impact_mental_health_wellbeing,               
         panworry.impact_mental_health_childrens,               
         panworry.impact_relatives_mental_health,           
         panworry.being_socially_isolated,                    
         panworry.people_you_know_being_socially_isolated,      
         panworry.shortage_of_essential_supplies,                
         panworry.shortage_of_medication_or_access_to_healthcare,
         panworry.healthcare_people_essential_supplies,          
         panworry.information_virus_government_accuracy,         
         panworry.the_governments_response_to_the_pandemic,      
         panworry.separation_from_family_members,         
         panworry.standing_impact_global_recession,
         
         panworry.other_,
         
         panworry.impact_on_your_employment_status_numeric,                                    
         panworry.employment_status_household_key_numeric,              
         panworry.impact_on_your_education_or_exams_numeric,            
         panworry.exams_impact_education_children_numeric,              
         panworry.financial_impact_numeric,                           
         panworry.contracting_the_virus_numeric,                       
         panworry.people_you_know_contracting_the_virus_numeric,       
         panworry.people_you_dont_know_contracting_the_virus_numeric,   
         panworry.impact_mental_health_wellbeing_numeric,               
         panworry.impact_mental_health_childrens_numeric,               
         panworry.impact_relatives_mental_health_numeric,           
         panworry.being_socially_isolated_numeric,                    
         panworry.people_you_know_being_socially_isolated_numeric,      
         panworry.shortage_of_essential_supplies_numeric,                
         panworry.shortage_of_medication_or_access_to_healthcare_numeric,
         panworry.healthcare_people_essential_supplies_numeric,          
         panworry.information_virus_government_accuracy_numeric,         
         panworry.the_governments_response_to_the_pandemic_numeric,      
         panworry.separation_from_family_members_numeric,         
         panworry.standing_impact_global_recession_numeric,
         panworry.other__numeric)

#Check nbr mhd data IDs
x <- nbr.5[nbr.5$ID %in% nbr.1$ID,]

length(unique(x$ID))

x <- nbr.5[nbr.5$ID %in% nbr.2$ID,]

length(unique(x$ID))

x <- nbr.5[nbr.5$ID %in% nbr.3$ID,]

length(unique(x$ID))

x <- nbr.5[nbr.5$ID %in% nbr.4$ID,]

length(unique(x$ID))

nrow(nbr.5)
nrow(nbr.4)
nrow(nbr.3)
nrow(nbr.2)
nrow(nbr.1)
}

#NO HIGHEST EDUCATION PREPAN
#no edeq baseline (only in ramp)
```

##NBR  data frame list
```{r NBR data frame list}
if(NBR == TRUE) {
dfs.list <- list(
  nbr.1,
  nbr.2,
  nbr.3,
  nbr.4,
  nbr.5,
  nbr.6,
  nbr.7
)
}

```

##Join all NBR 
```{r Join all NBR questionnaires}
if(NBR == TRUE) {
dat.raw.nbr <- plyr::join_all(
  dfs.list,
  by = c("ID", "cohort_name") # Alternatively you can join by several columns EDGI -> "Age", "Sex", "Birthyear"
  )

#look at the data
colnames(dat.raw.nbr)
}
```

#Get rid of duplicates in NBR
```{r Check duplicates}
if(NBR == TRUE) {
dat.raw.nbr$ID.dup <- duplicated(dat.raw.nbr$ID)

summary(as.factor(dat.raw.nbr$ID.dup))

select(dat.raw.nbr)

 #Check for duplicate names of columns
names_freq <- as.data.frame(table(names(dat.raw.nbr)))
names_freq[names_freq$Freq > 1, ]

##Filter out duplicate column names
 dat.dup <- dat.raw.nbr %>%
  filter(ID.dup == TRUE)

dat.raw.nbr <- dat.raw.nbr %>%
  filter(ID.dup == FALSE)

colnames(dat.raw.nbr)
}

```

##RAMP variable list
```{r RAMP variable list}
if(RAMP == TRUE) {

  
 
  ramp.1 <- ramp.dem.raw.id %>%
    select(ID,
           cohort_name,
           gender_unc,
           ethnicity,
           age_unc,
           dem2.member_vulnerable_group,
           dem2.solid_organ_transplant_recipient,
           dem2.lung_cancer_radical_radiotherapy,
           dem2.bone_marrow_blood_leukaemia,
           dem2.immunotherapy_cancer_continuing_antibody,
           dem2.parp_inhibitors_affect_immune,
           dem2.stem_cell_transplants_bone,
           dem2.severe_copd_cystic_fibrosis, #= dem2.cystic_fibrosis_severe_asthma,
           dem2.inborn_errors_rare_diseases, # = dem2.inborn_errors_metabolism_infections,
           dem2.taking_medicine_that_weakens_your_immune_system,
           dem2.congenital_pregnant_acquired_significant, # = dem2.condition_infections_makes,
           dem2.pregnant,
           dem2.over_70_years_old,
           dem2.prefer_not_to_say.2, # = dem2.prefer_not_to_say.1,
           dem2.unsure,
           transgender,
           
         dem2.living_with_partner_or_spouse,
         dem2.living_alone,
         dem2.living_with_partner_or_spouse,
         dem2.living_with_housemates,
         dem2.age_children_living,
         dem2.age_children_living.1,
         dem2.living_with_other_members_of_my_family,
         dem2.spouse_partner_members_living,
         dem2.staying_live,
         dem2.staying_live.1,
         dem2.prefer_not_to_say,

         dem2.living_situation_change_pandemic,


         dem2.living_alone.1,
         dem2.living_with_partner_or_spouse.1,
         dem2.living_with_housemates.1,
         dem2.age_children_living.2,
         dem2.age_children_living.3,
         dem2.living_with_other_members_of_my_family.1,
         dem2.spouse_partner_members_living.1,
         dem2.staying_live.2,
         dem2.staying_live.3,
         dem2.prefer_not_to_say.1)

  ramp.2 <- ramp.dem.employ.raw.id %>%
    select(ID,
           cohort_name,
           highest_education,
           highest_education_numeric,
           employment_prior_covid,
           employment_prior_covid_numeric,
           employment_change,
           employment_change_numeric,
           key_worker,
           key_worker_numeric,
           
           employ.fulltime_employed,
  employ.parttime_employed,
  employ.unemployed,
  employ.zerohours_contract,
  employ.stayathome_parent_or_carer,
  employ.selfemployed,
  employ.contract_or_freelance_work,
  employ.small_business_owner,
  employ.receiving_state_income,
  employ.retired,
  employ.student_gcse_or_a_level,
  employ.student_university,
  employ.my_employment_status_has_not_changed,
  employ.became_unemployed,
  employ.reduction_in_hours,
  employ.reduction_in_salary,
  employ.benefits_increased,
  employ.benefits_decreased,
  employ.change_in_duties_or_responsibilities,
  employ.became_employed,
  employ.increased_hours,
  employ.increased_salary,
  employ.furloughed_or_paid_leave_government_funded,
  employ.furloughed_or_paid_leave_company_funded,
  employ.paid_leave_furloughed,
  employ.taking_unpaid_leave,
  employ.other,
  employ.other_text.txt,
  employ.no_impact,
  employ.cancelled_exams,
  employ.change_in_format_of_exams,
  employ.automatic_pass,
  employ.change_in_deadlines,
  employ.change_in_lesson_delivery,
  employ.past_performance_grade_decided,
  employ.cancelled_classes,
  employ.cannot_complete_degree,
  employ.impact_on_studies_still_unknown,
  employ.other.1,
  employ.other_text.txt.1,
  employ.losing_job_due_risk,
  employ.increased_due_job_pandemic)
   
  ramp.3 <- edeq.ramp.baseline.raw.id %>% 
  select(ID,
  cohort_name,
  edeq.deliberately_limit_amount_influence.1_.Wavebaseline,
edeq.calories_made_body_shape.1_.Wavebaseline,
edeq.weight_influenced_person.1_.Wavebaseline,
edeq.dissatisfied_shape_weight.1_.Wavebaseline,
edeq.eating_behaviours_concerns_distressed.1_.Wavebaseline,
edeq.nibbled_picked_snacks_grazed.1_.Wavebaseline,
edeq.felt_anxious_blue_bored.2_.Wavebaseline,
edeq.felt_anxious_blue_bored.3_.Wavebaseline,
edeq.actively_been_monitoring_your_shape_or_weight_.1_.Wavebaseline,
edeq.regard_lost_control_eaten.1_.Wavebaseline,
edeq.sick_means_made_shape.1_.Wavebaseline,
edeq.diuretics_laxatives_means_shape.1_.Wavebaseline,
edeq.compulsive_driven_burn_calories.1_.Wavebaseline,
  
  edeq.deliberately_limit_amount_influence.1_.Wavebaseline_numeric,
edeq.calories_made_body_shape.1_.Wavebaseline_numeric,
edeq.weight_influenced_person.1_.Wavebaseline_numeric,
edeq.dissatisfied_shape_weight.1_.Wavebaseline_numeric,
edeq.eating_behaviours_concerns_distressed.1_.Wavebaseline_numeric,
edeq.nibbled_picked_snacks_grazed.1_.Wavebaseline_numeric,
edeq.felt_anxious_blue_bored.2_.Wavebaseline_numeric,
edeq.felt_anxious_blue_bored.3_.Wavebaseline_numeric,
edeq.actively_been_monitoring_your_shape_or_weight_.1_.Wavebaseline_numeric,
edeq.regard_lost_control_eaten.1_.Wavebaseline_numeric,
edeq.sick_means_made_shape.1_.Wavebaseline_numeric,
edeq.diuretics_laxatives_means_shape.1_.Wavebaseline_numeric,
edeq.compulsive_driven_burn_calories.1_.Wavebaseline_numeric,

 edeq.deliberately_limit_amount_influence_.Wavebaseline,
         edeq.calories_made_body_shape_.Wavebaseline ,
         edeq.weight_influenced_person_.Wavebaseline,
         edeq.dissatisfied_shape_weight_.Wavebaseline ,
         edeq.nibbled_picked_snacks_grazed_.Wavebaseline ,
         edeq.felt_anxious_blue_bored_.Wavebaseline ,
         edeq.felt_anxious_blue_bored.1_.Wavebaseline ,
         edeq.eating_behaviours_concerns_distressed_.Wavebaseline,
         edeq.actively_been_monitoring_your_shape_or_weight_.Wavebaseline,
         edeq.regard_lost_control_eaten_.Wavebaseline,
         edeq.sick_means_made_shape_.Wavebaseline,
         edeq.diuretics_laxatives_means_shape_.Wavebaseline,
         edeq.compulsive_driven_burn_calories_.Wavebaseline,
  
   edeq.deliberately_limit_amount_influence_.Wavebaseline_numeric,
         edeq.calories_made_body_shape_.Wavebaseline_numeric,
         edeq.weight_influenced_person_.Wavebaseline_numeric,
         edeq.dissatisfied_shape_weight_.Wavebaseline_numeric ,
         edeq.nibbled_picked_snacks_grazed_.Wavebaseline_numeric ,
         edeq.felt_anxious_blue_bored_.Wavebaseline_numeric ,
         edeq.felt_anxious_blue_bored.1_.Wavebaseline_numeric ,
         edeq.eating_behaviours_concerns_distressed_.Wavebaseline_numeric ,
         edeq.actively_been_monitoring_your_shape_or_weight_.Wavebaseline_numeric,
         edeq.regard_lost_control_eaten_.Wavebaseline_numeric,
         edeq.sick_means_made_shape_.Wavebaseline_numeric,
         edeq.diuretics_laxatives_means_shape_.Wavebaseline_numeric ,
         edeq.compulsive_driven_burn_calories_.Wavebaseline_numeric 
  )

  ramp.4 <- mhd.raw.id %>% 
  select(ID,
         cohort_name,
         control,
         control_numeric,
         depressive_disorders_numeric,
         anxiety_disorders_numeric,
         eating_disorders_diagnosed_numeric,
         obsessive_compulsive_disorders_numeric,
         psychotic_disorders_numeric,
         PERSONALITY_DISORDER_NUMERIC,
         agoraphobia_panic_disorder_numeric,
         depression_and_anxiety_numeric,
         bipolar_and_schizophrenia_numeric,
         mhd.mania_hypomania_bipolar_or_manicdepression_numeric,
         mhd.posttraumatic_stress_disorder_ptsd_numeric, 
         autism_spectrum_disorder_numeric,
         mhd.attention_deficit_hyperactivity_disorder_numeric,
         mhd.personality_disorder_numeric,
         mhd.body_dysmorphic_disorder_bdd_numeric,
         mhd.anorexia_nervosa_numeric,
         mhd.atypical_anorexia_nervosa_numeric,
         mhd.bulimia_nervosa_numeric,
         mhd.bingeeating_disorder_numeric)


ramp.5 <- taf.ramp.baseline.raw.id  %>% 
  select(ID,
         cohort_name,
         taf.worth_living_life_people_.Wavebaseline,
  taf.felt_weeks_past_.Wavebaseline,
  taf.have_you_contemplated_harming_yourself_.Wavebaseline,
  taf.felt_weeks_past.1_.Wavebaseline,
  taf.meant_life_end_weeks_.Wavebaseline)


ramp.6 <- taf.ramp.baseline.raw.id %>% #for retro prepan
  select(ID,
  cohort_name,
  taf.pandemic_felt_.Wavebaseline,
  taf.pandemic_felt.1_.Wavebaseline,
  taf.meant_end_life_pandemic_.Wavebaseline)

ramp.7 <- ramp_pan_worry.id %>%
  select(ID,
         cohort_name,
         panworry.impact_on_your_employment_status,                                    
         panworry.employment_status_household_key,              
         panworry.impact_on_your_education_or_exams,            
         panworry.exams_impact_education_children,              
         panworry.financial_impact,                           
         panworry.contracting_the_virus,                       
         panworry.people_you_know_contracting_the_virus,       
         panworry.people_you_dont_know_contracting_the_virus,   
         panworry.impact_mental_health_wellbeing,               
         panworry.impact_mental_health_childrens,               
         panworry.impact_relatives_mental_health,           
         panworry.being_socially_isolated,                    
         panworry.people_you_know_being_socially_isolated,      
         panworry.shortage_of_essential_supplies,                
         panworry.shortage_of_medication_or_access_to_healthcare,
         panworry.healthcare_people_essential_supplies,          
         panworry.information_virus_government_accuracy,         
         panworry.the_governments_response_to_the_pandemic,      
         panworry.separation_from_family_members,         
         panworry.standing_impact_global_recession,
         
         panworry.other_,
         
         panworry.impact_on_your_employment_status_numeric,                                    
         panworry.employment_status_household_key_numeric,              
         panworry.impact_on_your_education_or_exams_numeric,            
         panworry.exams_impact_education_children_numeric,              
         panworry.financial_impact_numeric,                           
         panworry.contracting_the_virus_numeric,                       
         panworry.people_you_know_contracting_the_virus_numeric,       
         panworry.people_you_dont_know_contracting_the_virus_numeric,   
         panworry.impact_mental_health_wellbeing_numeric,               
         panworry.impact_mental_health_childrens_numeric,               
         panworry.impact_relatives_mental_health_numeric,           
         panworry.being_socially_isolated_numeric,                    
         panworry.people_you_know_being_socially_isolated_numeric,      
         panworry.shortage_of_essential_supplies_numeric,                
         panworry.shortage_of_medication_or_access_to_healthcare_numeric,
         panworry.healthcare_people_essential_supplies_numeric,          
         panworry.information_virus_government_accuracy_numeric,         
         panworry.the_governments_response_to_the_pandemic_numeric,      
         panworry.separation_from_family_members_numeric,         
         panworry.standing_impact_global_recession_numeric,
         panworry.other__numeric)

#Check ramp.4 has same IDs as other datasets
x <- ramp.4[ramp.4$ID %in% ramp.1$ID,]

length(unique(x$ID))

x <- ramp.4[ramp.4$ID %in% ramp.2$ID,]

length(unique(x$ID))

x <- ramp.4[ramp.4$ID %in% ramp.3$ID,]

length(unique(x$ID))

x <- ramp.4[ramp.4$ID %in% ramp.5$ID,]

length(unique(x$ID))    


}

#NO SEX
#no highest education pre-pandemic
```

##RAMP  data frame list
```{r RAMP data frame list}
if(RAMP == TRUE) {
dfs.list <- list(
  ramp.1,
  ramp.2,
  ramp.3,
  ramp.4,
  ramp.5,
  ramp.6,
  ramp.7
  
)
}
```

##Join all RAMP
```{r Join all RAMP questionnaires}
if(RAMP == TRUE) {
dat.raw.ramp <- plyr::join_all(
  dfs.list,
  by = c("ID", "cohort_name") # Alternatively you can join by several columns EDGI -> "Age", "Sex", "Birthyear"
  )

#look at the data
colnames(dat.raw.ramp)
}

```

#Get rid of duplicates in RAMP
```{r Check duplicates}
if(RAMP == TRUE) {
dat.raw.ramp$ID.dup <- duplicated(dat.raw.ramp$ID)

summary(as.factor(dat.raw.ramp$ID.dup))

 #Check for duplicate names of columns
names_freq <- as.data.frame(table(names(dat.raw.ramp)))
names_freq[names_freq$Freq > 1, ]

##Filter out duplicate column names
 dat.dup <- dat.raw.ramp %>%
  filter(ID.dup == TRUE)

dat.raw.ramp <- dat.raw.ramp %>%
  filter(ID.dup == FALSE)

}
```

# Export baseline data
```{r export data}
if(GLAD == TRUE) {
saveRDS(object = dat.raw.glad, file = paste0("/Users/helenadavies/King's College London/MT-Translational Neuropsychiatric Genomics - Helena_Davies_PhD - Helena_Davies_PhD/EDBeh_SelfHarm/data_cleaned/NEW_baseline_glad", date, ".rds"))
}

if(EDGI == TRUE) {
saveRDS(object = dat.raw.edgi, file = paste0("/Users/helenadavies/King's College London/MT-Translational Neuropsychiatric Genomics - Helena_Davies_PhD - Helena_Davies_PhD/EDBeh_SelfHarm/data_cleaned/NEW_baseline_edgi", date, ".rds"))
  
}
if(RAMP == TRUE) {
  saveRDS(object = dat.raw.ramp, file = paste0("/Users/helenadavies/King's College London/MT-Translational Neuropsychiatric Genomics - Helena_Davies_PhD - Helena_Davies_PhD/EDBeh_SelfHarm/data_cleaned/NEW_baseline_ramp", date, ".rds"))
}


if(NBR == TRUE) {
  saveRDS(object = dat.raw.nbr, file = paste0("/Users/helenadavies/King's College London/MT-Translational Neuropsychiatric Genomics - Helena_Davies_PhD - Helena_Davies_PhD/EDBeh_SelfHarm/data_cleaned/NEW_baseline_nbr", date, ".rds"))
}


```

# Export all follow up data
```{r Export follow up data}
if(COPING == TRUE) {

saveRDS(object = dat.raw.taf.coping, file = paste0("/Users/helenadavies/King's College London/MT-Translational Neuropsychiatric Genomics - Helena_Davies_PhD - Helena_Davies_PhD/EDBeh_SelfHarm/data_cleaned/TAF_coping", date, ".rds"))
  
  saveRDS(object = edeq.coping.followupb.screener.raw.id, file = paste0("/Users/helenadavies/King's College London/MT-Translational Neuropsychiatric Genomics - Helena_Davies_PhD - Helena_Davies_PhD/EDBeh_SelfHarm/data_cleaned/EDEQ_screener_coping", date, ".rds"))
  
  saveRDS(object = dat.raw.dem.coping.followup, file = paste0("/Users/helenadavies/King's College London/MT-Translational Neuropsychiatric Genomics - Helena_Davies_PhD - Helena_Davies_PhD/EDBeh_SelfHarm/data_cleaned/DEM_followup_coping", date, ".rds"))
  
  saveRDS(object = coping.loss.followupb.raw.id, file = paste0("/Users/helenadavies/King's College London/MT-Translational Neuropsychiatric Genomics - Helena_Davies_PhD - Helena_Davies_PhD/EDBeh_SelfHarm/data_cleaned/LOSS_coping_followup", date, ".rds"))

}

if(RAMP == TRUE) {

  saveRDS(object = dat.raw.taf.ramp, file = paste0("/Users/helenadavies/King's College London/MT-Translational Neuropsychiatric Genomics - Helena_Davies_PhD - Helena_Davies_PhD/EDBeh_SelfHarm/data_cleaned/TAF_ramp", date, ".rds"))
  
  saveRDS(object = edeq.ramp.followupb.screener.raw.id, file = paste0("/Users/helenadavies/King's College London/MT-Translational Neuropsychiatric Genomics - Helena_Davies_PhD - Helena_Davies_PhD/EDBeh_SelfHarm/data_cleaned/EDEQ_screener_ramp", date, ".rds"))
  
   saveRDS(object = dat.raw.dem.ramp.followup, file = paste0("/Users/helenadavies/King's College London/MT-Translational Neuropsychiatric Genomics - Helena_Davies_PhD - Helena_Davies_PhD/EDBeh_SelfHarm/data_cleaned/DEM_followup_ramp", date, ".rds"))

   saveRDS(object = ramp.loss.followupb.raw.id, file = paste0("/Users/helenadavies/King's College London/MT-Translational Neuropsychiatric Genomics - Helena_Davies_PhD - Helena_Davies_PhD/EDBeh_SelfHarm/data_cleaned/LOSS_ramp_followup", date, ".rds"))

}

```






