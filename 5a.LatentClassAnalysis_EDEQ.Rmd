---
title: "Latent class analysis - EDEQ"
author: "Helena Davies"
date: "12/08/2021"
output: html_document
---
# Set up 
```{r Setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      comment=NA,
                      prompt=FALSE,
                      cache=FALSE)
```

Delete everything in your global environment
```{r Delete everything in your global environment}
remove(list = ls())
```

Call in library script
```{r Source library files}
source("./libraries.R")
```

Retrieve the recent date
```{r Recent date}
date = Sys.Date()
date
```

Call in R functions scripts
```{r Call in function library functions}
source("./functions.R")
```

# Read in EDEQ baseline data
## data.final is generated from the "3.Merging" script
```{r Read in data}
baseline_edeq_raw <- readRDS(file = "../data_raw/ramp/edeq_ramp.rds")

# Check
dim(baseline_edeq_raw)
colnames(baseline_edeq_raw)
```

## Select edeq columns
```{r Select edeq columns from ramp baseline data}

exclude_cols_dem <- c("ID")

baseline_edeq_raw.id <- baseline_edeq_raw %>% #new dataset with ID
  drop_na(`Login ID`) %>% # Drop NAs
  select(
         ID = `Login ID`, # ID
         edeq.deliberately_limit_amount_influence_baseline = edeq.deliberately_limit_amount_influence,              
         edeq.calories_made_body_shape_baseline = edeq.calories_made_body_shape,                    
         edeq.weight_influenced_person_baseline = edeq.weight_influenced_person,                        
         edeq.dissatisfied_shape_weight_baseline = edeq.dissatisfied_shape_weight,                    
         edeq.nibbled_picked_snacks_grazed_baseline = edeq.nibbled_picked_snacks_grazed,                    
         edeq.felt_anxious_blue_bored_baseline = edeq.felt_anxious_blue_bored,                     
         edeq.felt_anxious_blue_bored.1_baseline = edeq.felt_anxious_blue_bored.1,        
         edeq.actively_been_monitoring_your_shape_or_weight__baseline = edeq.actively_been_monitoring_your_shape_or_weight_,
         edeq.regard_lost_control_eaten_baseline = edeq.regard_lost_control_eaten,
         edeq.sick_means_made_shape_baseline = edeq.sick_means_made_shape,
         edeq.diuretics_laxatives_means_shape_baseline = edeq.diuretics_laxatives_means_shape,
         edeq.compulsive_driven_burn_calories_baseline = edeq.compulsive_driven_burn_calories,
         edeq.eating_behaviours_concerns_distressed_baseline = edeq.eating_behaviours_concerns_distressed
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
 #mutate_if(is.numeric, ~na_if(., -99)) %>%
  #mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
 # mutate_if(is.factor, ~na_if(., "Don't know")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))
# Inspect dimensions
dim(baseline_edeq_raw.id)
# Inspect colnames
colnames(baseline_edeq_raw.id)
#Differences
dim(baseline_edeq_raw.id)[1]-dim(baseline_edeq_raw)[1]
freq(baseline_edeq_raw.id$edeq.actively_been_monitoring_your_shape_or_weight__baseline_numeric)
```
```{r select columns}
ramp_baseline_edeq <- baseline_edeq_raw.id %>%
  select(ID,
     edeq.deliberately_limit_amount_influence_baseline,            
         edeq.calories_made_body_shape_baseline,                   
         edeq.weight_influenced_person_baseline,                       
         edeq.dissatisfied_shape_weight_baseline ,                   
         edeq.nibbled_picked_snacks_grazed_baseline, 
        edeq.eating_behaviours_concerns_distressed_baseline,
         edeq.felt_anxious_blue_bored_baseline,                    
         edeq.felt_anxious_blue_bored.1_baseline,   
         edeq.actively_been_monitoring_your_shape_or_weight__baseline_numeric,
         edeq.regard_lost_control_eaten_baseline_numeric,
         edeq.sick_means_made_shape_baseline_numeric,
         edeq.diuretics_laxatives_means_shape_baseline_numeric,
         edeq.compulsive_driven_burn_calories_baseline_numeric
     )

```


# EDEQ follow up B
## COPING
### Read in data
NB: The EDEQ  is only available in follow up B across both RAMP and COPING.
```{r Read in data COPING follow up B EDEQ }
edeq_followup_COPING <- readRDS(file = "../data_raw/coping/edeq_coping_followupb.rds")

# Check
dim(edeq_followup_COPING)
colnames(edeq_followup_COPING)
```

Select variables COPING follow up B EDEQ 
```{r Select variables COPING follow up B EDEQ }

exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate_waves",
                  "endDate")

edeq_followup_COPING.id <- edeq_followup_COPING %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  #add_column(cohort_name = "coping", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
       #  cohort_name, # Sample
         startDate_waves = startDate,
         edeq.deliberately_limit_amount_influence,
         edeq.calories_made_body_shape,                     
         edeq.weight_influenced_person,                      
         edeq.dissatisfied_shape_weight,                     
         edeq.actively_been_monitoring_your_shape_or_weight_, ### +++ HAL HERE - Change these to numeric 
         edeq.regard_lost_control_eaten,                    
         edeq.sick_means_made_shape,                      
         edeq.diuretics_laxatives_means_shape,               
         edeq.compulsive_driven_burn_calories,              
         edeq.eating_behaviours_distressed_concerns,        
         edeq.nibbled_picked_snacks_grazed,                  
         edeq.felt_anxious_blue_bored,                        
         edeq.felt_anxious_blue_bored.1                  
        # edeq.experiences_pandemic                     
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  #mutate_if(is.numeric, ~na_if(., -99)) %>%
 # mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  #mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  #mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
  #mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  #mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(edeq_followup_COPING.id)
# Inspect colnames
colnames(edeq_followup_COPING.id)
#Differences
dim(edeq_followup_COPING)[1]-dim(edeq_followup_COPING.id)[1]

```

# EDEQ follow up B
## RAMP
### Read in data
```{r Read in data RAMP follow up B EDEQ }

edeq_followup_RAMP <- readRDS(file = "../data_raw/ramp/edeq_ramp_followupb.rds")

# Check
dim(edeq_followup_RAMP)
colnames(edeq_followup_RAMP)

```
Select variables COPING follow up B EDEQ 
```{r Select variables COPING follow up B EDEQ }

exclude_cols_dem <- c("ID",
                  "cohort_name",
                  "startDate_waves",
                  "endDate")

edeq_followup_RAMP.id <- edeq_followup_RAMP %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
#  add_column(cohort_name = "ramp", .before = "startDate") %>% #create new column 
  select(
         ID = externalDataReference, # ID
     #    cohort_name, # Sample
         startDate_waves = startDate,
         edeq.deliberately_limit_amount_influence,
         edeq.calories_made_body_shape,                     
         edeq.weight_influenced_person,                      
         edeq.dissatisfied_shape_weight,                     
         edeq.actively_been_monitoring_your_shape_or_weight_,
         edeq.regard_lost_control_eaten,                    
         edeq.sick_means_made_shape,                      
         edeq.diuretics_laxatives_means_shape,               
         edeq.compulsive_driven_burn_calories,              
         edeq.eating_behaviours_distressed_concerns,        
         edeq.nibbled_picked_snacks_grazed,                  
         edeq.felt_anxious_blue_bored,                        
         edeq.felt_anxious_blue_bored.1                 
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  #mutate_if(is.numeric, ~na_if(., -99)) %>%
 # mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  #mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  #mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
 # mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) # Drop empty factor levels
  #mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
 # mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  #mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(edeq_followup_RAMP.id)
# Inspect colnames
colnames(edeq_followup_RAMP.id)
#Differences
dim(edeq_followup_RAMP)[1]-dim(edeq_followup_RAMP.id)[1]

```

# TIMEPOINTS / PHASES - RAMP - EDEQ 
Create phase columns in follow up data - RAMP
```{r Identify phases source script RAMP}

# MAY 1 (wave 1b) - FOLLOW UP B
start2 <- as.POSIXct("2020-05-05")
end2 <-  as.POSIXct("2020-05-19")  

# JUNE 1 (wave 2b) - FOLLOW UP B ##COPING STARTS HERE
start4 <- as.POSIXct("2020-06-02")
end4 <-  as.POSIXct("2020-06-16")  

# JULY 1 (wave 3b) - FOLLOW UP B
start6 <- as.POSIXct("2020-06-30")
end6 <-  as.POSIXct("2020-07-14") 

# JULY - AUG (wave 4b) - FOLLOW UP B
start8 <- as.POSIXct("2020-07-28")
end8 <-  as.POSIXct("2020-08-25") 

# SEPT - OCT (wave 6b) - FOLLOW UP B
start10 <- as.POSIXct("2020-09-22")
end10 <-  as.POSIXct("2020-10-20") 

# NOV - DEC (wave 8b) - FOLLOW UP B
start12 <- as.POSIXct("2020-11-17")
end12 <-  as.POSIXct("2020-12-15") 

# JAN - FEB (wave 10b) - FOLLOW UP B
start14 <- as.POSIXct("2021-01-12")
end14 <-  as.POSIXct("2021-02-09") 

# MARCH - APRIL (wave 11a) - FOLLOW UP B
start16 <- as.POSIXct("2021-03-09")
end16 <-  as.POSIXct("2021-06-06") 

edeq_followup_RAMP.id <- edeq_followup_RAMP.id %>%
  mutate(wave_edeq =  case_when(
    startDate_waves >= start2 & startDate_waves < end2 ~ ".Wave_1b",
    startDate_waves >= start4 & startDate_waves < end4 ~ ".Wave_2b",
    startDate_waves >= start6 & startDate_waves < end6 ~ ".Wave_3b",
    startDate_waves >= start8 & startDate_waves < end8 ~ ".Wave_4b",
    startDate_waves >= start10 & startDate_waves < end10 ~ ".Wave_6b",
    startDate_waves >= start12 & startDate_waves < end12 ~ ".Wave_8b",
    startDate_waves >= start14 & startDate_waves < end14 ~ ".Wave_10b",
    startDate_waves >= start16 & startDate_waves < end16 ~ ".Wave_12b"))
```

Check number of entries per wave
```{r Check number of entries per wave RAMP EDEQ }

edeq_followup_RAMP.id %>%
  group_by(wave_edeq) %>%
  count()

```

Idenfity duplicate IDs in a single wave
```{r Idenfity duplicate IDs in a single wave RAMP EDEQ }

# Identify dup IDs in a single wave
edeq_followup_RAMP.id %>%
   group_by(wave_edeq, ID) %>%
   summarize(N = n()) %>%
   filter(N > 1)

```

Want the LATER data entry from people who answered twice within a single wave (again, for now!)
[want ID AND wave to be unique]
```{r Later date entry RAMP EDEQ }
# Confirm number of rows in current dataset 
nrow(edeq_followup_RAMP.id)

# Filter out duplicated IDs AND wave, keeping the LAST entry
edeq_followup_RAMP.id <- edeq_followup_RAMP.id %>% 
    group_by(ID) %>% 
    filter(!duplicated(wave_edeq,
                      fromLast = TRUE)
           )

nrow(edeq_followup_RAMP.id)

```

Change follow up EDEQ RAMP  to wide format

```{r RAMP EDEQ  wide format}
edeq_followup_RAMP.id <- edeq_followup_RAMP.id %>%
  group_by(wave_edeq) %>%
  mutate(row = row_number()) %>%
  tidyr::pivot_wider(id_cols = ID,
    names_from = wave_edeq, 
                     values_from = c(edeq.deliberately_limit_amount_influence,
                                     edeq.calories_made_body_shape,                     
                                     edeq.weight_influenced_person,                      
                                     edeq.dissatisfied_shape_weight,                     
                                     edeq.actively_been_monitoring_your_shape_or_weight__numeric,
                                     edeq.regard_lost_control_eaten_numeric,                    
                                     edeq.sick_means_made_shape_numeric,                      
                                     edeq.diuretics_laxatives_means_shape_numeric,               
                                     edeq.compulsive_driven_burn_calories_numeric,              
                                     edeq.eating_behaviours_distressed_concerns,        
                                     edeq.nibbled_picked_snacks_grazed,                  
                                     edeq.felt_anxious_blue_bored,                        
                                     edeq.felt_anxious_blue_bored.1)) 
  

```

Select variables for dataset EDEQ RAMP 
```{r Select variables for dataset RAMP EDEQ }
edeq_followup_RAMP.id <- edeq_followup_RAMP.id  %>%
  select(ID,
         edeq.deliberately_limit_amount_influence_.Wave_1b,
         edeq.deliberately_limit_amount_influence_.Wave_2b,    
         edeq.deliberately_limit_amount_influence_.Wave_3b,       
         edeq.deliberately_limit_amount_influence_.Wave_4b,
         edeq.deliberately_limit_amount_influence_.Wave_6b,
         edeq.deliberately_limit_amount_influence_.Wave_8b,
         edeq.deliberately_limit_amount_influence_.Wave_10b,
         edeq.deliberately_limit_amount_influence_.Wave_12b,
        
         edeq.calories_made_body_shape_.Wave_1b,
         edeq.calories_made_body_shape_.Wave_2b,    
         edeq.calories_made_body_shape_.Wave_3b,       
         edeq.calories_made_body_shape_.Wave_4b,
         edeq.calories_made_body_shape_.Wave_6b,
         edeq.calories_made_body_shape_.Wave_8b,
         edeq.calories_made_body_shape_.Wave_10b,
         edeq.calories_made_body_shape_.Wave_12b,
        
         edeq.weight_influenced_person_.Wave_1b,
         edeq.weight_influenced_person_.Wave_2b,    
         edeq.weight_influenced_person_.Wave_3b,       
         edeq.weight_influenced_person_.Wave_4b,
         edeq.weight_influenced_person_.Wave_6b,
         edeq.weight_influenced_person_.Wave_8b,
         edeq.weight_influenced_person_.Wave_10b,
         edeq.weight_influenced_person_.Wave_12b,
        
         edeq.dissatisfied_shape_weight_.Wave_1b,
         edeq.dissatisfied_shape_weight_.Wave_2b,    
         edeq.dissatisfied_shape_weight_.Wave_3b,       
         edeq.dissatisfied_shape_weight_.Wave_4b,
         edeq.dissatisfied_shape_weight_.Wave_6b,
         edeq.dissatisfied_shape_weight_.Wave_8b,
         edeq.dissatisfied_shape_weight_.Wave_10b,
         edeq.dissatisfied_shape_weight_.Wave_12b,
         
         edeq.actively_been_monitoring_your_shape_or_weight__numeric_.Wave_1b,
         edeq.actively_been_monitoring_your_shape_or_weight__numeric_.Wave_2b,
         edeq.actively_been_monitoring_your_shape_or_weight__numeric_.Wave_3b,
         edeq.actively_been_monitoring_your_shape_or_weight__numeric_.Wave_4b,
         edeq.actively_been_monitoring_your_shape_or_weight__numeric_.Wave_6b,
         edeq.actively_been_monitoring_your_shape_or_weight__numeric_.Wave_8b,
         edeq.actively_been_monitoring_your_shape_or_weight__numeric_.Wave_10b,
         edeq.actively_been_monitoring_your_shape_or_weight__numeric_.Wave_12b,
         
         edeq.regard_lost_control_eaten_numeric_.Wave_1b,
         edeq.regard_lost_control_eaten_numeric_.Wave_2b,
         edeq.regard_lost_control_eaten_numeric_.Wave_3b,
         edeq.regard_lost_control_eaten_numeric_.Wave_4b,
         edeq.regard_lost_control_eaten_numeric_.Wave_6b,
         edeq.regard_lost_control_eaten_numeric_.Wave_8b,
         edeq.regard_lost_control_eaten_numeric_.Wave_10b,
         edeq.regard_lost_control_eaten_numeric_.Wave_12b,
         
         edeq.sick_means_made_shape_numeric_.Wave_1b,
         edeq.sick_means_made_shape_numeric_.Wave_2b,
         edeq.sick_means_made_shape_numeric_.Wave_3b,
         edeq.sick_means_made_shape_numeric_.Wave_4b,
         edeq.sick_means_made_shape_numeric_.Wave_6b,
         edeq.sick_means_made_shape_numeric_.Wave_8b,
         edeq.sick_means_made_shape_numeric_.Wave_10b,
         edeq.sick_means_made_shape_numeric_.Wave_12b,
         
         edeq.diuretics_laxatives_means_shape_numeric_.Wave_1b,
         edeq.diuretics_laxatives_means_shape_numeric_.Wave_2b,
         edeq.diuretics_laxatives_means_shape_numeric_.Wave_3b,
         edeq.diuretics_laxatives_means_shape_numeric_.Wave_4b,
         edeq.diuretics_laxatives_means_shape_numeric_.Wave_6b,
         edeq.diuretics_laxatives_means_shape_numeric_.Wave_8b,
         edeq.diuretics_laxatives_means_shape_numeric_.Wave_10b,
         edeq.diuretics_laxatives_means_shape_numeric_.Wave_12b,
         
         edeq.compulsive_driven_burn_calories_numeric_.Wave_1b,
         edeq.compulsive_driven_burn_calories_numeric_.Wave_2b,
         edeq.compulsive_driven_burn_calories_numeric_.Wave_3b,
         edeq.compulsive_driven_burn_calories_numeric_.Wave_4b,
         edeq.compulsive_driven_burn_calories_numeric_.Wave_6b,
         edeq.compulsive_driven_burn_calories_numeric_.Wave_8b,
         edeq.compulsive_driven_burn_calories_numeric_.Wave_10b,
         edeq.compulsive_driven_burn_calories_numeric_.Wave_12b,
         
         edeq.eating_behaviours_distressed_concerns_.Wave_1b,
         edeq.eating_behaviours_distressed_concerns_.Wave_2b,
         edeq.eating_behaviours_distressed_concerns_.Wave_3b,
         edeq.eating_behaviours_distressed_concerns_.Wave_4b,
         edeq.eating_behaviours_distressed_concerns_.Wave_6b,
         edeq.eating_behaviours_distressed_concerns_.Wave_8b,
         edeq.eating_behaviours_distressed_concerns_.Wave_10b,
         edeq.eating_behaviours_distressed_concerns_.Wave_12b,
         
         edeq.nibbled_picked_snacks_grazed_.Wave_1b,
         edeq.nibbled_picked_snacks_grazed_.Wave_2b,
         edeq.nibbled_picked_snacks_grazed_.Wave_3b,
         edeq.nibbled_picked_snacks_grazed_.Wave_4b,
         edeq.nibbled_picked_snacks_grazed_.Wave_6b,
         edeq.nibbled_picked_snacks_grazed_.Wave_8b,
         edeq.nibbled_picked_snacks_grazed_.Wave_10b,
         edeq.nibbled_picked_snacks_grazed_.Wave_12b,
         
         edeq.felt_anxious_blue_bored_.Wave_1b,
         edeq.felt_anxious_blue_bored_.Wave_2b,
         edeq.felt_anxious_blue_bored_.Wave_3b,
         edeq.felt_anxious_blue_bored_.Wave_4b,
         edeq.felt_anxious_blue_bored_.Wave_6b,
         edeq.felt_anxious_blue_bored_.Wave_8b,
         edeq.felt_anxious_blue_bored_.Wave_10b,
         edeq.felt_anxious_blue_bored_.Wave_12b,
         
         edeq.felt_anxious_blue_bored.1_.Wave_1b,
         edeq.felt_anxious_blue_bored.1_.Wave_2b,
         edeq.felt_anxious_blue_bored.1_.Wave_3b,
         edeq.felt_anxious_blue_bored.1_.Wave_4b,
         edeq.felt_anxious_blue_bored.1_.Wave_6b,
         edeq.felt_anxious_blue_bored.1_.Wave_8b,
         edeq.felt_anxious_blue_bored.1_.Wave_10b,
         edeq.felt_anxious_blue_bored.1_.Wave_12b)

# Add cohort name back in
edeq_followup_RAMP.id$cohort_name <- "ramp"
```

Remove duplicate IDs EDEQ RAMP 
```{r Remove duplicate IDs RAMP EDEQ }

# Check col names
colnames(edeq_followup_RAMP.id)

# Remove dupilcate IDs (as each wave is now a column, there should be NO dup IDs)
edeq_followup_RAMP.id  <- edeq_followup_RAMP.id  %>%
  filter(., !duplicated(ID)) 

# Check number of rows
nrow(edeq_followup_RAMP.id)

```

# TIMEPOINTS / PHASES - COPING - EDEQ 
Create phase columns in follow up data - COPING
```{r Identify phases COPING}

edeq_followup_COPING.id <- edeq_followup_COPING.id %>%
  mutate(wave_edeq =  case_when(
   # startDate_waves >= start2 & startDate_waves < end2 ~ ".Wave_1b",
    startDate_waves >= start4 & startDate_waves < end4 ~ ".Wave_2b",
    startDate_waves >= start6 & startDate_waves < end6 ~ ".Wave_3b",
    startDate_waves >= start8 & startDate_waves < end8 ~ ".Wave_4b",
    startDate_waves >= start10 & startDate_waves < end10 ~ ".Wave_6b",
    startDate_waves >= start12 & startDate_waves < end12 ~ ".Wave_8b",
    startDate_waves >= start14 & startDate_waves < end14 ~ ".Wave_10b",
    startDate_waves >= start16 & startDate_waves < end16 ~ ".Wave_12b"))
```

Check number of entries per wave
```{r Check number of entries per wave COPING EDEQ }

edeq_followup_COPING.id %>%
  group_by(wave_edeq) %>%
  count()

```

Check number of entries per wave
```{r Check number of entries per wave COPING EDEQ }

edeq_followup_COPING.id %>%
  group_by(wave_edeq) %>%
  count()

```

Idenfity duplicate IDs in a single wave
```{r Idenfity duplicate IDs in a single wave COPING EDEQ }

# Identify dup IDs in a single wave
edeq_followup_COPING.id %>%
   group_by(wave_edeq, ID) %>%
   summarize(N = n()) %>%
   filter(N > 1)

```

Want the LATER data entry from people who answered twice within a single wave (again, for now!)
[want ID AND wave to be unique]
```{r Later date entry COPING EDEQ }
# Confirm number of rows in current dataset 
nrow(edeq_followup_COPING.id)

# Filter out duplicated IDs AND wave, keeping the LAST entry
edeq_followup_COPING.id <- edeq_followup_COPING.id %>% 
    group_by(ID) %>% 
    filter(!duplicated(wave_edeq,
                      fromLast = TRUE)
           )

nrow(edeq_followup_COPING.id)

```

Change follow up EDEQ COPING  to wide format

```{r COPING EDEQ  wide format}
edeq_followup_COPING.id <- edeq_followup_COPING.id %>%
  group_by(wave_edeq) %>%
  mutate(row = row_number()) %>%
  tidyr::pivot_wider(id_cols = ID,
    names_from = wave_edeq, 
                     values_from = c(edeq.deliberately_limit_amount_influence,
                                     edeq.calories_made_body_shape,                     
                                     edeq.weight_influenced_person,                      
                                     edeq.dissatisfied_shape_weight,                     
                                     edeq.actively_been_monitoring_your_shape_or_weight__numeric,
                                     edeq.regard_lost_control_eaten_numeric,                    
                                     edeq.sick_means_made_shape_numeric,                      
                                     edeq.diuretics_laxatives_means_shape_numeric,               
                                     edeq.compulsive_driven_burn_calories_numeric,              
                                     edeq.eating_behaviours_distressed_concerns,        
                                     edeq.nibbled_picked_snacks_grazed,                  
                                     edeq.felt_anxious_blue_bored,                        
                                     edeq.felt_anxious_blue_bored.1)) 
  

```

Select variables for dataset EDEQ COPING 

```{r Select variables for dataset COPING EDEQ }
edeq_followup_COPING.id <- edeq_followup_COPING.id  %>%
  select(ID,
         #edeq.deliberately_limit_amount_influence_.Wave_1b,
         edeq.deliberately_limit_amount_influence_.Wave_2b,    
         edeq.deliberately_limit_amount_influence_.Wave_3b,       
         edeq.deliberately_limit_amount_influence_.Wave_4b,
         edeq.deliberately_limit_amount_influence_.Wave_6b,
         edeq.deliberately_limit_amount_influence_.Wave_8b,
         edeq.deliberately_limit_amount_influence_.Wave_10b,
         edeq.deliberately_limit_amount_influence_.Wave_12b,
        
         #edeq.calories_made_body_shape_.Wave_1b,
         edeq.calories_made_body_shape_.Wave_2b,    
         edeq.calories_made_body_shape_.Wave_3b,       
         edeq.calories_made_body_shape_.Wave_4b,
         edeq.calories_made_body_shape_.Wave_6b,
         edeq.calories_made_body_shape_.Wave_8b,
         edeq.calories_made_body_shape_.Wave_10b,
         edeq.calories_made_body_shape_.Wave_12b,
        
         #edeq.weight_influenced_person_.Wave_1b,
         edeq.weight_influenced_person_.Wave_2b,    
         edeq.weight_influenced_person_.Wave_3b,       
         edeq.weight_influenced_person_.Wave_4b,
         edeq.weight_influenced_person_.Wave_6b,
         edeq.weight_influenced_person_.Wave_8b,
         edeq.weight_influenced_person_.Wave_10b,
         edeq.weight_influenced_person_.Wave_12b,
        
        # edeq.dissatisfied_shape_weight_.Wave_1b,
         edeq.dissatisfied_shape_weight_.Wave_2b,    
         edeq.dissatisfied_shape_weight_.Wave_3b,       
         edeq.dissatisfied_shape_weight_.Wave_4b,
         edeq.dissatisfied_shape_weight_.Wave_6b,
         edeq.dissatisfied_shape_weight_.Wave_8b,
         edeq.dissatisfied_shape_weight_.Wave_10b,
         edeq.dissatisfied_shape_weight_.Wave_12b,
         
         #edeq.actively_been_monitoring_your_shape_or_weight__.Wave_1b,
         edeq.actively_been_monitoring_your_shape_or_weight__numeric_.Wave_2b,
         edeq.actively_been_monitoring_your_shape_or_weight__numeric_.Wave_3b,
         edeq.actively_been_monitoring_your_shape_or_weight__numeric_.Wave_4b,
         edeq.actively_been_monitoring_your_shape_or_weight__numeric_.Wave_6b,
         edeq.actively_been_monitoring_your_shape_or_weight__numeric_.Wave_8b,
         edeq.actively_been_monitoring_your_shape_or_weight__numeric_.Wave_10b,
         edeq.actively_been_monitoring_your_shape_or_weight__numeric_.Wave_12b,
         
        # edeq.regard_lost_control_eaten_.Wave_1b,
         edeq.regard_lost_control_eaten_numeric_.Wave_2b,
         edeq.regard_lost_control_eaten_numeric_.Wave_3b,
         edeq.regard_lost_control_eaten_numeric_.Wave_4b,
         edeq.regard_lost_control_eaten_numeric_.Wave_6b,
         edeq.regard_lost_control_eaten_numeric_.Wave_8b,
         edeq.regard_lost_control_eaten_numeric_.Wave_10b,
         edeq.regard_lost_control_eaten_numeric_.Wave_12b,
         
        # edeq.sick_means_made_shape_.Wave_1b,
         edeq.sick_means_made_shape_numeric_.Wave_2b,
         edeq.sick_means_made_shape_numeric_.Wave_3b,
         edeq.sick_means_made_shape_numeric_.Wave_4b,
         edeq.sick_means_made_shape_numeric_.Wave_6b,
         edeq.sick_means_made_shape_numeric_.Wave_8b,
         edeq.sick_means_made_shape_numeric_.Wave_10b,
         edeq.sick_means_made_shape_numeric_.Wave_12b,
         
        # edeq.diuretics_laxatives_means_shape_.Wave_1b,
         edeq.diuretics_laxatives_means_shape_numeric_.Wave_2b,
         edeq.diuretics_laxatives_means_shape_numeric_.Wave_3b,
         edeq.diuretics_laxatives_means_shape_numeric_.Wave_4b,
         edeq.diuretics_laxatives_means_shape_numeric_.Wave_6b,
         edeq.diuretics_laxatives_means_shape_numeric_.Wave_8b,
         edeq.diuretics_laxatives_means_shape_numeric_.Wave_10b,
         edeq.diuretics_laxatives_means_shape_numeric_.Wave_12b,
         
        # edeq.compulsive_driven_burn_calories_.Wave_1b,
         edeq.compulsive_driven_burn_calories_numeric_.Wave_2b,
         edeq.compulsive_driven_burn_calories_numeric_.Wave_3b,
         edeq.compulsive_driven_burn_calories_numeric_.Wave_4b,
         edeq.compulsive_driven_burn_calories_numeric_.Wave_6b,
         edeq.compulsive_driven_burn_calories_numeric_.Wave_8b,
         edeq.compulsive_driven_burn_calories_numeric_.Wave_10b,
         edeq.compulsive_driven_burn_calories_numeric_.Wave_12b,
         
       #  edeq.eating_behaviours_distressed_concerns_.Wave_1b,
         edeq.eating_behaviours_distressed_concerns_.Wave_2b,
         edeq.eating_behaviours_distressed_concerns_.Wave_3b,
         edeq.eating_behaviours_distressed_concerns_.Wave_4b,
         edeq.eating_behaviours_distressed_concerns_.Wave_6b,
         edeq.eating_behaviours_distressed_concerns_.Wave_8b,
         edeq.eating_behaviours_distressed_concerns_.Wave_10b,
         edeq.eating_behaviours_distressed_concerns_.Wave_12b,
         
        # edeq.nibbled_picked_snacks_grazed_.Wave_1b,
         edeq.nibbled_picked_snacks_grazed_.Wave_2b,
         edeq.nibbled_picked_snacks_grazed_.Wave_3b,
         edeq.nibbled_picked_snacks_grazed_.Wave_4b,
         edeq.nibbled_picked_snacks_grazed_.Wave_6b,
         edeq.nibbled_picked_snacks_grazed_.Wave_8b,
         edeq.nibbled_picked_snacks_grazed_.Wave_10b,
         edeq.nibbled_picked_snacks_grazed_.Wave_12b,
         
       #  edeq.felt_anxious_blue_bored_.Wave_1b,
         edeq.felt_anxious_blue_bored_.Wave_2b,
         edeq.felt_anxious_blue_bored_.Wave_3b,
         edeq.felt_anxious_blue_bored_.Wave_4b,
         edeq.felt_anxious_blue_bored_.Wave_6b,
         edeq.felt_anxious_blue_bored_.Wave_8b,
         edeq.felt_anxious_blue_bored_.Wave_10b,
         edeq.felt_anxious_blue_bored_.Wave_12b,
         
       #  edeq.felt_anxious_blue_bored.1_.Wave_1b,
         edeq.felt_anxious_blue_bored.1_.Wave_2b,
         edeq.felt_anxious_blue_bored.1_.Wave_3b,
         edeq.felt_anxious_blue_bored.1_.Wave_4b,
         edeq.felt_anxious_blue_bored.1_.Wave_6b,
         edeq.felt_anxious_blue_bored.1_.Wave_8b,
         edeq.felt_anxious_blue_bored.1_.Wave_10b,
         edeq.felt_anxious_blue_bored.1_.Wave_12b
         )

# Add cohort name back in
edeq_followup_COPING.id$cohort_name <- "coping"
```

Remove duplicate IDs EDEQ COPING 
```{r Remove duplicate IDs COPING EDEQ }

# Check col names
colnames(edeq_followup_COPING.id)

# Remove dupilcate IDs (as each wave is now a column, there should be NO dup IDs)
edeq_followup_COPING.id  <- edeq_followup_COPING.id  %>%
  filter(., !duplicated(ID)) 

# Check number of rows
nrow(edeq_followup_COPING.id)

```

# Merging data
## Merge RAMP baseline with RAMP follow up
```{r merge RAMP baseline and follow up}
RAMP_merged <- merge(ramp_baseline_edeq,
  edeq_followup_RAMP.id,
  by = "ID")

RAMP_merged %>%
  colnames()
```

## Create empty columns in COPING to match those in RAMP

```{r empty columns in COPING to match RAMP}
RAMP_edeq_columns <- c(
"edeq.deliberately_limit_amount_influence_.Wave_1b",
"edeq.calories_made_body_shape_.Wave_1b",
"edeq.weight_influenced_person_.Wave_1b",
"edeq.dissatisfied_shape_weight_.Wave_1b",
"edeq.actively_been_monitoring_your_shape_or_weight__numeric_.Wave_1b",
"edeq.regard_lost_control_eaten_numeric_.Wave_1b",
"edeq.sick_means_made_shape_numeric_.Wave_1b",
"edeq.diuretics_laxatives_means_shape_numeric_.Wave_1b",
"edeq.compulsive_driven_burn_calories_numeric_.Wave_1b",
"edeq.eating_behaviours_distressed_concerns_.Wave_1b",
"edeq.nibbled_picked_snacks_grazed_.Wave_1b",
"edeq.felt_anxious_blue_bored_.Wave_1b",
"edeq.felt_anxious_blue_bored.1_.Wave_1b",

"edeq.deliberately_limit_amount_influence_baseline", 
"edeq.eating_behaviours_concerns_distressed_baseline",
         "edeq.calories_made_body_shape_baseline",                   
         "edeq.weight_influenced_person_baseline",                       
         "edeq.dissatisfied_shape_weight_baseline",                   
         "edeq.nibbled_picked_snacks_grazed_baseline",                  
         "edeq.felt_anxious_blue_bored_baseline",                    
         "edeq.felt_anxious_blue_bored.1_baseline",   
         "edeq.actively_been_monitoring_your_shape_or_weight__baseline_numeric",
         "edeq.regard_lost_control_eaten_baseline_numeric",
         "edeq.sick_means_made_shape_baseline_numeric",
         "edeq.diuretics_laxatives_means_shape_baseline_numeric",
         "edeq.compulsive_driven_burn_calories_baseline_numeric")

edeq_followup_COPING.id[RAMP_edeq_columns] <- NA_real_
```

## Bind data using rbind
```{r rbind RAMP and COPING data}
EDEQ_dat <- edeq_followup_COPING.id %>%
  rbind(RAMP_merged)

# Check
EDEQ_dat %>%
  colnames()

EDEQ_dat %>%
  nrow()
```
# First time filling out EDEQ
```{r first time only}

# On how many of the past 28 days:	Have you been deliberately trying to limit the amount of food you eat to influence your shape or weight ?
EDEQ_dat <- EDEQ_dat %>%
  mutate(edeq.deliberate_limit_food =
           case_when(
                    edeq.deliberately_limit_amount_influence_baseline == "No days" ~ "No days",
                    edeq.deliberately_limit_amount_influence_baseline == "1-4 days" ~ "1-4 days",
                    edeq.deliberately_limit_amount_influence_baseline == "5-10 days" ~ "5-10 days",
                    edeq.deliberately_limit_amount_influence_baseline == "11-16 days" ~ "11-16 days",
                    edeq.deliberately_limit_amount_influence_baseline == "17-22 days" ~ "17-22 days",
                    edeq.deliberately_limit_amount_influence_baseline == "23-27 days" ~ "23-27 days",
                    edeq.deliberately_limit_amount_influence_baseline == "Every day" ~ "Every day",
                    
                    edeq.deliberately_limit_amount_influence_.Wave_1b == "No days" ~ "No days",
                    edeq.deliberately_limit_amount_influence_.Wave_1b == "1-4 days" ~ "1-4 days",
                    edeq.deliberately_limit_amount_influence_.Wave_1b == "5-10 days" ~ "5-10 days",
                    edeq.deliberately_limit_amount_influence_.Wave_1b == "11-16 days" ~ "11-16 days",
                    edeq.deliberately_limit_amount_influence_.Wave_1b == "17-22 days" ~ "17-22 days",
                    edeq.deliberately_limit_amount_influence_.Wave_1b == "23-27 days" ~ "23-27 days",
                    edeq.deliberately_limit_amount_influence_.Wave_1b == "Every day" ~ "Every day",
                    
                    edeq.deliberately_limit_amount_influence_.Wave_2b == "No days" ~ "No days",
                    edeq.deliberately_limit_amount_influence_.Wave_2b == "1-4 days" ~ "1-4 days",
                    edeq.deliberately_limit_amount_influence_.Wave_2b == "5-10 days" ~ "5-10 days",
                    edeq.deliberately_limit_amount_influence_.Wave_2b == "11-16 days" ~ "11-16 days",
                    edeq.deliberately_limit_amount_influence_.Wave_2b == "17-22 days" ~ "17-22 days",
                    edeq.deliberately_limit_amount_influence_.Wave_2b == "23-27 days" ~ "23-27 days",
                    edeq.deliberately_limit_amount_influence_.Wave_2b == "Every day" ~ "Every day",
                    
                    edeq.deliberately_limit_amount_influence_.Wave_3b == "No days" ~ "No days", 
                    edeq.deliberately_limit_amount_influence_.Wave_3b == "1-4 days" ~ "1-4 days",
                    edeq.deliberately_limit_amount_influence_.Wave_3b == "5-10 days" ~ "5-10 days",
                    edeq.deliberately_limit_amount_influence_.Wave_3b == "11-16 days" ~ "11-16 days",
                    edeq.deliberately_limit_amount_influence_.Wave_3b == "17-22 days" ~ "17-22 days",
                    edeq.deliberately_limit_amount_influence_.Wave_3b == "23-27 days" ~ "23-27 days",
                    edeq.deliberately_limit_amount_influence_.Wave_3b == "Every day" ~ "Every day",
                    
                    edeq.deliberately_limit_amount_influence_.Wave_4b == "No days" ~ "No days", 
                    edeq.deliberately_limit_amount_influence_.Wave_4b == "1-4 days" ~ "1-4 days",
                    edeq.deliberately_limit_amount_influence_.Wave_4b == "5-10 days" ~ "5-10 days",
                    edeq.deliberately_limit_amount_influence_.Wave_4b == "11-16 days" ~ "11-16 days",
                    edeq.deliberately_limit_amount_influence_.Wave_4b == "17-22 days" ~ "17-22 days",
                    edeq.deliberately_limit_amount_influence_.Wave_4b == "23-27 days" ~ "23-27 days",
                    edeq.deliberately_limit_amount_influence_.Wave_4b == "Every day" ~ "Every day",
                    
                    edeq.deliberately_limit_amount_influence_.Wave_6b == "No days" ~ "No days", 
                    edeq.deliberately_limit_amount_influence_.Wave_6b == "1-4 days" ~ "1-4 days",
                    edeq.deliberately_limit_amount_influence_.Wave_6b == "5-10 days" ~ "5-10 days",
                    edeq.deliberately_limit_amount_influence_.Wave_6b == "11-16 days" ~ "11-16 days",
                    edeq.deliberately_limit_amount_influence_.Wave_6b == "17-22 days" ~ "17-22 days",
                    edeq.deliberately_limit_amount_influence_.Wave_6b == "23-27 days" ~ "23-27 days",
                    edeq.deliberately_limit_amount_influence_.Wave_6b == "Every day" ~ "Every day",
                    
                    edeq.deliberately_limit_amount_influence_.Wave_8b == "No days" ~ "No days", 
                    edeq.deliberately_limit_amount_influence_.Wave_8b == "1-4 days" ~ "1-4 days",
                    edeq.deliberately_limit_amount_influence_.Wave_8b == "5-10 days" ~ "5-10 days",
                    edeq.deliberately_limit_amount_influence_.Wave_8b == "11-16 days" ~ "11-16 days",
                    edeq.deliberately_limit_amount_influence_.Wave_8b == "17-22 days" ~ "17-22 days",
                    edeq.deliberately_limit_amount_influence_.Wave_8b == "23-27 days" ~ "23-27 days",
                    edeq.deliberately_limit_amount_influence_.Wave_8b == "Every day" ~ "Every day",
                    
                    edeq.deliberately_limit_amount_influence_.Wave_10b == "No days" ~ "No days", 
                    edeq.deliberately_limit_amount_influence_.Wave_10b == "1-4 days" ~ "1-4 days",
                    edeq.deliberately_limit_amount_influence_.Wave_10b == "5-10 days" ~ "5-10 days",
                    edeq.deliberately_limit_amount_influence_.Wave_10b == "11-16 days" ~ "11-16 days",
                    edeq.deliberately_limit_amount_influence_.Wave_10b == "17-22 days" ~ "17-22 days",
                    edeq.deliberately_limit_amount_influence_.Wave_10b == "23-27 days" ~ "23-27 days",
                    edeq.deliberately_limit_amount_influence_.Wave_10b == "Every day" ~ "Every day",
                    
                    edeq.deliberately_limit_amount_influence_.Wave_12b == "No days" ~ "No days", 
                    edeq.deliberately_limit_amount_influence_.Wave_12b == "1-4 days" ~ "1-4 days",
                    edeq.deliberately_limit_amount_influence_.Wave_12b == "5-10 days" ~ "5-10 days",
                    edeq.deliberately_limit_amount_influence_.Wave_12b == "11-16 days" ~ "11-16 days",
                    edeq.deliberately_limit_amount_influence_.Wave_12b == "17-22 days" ~ "17-22 days",
                    edeq.deliberately_limit_amount_influence_.Wave_12b == "23-27 days" ~ "23-27 days",
                    edeq.deliberately_limit_amount_influence_.Wave_12b == "Every day" ~ "Every day"
           
         )
  )
 
# Check
EDEQ_dat %>%
  freq(edeq.deliberate_limit_food)

# On how many of the past 28 days:	Has thinking about body shape, weight, food, eating, or calories made it very difficult to concentrate on things you are interested in ?
EDEQ_dat <- EDEQ_dat %>%
  mutate(edeq.difficulty_concentrating =
           case_when( 
                    edeq.calories_made_body_shape_baseline == "No days" ~ "No days",
                    edeq.calories_made_body_shape_baseline == "1-4 days" ~ "1-4 days",
                    edeq.calories_made_body_shape_baseline == "5-10 days" ~ "5-10 days",
                    edeq.calories_made_body_shape_baseline == "11-16 days" ~ "11-16 days",
                    edeq.calories_made_body_shape_baseline == "17-22 days" ~ "17-22 days",
                    edeq.calories_made_body_shape_baseline == "23-27 days" ~ "23-27 days",
                    edeq.calories_made_body_shape_baseline == "Every day" ~ "Every day",
                    
                    edeq.calories_made_body_shape_.Wave_1b == "No days" ~ "No days",
                    edeq.calories_made_body_shape_.Wave_1b == "1-4 days" ~ "1-4 days",
                    edeq.calories_made_body_shape_.Wave_1b == "5-10 days" ~ "5-10 days",
                    edeq.calories_made_body_shape_.Wave_1b == "11-16 days" ~ "11-16 days",
                    edeq.calories_made_body_shape_.Wave_1b == "17-22 days" ~ "17-22 days",
                    edeq.calories_made_body_shape_.Wave_1b == "23-27 days" ~ "23-27 days",
                    edeq.calories_made_body_shape_.Wave_1b == "Every day" ~ "Every day",
                    
                    edeq.calories_made_body_shape_.Wave_2b == "No days" ~ "No days",
                    edeq.calories_made_body_shape_.Wave_2b == "1-4 days" ~ "1-4 days",
                    edeq.calories_made_body_shape_.Wave_2b == "5-10 days" ~ "5-10 days",
                    edeq.calories_made_body_shape_.Wave_2b == "11-16 days" ~ "11-16 days",
                    edeq.calories_made_body_shape_.Wave_2b == "17-22 days" ~ "17-22 days",
                    edeq.calories_made_body_shape_.Wave_2b == "23-27 days" ~ "23-27 days",
                    edeq.calories_made_body_shape_.Wave_2b == "Every day" ~ "Every day",
                    
                    edeq.calories_made_body_shape_.Wave_3b == "No days" ~ "No days", 
                    edeq.calories_made_body_shape_.Wave_3b == "1-4 days" ~ "1-4 days",
                    edeq.calories_made_body_shape_.Wave_3b == "5-10 days" ~ "5-10 days",
                    edeq.calories_made_body_shape_.Wave_3b == "11-16 days" ~ "11-16 days",
                    edeq.calories_made_body_shape_.Wave_3b == "17-22 days" ~ "17-22 days",
                    edeq.calories_made_body_shape_.Wave_3b == "23-27 days" ~ "23-27 days",
                    edeq.calories_made_body_shape_.Wave_3b == "Every day" ~ "Every day",
                    
                    edeq.calories_made_body_shape_.Wave_4b == "No days" ~ "No days", 
                    edeq.calories_made_body_shape_.Wave_4b == "1-4 days" ~ "1-4 days",
                    edeq.calories_made_body_shape_.Wave_4b == "5-10 days" ~ "5-10 days",
                    edeq.calories_made_body_shape_.Wave_4b == "11-16 days" ~ "11-16 days",
                    edeq.calories_made_body_shape_.Wave_4b == "17-22 days" ~ "17-22 days",
                    edeq.calories_made_body_shape_.Wave_4b == "23-27 days" ~ "23-27 days",
                    edeq.calories_made_body_shape_.Wave_4b == "Every day" ~ "Every day",
                    
                    edeq.calories_made_body_shape_.Wave_6b == "No days" ~ "No days", 
                    edeq.calories_made_body_shape_.Wave_6b == "1-4 days" ~ "1-4 days",
                    edeq.calories_made_body_shape_.Wave_6b == "5-10 days" ~ "5-10 days",
                    edeq.calories_made_body_shape_.Wave_6b == "11-16 days" ~ "11-16 days",
                    edeq.calories_made_body_shape_.Wave_6b == "17-22 days" ~ "17-22 days",
                    edeq.calories_made_body_shape_.Wave_6b == "23-27 days" ~ "23-27 days",
                    edeq.calories_made_body_shape_.Wave_6b == "Every day" ~ "Every day",
                    
                    edeq.calories_made_body_shape_.Wave_8b == "No days" ~ "No days", 
                    edeq.calories_made_body_shape_.Wave_8b == "1-4 days" ~ "1-4 days",
                    edeq.calories_made_body_shape_.Wave_8b == "5-10 days" ~ "5-10 days",
                    edeq.calories_made_body_shape_.Wave_8b == "11-16 days" ~ "11-16 days",
                    edeq.calories_made_body_shape_.Wave_8b == "17-22 days" ~ "17-22 days",
                    edeq.calories_made_body_shape_.Wave_8b == "23-27 days" ~ "23-27 days",
                    edeq.calories_made_body_shape_.Wave_8b == "Every day" ~ "Every day",
                    
                    edeq.calories_made_body_shape_.Wave_10b == "No days" ~ "No days", 
                    edeq.calories_made_body_shape_.Wave_10b == "1-4 days" ~ "1-4 days",
                    edeq.calories_made_body_shape_.Wave_10b == "5-10 days" ~ "5-10 days",
                    edeq.calories_made_body_shape_.Wave_10b == "11-16 days" ~ "11-16 days",
                    edeq.calories_made_body_shape_.Wave_10b == "17-22 days" ~ "17-22 days",
                    edeq.calories_made_body_shape_.Wave_10b == "23-27 days" ~ "23-27 days",
                    edeq.calories_made_body_shape_.Wave_10b == "Every day" ~ "Every day",
                    
                    edeq.calories_made_body_shape_.Wave_12b == "No days" ~ "No days", 
                    edeq.calories_made_body_shape_.Wave_12b == "1-4 days" ~ "1-4 days",
                    edeq.calories_made_body_shape_.Wave_12b == "5-10 days" ~ "5-10 days",
                    edeq.calories_made_body_shape_.Wave_12b == "11-16 days" ~ "11-16 days",
                    edeq.calories_made_body_shape_.Wave_12b == "17-22 days" ~ "17-22 days",
                    edeq.calories_made_body_shape_.Wave_12b == "23-27 days" ~ "23-27 days",
                    edeq.calories_made_body_shape_.Wave_12b == "Every day" ~ "Every day"
           
         )
  )
 
# Check
EDEQ_dat %>%
  freq(edeq.difficulty_concentrating)

# Over the past 28 days:	Has your weight influenced how you think about yourself as a person?
EDEQ_dat <- EDEQ_dat %>%
  mutate(edeq.weight_influenced_think_person =
           case_when(
                    edeq.weight_influenced_person_baseline == "0" ~ "0",
                    edeq.weight_influenced_person_baseline == "1" ~ "1",
                    edeq.weight_influenced_person_baseline == "2" ~ "2",
                    edeq.weight_influenced_person_baseline == "3" ~ "3",
                    edeq.weight_influenced_person_baseline == "4" ~ "4",
                    edeq.weight_influenced_person_baseline == "5" ~ "5",
                    
                    edeq.weight_influenced_person_.Wave_1b == "0" ~ "0",
                    edeq.weight_influenced_person_.Wave_1b == "1" ~ "1",
                    edeq.weight_influenced_person_.Wave_1b == "2" ~ "2",
                    edeq.weight_influenced_person_.Wave_1b == "3" ~ "3",
                    edeq.weight_influenced_person_.Wave_1b == "4" ~ "4",
                    edeq.weight_influenced_person_.Wave_1b == "5" ~ "5",
                    
                    edeq.weight_influenced_person_.Wave_2b == "0" ~ "0",
                    edeq.weight_influenced_person_.Wave_2b == "1" ~ "1",
                    edeq.weight_influenced_person_.Wave_2b == "2" ~ "2",
                    edeq.weight_influenced_person_.Wave_2b == "3" ~ "3",
                    edeq.weight_influenced_person_.Wave_2b == "4" ~ "4",
                    edeq.weight_influenced_person_.Wave_2b == "5" ~ "5",

                    edeq.weight_influenced_person_.Wave_3b == "0" ~ "0",
                    edeq.weight_influenced_person_.Wave_3b == "1" ~ "1",
                    edeq.weight_influenced_person_.Wave_3b == "2" ~ "2",
                    edeq.weight_influenced_person_.Wave_3b == "3" ~ "3",
                    edeq.weight_influenced_person_.Wave_3b == "4" ~ "4",
                    edeq.weight_influenced_person_.Wave_3b == "5" ~ "5",
                    
                    edeq.weight_influenced_person_.Wave_4b == "0" ~ "0",
                    edeq.weight_influenced_person_.Wave_4b == "1" ~ "1",
                    edeq.weight_influenced_person_.Wave_4b == "2" ~ "2",
                    edeq.weight_influenced_person_.Wave_4b == "3" ~ "3",
                    edeq.weight_influenced_person_.Wave_4b == "4" ~ "4",
                    edeq.weight_influenced_person_.Wave_4b == "5" ~ "5",
                    
                    edeq.weight_influenced_person_.Wave_6b == "0" ~ "0",
                    edeq.weight_influenced_person_.Wave_6b == "1" ~ "1",
                    edeq.weight_influenced_person_.Wave_6b == "2" ~ "2",
                    edeq.weight_influenced_person_.Wave_6b == "3" ~ "3",
                    edeq.weight_influenced_person_.Wave_6b == "4" ~ "4",
                    edeq.weight_influenced_person_.Wave_6b == "5" ~ "5",
                  
                    edeq.weight_influenced_person_.Wave_8b == "0" ~ "0",
                    edeq.weight_influenced_person_.Wave_8b == "1" ~ "1",
                    edeq.weight_influenced_person_.Wave_8b == "2" ~ "2",
                    edeq.weight_influenced_person_.Wave_8b == "3" ~ "3",
                    edeq.weight_influenced_person_.Wave_8b == "4" ~ "4",
                    edeq.weight_influenced_person_.Wave_8b == "5" ~ "5",
                    
                    edeq.weight_influenced_person_.Wave_10b == "0" ~ "0",
                    edeq.weight_influenced_person_.Wave_10b == "1" ~ "1",
                    edeq.weight_influenced_person_.Wave_10b == "2" ~ "2",
                    edeq.weight_influenced_person_.Wave_10b == "3" ~ "3",
                    edeq.weight_influenced_person_.Wave_10b == "4" ~ "4",
                    edeq.weight_influenced_person_.Wave_10b == "5" ~ "5",
                    
                    edeq.weight_influenced_person_.Wave_12b == "0" ~ "0",
                    edeq.weight_influenced_person_.Wave_12b == "1" ~ "1",
                    edeq.weight_influenced_person_.Wave_12b == "2" ~ "2",
                    edeq.weight_influenced_person_.Wave_12b == "3" ~ "3",
                    edeq.weight_influenced_person_.Wave_12b == "4" ~ "4",
                    edeq.weight_influenced_person_.Wave_12b == "5" ~ "5"
         )
  )
 
# Check
EDEQ_dat %>%
  freq(edeq.weight_influenced_think_person)

# Over the past 28 days:	How dissatisfied have you been with your weight or shape?
EDEQ_dat <- EDEQ_dat %>%
  mutate(edeq.dissatisfied_weight_shape =
           case_when(
                    edeq.dissatisfied_shape_weight_baseline == "0" ~ "0",
                    edeq.dissatisfied_shape_weight_baseline == "1" ~ "1",
                    edeq.dissatisfied_shape_weight_baseline == "2" ~ "2",
                    edeq.dissatisfied_shape_weight_baseline == "3" ~ "3",
                    edeq.dissatisfied_shape_weight_baseline == "4" ~ "4",
                    edeq.dissatisfied_shape_weight_baseline == "5" ~ "5",
                    
                    edeq.dissatisfied_shape_weight_.Wave_1b == "0" ~ "0",
                    edeq.dissatisfied_shape_weight_.Wave_1b == "1" ~ "1",
                    edeq.dissatisfied_shape_weight_.Wave_1b == "2" ~ "2",
                    edeq.dissatisfied_shape_weight_.Wave_1b == "3" ~ "3",
                    edeq.dissatisfied_shape_weight_.Wave_1b == "4" ~ "4",
                    edeq.dissatisfied_shape_weight_.Wave_1b == "5" ~ "5",
                    
                    edeq.dissatisfied_shape_weight_.Wave_2b == "0" ~ "0",
                    edeq.dissatisfied_shape_weight_.Wave_2b == "1" ~ "1",
                    edeq.dissatisfied_shape_weight_.Wave_2b == "2" ~ "2",
                    edeq.dissatisfied_shape_weight_.Wave_2b == "3" ~ "3",
                    edeq.dissatisfied_shape_weight_.Wave_2b == "4" ~ "4",
                    edeq.dissatisfied_shape_weight_.Wave_2b == "5" ~ "5",

                    edeq.dissatisfied_shape_weight_.Wave_3b == "0" ~ "0",
                    edeq.dissatisfied_shape_weight_.Wave_3b == "1" ~ "1",
                    edeq.dissatisfied_shape_weight_.Wave_3b == "2" ~ "2",
                    edeq.dissatisfied_shape_weight_.Wave_3b == "3" ~ "3",
                    edeq.dissatisfied_shape_weight_.Wave_3b == "4" ~ "4",
                    edeq.dissatisfied_shape_weight_.Wave_3b == "5" ~ "5",
                    
                    edeq.dissatisfied_shape_weight_.Wave_4b == "0" ~ "0",
                    edeq.dissatisfied_shape_weight_.Wave_4b == "1" ~ "1",
                    edeq.dissatisfied_shape_weight_.Wave_4b == "2" ~ "2",
                    edeq.dissatisfied_shape_weight_.Wave_4b == "3" ~ "3",
                    edeq.dissatisfied_shape_weight_.Wave_4b == "4" ~ "4",
                    edeq.dissatisfied_shape_weight_.Wave_4b == "5" ~ "5",
                    
                    edeq.dissatisfied_shape_weight_.Wave_6b == "0" ~ "0",
                    edeq.dissatisfied_shape_weight_.Wave_6b == "1" ~ "1",
                    edeq.dissatisfied_shape_weight_.Wave_6b == "2" ~ "2",
                    edeq.dissatisfied_shape_weight_.Wave_6b == "3" ~ "3",
                    edeq.dissatisfied_shape_weight_.Wave_6b == "4" ~ "4",
                    edeq.dissatisfied_shape_weight_.Wave_6b == "5" ~ "5",
                  
                    edeq.dissatisfied_shape_weight_.Wave_8b == "0" ~ "0",
                    edeq.dissatisfied_shape_weight_.Wave_8b == "1" ~ "1",
                    edeq.dissatisfied_shape_weight_.Wave_8b == "2" ~ "2",
                    edeq.dissatisfied_shape_weight_.Wave_8b == "3" ~ "3",
                    edeq.dissatisfied_shape_weight_.Wave_8b == "4" ~ "4",
                    edeq.dissatisfied_shape_weight_.Wave_8b == "5" ~ "5",
                    
                    edeq.dissatisfied_shape_weight_.Wave_10b == "0" ~ "0",
                    edeq.dissatisfied_shape_weight_.Wave_10b == "1" ~ "1",
                    edeq.dissatisfied_shape_weight_.Wave_10b == "2" ~ "2",
                    edeq.dissatisfied_shape_weight_.Wave_10b == "3" ~ "3",
                    edeq.dissatisfied_shape_weight_.Wave_10b == "4" ~ "4",
                    edeq.dissatisfied_shape_weight_.Wave_10b == "5" ~ "5",
                    
                    edeq.dissatisfied_shape_weight_.Wave_12b == "0" ~ "0",
                    edeq.dissatisfied_shape_weight_.Wave_12b == "1" ~ "1",
                    edeq.dissatisfied_shape_weight_.Wave_12b == "2" ~ "2",
                    edeq.dissatisfied_shape_weight_.Wave_12b == "3" ~ "3",
                    edeq.dissatisfied_shape_weight_.Wave_12b == "4" ~ "4",
                    edeq.dissatisfied_shape_weight_.Wave_12b == "5" ~ "5"
         )
  )
 
# Check
EDEQ_dat %>%
  freq(edeq.dissatisfied_weight_shape)

# Over the past 28 days, how many times per day have you:	Actively been monitoring your shape or weight ?
EDEQ_dat <- EDEQ_dat %>%
  mutate(edeq.actively_monitoring_shape_weight =
           case_when(
                    !is.na(edeq.actively_been_monitoring_your_shape_or_weight__baseline_numeric)  ~ edeq.actively_been_monitoring_your_shape_or_weight__baseline_numeric,
                    !is.na(edeq.actively_been_monitoring_your_shape_or_weight__numeric_.Wave_1b)  ~ edeq.actively_been_monitoring_your_shape_or_weight__numeric_.Wave_1b,
                    !is.na(edeq.actively_been_monitoring_your_shape_or_weight__numeric_.Wave_2b)  ~ edeq.actively_been_monitoring_your_shape_or_weight__numeric_.Wave_2b,
                    !is.na(edeq.actively_been_monitoring_your_shape_or_weight__numeric_.Wave_3b)  ~ edeq.actively_been_monitoring_your_shape_or_weight__numeric_.Wave_3b,
                    !is.na(edeq.actively_been_monitoring_your_shape_or_weight__numeric_.Wave_4b)  ~ edeq.actively_been_monitoring_your_shape_or_weight__numeric_.Wave_4b,
                    !is.na(edeq.actively_been_monitoring_your_shape_or_weight__numeric_.Wave_6b)  ~ edeq.actively_been_monitoring_your_shape_or_weight__numeric_.Wave_6b,
                    !is.na(edeq.actively_been_monitoring_your_shape_or_weight__numeric_.Wave_8b)  ~ edeq.actively_been_monitoring_your_shape_or_weight__numeric_.Wave_8b,
                    !is.na(edeq.actively_been_monitoring_your_shape_or_weight__numeric_.Wave_10b)  ~ edeq.actively_been_monitoring_your_shape_or_weight__numeric_.Wave_10b,
                    !is.na(edeq.actively_been_monitoring_your_shape_or_weight__numeric_.Wave_12b)  ~ edeq.actively_been_monitoring_your_shape_or_weight__numeric_.Wave_12b
                    )
         )
 
# Check
EDEQ_dat %>%
  freq(edeq.actively_monitoring_shape_weight)


# Over the past 28 days, how many times per day have you:	Eaten what other people would regard as an unusually large amount of food with a sense of having lost control over your eating?
EDEQ_dat <- EDEQ_dat %>%
  mutate(edeq.binge_eating =
           case_when(
                    !is.na(edeq.regard_lost_control_eaten_baseline_numeric)  ~ edeq.regard_lost_control_eaten_baseline_numeric,
                    !is.na(edeq.regard_lost_control_eaten_numeric_.Wave_1b)  ~ edeq.regard_lost_control_eaten_numeric_.Wave_1b,
                    !is.na(edeq.regard_lost_control_eaten_numeric_.Wave_2b)  ~ edeq.regard_lost_control_eaten_numeric_.Wave_2b,
                    !is.na(edeq.regard_lost_control_eaten_numeric_.Wave_3b)  ~ edeq.regard_lost_control_eaten_numeric_.Wave_3b,
                    !is.na(edeq.regard_lost_control_eaten_numeric_.Wave_4b)  ~ edeq.regard_lost_control_eaten_numeric_.Wave_4b,
                    !is.na(edeq.regard_lost_control_eaten_numeric_.Wave_6b)  ~ edeq.regard_lost_control_eaten_numeric_.Wave_6b,
                    !is.na(edeq.regard_lost_control_eaten_numeric_.Wave_8b)  ~ edeq.regard_lost_control_eaten_numeric_.Wave_8b,
                    !is.na(edeq.regard_lost_control_eaten_numeric_.Wave_10b)  ~ edeq.regard_lost_control_eaten_numeric_.Wave_10b,
                    !is.na(edeq.regard_lost_control_eaten_numeric_.Wave_12b)  ~ edeq.regard_lost_control_eaten_numeric_.Wave_12b
                    )
         )

 
# Check
EDEQ_dat %>%
  freq(edeq.binge_eating)

# Over the past 28 days, how many times per day have you:	Made yourself sick as a means of controlling your shape or weight?
EDEQ_dat <- EDEQ_dat %>%
  mutate(edeq.self_induced_vomiting =
           case_when(
                    !is.na(edeq.sick_means_made_shape_baseline_numeric)  ~ edeq.sick_means_made_shape_baseline_numeric,
                    !is.na(edeq.sick_means_made_shape_numeric_.Wave_1b)  ~ edeq.sick_means_made_shape_numeric_.Wave_1b,
                    !is.na(edeq.sick_means_made_shape_numeric_.Wave_2b)  ~ edeq.sick_means_made_shape_numeric_.Wave_2b,
                    !is.na(edeq.sick_means_made_shape_numeric_.Wave_3b)  ~ edeq.sick_means_made_shape_numeric_.Wave_3b,
                    !is.na(edeq.sick_means_made_shape_numeric_.Wave_4b)  ~ edeq.sick_means_made_shape_numeric_.Wave_4b,
                    !is.na(edeq.sick_means_made_shape_numeric_.Wave_6b)  ~ edeq.sick_means_made_shape_numeric_.Wave_6b,
                    !is.na(edeq.sick_means_made_shape_numeric_.Wave_8b)  ~ edeq.sick_means_made_shape_numeric_.Wave_8b,
                    !is.na(edeq.sick_means_made_shape_numeric_.Wave_10b)  ~ edeq.sick_means_made_shape_numeric_.Wave_10b,
                    !is.na(edeq.sick_means_made_shape_numeric_.Wave_12b)  ~ edeq.sick_means_made_shape_numeric_.Wave_12b
                    )
         )

 
# Check
EDEQ_dat %>%
  freq(edeq.self_induced_vomiting)

# Over the past 28 days, how many times per day have you:	Taken laxatives, diuretics, or diet pills as a means of controlling your shape or weight?
EDEQ_dat <- EDEQ_dat %>%
  mutate(edeq.laxatives_diuretics_diet_pills =
           case_when(
                    !is.na(edeq.diuretics_laxatives_means_shape_baseline_numeric)  ~ edeq.diuretics_laxatives_means_shape_baseline_numeric,
                    !is.na(edeq.diuretics_laxatives_means_shape_numeric_.Wave_1b)  ~ edeq.diuretics_laxatives_means_shape_numeric_.Wave_1b,
                    !is.na(edeq.diuretics_laxatives_means_shape_numeric_.Wave_2b)  ~ edeq.diuretics_laxatives_means_shape_numeric_.Wave_2b,
                    !is.na(edeq.diuretics_laxatives_means_shape_numeric_.Wave_3b)  ~ edeq.diuretics_laxatives_means_shape_numeric_.Wave_3b,
                    !is.na(edeq.diuretics_laxatives_means_shape_numeric_.Wave_4b)  ~ edeq.diuretics_laxatives_means_shape_numeric_.Wave_4b,
                    !is.na(edeq.diuretics_laxatives_means_shape_numeric_.Wave_6b)  ~ edeq.diuretics_laxatives_means_shape_numeric_.Wave_6b,
                    !is.na(edeq.diuretics_laxatives_means_shape_numeric_.Wave_8b)  ~ edeq.diuretics_laxatives_means_shape_numeric_.Wave_8b,
                    !is.na(edeq.diuretics_laxatives_means_shape_numeric_.Wave_10b)  ~ edeq.diuretics_laxatives_means_shape_numeric_.Wave_10b,
                    !is.na(edeq.diuretics_laxatives_means_shape_numeric_.Wave_12b)  ~ edeq.diuretics_laxatives_means_shape_numeric_.Wave_12b
                    )
         )

 
# Check
EDEQ_dat %>%
  freq(edeq.laxatives_diuretics_diet_pills)

# Over the past 28 days, how many times per day have you:	Exercised in a “driven” or “compulsive” way as a means of controlling your weight, shape, or amount of fat, or to burn off calories?
EDEQ_dat <- EDEQ_dat %>%
  mutate(edeq.excessive_exercise =
           case_when(
                    !is.na(edeq.compulsive_driven_burn_calories_baseline_numeric)  ~ edeq.compulsive_driven_burn_calories_baseline_numeric,
                    !is.na(edeq.compulsive_driven_burn_calories_numeric_.Wave_1b)  ~ edeq.compulsive_driven_burn_calories_numeric_.Wave_1b,
                    !is.na(edeq.compulsive_driven_burn_calories_numeric_.Wave_2b)  ~ edeq.compulsive_driven_burn_calories_numeric_.Wave_2b,
                    !is.na(edeq.compulsive_driven_burn_calories_numeric_.Wave_3b)  ~ edeq.compulsive_driven_burn_calories_numeric_.Wave_3b,
                    !is.na(edeq.compulsive_driven_burn_calories_numeric_.Wave_4b)  ~ edeq.compulsive_driven_burn_calories_numeric_.Wave_4b,
                    !is.na(edeq.compulsive_driven_burn_calories_numeric_.Wave_6b)  ~ edeq.compulsive_driven_burn_calories_numeric_.Wave_6b,
                    !is.na(edeq.compulsive_driven_burn_calories_numeric_.Wave_8b)  ~ edeq.compulsive_driven_burn_calories_numeric_.Wave_8b,
                    !is.na(edeq.compulsive_driven_burn_calories_numeric_.Wave_10b)  ~ edeq.compulsive_driven_burn_calories_numeric_.Wave_10b,
                    !is.na(edeq.compulsive_driven_burn_calories_numeric_.Wave_12b)  ~ edeq.compulsive_driven_burn_calories_numeric_.Wave_12b
                    )
         )

 
# Check
EDEQ_dat %>%
  freq(edeq.excessive_exercise)

# Over the past 28 days:	How distressed have you been by your eating behaviours, the measures you've taken to control your weight, or concerns about your weight and shape?
EDEQ_dat <- EDEQ_dat %>%
  mutate(edeq.distressed_by_behaviours =
           case_when(
                    edeq.eating_behaviours_concerns_distressed_baseline == "0" ~ "0",
                    edeq.eating_behaviours_concerns_distressed_baseline == "1" ~ "1",
                    edeq.eating_behaviours_concerns_distressed_baseline == "2" ~ "2",
                    edeq.eating_behaviours_concerns_distressed_baseline == "3" ~ "3",
                    edeq.eating_behaviours_concerns_distressed_baseline == "4" ~ "4",
                    edeq.eating_behaviours_concerns_distressed_baseline == "5" ~ "5",
                    
                    edeq.eating_behaviours_distressed_concerns_.Wave_1b == "0" ~ "0",
                    edeq.eating_behaviours_distressed_concerns_.Wave_1b == "1" ~ "1",
                    edeq.eating_behaviours_distressed_concerns_.Wave_1b == "2" ~ "2",
                    edeq.eating_behaviours_distressed_concerns_.Wave_1b == "3" ~ "3",
                    edeq.eating_behaviours_distressed_concerns_.Wave_1b == "4" ~ "4",
                    edeq.eating_behaviours_distressed_concerns_.Wave_1b == "5" ~ "5",
                    
                    edeq.eating_behaviours_distressed_concerns_.Wave_2b == "0" ~ "0",
                    edeq.eating_behaviours_distressed_concerns_.Wave_2b == "1" ~ "1",
                    edeq.eating_behaviours_distressed_concerns_.Wave_2b == "2" ~ "2",
                    edeq.eating_behaviours_distressed_concerns_.Wave_2b == "3" ~ "3",
                    edeq.eating_behaviours_distressed_concerns_.Wave_2b == "4" ~ "4",
                    edeq.eating_behaviours_distressed_concerns_.Wave_2b == "5" ~ "5",

                    edeq.eating_behaviours_distressed_concerns_.Wave_3b == "0" ~ "0",
                    edeq.eating_behaviours_distressed_concerns_.Wave_3b == "1" ~ "1",
                    edeq.eating_behaviours_distressed_concerns_.Wave_3b == "2" ~ "2",
                    edeq.eating_behaviours_distressed_concerns_.Wave_3b == "3" ~ "3",
                    edeq.eating_behaviours_distressed_concerns_.Wave_3b == "4" ~ "4",
                    edeq.eating_behaviours_distressed_concerns_.Wave_3b == "5" ~ "5",
                    
                    edeq.eating_behaviours_distressed_concerns_.Wave_4b == "0" ~ "0",
                    edeq.eating_behaviours_distressed_concerns_.Wave_4b == "1" ~ "1",
                    edeq.eating_behaviours_distressed_concerns_.Wave_4b == "2" ~ "2",
                    edeq.eating_behaviours_distressed_concerns_.Wave_4b == "3" ~ "3",
                    edeq.eating_behaviours_distressed_concerns_.Wave_4b == "4" ~ "4",
                    edeq.eating_behaviours_distressed_concerns_.Wave_4b == "5" ~ "5",
                    
                    edeq.eating_behaviours_distressed_concerns_.Wave_6b == "0" ~ "0",
                    edeq.eating_behaviours_distressed_concerns_.Wave_6b == "1" ~ "1",
                    edeq.eating_behaviours_distressed_concerns_.Wave_6b == "2" ~ "2",
                    edeq.eating_behaviours_distressed_concerns_.Wave_6b == "3" ~ "3",
                    edeq.eating_behaviours_distressed_concerns_.Wave_6b == "4" ~ "4",
                    edeq.eating_behaviours_distressed_concerns_.Wave_6b == "5" ~ "5",
                  
                    edeq.eating_behaviours_distressed_concerns_.Wave_8b == "0" ~ "0",
                    edeq.eating_behaviours_distressed_concerns_.Wave_8b == "1" ~ "1",
                    edeq.eating_behaviours_distressed_concerns_.Wave_8b == "2" ~ "2",
                    edeq.eating_behaviours_distressed_concerns_.Wave_8b == "3" ~ "3",
                    edeq.eating_behaviours_distressed_concerns_.Wave_8b == "4" ~ "4",
                    edeq.eating_behaviours_distressed_concerns_.Wave_8b == "5" ~ "5",
                    
                    edeq.eating_behaviours_distressed_concerns_.Wave_10b == "0" ~ "0",
                    edeq.eating_behaviours_distressed_concerns_.Wave_10b == "1" ~ "1",
                    edeq.eating_behaviours_distressed_concerns_.Wave_10b == "2" ~ "2",
                    edeq.eating_behaviours_distressed_concerns_.Wave_10b == "3" ~ "3",
                    edeq.eating_behaviours_distressed_concerns_.Wave_10b == "4" ~ "4",
                    edeq.eating_behaviours_distressed_concerns_.Wave_10b == "5" ~ "5",
                    
                    edeq.eating_behaviours_distressed_concerns_.Wave_12b == "0" ~ "0",
                    edeq.eating_behaviours_distressed_concerns_.Wave_12b == "1" ~ "1",
                    edeq.eating_behaviours_distressed_concerns_.Wave_12b == "2" ~ "2",
                    edeq.eating_behaviours_distressed_concerns_.Wave_12b == "3" ~ "3",
                    edeq.eating_behaviours_distressed_concerns_.Wave_12b == "4" ~ "4",
                    edeq.eating_behaviours_distressed_concerns_.Wave_12b == "5" ~ "5"
         )
  )
 
 
# Check
EDEQ_dat %>%
  freq(edeq.distressed_by_behaviours)

# Over the past 28 days, on how many days have you:	Picked at, nibbled, or grazed food repeatedly outside of planned meals and snacks?
EDEQ_dat <- EDEQ_dat %>%
  mutate(edeq.repeated_grazing =
           case_when( 
                    edeq.nibbled_picked_snacks_grazed_baseline == "No days" ~ "No days",
                    edeq.nibbled_picked_snacks_grazed_baseline == "1-4 days" ~ "1-4 days",
                    edeq.nibbled_picked_snacks_grazed_baseline == "5-10 days" ~ "5-10 days",
                    edeq.nibbled_picked_snacks_grazed_baseline == "11-16 days" ~ "11-16 days",
                    edeq.nibbled_picked_snacks_grazed_baseline == "17-22 days" ~ "17-22 days",
                    edeq.nibbled_picked_snacks_grazed_baseline == "23-27 days" ~ "23-27 days",
                    edeq.nibbled_picked_snacks_grazed_baseline == "Every day" ~ "Every day",
                    
                    edeq.nibbled_picked_snacks_grazed_.Wave_1b == "No days" ~ "No days",
                    edeq.nibbled_picked_snacks_grazed_.Wave_1b == "1-4 days" ~ "1-4 days",
                    edeq.nibbled_picked_snacks_grazed_.Wave_1b == "5-10 days" ~ "5-10 days",
                    edeq.nibbled_picked_snacks_grazed_.Wave_1b == "11-16 days" ~ "11-16 days",
                    edeq.nibbled_picked_snacks_grazed_.Wave_1b == "17-22 days" ~ "17-22 days",
                    edeq.nibbled_picked_snacks_grazed_.Wave_1b == "23-27 days" ~ "23-27 days",
                    edeq.nibbled_picked_snacks_grazed_.Wave_1b == "Every day" ~ "Every day",
                    
                    edeq.nibbled_picked_snacks_grazed_.Wave_2b == "No days" ~ "No days",
                    edeq.nibbled_picked_snacks_grazed_.Wave_2b == "1-4 days" ~ "1-4 days",
                    edeq.nibbled_picked_snacks_grazed_.Wave_2b == "5-10 days" ~ "5-10 days",
                    edeq.nibbled_picked_snacks_grazed_.Wave_2b == "11-16 days" ~ "11-16 days",
                    edeq.nibbled_picked_snacks_grazed_.Wave_2b == "17-22 days" ~ "17-22 days",
                    edeq.nibbled_picked_snacks_grazed_.Wave_2b == "23-27 days" ~ "23-27 days",
                    edeq.nibbled_picked_snacks_grazed_.Wave_2b == "Every day" ~ "Every day",
                    
                    edeq.nibbled_picked_snacks_grazed_.Wave_3b == "No days" ~ "No days", 
                    edeq.nibbled_picked_snacks_grazed_.Wave_3b == "1-4 days" ~ "1-4 days",
                    edeq.nibbled_picked_snacks_grazed_.Wave_3b == "5-10 days" ~ "5-10 days",
                    edeq.nibbled_picked_snacks_grazed_.Wave_3b == "11-16 days" ~ "11-16 days",
                    edeq.nibbled_picked_snacks_grazed_.Wave_3b == "17-22 days" ~ "17-22 days",
                    edeq.nibbled_picked_snacks_grazed_.Wave_3b == "23-27 days" ~ "23-27 days",
                    edeq.nibbled_picked_snacks_grazed_.Wave_3b == "Every day" ~ "Every day",
                    
                    edeq.nibbled_picked_snacks_grazed_.Wave_4b == "No days" ~ "No days", 
                    edeq.nibbled_picked_snacks_grazed_.Wave_4b == "1-4 days" ~ "1-4 days",
                    edeq.nibbled_picked_snacks_grazed_.Wave_4b == "5-10 days" ~ "5-10 days",
                    edeq.nibbled_picked_snacks_grazed_.Wave_4b == "11-16 days" ~ "11-16 days",
                    edeq.nibbled_picked_snacks_grazed_.Wave_4b == "17-22 days" ~ "17-22 days",
                    edeq.nibbled_picked_snacks_grazed_.Wave_4b == "23-27 days" ~ "23-27 days",
                    edeq.nibbled_picked_snacks_grazed_.Wave_4b == "Every day" ~ "Every day",
                    
                    edeq.nibbled_picked_snacks_grazed_.Wave_6b == "No days" ~ "No days", 
                    edeq.nibbled_picked_snacks_grazed_.Wave_6b == "1-4 days" ~ "1-4 days",
                    edeq.nibbled_picked_snacks_grazed_.Wave_6b == "5-10 days" ~ "5-10 days",
                    edeq.nibbled_picked_snacks_grazed_.Wave_6b == "11-16 days" ~ "11-16 days",
                    edeq.nibbled_picked_snacks_grazed_.Wave_6b == "17-22 days" ~ "17-22 days",
                    edeq.nibbled_picked_snacks_grazed_.Wave_6b == "23-27 days" ~ "23-27 days",
                    edeq.nibbled_picked_snacks_grazed_.Wave_6b == "Every day" ~ "Every day",
                    
                    edeq.nibbled_picked_snacks_grazed_.Wave_8b == "No days" ~ "No days", 
                    edeq.nibbled_picked_snacks_grazed_.Wave_8b == "1-4 days" ~ "1-4 days",
                    edeq.nibbled_picked_snacks_grazed_.Wave_8b == "5-10 days" ~ "5-10 days",
                    edeq.nibbled_picked_snacks_grazed_.Wave_8b == "11-16 days" ~ "11-16 days",
                    edeq.nibbled_picked_snacks_grazed_.Wave_8b == "17-22 days" ~ "17-22 days",
                    edeq.nibbled_picked_snacks_grazed_.Wave_8b == "23-27 days" ~ "23-27 days",
                    edeq.nibbled_picked_snacks_grazed_.Wave_8b == "Every day" ~ "Every day",
                    
                    edeq.nibbled_picked_snacks_grazed_.Wave_10b == "No days" ~ "No days", 
                    edeq.nibbled_picked_snacks_grazed_.Wave_10b == "1-4 days" ~ "1-4 days",
                    edeq.nibbled_picked_snacks_grazed_.Wave_10b == "5-10 days" ~ "5-10 days",
                    edeq.nibbled_picked_snacks_grazed_.Wave_10b == "11-16 days" ~ "11-16 days",
                    edeq.nibbled_picked_snacks_grazed_.Wave_10b == "17-22 days" ~ "17-22 days",
                    edeq.nibbled_picked_snacks_grazed_.Wave_10b == "23-27 days" ~ "23-27 days",
                    edeq.nibbled_picked_snacks_grazed_.Wave_10b == "Every day" ~ "Every day",
                    
                    edeq.nibbled_picked_snacks_grazed_.Wave_12b == "No days" ~ "No days", 
                    edeq.nibbled_picked_snacks_grazed_.Wave_12b == "1-4 days" ~ "1-4 days",
                    edeq.nibbled_picked_snacks_grazed_.Wave_12b == "5-10 days" ~ "5-10 days",
                    edeq.nibbled_picked_snacks_grazed_.Wave_12b == "11-16 days" ~ "11-16 days",
                    edeq.nibbled_picked_snacks_grazed_.Wave_12b == "17-22 days" ~ "17-22 days",
                    edeq.nibbled_picked_snacks_grazed_.Wave_12b == "23-27 days" ~ "23-27 days",
                    edeq.nibbled_picked_snacks_grazed_.Wave_12b == "Every day" ~ "Every day"
           
         )
  )

 
# Check
EDEQ_dat %>%
  freq(edeq.repeated_grazing)

# Over the past 28 days, on how many days have you:	Eaten more than usual because you felt anxious, blue, bored, frustrated or lonely?
EDEQ_dat <- EDEQ_dat %>%
  mutate(edeq.eaten_more_emotional =
           case_when( 
                    edeq.felt_anxious_blue_bored_baseline == "No days" ~ "No days",
                    edeq.felt_anxious_blue_bored_baseline == "1-4 days" ~ "1-4 days",
                    edeq.felt_anxious_blue_bored_baseline == "5-10 days" ~ "5-10 days",
                    edeq.felt_anxious_blue_bored_baseline == "11-16 days" ~ "11-16 days",
                    edeq.felt_anxious_blue_bored_baseline == "17-22 days" ~ "17-22 days",
                    edeq.felt_anxious_blue_bored_baseline == "23-27 days" ~ "23-27 days",
                    edeq.felt_anxious_blue_bored_baseline == "Every day" ~ "Every day",
                    
                    edeq.felt_anxious_blue_bored_.Wave_1b == "No days" ~ "No days",
                    edeq.felt_anxious_blue_bored_.Wave_1b == "1-4 days" ~ "1-4 days",
                    edeq.felt_anxious_blue_bored_.Wave_1b == "5-10 days" ~ "5-10 days",
                    edeq.felt_anxious_blue_bored_.Wave_1b == "11-16 days" ~ "11-16 days",
                    edeq.felt_anxious_blue_bored_.Wave_1b == "17-22 days" ~ "17-22 days",
                    edeq.felt_anxious_blue_bored_.Wave_1b == "23-27 days" ~ "23-27 days",
                    edeq.felt_anxious_blue_bored_.Wave_1b == "Every day" ~ "Every day",
                    
                    edeq.felt_anxious_blue_bored_.Wave_2b == "No days" ~ "No days",
                    edeq.felt_anxious_blue_bored_.Wave_2b == "1-4 days" ~ "1-4 days",
                    edeq.felt_anxious_blue_bored_.Wave_2b == "5-10 days" ~ "5-10 days",
                    edeq.felt_anxious_blue_bored_.Wave_2b == "11-16 days" ~ "11-16 days",
                    edeq.felt_anxious_blue_bored_.Wave_2b == "17-22 days" ~ "17-22 days",
                    edeq.felt_anxious_blue_bored_.Wave_2b == "23-27 days" ~ "23-27 days",
                    edeq.felt_anxious_blue_bored_.Wave_2b == "Every day" ~ "Every day",
                    
                    edeq.felt_anxious_blue_bored_.Wave_3b == "No days" ~ "No days", 
                    edeq.felt_anxious_blue_bored_.Wave_3b == "1-4 days" ~ "1-4 days",
                    edeq.felt_anxious_blue_bored_.Wave_3b == "5-10 days" ~ "5-10 days",
                    edeq.felt_anxious_blue_bored_.Wave_3b == "11-16 days" ~ "11-16 days",
                    edeq.felt_anxious_blue_bored_.Wave_3b == "17-22 days" ~ "17-22 days",
                    edeq.felt_anxious_blue_bored_.Wave_3b == "23-27 days" ~ "23-27 days",
                    edeq.felt_anxious_blue_bored_.Wave_3b == "Every day" ~ "Every day",
                    
                    edeq.felt_anxious_blue_bored_.Wave_4b == "No days" ~ "No days", 
                    edeq.felt_anxious_blue_bored_.Wave_4b == "1-4 days" ~ "1-4 days",
                    edeq.felt_anxious_blue_bored_.Wave_4b == "5-10 days" ~ "5-10 days",
                    edeq.felt_anxious_blue_bored_.Wave_4b == "11-16 days" ~ "11-16 days",
                    edeq.felt_anxious_blue_bored_.Wave_4b == "17-22 days" ~ "17-22 days",
                    edeq.felt_anxious_blue_bored_.Wave_4b == "23-27 days" ~ "23-27 days",
                    edeq.felt_anxious_blue_bored_.Wave_4b == "Every day" ~ "Every day",
                    
                    edeq.felt_anxious_blue_bored_.Wave_6b == "No days" ~ "No days", 
                    edeq.felt_anxious_blue_bored_.Wave_6b == "1-4 days" ~ "1-4 days",
                    edeq.felt_anxious_blue_bored_.Wave_6b == "5-10 days" ~ "5-10 days",
                    edeq.felt_anxious_blue_bored_.Wave_6b == "11-16 days" ~ "11-16 days",
                    edeq.felt_anxious_blue_bored_.Wave_6b == "17-22 days" ~ "17-22 days",
                    edeq.felt_anxious_blue_bored_.Wave_6b == "23-27 days" ~ "23-27 days",
                    edeq.felt_anxious_blue_bored_.Wave_6b == "Every day" ~ "Every day",
                    
                    edeq.felt_anxious_blue_bored_.Wave_8b == "No days" ~ "No days", 
                    edeq.felt_anxious_blue_bored_.Wave_8b == "1-4 days" ~ "1-4 days",
                    edeq.felt_anxious_blue_bored_.Wave_8b == "5-10 days" ~ "5-10 days",
                    edeq.felt_anxious_blue_bored_.Wave_8b == "11-16 days" ~ "11-16 days",
                    edeq.felt_anxious_blue_bored_.Wave_8b == "17-22 days" ~ "17-22 days",
                    edeq.felt_anxious_blue_bored_.Wave_8b == "23-27 days" ~ "23-27 days",
                    edeq.felt_anxious_blue_bored_.Wave_8b == "Every day" ~ "Every day",
                    
                    edeq.felt_anxious_blue_bored_.Wave_10b == "No days" ~ "No days", 
                    edeq.felt_anxious_blue_bored_.Wave_10b == "1-4 days" ~ "1-4 days",
                    edeq.felt_anxious_blue_bored_.Wave_10b == "5-10 days" ~ "5-10 days",
                    edeq.felt_anxious_blue_bored_.Wave_10b == "11-16 days" ~ "11-16 days",
                    edeq.felt_anxious_blue_bored_.Wave_10b == "17-22 days" ~ "17-22 days",
                    edeq.felt_anxious_blue_bored_.Wave_10b == "23-27 days" ~ "23-27 days",
                    edeq.felt_anxious_blue_bored_.Wave_10b == "Every day" ~ "Every day",
                    
                    edeq.felt_anxious_blue_bored_.Wave_12b == "No days" ~ "No days", 
                    edeq.felt_anxious_blue_bored_.Wave_12b == "1-4 days" ~ "1-4 days",
                    edeq.felt_anxious_blue_bored_.Wave_12b == "5-10 days" ~ "5-10 days",
                    edeq.felt_anxious_blue_bored_.Wave_12b == "11-16 days" ~ "11-16 days",
                    edeq.felt_anxious_blue_bored_.Wave_12b == "17-22 days" ~ "17-22 days",
                    edeq.felt_anxious_blue_bored_.Wave_12b == "23-27 days" ~ "23-27 days",
                    edeq.felt_anxious_blue_bored_.Wave_12b == "Every day" ~ "Every day"
           
         )
  )

 
# Check
EDEQ_dat %>%
  freq(edeq.eaten_more_emotional)

# Over the past 28 days, on how many days have you:	Eaten more than usual because you felt anxious, blue, bored, frustrated or lonely?
EDEQ_dat <- EDEQ_dat %>%
  mutate(edeq.eaten_less_emotional =
           case_when( 
                    edeq.felt_anxious_blue_bored.1_baseline == "No days" ~ "No days",
                    edeq.felt_anxious_blue_bored.1_baseline == "1-4 days" ~ "1-4 days",
                    edeq.felt_anxious_blue_bored.1_baseline == "5-10 days" ~ "5-10 days",
                    edeq.felt_anxious_blue_bored.1_baseline == "11-16 days" ~ "11-16 days",
                    edeq.felt_anxious_blue_bored.1_baseline == "17-22 days" ~ "17-22 days",
                    edeq.felt_anxious_blue_bored.1_baseline == "23-27 days" ~ "23-27 days",
                    edeq.felt_anxious_blue_bored.1_baseline == "Every day" ~ "Every day",
                    
                    edeq.felt_anxious_blue_bored.1_.Wave_1b == "No days" ~ "No days",
                    edeq.felt_anxious_blue_bored.1_.Wave_1b == "1-4 days" ~ "1-4 days",
                    edeq.felt_anxious_blue_bored.1_.Wave_1b == "5-10 days" ~ "5-10 days",
                    edeq.felt_anxious_blue_bored.1_.Wave_1b == "11-16 days" ~ "11-16 days",
                    edeq.felt_anxious_blue_bored.1_.Wave_1b == "17-22 days" ~ "17-22 days",
                    edeq.felt_anxious_blue_bored.1_.Wave_1b == "23-27 days" ~ "23-27 days",
                    edeq.felt_anxious_blue_bored.1_.Wave_1b == "Every day" ~ "Every day",
                    
                    edeq.felt_anxious_blue_bored.1_.Wave_2b == "No days" ~ "No days",
                    edeq.felt_anxious_blue_bored.1_.Wave_2b == "1-4 days" ~ "1-4 days",
                    edeq.felt_anxious_blue_bored.1_.Wave_2b == "5-10 days" ~ "5-10 days",
                    edeq.felt_anxious_blue_bored.1_.Wave_2b == "11-16 days" ~ "11-16 days",
                    edeq.felt_anxious_blue_bored.1_.Wave_2b == "17-22 days" ~ "17-22 days",
                    edeq.felt_anxious_blue_bored.1_.Wave_2b == "23-27 days" ~ "23-27 days",
                    edeq.felt_anxious_blue_bored.1_.Wave_2b == "Every day" ~ "Every day",
                    
                    edeq.felt_anxious_blue_bored.1_.Wave_3b == "No days" ~ "No days", 
                    edeq.felt_anxious_blue_bored.1_.Wave_3b == "1-4 days" ~ "1-4 days",
                    edeq.felt_anxious_blue_bored.1_.Wave_3b == "5-10 days" ~ "5-10 days",
                    edeq.felt_anxious_blue_bored.1_.Wave_3b == "11-16 days" ~ "11-16 days",
                    edeq.felt_anxious_blue_bored.1_.Wave_3b == "17-22 days" ~ "17-22 days",
                    edeq.felt_anxious_blue_bored.1_.Wave_3b == "23-27 days" ~ "23-27 days",
                    edeq.felt_anxious_blue_bored.1_.Wave_3b == "Every day" ~ "Every day",
                    
                    edeq.felt_anxious_blue_bored.1_.Wave_4b == "No days" ~ "No days", 
                    edeq.felt_anxious_blue_bored.1_.Wave_4b == "1-4 days" ~ "1-4 days",
                    edeq.felt_anxious_blue_bored.1_.Wave_4b == "5-10 days" ~ "5-10 days",
                    edeq.felt_anxious_blue_bored.1_.Wave_4b == "11-16 days" ~ "11-16 days",
                    edeq.felt_anxious_blue_bored.1_.Wave_4b == "17-22 days" ~ "17-22 days",
                    edeq.felt_anxious_blue_bored.1_.Wave_4b == "23-27 days" ~ "23-27 days",
                    edeq.felt_anxious_blue_bored.1_.Wave_4b == "Every day" ~ "Every day",
                    
                    edeq.felt_anxious_blue_bored.1_.Wave_6b == "No days" ~ "No days", 
                    edeq.felt_anxious_blue_bored.1_.Wave_6b == "1-4 days" ~ "1-4 days",
                    edeq.felt_anxious_blue_bored.1_.Wave_6b == "5-10 days" ~ "5-10 days",
                    edeq.felt_anxious_blue_bored.1_.Wave_6b == "11-16 days" ~ "11-16 days",
                    edeq.felt_anxious_blue_bored.1_.Wave_6b == "17-22 days" ~ "17-22 days",
                    edeq.felt_anxious_blue_bored.1_.Wave_6b == "23-27 days" ~ "23-27 days",
                    edeq.felt_anxious_blue_bored.1_.Wave_6b == "Every day" ~ "Every day",
                    
                    edeq.felt_anxious_blue_bored.1_.Wave_8b == "No days" ~ "No days", 
                    edeq.felt_anxious_blue_bored.1_.Wave_8b == "1-4 days" ~ "1-4 days",
                    edeq.felt_anxious_blue_bored.1_.Wave_8b == "5-10 days" ~ "5-10 days",
                    edeq.felt_anxious_blue_bored.1_.Wave_8b == "11-16 days" ~ "11-16 days",
                    edeq.felt_anxious_blue_bored.1_.Wave_8b == "17-22 days" ~ "17-22 days",
                    edeq.felt_anxious_blue_bored.1_.Wave_8b == "23-27 days" ~ "23-27 days",
                    edeq.felt_anxious_blue_bored.1_.Wave_8b == "Every day" ~ "Every day",
                    
                    edeq.felt_anxious_blue_bored.1_.Wave_10b == "No days" ~ "No days", 
                    edeq.felt_anxious_blue_bored.1_.Wave_10b == "1-4 days" ~ "1-4 days",
                    edeq.felt_anxious_blue_bored.1_.Wave_10b == "5-10 days" ~ "5-10 days",
                    edeq.felt_anxious_blue_bored.1_.Wave_10b == "11-16 days" ~ "11-16 days",
                    edeq.felt_anxious_blue_bored.1_.Wave_10b == "17-22 days" ~ "17-22 days",
                    edeq.felt_anxious_blue_bored.1_.Wave_10b == "23-27 days" ~ "23-27 days",
                    edeq.felt_anxious_blue_bored.1_.Wave_10b == "Every day" ~ "Every day",
                    
                    edeq.felt_anxious_blue_bored.1_.Wave_12b == "No days" ~ "No days", 
                    edeq.felt_anxious_blue_bored.1_.Wave_12b == "1-4 days" ~ "1-4 days",
                    edeq.felt_anxious_blue_bored.1_.Wave_12b == "5-10 days" ~ "5-10 days",
                    edeq.felt_anxious_blue_bored.1_.Wave_12b == "11-16 days" ~ "11-16 days",
                    edeq.felt_anxious_blue_bored.1_.Wave_12b == "17-22 days" ~ "17-22 days",
                    edeq.felt_anxious_blue_bored.1_.Wave_12b == "23-27 days" ~ "23-27 days",
                    edeq.felt_anxious_blue_bored.1_.Wave_12b == "Every day" ~ "Every day"
           
         )
  )

 
# Check
EDEQ_dat %>%
  freq(edeq.eaten_less_emotional)


```

# Save dataset ready for analysis
## Select variables
```{r select variables}

EDEQ_dat_final <- EDEQ_dat %>%
  select(ID,
         cohort_name,
         edeq.deliberate_limit_food,
         edeq.difficulty_concentrating,
         edeq.weight_influenced_think_person,
         edeq.dissatisfied_weight_shape,
         edeq.actively_monitoring_shape_weight,
         edeq.binge_eating,
         edeq.self_induced_vomiting,
         edeq.laxatives_diuretics_diet_pills,
         edeq.excessive_exercise,
         edeq.distressed_by_behaviours,
         edeq.repeated_grazing,
         edeq.eaten_more_emotional,
         edeq.eaten_less_emotional
         )
```

```{r save dataset}
saveRDS(object = EDEQ_dat_final, file = paste0("/Users/helenadavies/werk/EDBEHSELFHARM2/gitEDBEHSELFHARM/data_cleaned/EDEQ_dat_final", date, ".rds"))
```

# Latent class analysis
The basis of latent class analysis is that each subject is assumed to belong to one of a finite number of classes, with each class described by a set of parameters that define the distribution of outcomes or manifest variables for a subject, and is a form of finite mixture model (McLachlan and Peel 2000). Generally, the number of classes is unknown and must be determined from the data.

When used as a classification algorithm the model does not simply return the most likely class for each subject but returns a probability of class membership, based on the observed outcomes. The posterior probability for a set of given observed outcomes can be obtained from Bayes theorem.

The assumption of latent class models is conditional or local independence, where the outcomes are independent conditional on the latent class. This assumes that subjects within a class are homogeneous. Where this does not apply, that is the true classes are heterogeneous, a consequence of this will be to increase the number of latent classes required in attempting to explain the heterogeneity, with possible consequent difficulty in interpretation. A solution is to incorporate random effects so that the outcomes are independent conditional on the latent class and random effect or effects.

The advantage of randomLCA over the other packages is that it will fit both standard latent class models and those incorporating random effects.

https://maksimrudnev.com/2016/12/28/latent-class-analysis-in-r/
CRAN offers plenty of different ways to get clusters on your data, but most of these packages have a very narrow and specific utility. For example, I found at least 15 packages involving latent class models, of which only six perform latent class analysis in the form of classification based on indicators, and only two of them allow including nominal indicators, and none allows including ordinal indicators.

```{r testing}
# export data frame to Stata binary format 
library(foreign)
write.dta(mydata, "c:/mydata.dta")
```

















