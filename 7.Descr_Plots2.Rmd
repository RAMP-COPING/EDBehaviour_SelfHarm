---
title: "7.Descr_Plots2"
author: "Helena Davies"
date: "24/05/2021"
output: html_document
---
```{r Setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      comment=NA,
                      prompt=FALSE,
                      cache=FALSE)
```

Delete everything in your global environment
```{r Delete everything in your global environment}
remove(list = ls())
```

#### Call in library script

```{r source files}
source("./libraries.R")
```


#Retrieve the recent date
```{r Recent date}
date = Sys.Date()
date
```

#### R functions

```{r call in function library functions}
# source all functions in the function folder
source("./functions.R")
```

# Read in data
```{r}
dat <- readRDS(file = "../data_cleaned/test_dat2021-05-24.rds")
dim(dat)
colnames(dat)
```
#DESCRIPTIVES
ANOVA: two assumptions were tested: normality, using the Shapiro Wilks Test and visual inspection of histograms, and homoscedasticity, using the Levene’s test. If all assumptions were met, we used ANOVA to determine if differences between groups were significant. If significant (p < 0.05), we performed Tukey’s multiple comparison tests to determine which mean/s differed significantly from the rest. If either both assumptions or only the normality assumption were violated, we performed the non-parametric equivalent of ANOVA: Kruskal-Wallis one-way ANOVA. If significant, Dunn’s post-hoc tests were carried out with bh-adjusted levels of significance. If only homoscedasticity was violated, we performed Welch's unequal variances t-test. If significant, pairwise t-tests between all groups were calculated, with bh-adjusted levels of significance. 

#Generate mode function
```{r}

mode_func <- function(x, na.rm = FALSE) {
  if(na.rm){
    x = x[!is.na(x)]
  }

  ux <- unique(x)
  return(ux[which.max(tabulate(match(x, ux)))])
}

```

######### BINGE EATING ###########

#Create one variable for experience of binge eating
```{r}
dat <- dat %>%
  mutate(experience_binge_eating = 
           case_when(lifetime_binge_eating_baseline_numeric == 1 ~ "Previous experience of binge eating",
                     
                     lifetime_binge_eating_baseline_numeric == 0 &
                       NEW_binge_eating_pandemic == 0 ~ "No previous or pandemic experience of binge eating",
                     
                      lifetime_binge_eating_baseline_numeric == 0 &
                     NEW_binge_eating_pandemic == 1 ~ "New pandemic experience of binge eating"
                    
           )
    
  )


dat %>%
  freq(experience_binge_eating) # People who are NA did not fill out any follow up questionnaires


```

CONTINUOUS VARIABLES:
  • BMI at baseline
  • Comorbidity count
  
CATEGORICAL VARIABLES:
  •	age
  •	gender
  •	Ethnicity 
  •	Education 
  • Control status (removing people with EDs)
  • BMI at baseline
  • Pre-existing physical health condition
  • Disability
  • Key worker status at baseline
  • Defined as vulnerable person according to Goverment 
  • Positive covid test at baseline (or somewhere down the line - needs to be BEFORE symptom)
  • Change in employment status
  • Living situation
  • Pandemic worry
 
#CONTINIOUS - BINGE EATING
# Means + SDs of continuous variables for each group: 1) NEW experience, 2) No new experience
```{r}

#BMI AT BASELINE
#COMORBIDITY COUMT


```


#CATEGORICAL - BINGE EATING
#Education
```{r}

#Change to A-Levels or higher
dat <- dat %>%
  mutate(higher_than_alevels =
           case_when(highest_education == "No formal qualifications" |
                      highest_education == "GCSE/CSE" |
                        highest_education == "NVQ" ~ 0,
                     
                     highest_education == "A-levels" |
                      highest_education == "University/Other professional qualifications" ~ 1
          ))


#NEW experience binge eating
dat %>%
  filter(experience_binge_eating == "New pandemic experience of binge eating") %>%
  freq(higher_than_alevels)


#NO NEW experience binge eating
dat %>%
  filter(experience_binge_eating == "No previous or pandemic experience of binge eating") %>%
  freq(higher_than_alevels)

```

#Binge eating: Bar plot of GENDER and 1) previous experience, 2) no previous experience and none during pandemic, 3) no previous experience but experience during pandemic
```{r}

#Remove NAs
dat_no_nas1 <- dat %>%
  filter(!is.na(experience_binge_eating))

dat_no_nas <- dat_no_nas1 %>%
  filter(!is.na(gender_cleaned))

#Plot 
gender_experience_plot_BE <- dat_no_nas %>% 
    ggplot(
     aes(
       x = gender_cleaned,
       y = (stat(count)),
       fill = experience_binge_eating,
       label = (stat(count))
      )
     ) +
   geom_bar(
     stat = "count",
     position = "fill"
     ) +
  geom_text(stat = 'count',
            position = "fill") +
  theme_light() + 
  labs(x = 'Gender', y = 'Percentage binge eating', fill = 'Experience')

gender_experience_plot_BE

```


#Binge eating: Bar plot of ETHNICITY and 1) previous experience, 2) no previous experience and none during pandemic, 3) no previous experience but experience during pandemic
```{r}

#Remove NAs
dat_no_nas1 <- dat %>%
  filter(!is.na(experience_binge_eating))

dat_no_nas <- dat_no_nas1 %>%
  filter(!is.na(ethnicity_binary))

#Plot 
ethnicity_experience_plot_BE <- dat_no_nas %>% 
    ggplot(
     aes(
       x = ethnicity_binary,
       y = (stat(count)),
       fill = experience_binge_eating,
       label = (stat(count))
      )
     ) +
   geom_bar(
     stat = "count",
     position = "fill"
     ) +
  geom_text(stat = 'count',
            position = "fill") +
  theme_light() + 
  labs(x = 'Ethnicity', y = 'Percentage binge eating', fill = 'Experience')

ethnicity_experience_plot_BE

```

#Binge eating: Bar plot of EDUCATION and 1) previous experience, 2) no previous experience and none during pandemic, 3) no previous experience but experience during pandemic
```{r}

#Rename education labels
dat <- dat %>%
  mutate(highest_education_renamed =
           case_when(highest_education == "No formal qualifications" ~ "No formal qualifications",
                     highest_education == "GCSE/CSE" ~ "GCSE/CSE",
                     highest_education == "NVQ" ~ "NVQ",
                       highest_education == "A-levels" ~"A-levels",
                       highest_education == "University/Other professional qualifications" ~ "Uni/Prof qual"
             
           ))

#Check
dat %>%
  freq(highest_education_renamed)

#Change order
dat$highest_education_renamed <- ordered(dat$highest_education_renamed,
                                         levels = c("No formal qualifications",
                                                    "GCSE/CSE",
                                                    "NVQ",
                                                    "A-levels",
                                                    "Uni/Prof qual"))

#Remove NAs
dat_no_nas1 <- dat %>%
  filter(!is.na(experience_binge_eating))

#Remove NAs
dat_no_nas <- dat_no_nas1 %>%
  filter(!is.na(highest_education_renamed))


#Plot 
education_experience_plot_BE <- dat_no_nas %>% 
    ggplot(
     aes(
       x = highest_education_renamed,
       y = (stat(count)),
       fill = experience_binge_eating,
       label = (stat(count))
      )
     ) +
   geom_bar(
     stat = "count",
     position = "fill"
     ) +
  geom_text(stat = 'count',
            position = "fill") +
  theme_light() + 
  labs(x = 'Highest education', y = 'Percentage binge eating', fill = 'Experience') +
 #scale_x_discrete(guide = guide_axis(n.dodge=5)) +
  theme(axis.text.x = element_text(angle = 45)) +
  theme(axis.text.x = element_text(vjust=0.6)) 

education_experience_plot_BE

```
#Binge eating: Bar plot of COMORBIDITIES COUNT and 1) previous experience, 2) no previous experience and none during pandemic, 3) no previous experience but experience during pandemic
```{r}

#Remove NAs
dat_no_nas1 <- dat %>%
  filter(!is.na(experience_binge_eating))

dat_no_nas <- dat_no_nas1 %>%
  filter(!is.na(comorbidities_count))

#Filter out people with EDs?
dat_no_nas <- dat_no_nas %>%
  filter(!comorbidities == "Diagnosed eating disorder")

dat_no_nas <- dat_no_nas %>%
  filter(!comorbidities == "Suspected eating disorder")

#Plot 
comorbid_count_experience_plot_BE <- dat_no_nas %>% 
    ggplot(
     aes(
       x = comorbidities_count,
       y = (stat(count)),
       fill = experience_binge_eating,
       label = (stat(count))
      )
     ) +
   geom_bar(
     stat = "count",
     position = "fill"
     ) +
  geom_text(stat = 'count',
            position = "fill") +
  theme_light() + 
  labs(x = 'Number of comorbidities', y = 'Percentage binge eating', fill = 'Experience')

comorbid_count_experience_plot_BE

```
#Binge eating: Bar plot of CONTROLS and 1) previous experience, 2) no previous experience and none during pandemic, 3) no previous experience but experience during pandemic
```{r}

#Remove NAs
dat_no_nas1 <- dat %>%
  filter(!is.na(experience_binge_eating))

dat_no_nas <- dat_no_nas1 %>%
  filter(!is.na(control_numeric))

#Filter out people with EDs?
dat_no_nas <- dat_no_nas %>%
  filter(!comorbidities == "Diagnosed eating disorder")

dat_no_nas <- dat_no_nas %>%
  filter(!comorbidities == "Suspected eating disorder")

#Create new variable - control as a factor
dat_no_nas <- dat_no_nas %>%
  mutate(control_factor = 
           case_when(control_numeric == 1 ~ "Control",
                     control_numeric ==0 ~ "Not control"
             
           )
  )
         
#Plot 
control_experience_plot_BE <- dat_no_nas %>% 
    ggplot(
     aes(
       x = control_factor,
       y = (stat(count)),
       fill = experience_binge_eating,
       label = (stat(count))
      )
     ) +
   geom_bar(
     stat = "count",
     position = "fill"
     ) +
  geom_text(stat = 'count',
            position = "fill") +
  theme_light() + 
  labs(x = 'Control status', y = 'Percentage binge eating', fill = 'Experience')

control_experience_plot_BE

```





#Binge eating: Bar plot of COMORBIDITY TYPE and 1) previous experience, 2) no previous experience and none during pandemic, 3) no previous experience but experience during pandemic
```{r}

#Remove NAs
dat_no_nas1 <- dat %>%
  filter(!is.na(experience_binge_eating))

dat_no_nas <- dat_no_nas1 %>%
  filter(!is.na(comorbidities))

#Filter out people with EDs?
dat_no_nas <- dat_no_nas %>%
  filter(!comorbidities == "Eating disorder")

#Plot 
comorbid_experience_plot_BE <- dat_no_nas %>% 
    ggplot(
     aes(
       x = comorbidities,
       y = (stat(count)),
       fill = experience_binge_eating,
       label = (stat(count))
      )
     ) +
   geom_bar(
     stat = "count",
     position = "fill"
     ) +
  geom_text(stat = 'count',
            position = "fill") +
  theme_light() + 
  labs(x = 'comorbidities', y = 'Percentage binge eating', fill = 'Experience')

comorbid_experience_plot_BE

```

#Binge eating: Bar plot of AGE and 1) previous experience, 2) no previous experience and none during pandemic, 3) no previous experience but experience during pandemic
```{r}

#Remove NAs
dat_no_nas1 <- dat %>%
  filter(!is.na(experience_binge_eating))

dat_no_nas <- dat_no_nas1 %>%
  filter(!is.na(age_category_COVID_baseline))


#Plot 
age_experience_plot_BE <- dat_no_nas %>% 
    ggplot(
     aes(
       x = age_category_COVID_baseline,
       y = (stat(count)),
       fill = experience_binge_eating,
       label = (stat(count))
      )
     ) +
   geom_bar(
     stat = "count",
     position = "fill"
     ) +
  geom_text(stat = 'count',
            position = "fill") +
  theme_light() + 
  labs(x = 'Age', y = 'Percentage binge eating', fill = 'Experience')

age_experience_plot_BE

```

#Binge eating: Bar plot of KEY WORKER and 1) previous experience, 2) no previous experience and none during pandemic, 3) no previous experience but experience during pandemic
```{r}

#Remove NAs
dat_no_nas1 <- dat %>%
  filter(!is.na(experience_binge_eating))

dat_no_nas <- dat_no_nas1 %>%
  filter(!is.na(key_worker))


#Plot 
key_worker_experience_plot_BE <- dat_no_nas %>% 
    ggplot(
     aes(
       x = key_worker,
       y = (stat(count)),
       fill = experience_binge_eating,
       label = (stat(count))
      )
     ) +
   geom_bar(
     stat = "count",
     position = "fill"
     ) +
  geom_text(stat = 'count',
            position = "fill") +
  theme_light() + 
  labs(x = 'Key worker', y = 'Percentage binge eating', fill = 'Experience')

key_worker_experience_plot_BE

```
#binge eating: Bar plot of VULNERABLE STATUS and 1) previous experience, 2) no previous experience and none during pandemic, 3) no previous experience but experience during pandemic
```{r}

#Remove NAs
dat_no_nas1 <- dat %>%
  filter(!is.na(experience_binge_eating))

dat_no_nas <- dat_no_nas1 %>%
  filter(!is.na(vulnerable_group_member))

dat_no_nas <- dat_no_nas %>%
  mutate(vulnerable_group_member_renamed =
           case_when(
           vulnerable_group_member == "Not I am not a member of a vulnerable group" ~ "No",
           vulnerable_group_member == "I am not a member of a vulnerable group" ~ "Yes",
         )
  )


dat %>%
  freq(vulnerable_group_member)
#Plot 
vul_mem_experience_plot_BE <- dat_no_nas %>% 
    ggplot(
     aes(
       x = vulnerable_group_member_renamed,
       y = (stat(count)),
       fill = experience_binge_eating,
       label = (stat(count))
      )
     ) +
   geom_bar(
     stat = "count",
     position = "fill"
     ) +
  geom_text(stat = 'count',
            position = "fill") +
  theme_light() + 
  labs(x = 'Vulnerable group member', y = 'Percentage self-harm', fill = 'Experience')

vul_mem_experience_plot_BE

```
######### LOW WEIGHT ###########

#Create one variable for experience of low weight
```{r}
dat <- dat %>%
  mutate(experience_low_weight = 
           case_when(lifetime_low_weight_baseline_numeric == 1 ~ "Previous experience of low weight",
                     
                     lifetime_low_weight_baseline_numeric == 0 &
                       NEW_low_weight_pandemic == 0 ~ "No previous or pandemic experience of low weight",
                     
                      lifetime_low_weight_baseline_numeric == 0 &
                     NEW_low_weight_pandemic == 1 ~ "New pandemic experience of low weight"
                    
           )
    
  )


dat %>%
  freq(experience_low_weight) # People who are NA did not fill out any follow up questionnaires

```


#Low weight: Bar plot of GENDER and 1) previous experience, 2) no previous experience and none during pandemic, 3) no previous experience but experience during pandemic
```{r}

#Remove NAs
dat_no_nas1 <- dat %>%
  filter(!is.na(experience_low_weight))

dat_no_nas <- dat_no_nas1 %>%
  filter(!is.na(gender_cleaned))

#Plot 
gender_experience_plot_LW <- dat_no_nas %>% 
    ggplot(
     aes(
       x = gender_cleaned,
       y = (stat(count)),
       fill = experience_low_weight,
       label = (stat(count))
      )
     ) +
   geom_bar(
     stat = "count",
     position = "fill"
     ) +
  geom_text(stat = 'count',
            position = "fill") +
  theme_light() + 
  labs(x = 'Gender', y = 'Percentage low weight', fill = 'Experience')

gender_experience_plot_LW

```


#Binge eating: Bar plot of ETHNICITY and 1) previous experience, 2) no previous experience and none during pandemic, 3) no previous experience but experience during pandemic
```{r}

#Remove NAs
dat_no_nas1 <- dat %>%
  filter(!is.na(experience_low_weight))

dat_no_nas <- dat_no_nas1 %>%
  filter(!is.na(ethnicity_binary))

#Plot 
ethnicity_experience_plot_LW <- dat_no_nas %>% 
    ggplot(
     aes(
       x = ethnicity_binary,
       y = (stat(count)),
       fill = experience_low_weight,
       label = (stat(count))
      )
     ) +
   geom_bar(
     stat = "count",
     position = "fill"
     ) +
  geom_text(stat = 'count',
            position = "fill") +
  theme_light() + 
  labs(x = 'Ethnicity', y = 'Percentage low weight', fill = 'Experience')

ethnicity_experience_plot_LW

```

#Low weight: Bar plot of EDUCATION and 1) previous experience, 2) no previous experience and none during pandemic, 3) no previous experience but experience during pandemic
```{r}

#Remove NAs
dat_no_nas1 <- dat %>%
  filter(!is.na(experience_low_weight))

#Remove NAs
dat_no_nas <- dat_no_nas1 %>%
  filter(!is.na(highest_education_renamed))


#Plot 
education_experience_plot_LW <- dat_no_nas %>% 
    ggplot(
     aes(
       x = highest_education_renamed,
       y = (stat(count)),
       fill = experience_low_weight,
       label = (stat(count))
      )
     ) +
   geom_bar(
     stat = "count",
     position = "fill"
     ) +
  geom_text(stat = 'count',
            position = "fill") +
  theme_light() + 
  labs(x = 'Highest education', y = 'Percentage low weight', fill = 'Experience') +
 #scale_x_discrete(guide = guide_axis(n.dodge=5)) +
  theme(axis.text.x = element_text(angle = 45)) +
  theme(axis.text.x = element_text(vjust=0.6)) 

education_experience_plot_LW

```

#Low weight: Bar plot of AGE and 1) previous experience, 2) no previous experience and none during pandemic, 3) no previous experience but experience during pandemic
```{r}

#Remove NAs
dat_no_nas1 <- dat %>%
  filter(!is.na(experience_low_weight))

dat_no_nas <- dat_no_nas1 %>%
  filter(!is.na(age_category_COVID_baseline))


#Plot 
age_experience_plot_LW <- dat_no_nas %>% 
    ggplot(
     aes(
       x = age_category_COVID_baseline,
       y = (stat(count)),
       fill = experience_low_weight,
       label = (stat(count))
      )
     ) +
   geom_bar(
     stat = "count",
     position = "fill"
     ) +
  geom_text(stat = 'count',
            position = "fill") +
  theme_light() + 
  labs(x = 'Age', y = 'Percentage low weight', fill = 'Experience')

age_experience_plot_LW

```

#Low weight: Bar plot of COMORBIDITIES COUNT and 1) previous experience, 2) no previous experience and none during pandemic, 3) no previous experience but experience during pandemic
```{r}

#Remove NAs
dat_no_nas1 <- dat %>%
  filter(!is.na(experience_low_weight))

dat_no_nas <- dat_no_nas1 %>%
  filter(!is.na(comorbidities_count))

#Filter out people with EDs?
dat_no_nas <- dat_no_nas %>%
  filter(!comorbidities == "Diagnosed eating disorder")

dat_no_nas <- dat_no_nas %>%
  filter(!comorbidities == "Suspected eating disorder")

#Plot 
comorbid_count_experience_plot_LW <- dat_no_nas %>% 
    ggplot(
     aes(
       x = comorbidities_count,
       y = (stat(count)),
       fill = experience_low_weight,
       label = (stat(count))
      )
     ) +
   geom_bar(
     stat = "count",
     position = "fill"
     ) +
  geom_text(stat = 'count',
            position = "fill") +
  theme_light() + 
  labs(x = 'Number of comorbidities', y = 'Percentage low weight', fill = 'Experience')

comorbid_count_experience_plot_LW

```
#Low weight: Bar plot of CONTROLS and 1) previous experience, 2) no previous experience and none during pandemic, 3) no previous experience but experience during pandemic
```{r}

#Remove NAs
dat_no_nas1 <- dat %>%
  filter(!is.na(experience_low_weight))

dat_no_nas <- dat_no_nas1 %>%
  filter(!is.na(control_numeric))

#Filter out people with EDs?
dat_no_nas <- dat_no_nas %>%
  filter(!comorbidities == "Diagnosed eating disorder")

dat_no_nas <- dat_no_nas %>%
  filter(!comorbidities == "Suspected eating disorder")

#Create new variable - control as a factor
dat_no_nas <- dat_no_nas %>%
  mutate(control_factor = 
           case_when(control_numeric == 1 ~ "Control",
                     control_numeric ==0 ~ "Not control"
             
           )
  )
         
#Plot 
control_experience_plot_LW <- dat_no_nas %>% 
    ggplot(
     aes(
       x = control_factor,
       y = (stat(count)),
       fill = experience_low_weight,
       label = (stat(count))
      )
     ) +
   geom_bar(
     stat = "count",
     position = "fill"
     ) +
  geom_text(stat = 'count',
            position = "fill") +
  theme_light() + 
  labs(x = 'Control status', y = 'Percentage low weight', fill = 'Experience')

control_experience_plot_LW

```
#Key worker: Bar plot of KEY WORKER and 1) previous experience, 2) no previous experience and none during pandemic, 3) no previous experience but experience during pandemic
```{r}

#Remove NAs
dat_no_nas1 <- dat %>%
  filter(!is.na(experience_low_weight))

dat_no_nas <- dat_no_nas1 %>%
  filter(!is.na(key_worker))


#Plot 
key_worker_experience_plot_LW <- dat_no_nas %>% 
    ggplot(
     aes(
       x = key_worker,
       y = (stat(count)),
       fill = experience_low_weight,
       label = (stat(count))
      )
     ) +
   geom_bar(
     stat = "count",
     position = "fill"
     ) +
  geom_text(stat = 'count',
            position = "fill") +
  theme_light() + 
  labs(x = 'Key worker', y = 'Percentage low weight', fill = 'Experience')

key_worker_experience_plot_LW

```
#low weight: Bar plot of VULNERABLE STATUS and 1) previous experience, 2) no previous experience and none during pandemic, 3) no previous experience but experience during pandemic
```{r}

#Remove NAs
dat_no_nas1 <- dat %>%
  filter(!is.na(experience_low_weight))

dat_no_nas <- dat_no_nas1 %>%
  filter(!is.na(vulnerable_group_member))

dat_no_nas <- dat_no_nas %>%
  mutate(vulnerable_group_member_renamed =
           case_when(
           vulnerable_group_member == "Not I am not a member of a vulnerable group" ~ "No",
           vulnerable_group_member == "I am not a member of a vulnerable group" ~ "Yes",
         )
  )


dat %>%
  freq(vulnerable_group_member)
#Plot 
vul_mem_experience_plot_LW <- dat_no_nas %>% 
    ggplot(
     aes(
       x = vulnerable_group_member_renamed,
       y = (stat(count)),
       fill = experience_low_weight,
       label = (stat(count))
      )
     ) +
   geom_bar(
     stat = "count",
     position = "fill"
     ) +
  geom_text(stat = 'count',
            position = "fill") +
  theme_light() + 
  labs(x = 'Vulnerable group member', y = 'Percentage self-harm', fill = 'Experience')

vul_mem_experience_plot_LW

```
######### PASSIVE SUICIDAL IDEATION ###########

#Create one variable for experience of suicidal ideation
```{r}

dat <- dat %>%
  mutate(experience_passive_suicidal_ideation = 
           case_when(
             
             PREPANDEMIC_passive_suicidal_ideation == 1 ~ "Retro prepan experience of passive suicidal ideation",
             
             PREPANDEMIC_passive_suicidal_ideation == 0 &
              passive_suicidal_ideation_PANDEMIC == 0 ~ "No previous or pandemic passive suicidal ideation",
                     
                     PREPANDEMIC_passive_suicidal_ideation == 0 &
                       passive_suicidal_ideation_PANDEMIC == 1 ~ "New pandemic experience of passive suicidal ideation",
                     
                    
           )
    
  )


dat %>%
  freq(experience_passive_suicidal_ideation) # People who are NA did not fill out any follow up questionnaires

```


#Passive suicidal ideation: Bar plot of GENDER and 1) previous experience, 2) no previous experience and none during pandemic, 3) no previous experience but experience during pandemic
```{r}

#Remove NAs
dat_no_nas1 <- dat %>%
  filter(!is.na(experience_passive_suicidal_ideation))

dat_no_nas <- dat_no_nas1 %>%
  filter(!is.na(gender_cleaned))

#Plot 
gender_experience_plot_PSI <- dat_no_nas %>% 
    ggplot(
     aes(
       x = gender_cleaned,
       y = (stat(count)),
       fill = experience_passive_suicidal_ideation,
       label = (stat(count))
      )
     ) +
   geom_bar(
     stat = "count",
     position = "fill"
     ) +
  geom_text(stat = 'count',
            position = "fill") +
  theme_light() + 
  labs(x = 'Gender', y = 'Percentage passive suicidal ideation', fill = 'Experience')

gender_experience_plot_PSI

```


#Passive suicidal ideation: Bar plot of ETHNICITY and 1) previous experience, 2) no previous experience and none during pandemic, 3) no previous experience but experience during pandemic
```{r}

#Remove NAs
dat_no_nas1 <- dat %>%
  filter(!is.na(experience_passive_suicidal_ideation))

dat_no_nas <- dat_no_nas1 %>%
  filter(!is.na(ethnicity_binary))

#Plot 
ethnicity_experience_plot_PSI <- dat_no_nas %>% 
    ggplot(
     aes(
       x = ethnicity_binary,
       y = (stat(count)),
       fill = experience_passive_suicidal_ideation,
       label = (stat(count))
      )
     ) +
   geom_bar(
     stat = "count",
     position = "fill"
     ) +
  geom_text(stat = 'count',
            position = "fill") +
  theme_light() + 
  labs(x = 'Ethnicity', y = 'Percentage passive suicidal ideation', fill = 'Experience')

ethnicity_experience_plot_PSI

```

#Passive suicidal ideation: Bar plot of EDUCATION and 1) previous experience, 2) no previous experience and none during pandemic, 3) no previous experience but experience during pandemic
```{r}

#Remove NAs
dat_no_nas1 <- dat %>%
  filter(!is.na(experience_passive_suicidal_ideation))

#Remove NAs
dat_no_nas <- dat_no_nas1 %>%
  filter(!is.na(highest_education_renamed))


#Plot 
education_experience_plot_PSI <- dat_no_nas %>% 
    ggplot(
     aes(
       x = highest_education_renamed,
       y = (stat(count)),
       fill = experience_passive_suicidal_ideation,
       label = (stat(count))
      )
     ) +
   geom_bar(
     stat = "count",
     position = "fill"
     ) +
  geom_text(stat = 'count',
            position = "fill") +
  theme_light() + 
  labs(x = 'Highest education', y = 'Percentage passive suicidal ideation', fill = 'Experience') +
 #scale_x_discrete(guide = guide_axis(n.dodge=5)) +
  theme(axis.text.x = element_text(angle = 45)) +
  theme(axis.text.x = element_text(vjust=0.6)) 

education_experience_plot_PSI

```

#Passive suicidal ideation: Bar plot of AGE and 1) previous experience, 2) no previous experience and none during pandemic, 3) no previous experience but experience during pandemic
```{r}

#Remove NAs
dat_no_nas1 <- dat %>%
  filter(!is.na(experience_passive_suicidal_ideation))

dat_no_nas <- dat_no_nas1 %>%
  filter(!is.na(age_category_COVID_baseline))


#Plot 
age_experience_plot_PSI <- dat_no_nas %>% 
    ggplot(
     aes(
       x = age_category_COVID_baseline,
       y = (stat(count)),
       fill = experience_passive_suicidal_ideation,
       label = (stat(count))
      )
     ) +
   geom_bar(
     stat = "count",
     position = "fill"
     ) +
  geom_text(stat = 'count',
            position = "fill") +
  theme_light() + 
 labs(x = 'Age', y = 'Percentage passive suicidal ideation', fill = 'Experience')+
  theme(axis.text.x = element_text(angle = 45)) +
  theme(axis.text.x = element_text(vjust=0.6)) 

age_experience_plot_PSI

```

#Passive suicidal ideation: Bar plot of COMORBIDITIES COUNT and 1) previous experience, 2) no previous experience and none during pandemic, 3) no previous experience but experience during pandemic
```{r}

#Remove NAs
dat_no_nas1 <- dat %>%
  filter(!is.na(experience_passive_suicidal_ideation))

dat_no_nas <- dat_no_nas1 %>%
  filter(!is.na(comorbidities_count))

#Plot 
comorbid_count_experience_plot_PSI <- dat_no_nas %>% 
    ggplot(
     aes(
       x = comorbidities_count,
       y = (stat(count)),
       fill = experience_passive_suicidal_ideation,
       label = (stat(count))
      )
     ) +
   geom_bar(
     stat = "count",
     position = "fill"
     ) +
  geom_text(stat = 'count',
            position = "fill") +
  theme_light() + 
  labs(x = 'Number of comorbidities', y = 'Percentage passive suicidal ideation', fill = 'Experience')

comorbid_count_experience_plot_PSI

```
#Passive suicidal ideation: Bar plot of CONTROLS and 1) previous experience, 2) no previous experience and none during pandemic, 3) no previous experience but experience during pandemic
```{r}

#Remove NAs
dat_no_nas1 <- dat %>%
  filter(!is.na(experience_passive_suicidal_ideation))

dat_no_nas <- dat_no_nas1 %>%
  filter(!is.na(control_numeric))


#Create new variable - control as a factor
dat_no_nas <- dat_no_nas %>%
  mutate(control_factor = 
           case_when(control_numeric == 1 ~ "Control",
                     control_numeric ==0 ~ "Not control"
             
           )
  )
         
#Plot 
control_experience_plot_PSI <- dat_no_nas %>% 
    ggplot(
     aes(
       x = control_factor,
       y = (stat(count)),
       fill = experience_passive_suicidal_ideation,
       label = (stat(count))
      )
     ) +
   geom_bar(
     stat = "count",
     position = "fill"
     ) +
  geom_text(stat = 'count',
            position = "fill") +
  theme_light() + 
  labs(x = 'Control status', y = 'Percentage passive suicidal ideation', fill = 'Experience')

control_experience_plot_PSI

```

#Passive suicidal ideation: Bar plot of KEY WORKER and 1) previous experience, 2) no previous experience and none during pandemic, 3) no previous experience but experience during pandemic
```{r}

#Remove NAs
dat_no_nas1 <- dat %>%
  filter(!is.na(experience_passive_suicidal_ideation))

dat_no_nas <- dat_no_nas1 %>%
  filter(!is.na(key_worker))


#Plot 
key_worker_experience_plot_PSI <- dat_no_nas %>% 
    ggplot(
     aes(
       x = key_worker,
       y = (stat(count)),
       fill = experience_passive_suicidal_ideation,
       label = (stat(count))
      )
     ) +
   geom_bar(
     stat = "count",
     position = "fill"
     ) +
  geom_text(stat = 'count',
            position = "fill") +
  theme_light() + 
  labs(x = 'Key worker', y = 'Percentage passive suicidal ideation', fill = 'Experience')

key_worker_experience_plot_PSI

```
#Passive suicidal ideation: Bar plot of VULNERABLE STATUS and 1) previous experience, 2) no previous experience and none during pandemic, 3) no previous experience but experience during pandemic
```{r}

#Remove NAs
dat_no_nas1 <- dat %>%
  filter(!is.na(experience_passive_suicidal_ideation))

dat_no_nas <- dat_no_nas1 %>%
  filter(!is.na(vulnerable_group_member))

dat_no_nas <- dat_no_nas %>%
  mutate(vulnerable_group_member_renamed =
           case_when(
           vulnerable_group_member == "Not I am not a member of a vulnerable group" ~ "No",
           vulnerable_group_member == "I am not a member of a vulnerable group" ~ "Yes",
         )
  )


dat %>%
  freq(vulnerable_group_member)
#Plot 
vul_mem_experience_plot_PSI <- dat_no_nas %>% 
    ggplot(
     aes(
       x = vulnerable_group_member_renamed,
       y = (stat(count)),
       fill = experience_passive_suicidal_ideation,
       label = (stat(count))
      )
     ) +
   geom_bar(
     stat = "count",
     position = "fill"
     ) +
  geom_text(stat = 'count',
            position = "fill") +
  theme_light() + 
  labs(x = 'Vulnerable group member', y = 'Percentage self-harm', fill = 'Experience')

vul_mem_experience_plot_PSI

```

######### SELF-HARM IDEATION ###########
#Create one variable for experience of self-harm ideation
```{r}
dat <- dat %>%
  mutate(experience_selfharm_ideation = 
           case_when(
             
             PREPANDEMIC_selfharm_ideation == 1 ~ "Retro prepan experience of self-harm ideation",
             
             PREPANDEMIC_selfharm_ideation == 0 &
              selfharm_ideation_PANDEMIC == 0 ~ "No previous or pandemic self-harm ideation",
                     
                     PREPANDEMIC_selfharm_ideation == 0 &
                       selfharm_ideation_PANDEMIC == 1 ~ "New pandemic experience of self-harm ideation",
                     
                    
           )
    
  )


dat %>%
  freq(experience_selfharm_ideation) # People who are NA did not fill out any follow up questionnaires

```

#self-harm ideation: Bar plot of GENDER and 1) previous experience, 2) no previous experience and none during pandemic, 3) no previous experience but experience during pandemic
```{r}

#Remove NAs
dat_no_nas1 <- dat %>%
  filter(!is.na(experience_selfharm_ideation))

dat_no_nas <- dat_no_nas1 %>%
  filter(!is.na(gender_cleaned))

#Plot 
gender_experience_plot_SHI <- dat_no_nas %>% 
    ggplot(
     aes(
       x = gender_cleaned,
       y = (stat(count)),
       fill = experience_selfharm_ideation,
       label = (stat(count))
      )
     ) +
   geom_bar(
     stat = "count",
     position = "fill"
     ) +
  geom_text(stat = 'count',
            position = "fill") +
  theme_light() + 
  labs(x = 'Gender', y = 'Percentage self-harm ideation', fill = 'Experience')

gender_experience_plot_SHI

```


#self-harm ideation: Bar plot of ETHNICITY and 1) previous experience, 2) no previous experience and none during pandemic, 3) no previous experience but experience during pandemic
```{r}

#Remove NAs
dat_no_nas1 <- dat %>%
  filter(!is.na(experience_selfharm_ideation))

dat_no_nas <- dat_no_nas1 %>%
  filter(!is.na(ethnicity_binary))

#Plot 
ethnicity_experience_plot_SHI <- dat_no_nas %>% 
    ggplot(
     aes(
       x = ethnicity_binary,
       y = (stat(count)),
       fill = experience_selfharm_ideation,
       label = (stat(count))
      )
     ) +
   geom_bar(
     stat = "count",
     position = "fill"
     ) +
  geom_text(stat = 'count',
            position = "fill") +
  theme_light() + 
  labs(x = 'Ethnicity', y = 'Percentage self-harm ideation', fill = 'Experience')

ethnicity_experience_plot_SHI

```

#self-harm ideation: Bar plot of EDUCATION and 1) previous experience, 2) no previous experience and none during pandemic, 3) no previous experience but experience during pandemic
```{r}

#Remove NAs
dat_no_nas1 <- dat %>%
  filter(!is.na(experience_selfharm_ideation))

#Remove NAs
dat_no_nas <- dat_no_nas1 %>%
  filter(!is.na(highest_education_renamed))


#Plot 
education_experience_plot_SHI <- dat_no_nas %>% 
    ggplot(
     aes(
       x = highest_education_renamed,
       y = (stat(count)),
       fill = experience_selfharm_ideation,
       label = (stat(count))
      )
     ) +
   geom_bar(
     stat = "count",
     position = "fill"
     ) +
  geom_text(stat = 'count',
            position = "fill") +
  theme_light() + 
  labs(x = 'Highest education', y = 'Percentage self-harm ideation', fill = 'Experience') +
 #scale_x_discrete(guide = guide_axis(n.dodge=5)) +
  theme(axis.text.x = element_text(angle = 45)) +
  theme(axis.text.x = element_text(vjust=0.6)) 

education_experience_plot_SHI

```

#self-harm ideation: Bar plot of AGE and 1) previous experience, 2) no previous experience and none during pandemic, 3) no previous experience but experience during pandemic
```{r}

#Remove NAs
dat_no_nas1 <- dat %>%
  filter(!is.na(experience_selfharm_ideation))

dat_no_nas <- dat_no_nas1 %>%
  filter(!is.na(age_category_COVID_baseline))


#Plot 
age_experience_plot_SHI <- dat_no_nas %>% 
    ggplot(
     aes(
       x = age_category_COVID_baseline,
       y = (stat(count)),
       fill = experience_selfharm_ideation,
       label = (stat(count))
      )
     ) +
   geom_bar(
     stat = "count",
     position = "fill"
     ) +
  geom_text(stat = 'count',
            position = "fill") +
  theme_light() + 
 labs(x = 'Age', y = 'Percentage self-harm ideation', fill = 'Experience')+
  theme(axis.text.x = element_text(angle = 45)) +
  theme(axis.text.x = element_text(vjust=0.6)) 

age_experience_plot_SHI

```

#self-harm ideation: Bar plot of COMORBIDITIES COUNT and 1) previous experience, 2) no previous experience and none during pandemic, 3) no previous experience but experience during pandemic
```{r}

#Remove NAs
dat_no_nas1 <- dat %>%
  filter(!is.na(experience_selfharm_ideation))

dat_no_nas <- dat_no_nas1 %>%
  filter(!is.na(comorbidities_count))

#Plot 
comorbid_count_experience_plot_SHI <- dat_no_nas %>% 
    ggplot(
     aes(
       x = comorbidities_count,
       y = (stat(count)),
       fill = experience_selfharm_ideation,
       label = (stat(count))
      )
     ) +
   geom_bar(
     stat = "count",
     position = "fill"
     ) +
  geom_text(stat = 'count',
            position = "fill") +
  theme_light() + 
  labs(x = 'Number of comorbidities', y = 'Percentage self-harm ideation', fill = 'Experience')

comorbid_count_experience_plot_SHI

```

#self-harm ideation: Bar plot of CONTROLS and 1) previous experience, 2) no previous experience and none during pandemic, 3) no previous experience but experience during pandemic
```{r}

#Remove NAs
dat_no_nas1 <- dat %>%
  filter(!is.na(experience_selfharm_ideation))

dat_no_nas <- dat_no_nas1 %>%
  filter(!is.na(control_numeric))


#Create new variable - control as a factor
dat_no_nas <- dat_no_nas %>%
  mutate(control_factor = 
           case_when(control_numeric == 1 ~ "Control",
                     control_numeric ==0 ~ "Not control"
             
           )
  )
         
#Plot 
control_experience_plot_SHI <- dat_no_nas %>% 
    ggplot(
     aes(
       x = control_factor,
       y = (stat(count)),
       fill = experience_selfharm_ideation,
       label = (stat(count))
      )
     ) +
   geom_bar(
     stat = "count",
     position = "fill"
     ) +
  geom_text(stat = 'count',
            position = "fill") +
  theme_light() + 
  labs(x = 'Control status', y = 'Percentage self-harm ideation', fill = 'Experience')

control_experience_plot_SHI

```
#self-harm ideation: Bar plot of KEY WORKER and 1) previous experience, 2) no previous experience and none during pandemic, 3) no previous experience but experience during pandemic
```{r}

#Remove NAs
dat_no_nas1 <- dat %>%
  filter(!is.na(experience_selfharm_ideation))

dat_no_nas <- dat_no_nas1 %>%
  filter(!is.na(key_worker))


#Plot 
key_worker_experience_plot_SHI <- dat_no_nas %>% 
    ggplot(
     aes(
       x = key_worker,
       y = (stat(count)),
       fill = experience_selfharm_ideation,
       label = (stat(count))
      )
     ) +
   geom_bar(
     stat = "count",
     position = "fill"
     ) +
  geom_text(stat = 'count',
            position = "fill") +
  theme_light() + 
  labs(x = 'Key worker', y = 'Percentage self-harm ideation', fill = 'Experience')

key_worker_experience_plot_SHI

```
#Self-harm ideation: Bar plot of VULNERABLE STATUS and 1) previous experience, 2) no previous experience and none during pandemic, 3) no previous experience but experience during pandemic
```{r}

#Remove NAs
dat_no_nas1 <- dat %>%
  filter(!is.na(experience_selfharm_ideation))

dat_no_nas <- dat_no_nas1 %>%
  filter(!is.na(vulnerable_group_member))

dat_no_nas <- dat_no_nas %>%
  mutate(vulnerable_group_member_renamed =
           case_when(
           vulnerable_group_member == "Not I am not a member of a vulnerable group" ~ "No",
           vulnerable_group_member == "I am not a member of a vulnerable group" ~ "Yes",
         )
  )


dat %>%
  freq(vulnerable_group_member)
#Plot 
vul_mem_experience_plot_SHI <- dat_no_nas %>% 
    ggplot(
     aes(
       x = vulnerable_group_member_renamed,
       y = (stat(count)),
       fill = experience_selfharm_ideation,
       label = (stat(count))
      )
     ) +
   geom_bar(
     stat = "count",
     position = "fill"
     ) +
  geom_text(stat = 'count',
            position = "fill") +
  theme_light() + 
  labs(x = 'Vulnerable group member', y = 'Percentage self-harm', fill = 'Experience')

vul_mem_experience_plot_SHI

```
######### SELF-HARM ###########
#Create one variable for experience of self-harm 
```{r}
dat <- dat %>%
  mutate(experience_selfharm = 
           case_when(
             
             PREPANDEMIC_selfharm == 1 ~ "Retro prepan experience of self-harm",
             
             PREPANDEMIC_selfharm == 0 &
              selfharm_PANDEMIC == 0 ~ "No previous or pandemic self-harm",
                     
                     PREPANDEMIC_selfharm == 0 &
                       selfharm_PANDEMIC == 1 ~ "New pandemic experience of self-harm",
                     
                    
           )
    
  )


dat %>%
  freq(experience_selfharm) # People who are NA did not fill out any follow up questionnaires

```

#Self-harm: Bar plot of GENDER and 1) previous experience, 2) no previous experience and none during pandemic, 3) no previous experience but experience during pandemic
```{r}

#Remove NAs
dat_no_nas1 <- dat %>%
  filter(!is.na(experience_selfharm))

dat_no_nas <- dat_no_nas1 %>%
  filter(!is.na(gender_cleaned))

#Plot 
gender_experience_plot_SH <- dat_no_nas %>% 
    ggplot(
     aes(
       x = gender_cleaned,
       y = (stat(count)),
       fill = experience_selfharm,
       label = (stat(count))
      )
     ) +
   geom_bar(
     stat = "count",
     position = "fill"
     ) +
  geom_text(stat = 'count',
            position = "fill") +
  theme_light() + 
  labs(x = 'Gender', y = 'Percentage self-harm', fill = 'Experience')

gender_experience_plot_SH

```


#Self-harm: Bar plot of ETHNICITY and 1) previous experience, 2) no previous experience and none during pandemic, 3) no previous experience but experience during pandemic
```{r}

#Remove NAs
dat_no_nas1 <- dat %>%
  filter(!is.na(experience_selfharm))

dat_no_nas <- dat_no_nas1 %>%
  filter(!is.na(ethnicity_binary))

#Plot 
ethnicity_experience_plot_SH <- dat_no_nas %>% 
    ggplot(
     aes(
       x = ethnicity_binary,
       y = (stat(count)),
       fill = experience_selfharm,
       label = (stat(count))
      )
     ) +
   geom_bar(
     stat = "count",
     position = "fill"
     ) +
  geom_text(stat = 'count',
            position = "fill") +
  theme_light() + 
  labs(x = 'Ethnicity', y = 'Percentage self-harm', fill = 'Experience')

ethnicity_experience_plot_SH

```

#Self-harm: Bar plot of EDUCATION and 1) previous experience, 2) no previous experience and none during pandemic, 3) no previous experience but experience during pandemic
```{r}

#Remove NAs
dat_no_nas1 <- dat %>%
  filter(!is.na(experience_selfharm))

#Remove NAs
dat_no_nas <- dat_no_nas1 %>%
  filter(!is.na(highest_education_renamed))


#Plot 
education_experience_plot_SH <- dat_no_nas %>% 
    ggplot(
     aes(
       x = highest_education_renamed,
       y = (stat(count)),
       fill = experience_selfharm,
       label = (stat(count))
      )
     ) +
   geom_bar(
     stat = "count",
     position = "fill"
     ) +
  geom_text(stat = 'count',
            position = "fill") +
  theme_light() + 
  labs(x = 'Highest education', y = 'Percentage self-harm', fill = 'Experience') +
 #scale_x_discrete(guide = guide_axis(n.dodge=5)) +
  theme(axis.text.x = element_text(angle = 45)) +
  theme(axis.text.x = element_text(vjust=0.6)) 

education_experience_plot_SH

```

#Self-harm: Bar plot of AGE and 1) previous experience, 2) no previous experience and none during pandemic, 3) no previous experience but experience during pandemic
```{r}

#Remove NAs
dat_no_nas1 <- dat %>%
  filter(!is.na(experience_selfharm))

dat_no_nas <- dat_no_nas1 %>%
  filter(!is.na(age_category_COVID_baseline))


#Plot 
age_experience_plot_SH <- dat_no_nas %>% 
    ggplot(
     aes(
       x = age_category_COVID_baseline,
       y = (stat(count)),
       fill = experience_selfharm,
       label = (stat(count))
      )
     ) +
   geom_bar(
     stat = "count",
     position = "fill"
     ) +
  geom_text(stat = 'count',
            position = "fill") +
  theme_light() + 
 labs(x = 'Age', y = 'Percentage self-harm', fill = 'Experience')+
  theme(axis.text.x = element_text(angle = 45)) +
  theme(axis.text.x = element_text(vjust=0.6)) 

age_experience_plot_SH

```

#Self-harm: Bar plot of COMORBIDITIES COUNT and 1) previous experience, 2) no previous experience and none during pandemic, 3) no previous experience but experience during pandemic
```{r}

#Remove NAs
dat_no_nas1 <- dat %>%
  filter(!is.na(experience_selfharm))

dat_no_nas <- dat_no_nas1 %>%
  filter(!is.na(comorbidities_count))

#Plot 
comorbid_count_experience_plot_SH <- dat_no_nas %>% 
    ggplot(
     aes(
       x = comorbidities_count,
       y = (stat(count)),
       fill = experience_selfharm,
       label = (stat(count))
      )
     ) +
   geom_bar(
     stat = "count",
     position = "fill"
     ) +
  geom_text(stat = 'count',
            position = "fill") +
  theme_light() + 
  labs(x = 'Number of comorbidities', y = 'Percentage self-harm', fill = 'Experience')

comorbid_count_experience_plot_SH

```

#Self-harm: Bar plot of CONTROLS and 1) previous experience, 2) no previous experience and none during pandemic, 3) no previous experience but experience during pandemic
```{r}

#Remove NAs
dat_no_nas1 <- dat %>%
  filter(!is.na(experience_selfharm))

dat_no_nas <- dat_no_nas1 %>%
  filter(!is.na(control_numeric))


#Create new variable - control as a factor
dat_no_nas <- dat_no_nas %>%
  mutate(control_factor = 
           case_when(control_numeric == 1 ~ "Control",
                     control_numeric ==0 ~ "Not control"
             
           )
  )
         
#Plot 
control_experience_plot_SH <- dat_no_nas %>% 
    ggplot(
     aes(
       x = control_factor,
       y = (stat(count)),
       fill = experience_selfharm,
       label = (stat(count))
      )
     ) +
   geom_bar(
     stat = "count",
     position = "fill"
     ) +
  geom_text(stat = 'count',
            position = "fill") +
  theme_light() + 
  labs(x = 'Control status', y = 'Percentage self-harm', fill = 'Experience')

control_experience_plot_SH

```

#Self-harm: Bar plot of KEY WORKER and 1) previous experience, 2) no previous experience and none during pandemic, 3) no previous experience but experience during pandemic
```{r}

#Remove NAs
dat_no_nas1 <- dat %>%
  filter(!is.na(experience_selfharm))

dat_no_nas <- dat_no_nas1 %>%
  filter(!is.na(key_worker))


#Plot 
key_worker_experience_plot_SH <- dat_no_nas %>% 
    ggplot(
     aes(
       x = key_worker,
       y = (stat(count)),
       fill = experience_selfharm,
       label = (stat(count))
      )
     ) +
   geom_bar(
     stat = "count",
     position = "fill"
     ) +
  geom_text(stat = 'count',
            position = "fill") +
  theme_light() + 
  labs(x = 'Key worker', y = 'Percentage self-harm', fill = 'Experience')

key_worker_experience_plot_SH

```

#Self-harm: Bar plot of VULNERABLE STATUS and 1) previous experience, 2) no previous experience and none during pandemic, 3) no previous experience but experience during pandemic
```{r}

#Remove NAs
dat_no_nas1 <- dat %>%
  filter(!is.na(experience_selfharm))

dat_no_nas <- dat_no_nas1 %>%
  filter(!is.na(vulnerable_group_member))

dat_no_nas <- dat_no_nas %>%
  mutate(vulnerable_group_member_renamed =
           case_when(
           vulnerable_group_member == "Not I am not a member of a vulnerable group" ~ "No",
           vulnerable_group_member == "I am not a member of a vulnerable group" ~ "Yes",
         )
  )


dat %>%
  freq(vulnerable_group_member)
#Plot 
vul_mem_experience_plot_SH <- dat_no_nas %>% 
    ggplot(
     aes(
       x = vulnerable_group_member_renamed,
       y = (stat(count)),
       fill = experience_selfharm,
       label = (stat(count))
      )
     ) +
   geom_bar(
     stat = "count",
     position = "fill"
     ) +
  geom_text(stat = 'count',
            position = "fill") +
  theme_light() + 
  labs(x = 'Vulnerable group member', y = 'Percentage self-harm', fill = 'Experience')

vul_mem_experience_plot_SH

```