---
title: "COPING (NBR + GLAD + EDGI) + RAMP grouping at baseline"
author: "Helena Davies"
date: "06/05/2021"
output: html_document
---

This script identifies whether people have experienced lifetime low weight or lifetime binge eating at baseline.

Due to differences in the available variables, the way in which I have assessed lifetime binge eating and lifetime low weight differ across the datasets. 

EDGI = Selected those who filled in EDGI sign-up before after 23rd Jan (i.e., up to 3 months before COPING), then looked at their answers in the EDGI sign-up as to whether they have endorsed low weight (AN screener) or binge eating (BN/BED screener). I have chosen this date as it is 3 months before the start of the pandemic. We are going to assume that if someone at this point does NOT endorse binge eating or low weight, then we can assume that if they experience it during the pandemic, then it is for the first time. This is because the EDGI participants do NOT get asked the AN, BE, AAN or ICB modules at COPING baseline as they have already been asked in EDGI. It is however likely that we capture some false positives of 'new experiences' if someone experienced it AFTER filling out the EDGI signup but BEFORE filling out the COPING baseline).

RAMP = Looked at self-reported diagnoses at RAMP baseline. Endorsement of AN diagnosis is equivalent to low weight; endorsement of BN or BED is equivalent to binge eating.

GLAD & NBR = Looked at self-reported endorsement of low weight (AN screener) and binge eating (BED/BN screener) at COPING baseline.

```{r Setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      comment=NA,
                      prompt=FALSE,
                      cache=FALSE)
```

Delete everything in your global environment
```{r Delete everything in your global environment}
remove(list = ls())
```

Call in library script
```{r Souce library}
source("./libraries.R")
```

Call in functions script
```{r Source functions}
source("./functions.R")
```

Retrieve the recent date
```{r Recent date}
date = Sys.Date()
date
```

Read in ED data: GLAD COPING BE
```{r Read in data GLAD COPING BE}
dat.be.glad <- readRDS(file = "../data_raw/diagnostics/be_coping_glad.rds")

# Inspect dimensions
dim(dat.be.glad)
# Inspect colnames
colnames(dat.be.glad)

nrow(dat.be.glad)

```

Select variables: GLAD COPING BE
```{r Select variables GLAD COPING BE}

exclude_cols_dem <- c("ID",
                  "cohort_name")

dat.be.glad.id <- dat.be.glad %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  distinct(externalDataReference, .keep_all = TRUE) %>% 
 # add_column(cohort_name = "coping_glad", .before = "be.experience_regular_episodes_binge") %>% #create new column 
  select(
         ID = externalDataReference,# ID
       #  cohort_name, # Sample
      be.ate_regard_eating_binges =  be.ate_regard_short_period #rename to same as NBR
       
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  mutate_if(is.numeric, ~na_if(., -99)) %>%
  mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) %>% # Drop empty factor levels
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(dat.be.glad.id )
# Inspect colnames
colnames(dat.be.glad.id )
#Differences
dim(dat.be.glad)[1]-dim(dat.be.glad.id )[1]

```

Read in ED data: NBR COPING BE
```{r Read in data NBR COPING BE}
dat.be.nbr <- readRDS(file = "../data_raw/diagnostics/be_coping_nbr.rds")

# Inspect dimensions
dim(dat.be.nbr)
# Inspect colnames
colnames(dat.be.nbr)

nrow(dat.be.nbr)

```

Select variables: NBR COPING BE
```{r Select variables NBR COPING BE}

exclude_cols_dem <- c("ID",
                  "cohort_name")

dat.be.nbr.id <- dat.be.nbr %>% #new dataset with ID
  drop_na(subjectid) %>% # Drop NAs
  distinct(subjectid, .keep_all = TRUE) %>% 
  #add_column(cohort_name = "coping_nbr", .before = "be.experience_regular_episodes_binge") %>% #create new column 
  select(
         ID = subjectid,# ID
        # cohort_name, # Sample
       be.ate_regard_eating_binges
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  mutate_if(is.numeric, ~na_if(., -99)) %>%
  mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) %>% # Drop empty factor levels
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(dat.be.nbr.id )
# Inspect colnames
colnames(dat.be.nbr.id )
#Differences
dim(dat.be.nbr)[1]-dim(dat.be.nbr.id )[1]

```

Read in ED data: GLAD AN SCREENER
```{r Read in data GLAD AN screener}
dat.an.scr.glad <- readRDS(file = "../data_raw/glad/an_scr_coping_glad.rds")

# Inspect dimensions
dim(dat.an.scr.glad)
# Inspect colnames
colnames(dat.an.scr.glad)

nrow(dat.an.scr.glad)

```

Select variables: GLAD COPING AN SCREENER
```{r Select variables GLAD COPING AN SCREENER}

exclude_cols_dem <- c("ID",
                  "cohort_name")

dat.an.scr.glad.id <- dat.an.scr.glad %>% #new dataset with ID
  drop_na(externalDataReference) %>% # Drop NAs
  distinct(externalDataReference, .keep_all = TRUE) %>% 
  add_column(cohort_name = "coping_glad", .before = "an.weigh_weighed_people_thought") %>% #create new column 
  select(
         ID = externalDataReference,# ID
        cohort_name, # Sample
       an.weigh_weighed_people_thought
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  mutate_if(is.numeric, ~na_if(., -99)) %>%
  mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) %>% # Drop empty factor levels
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(dat.an.scr.glad.id )
# Inspect colnames
colnames(dat.an.scr.glad.id )
#Differences
dim(dat.an.scr.glad)[1]-dim(dat.an.scr.glad.id )[1]

```

Read in ED data: NBR AN SCREENER
```{r Read in data NBR AN SCREENER}
dat.an.scr.nbr <- readRDS(file = "../data_raw/nbr/an_scr_coping_nbr.rds")

# Inspect dimensions
dim(dat.an.scr.nbr)
# Inspect colnames
colnames(dat.an.scr.nbr)

nrow(dat.an.scr.nbr)

```

Select variables: NBR AN SCREENER
```{r Select variables NBR AN SCREENER}

exclude_cols_dem <- c("ID",
                  "cohort_name")

dat.an.scr.nbr.id <- dat.an.scr.nbr %>% #new dataset with ID
  drop_na(subjectid) %>% # Drop NAs
  distinct(subjectid, .keep_all = TRUE) %>% 
  add_column(cohort_name = "coping_nbr", .before = "an.weigh_weighed_people_thought") %>% #create new column 
  select(
         ID = subjectid,# ID
         cohort_name, # Sample
       an.weigh_weighed_people_thought
         ) %>%
  add_numeric(., exclude = exclude_cols_dem) %>%
  mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
  mutate_if(is.numeric, ~na_if(., -99)) %>%
  mutate_if(is.numeric, ~na_if(., -77)) %>%
  mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
  mutate_if(is.factor, ~na_if(., "Don't know")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
  mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) %>% # Drop empty factor levels
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
  mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))

# Inspect dimensions
dim(dat.an.scr.nbr.id )
# Inspect colnames
colnames(dat.an.scr.nbr.id )
#Differences
dim(dat.an.scr.nbr)[1]-dim(dat.an.scr.nbr.id)[1]

```

# Merge data
## GLAD
```{r Merge GLAD data}
dfs.list <- list(
  dat.be.glad.id,
 dat.an.scr.glad.id
)

# Merge
dat.ed.GLAD <- plyr::join_all(dfs.list,
                                      by = c("ID"))

# Check rows
nrow(dat.ed.GLAD)

# Check columns
colnames(dat.ed.GLAD)

```

# Merge data
## NBR
```{r Merge NBR data}
dfs.list <- list(
  dat.be.nbr.id,
 dat.an.scr.nbr.id
 
 )

# Merge
dat.ed.NBR <- plyr::join_all(dfs.list,
                                      by = c("ID"))

# Check rows
nrow(dat.ed.NBR)

# Check columns
colnames(dat.ed.NBR)
```

# Merge data 
# GLAD + NBR
```{r Merge data GLAD & NBR}
# Merge by rbind - both datasets have same columns
dat.ed <- rbind(dat.ed.NBR,
                   dat.ed.GLAD
                )


# Check colnames 
colnames(dat.ed)

# Check number of people
nrow(dat.ed)
```

# GLAD & NBR
## Lifetime binge eating at baseline
```{r Lifetime binge eating at baseline GLAD & NBR}
dat.ed <- dat.ed %>%
  mutate(lifetime_binge_eating_baseline_numeric =
           case_when(
             be.ate_regard_eating_binges == "Yes" ~ 1,
             be.ate_regard_eating_binges == "No" ~ 0,
             is.na(be.ate_regard_eating_binges) ~ NA_real_
           
           )
    
  )

# Check
dat.ed %>%
  freq(lifetime_binge_eating_baseline_numeric)
```

## Lifetime low weight at baseline
```{r Lifetime low weight at baseline GLAD & NBR}

dat.ed <- dat.ed %>%
  mutate(lifetime_low_weight_baseline_numeric =
           case_when(
            an.weigh_weighed_people_thought == "Yes" ~ 1, # Low weight 
            an.weigh_weighed_people_thought == "No" ~ 0 # Never been at low weight
            
           )
    
  )

# Check
dat.ed %>%
  freq(lifetime_low_weight_baseline_numeric)

```

# Import RAMP MHD self-report data
```{r Read in data RAMP MHD self-report}
ramp.mhd.raw <- readRDS(file = "../data_raw/ramp/health_mhq_ramp.rds")
  dim(ramp.mhd.raw)
  colnames(ramp.mhd.raw)
```

Select columns from RAMP self-report data
NB: This is the only ED data RAMP has (i.e., no sx-level info other than the EDEQ)
```{r Select columns RAMP MHD self-report}
  
exclude_cols <- c("cohort_name",
                    "ID")
  
ramp.mhd.raw.id <- ramp.mhd.raw %>%
    drop_na(`Login ID`) %>% # Drop NAs
    distinct(`Login ID`, .keep_all = TRUE) %>% # Remove duplicates based on ID
    #separate(`Login ID`, into = c("Sample", "ID"), sep = 4) %>% # Split ID in Sample and Number
    #separate(ID, into = "ID", sep = 7) %>%
    add_column(cohort_name = "ramp", .before = "mhd.anorexia_nervosa") %>% #create new column 
    select(
      ID = `Login ID`, # ID
      cohort_name, # Sample
      mhd.anorexia_nervosa,
       mhd.bulimia_nervosa,
     mhd.psychological_overeating_or_bingeeating_disorder
    ) %>%
    add_numeric(., exclude = exclude_cols) %>%
    mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
    mutate_if(is.numeric, ~na_if(., -99)) %>%
    mutate_if(is.numeric, ~na_if(., -77)) %>%
    mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
    mutate_if(is.factor, ~na_if(., "Don't know")) %>%
    mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
    mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
    mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) %>% # Drop empty factor levels
    mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
    mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
    mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))
  # Inspect dimensions
  dim(ramp.mhd.raw.id)
  # Inspect colnames
  colnames(ramp.mhd.raw.id)
  # Differences
  dim(ramp.mhd.raw)[1]-dim(ramp.mhd.raw.id)[1]
```

# RAMP - Lifetime binge eating at baseline
```{r Lifetime binge eating at baseline RAMP}

ramp.mhd.raw.id <- ramp.mhd.raw.id %>%
  mutate(lifetime_binge_eating_baseline_numeric =
           case_when(
             mhd.psychological_overeating_or_bingeeating_disorder == "Psychological overeating or binge-eating disorder" |
               mhd.bulimia_nervosa == "Bulimia nervosa" ~ 1, # If indicated that they have had either, than they have previously experienced binge eating
             
            is.na(mhd.psychological_overeating_or_bingeeating_disorder) &
            is.na(mhd.bulimia_nervosa) ~ NA_real_, # If missing for both, then we can't know whether they have experienced binge eating
             
              mhd.psychological_overeating_or_bingeeating_disorder == "Not Psychological overeating or binge-eating disorder" |
               mhd.bulimia_nervosa == "Not Bulimia nervosa" ~ 0 # If they have indicated that they have NOT had either, then we can assume they have not experienced binge eating
           
           )
    
  )

# Check
ramp.mhd.raw.id %>%
  freq(lifetime_binge_eating_baseline_numeric)
```

# RAMP -  Lifetime low weight baseline
```{r Lifetime low weight baseline RAMP}

ramp.mhd.raw.id <- ramp.mhd.raw.id %>%
  mutate(lifetime_low_weight_baseline_numeric =
           case_when(
            mhd.anorexia_nervosa == "Anorexia nervosa" ~ 1,
            mhd.anorexia_nervosa == "Not Anorexia nervosa" ~ 0,
            is.na(mhd.anorexia_nervosa) ~ NA_real_
            
           )
    
  )

# Check
ramp.mhd.raw.id %>%
  freq(lifetime_low_weight_baseline_numeric)

```

# EDGI = ED100K AFTER 23RD JAN
Reminder: I have chosen this date as it is 3 months before the start of the pandemic. We are going to assume that if someone at this point does NOT endorse binge eating or low weight, then we can assume that if they experience it during the pandemic, then it is for the first time (it is however likely that we capture some false positives of 'new experiences' if someone experienced it after filling out the EDGI signup but before filling out the COPING baseline). This is because the EDGI participants do NOT get asked the AN, BE, AAN or ICB modules at COPING baseline as they have already been asked in EDGI. 

## Import EDGI MHD data
```{r Read in data EDGI MHD}
edgi.mhd.raw <- readRDS(file = "../data_raw/edgi/mhd_edgi.rds")
dim(edgi.mhd.raw)
colnames(edgi.mhd.raw)
```

Select columns EDGI mhd data
```{r Select columns EDGI mhd data}
edgi.mhd.raw.id <- edgi.mhd.raw %>%
    drop_na(externalDataReference) %>% # Drop NAs
    distinct(externalDataReference, .keep_all = TRUE) %>% # Remove duplicates based on ID
    #separate(externalDataReference, into = c("Sample", "ID"), sep = 4) %>% # Split ID in Sample and Number
    # mutate(ID = as.numeric(ID)) %>%
    add_column(cohort_name = "coping_edgi", .before = "startDate") %>% #create new column 
    select(
      ID = externalDataReference, # ID
      endDate,
      cohort_name, # Sample
     mhd.people_thought_weigh_weighed
    ) %>%
    add_numeric(., exclude = exclude_cols) %>%
    mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
    mutate_if(is.numeric, ~na_if(., -99)) %>%
    mutate_if(is.numeric, ~na_if(., -77)) %>%
    mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
    mutate_if(is.factor, ~na_if(., "Don't know")) %>%
    mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
    mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
    mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) %>% # Drop empty factor levels
    mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
    mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
    mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))
  # Inspect dimensions
  dim(edgi.mhd.raw.id)
  # Inspect colnames
  colnames(edgi.mhd.raw.id)
  #Differences
  dim(edgi.mhd.raw.id)[1]-dim(edgi.mhd.raw.id)[1]
```

## Import EDGI BE data
```{r Read in EDGI BE data}
be.edgi.raw <- readRDS(file = "../data_raw/edgi/be_edgi.rds")
dim(be.edgi.raw)
colnames(be.edgi.raw)
```

Select columns EDGI BE data
```{r Select columns EDGI BE data}
be.edgi.raw.id <- be.edgi.raw  %>%
    drop_na(externalDataReference) %>% # Drop NAs
    distinct(externalDataReference, .keep_all = TRUE) %>% # Remove duplicates based on ID
    #separate(externalDataReference, into = c("Sample", "ID"), sep = 4) %>% # Split ID in Sample and Number
    # mutate(ID = as.numeric(ID)) %>%
    add_column(cohort_name = "coping_edgi", .before = "startDate") %>% #create new column 
    select(
      ID = externalDataReference, # ID
      endDate,
      be.short_period_ate_regard
    ) %>%
    add_numeric(., exclude = exclude_cols) %>%
    mutate_if(is.numeric, ~na_if(., -88)) %>% # Recode missing values to NAs in numeric variables
    mutate_if(is.numeric, ~na_if(., -99)) %>%
    mutate_if(is.numeric, ~na_if(., -77)) %>%
    mutate_if(is.factor, ~na_if(., "Seen but not answered")) %>% # Recode missing values to NAs in factor variables
    mutate_if(is.factor, ~na_if(., "Don't know")) %>%
    mutate_if(is.factor, ~na_if(., "Prefer not to say")) %>%
    mutate_if(is.factor, ~na_if(., "Prefer not to answer")) %>%
    mutate_if(is.factor, ~forcats::fct_drop(., only = "Seen but not answered")) %>% # Drop empty factor levels
    mutate_if(is.factor, ~forcats::fct_drop(., only = "Don't know")) %>%
    mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to answer")) %>%
    mutate_if(is.factor, ~forcats::fct_drop(., only = "Prefer not to say"))
  # Inspect dimensions
  dim(be.edgi.raw.id)
  # Inspect colnames
  colnames(be.edgi.raw.id)
  #Differences
  dim(be.edgi.raw)[1]-dim(be.edgi.raw.id)[1]
```

Filter by people who have filled out EDGI AFTER 23rd Jan (i.e., 3 months before start of lockdown - 23rd March)
```{r Filter EDGI data by 23rd Jan}
# EDGI BE  - Filter by people who completed baseline survey after 23rd Jan
be.edgi.raw.id$endDate <- as.Date(be.edgi.raw.id$endDate)

be.edgi.raw.id.filtered <- be.edgi.raw.id %>%
  filter(endDate > as.Date("2021-01-23"))

nrow(be.edgi.raw.id.filtered)

# MHD EDGI  - Filter by people who completed baseline survey after 23rd Jan
edgi.mhd.raw.id$endDate <- as.Date(edgi.mhd.raw.id$endDate)

edgi.mhd.raw.id.filtered <- edgi.mhd.raw.id %>%
  filter(endDate > as.Date("2021-01-23"))

nrow(edgi.mhd.raw.id.filtered)
```

# EDGI - Lifetime binge eating at baseline
```{r Lifetime binge eating baseline EDGI}
be.edgi.raw.id.filtered <- be.edgi.raw.id.filtered %>%
  mutate(lifetime_binge_eating_baseline_numeric =
           case_when(
              be.short_period_ate_regard == "Yes" ~ 1,
              be.short_period_ate_regard == "No" ~ 0,
              is.na(be.short_period_ate_regard) ~ NA_real_
           
           )
  )

# Check
be.edgi.raw.id.filtered %>%
  freq(lifetime_binge_eating_baseline_numeric)
```

# EDGI -  Lifetime low weight at baseline
```{r Lifetime low weight baseline EDGI}
edgi.mhd.raw.id.filtered <- edgi.mhd.raw.id.filtered %>%
  mutate(lifetime_low_weight_baseline_numeric =
           case_when( 
             mhd.people_thought_weigh_weighed == "Yes" ~ 1,
             
             mhd.people_thought_weigh_weighed == "No" ~ 0,
             
             is.na(mhd.people_thought_weigh_weighed) ~ NA_real_
           )
  )

# Check
edgi.mhd.raw.id.filtered %>%
  freq(lifetime_low_weight_baseline_numeric)
```

# Select variables from each dataset to keep

## RAMP
```{r Select variables to keep RAMP}
dat.baseline.groups.ramp <- ramp.mhd.raw.id %>%
  select(ID,
         cohort_name,
         lifetime_low_weight_baseline_numeric, # Low weight at baseline
         lifetime_binge_eating_baseline_numeric # Binge eating at baseline
         
   )
```

## GLAD & NBR
```{r Select variables to keep NBR & GLAD}
#Binge eating & low weight at baseline (GLAD + NBR)
dat.baseline.groups.nbr.glad <- dat.ed %>%
  select(ID,
         cohort_name,
         lifetime_binge_eating_baseline_numeric, # Binge eating at baseline
         lifetime_low_weight_baseline_numeric # Low weight at baseline
         )

```

## EDGI
```{r Select variables to keep EDGI}
# Binge eating at baseline
edgi.1 <- be.edgi.raw.id.filtered %>%
  select(ID,
         lifetime_binge_eating_baseline_numeric
         )

# Low weight at baseline
edgi.2 <- edgi.mhd.raw.id.filtered %>%
  select(ID,
         cohort_name,
         lifetime_low_weight_baseline_numeric
         )

dfs.list <- list(edgi.1,
             edgi.2)

# Merge
dat.baseline.groups.edgi <- plyr::join_all(
  dfs.list,
  by = c("ID") 
  )
```

# MERGE ALL DATA
```{r Merge all data}
baseline_ED_groups <- rbind(dat.baseline.groups.ramp,
      dat.baseline.groups.nbr.glad,
      dat.baseline.groups.edgi

)

# Check 
nrow(baseline_ED_groups)
colnames(baseline_ED_groups)
```

Save dataset
```{r Save final dataset ED baseline groupings}
saveRDS(object = baseline_ED_groups,
        file = paste0("/Users/helenadavies/King's College London/MT-Translational Neuropsychiatric Genomics - Helena_Davies_PhD - Helena_Davies_PhD/EDBeh_SelfHarm/data_cleaned/ED_BASELINE_groups", date, ".rds"))

```
