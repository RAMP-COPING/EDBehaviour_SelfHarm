---
title: "Screener analysis"
author: "Helena Davies"
date: "17/03/2021"
output: html_document
---

```{r Setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      comment=NA,
                      prompt=FALSE,
                      cache=FALSE)
```

Delete everything in your global environment
```{r Delete everything in your global environment}
remove(list = ls())
```

#### Call in library script

```{r source files}
source("./libraries.R")
```

#### Call in functions script

```{r source files}
source("./functions.R")
```

#Retrieve the recent date
```{r Recent date}
date = Sys.Date()
date
```

### Read in EDEQ data
```{r}
dat.edeq <- readRDS(file = "../data_cleaned/dat.edeq.rds")

# Inspect dimensions
dim(dat.edeq)
# Inspect colnames
colnames(dat.edeq)

nrow(dat.edeq)

```



##Exclude participants who are missing for EVERY edeq screener variable at every wave
```{r}
dat.edeq.screener <- dat.edeq %>%
  filter(
    !is.na(`ed_scid5.regular_episodes_eating_binges_.Wave 1`) |
    !is.na(`ed_scid5.regular_episodes_eating_binges_.Wave 2`) |
      !is.na(`ed_scid5.regular_episodes_eating_binges_.Wave 3`) |
      !is.na(`ed_scid5.regular_episodes_eating_binges_.Wave 4`) |
      !is.na(`ed_scid5.regular_episodes_eating_binges_.Wave 5`) |
      !is.na(`ed_scid5.regular_episodes_eating_binges_.Wave 6`) |
      !is.na(`ed_scid5.regular_episodes_eating_binges_.Wave 7`) |
      !is.na(`ed_scid5.regular_episodes_eating_binges_.Wave 8`) |
       !is.na(`ed_scid5.weigh_weighed_past_month_.Wave 1`) |
      !is.na(`ed_scid5.weigh_weighed_past_month_.Wave 2`) |
      !is.na(`ed_scid5.weigh_weighed_past_month_.Wave 3`) |
      !is.na(`ed_scid5.weigh_weighed_past_month_.Wave 4`) |
      !is.na(`ed_scid5.weigh_weighed_past_month_.Wave 5`) |
      !is.na(`ed_scid5.weigh_weighed_past_month_.Wave 6`) |
      !is.na(`ed_scid5.weigh_weighed_past_month_.Wave 7`) |
      !is.na(`ed_scid5.weigh_weighed_past_month_.Wave 8`) |
      !is.na(`ed_scid5.regular_episodes_eating_binges_numeric_.Wave 1`) |
      !is.na(`ed_scid5.regular_episodes_eating_binges_numeric_.Wave 2`) |
      !is.na(`ed_scid5.regular_episodes_eating_binges_numeric_.Wave 3`) |
      !is.na(`ed_scid5.regular_episodes_eating_binges_numeric_.Wave 4`) |
      !is.na(`ed_scid5.regular_episodes_eating_binges_numeric_.Wave 5`) |
      !is.na(`ed_scid5.regular_episodes_eating_binges_numeric_.Wave 6`) |
      !is.na(`ed_scid5.regular_episodes_eating_binges_numeric_.Wave 7`) |
      !is.na(`ed_scid5.regular_episodes_eating_binges_numeric_.Wave 8`) |
      !is.na(`ed_scid5.weigh_weighed_past_month_numeric_.Wave 1`) |
      !is.na(`ed_scid5.weigh_weighed_past_month_numeric_.Wave 2`) |
      !is.na(`ed_scid5.weigh_weighed_past_month_numeric_.Wave 3`) |
      !is.na(`ed_scid5.weigh_weighed_past_month_numeric_.Wave 4`) |
      !is.na(`ed_scid5.weigh_weighed_past_month_numeric_.Wave 5`) |
      !is.na(`ed_scid5.weigh_weighed_past_month_numeric_.Wave 6`) |
      !is.na(`ed_scid5.weigh_weighed_past_month_numeric_.Wave 7`) |
      !is.na(`ed_scid5.weigh_weighed_past_month_numeric_.Wave 8`) 
  )

nrow(dat.edeq.screener)   

```


#Exclude participants who are missing for EVERY edeq screener variable at every wave - BINGE EATING
```{r}

dat.binge.eating <- dat.edeq %>%
  filter(
    !is.na(`ed_scid5.regular_episodes_eating_binges_.Wave 1`) |
    !is.na(`ed_scid5.regular_episodes_eating_binges_.Wave 2`) |
      !is.na(`ed_scid5.regular_episodes_eating_binges_.Wave 3`) |
      !is.na(`ed_scid5.regular_episodes_eating_binges_.Wave 4`) |
      !is.na(`ed_scid5.regular_episodes_eating_binges_.Wave 5`) |
      !is.na(`ed_scid5.regular_episodes_eating_binges_.Wave 6`) |
      !is.na(`ed_scid5.regular_episodes_eating_binges_.Wave 7`) |
      !is.na(`ed_scid5.regular_episodes_eating_binges_.Wave 8`)
  )

nrow(dat.binge.eating)   

```

##Look at numbers for sample sizes of stratified plots - BINGE EATING 
```{r}

dat.binge.eating %>%
  freq(control)

dat.binge.eating %>%
  freq(eating_disorders_numeric)

dat.binge.eating %>%
  freq(gender_unc)

dat.binge.eating %>%
  freq(age_category)


dat.binge.eating %>%
  freq(cohort_name)
```
##Exclude participants who are missing for EVERY edeq screener variable at every wave - LOW WEIGHT
```{r}

dat.low.weight <- dat.edeq %>%
  filter(
    !is.na(`ed_scid5.weigh_weighed_past_month_.Wave 1`) |
    !is.na(`ed_scid5.weigh_weighed_past_month_.Wave 2`) |
      !is.na(`ed_scid5.weigh_weighed_past_month_.Wave 3`) |
      !is.na(`ed_scid5.weigh_weighed_past_month_.Wave 4`) |
      !is.na(`ed_scid5.weigh_weighed_past_month_.Wave 5`) |
      !is.na(`ed_scid5.weigh_weighed_past_month_.Wave 6`) |
      !is.na(`ed_scid5.weigh_weighed_past_month_.Wave 7`) |
      !is.na(`ed_scid5.weigh_weighed_past_month_.Wave 8`)
  )

nrow(dat.low.weight)   

```

##Look at numbers for sample sizes of stratified plots - LOW WEIGHT 
```{r}

dat.low.weight %>%
  freq(control)

dat.low.weight %>%
  freq(eating_disorders_numeric)

dat.low.weight %>%
  freq(gender_unc)

dat.low.weight %>%
  freq(age_category)


dat.low.weight %>%
  freq(cohort_name)
```

##rename columns
```{r}
dat.edeq.screener <- dat.edeq.screener %>% 
  rename(
    #Rename retro prepan waves to be consistent with all wave names
    edeq.sick_means_made_shape_numeric_.Waveretro_prepan = edeq.sick_means_made_shape.1_.Wavebaseline_numeric,
    edeq.felt_anxious_blue_bored.1_.Waveretro_prepan = edeq.felt_anxious_blue_bored.3_.Wavebaseline,
    edeq.diuretics_laxatives_means_shape_numeric_.Waveretro_prepan= edeq.diuretics_laxatives_means_shape.1_.Wavebaseline_numeric,
    edeq.compulsive_driven_burn_calories_numeric_.Waveretro_prepan = edeq.compulsive_driven_burn_calories.1_.Wavebaseline_numeric,
    edeq.nibbled_picked_snacks_grazed_.Waveretro_prepan = edeq.nibbled_picked_snacks_grazed.1_.Wavebaseline,
    edeq.felt_anxious_blue_bored_.Waveretro_prepan = edeq.felt_anxious_blue_bored.2_.Wavebaseline,
    edeq.regard_lost_control_eaten_numeric_.Waveretro_prepan = edeq.regard_lost_control_eaten.1_.Wavebaseline_numeric,
    edeq.calories_made_body_shape_.Waveretro_prepan = edeq.calories_made_body_shape.1_.Wavebaseline,
    edeq.weight_influenced_person_.Waveretro_prepan = edeq.weight_influenced_person.1_.Wavebaseline,
    edeq.dissatisfied_shape_weight_.Waveretro_prepan = edeq.dissatisfied_shape_weight.1_.Wavebaseline,
    edeq.actively_been_monitoring_your_shape_or_weight_numeric_.Waveretro_prepan = edeq.actively_been_monitoring_your_shape_or_weight_.1_.Wavebaseline_numeric,
    edeq.eating_behaviours_distressed_concerns_.Waveretro_prepan = edeq.eating_behaviours_concerns_distressed.1_.Wavebaseline,
    edeq.deliberately_limit_amount_influence_.Waveretro_prepan = edeq.deliberately_limit_amount_influence.1_.Wavebaseline,
    
    ##Rename all baseline waves to be consistent with wave names
    edeq.actively_been_monitoring_your_shape_or_weight_numeric_.Wavebaseline = edeq.actively_been_monitoring_your_shape_or_weight_.Wavebaseline_numeric,
    edeq.regard_lost_control_eaten_numeric_.Wavebaseline = edeq.regard_lost_control_eaten_.Wavebaseline_numeric,
    edeq.sick_means_made_shape_numeric_.Wavebaseline = edeq.sick_means_made_shape_.Wavebaseline_numeric,
    edeq.diuretics_laxatives_means_shape_numeric_.Wavebaseline = edeq.diuretics_laxatives_means_shape_.Wavebaseline_numeric,
    edeq.compulsive_driven_burn_calories_numeric_.Wavebaseline = edeq.compulsive_driven_burn_calories_.Wavebaseline_numeric,
    edeq.nibbled_picked_snacks_grazed_.Wavebaseline = edeq.nibbled_picked_snacks_grazed_.Wavebaseline,
    edeq.felt_anxious_blue_bored_.Wavebaseline = edeq.felt_anxious_blue_bored_.Wavebaseline,
    edeq.calories_made_body_shape_.Wavebaseline = edeq.calories_made_body_shape_.Wavebaseline,
    edeq.weight_influenced_person_.Wavebaseline = edeq.weight_influenced_person_.Wavebaseline,
    edeq.dissatisfied_shape_weight_.Wavebaseline = edeq.dissatisfied_shape_weight_.Wavebaseline,
    edeq.eating_behaviours_distressed_concerns_.Wavebaseline = edeq.eating_behaviours_concerns_distressed_.Wavebaseline,
    edeq.felt_anxious_blue_bored.1_.Wavebaseline = edeq.felt_anxious_blue_bored.1_.Wavebaseline,
    edeq.deliberately_limit_amount_influence_.Wavebaseline = edeq.deliberately_limit_amount_influence_.Wavebaseline,
    
    ##Rename all screeners so that they start with "edeq"
    `edeq.ed_scid5.regular_episodes_eating_binges_.Wave 1` = `ed_scid5.regular_episodes_eating_binges_.Wave 1`,
    `edeq.ed_scid5.regular_episodes_eating_binges_.Wave 2`  =  `ed_scid5.regular_episodes_eating_binges_.Wave 2`,
    `edeq.ed_scid5.regular_episodes_eating_binges_.Wave 3`  =  `ed_scid5.regular_episodes_eating_binges_.Wave 3`,
    `edeq.ed_scid5.regular_episodes_eating_binges_.Wave 4`  =  `ed_scid5.regular_episodes_eating_binges_.Wave 4`,
    `edeq.ed_scid5.regular_episodes_eating_binges_.Wave 5`  =  `ed_scid5.regular_episodes_eating_binges_.Wave 5`,
    `edeq.ed_scid5.regular_episodes_eating_binges_.Wave 6`  =  `ed_scid5.regular_episodes_eating_binges_.Wave 6`,
    `edeq.ed_scid5.regular_episodes_eating_binges_.Wave 7`  =  `ed_scid5.regular_episodes_eating_binges_.Wave 7`,
    `edeq.ed_scid5.regular_episodes_eating_binges_.Wave 8`  =  `ed_scid5.regular_episodes_eating_binges_.Wave 8`,

     `edeq.ed_scid5.weigh_weighed_past_month_.Wave 1`  = `ed_scid5.weigh_weighed_past_month_.Wave 1`,
    `edeq.ed_scid5.weigh_weighed_past_month_.Wave 2` =  `ed_scid5.weigh_weighed_past_month_.Wave 2`,
    `edeq.ed_scid5.weigh_weighed_past_month_.Wave 3` =  `ed_scid5.weigh_weighed_past_month_.Wave 3` ,
    `edeq.ed_scid5.weigh_weighed_past_month_.Wave 4` =  `ed_scid5.weigh_weighed_past_month_.Wave 4`,
    `edeq.ed_scid5.weigh_weighed_past_month_.Wave 5` =  `ed_scid5.weigh_weighed_past_month_.Wave 5`,
    `edeq.ed_scid5.weigh_weighed_past_month_.Wave 6` =  `ed_scid5.weigh_weighed_past_month_.Wave 6` ,  
    `edeq.ed_scid5.weigh_weighed_past_month_.Wave 7` =  `ed_scid5.weigh_weighed_past_month_.Wave 7` , 
    `edeq.ed_scid5.weigh_weighed_past_month_.Wave 8` =  `ed_scid5.weigh_weighed_past_month_.Wave 8`  
    

)


```



##Select variables for dataset
```{r}
dat.edeq.screener <- dat.edeq.screener %>%
  select(
    ID,                                                                                                                                            
         sex,
         cohort_name,
         gender_unc,  
         current_country, 
         uk_location,
         age_category,
         age_category_numeric,
         highest_education_prepan_numeric,
         highest_education_numeric,
         employment_prior_covid,
    anorexia_group_numeric, 
    COPING_anorexia_group_numeric,
    bulimia_group_numeric,
    COPING_bulimia_group_numeric,
  BED_group_numeric,
  COPING_bed_group_numeric,
         ethnicity,  
         key_worker, 
         employment_change, 
         highest_education_prepan,                                                                                                        
         highest_education,                                                                                                                  
         employment_prior_covid_numeric,                                                                                                         
         employment_change_numeric,                                                                                                                     
         key_worker_numeric,   
         control,                                                                     
         control_numeric,
         mhd.other_eating_disorder_numeric,
         depressive_disorders_numeric,
         eating_disorders_numeric,
         anxiety_disorders_numeric, 
         psychotic_disorders_numeric,
         mhd.suspected_eating_disorder_diagnosed_numeric,
         obsessive_compulsive_disorders_numeric,
         mhd.anorexia_nervosa_numeric,
         mhd.bulimia_nervosa_numeric,
         mhd.attention_deficit_hyperactivity_disorder_numeric,
         mhd.posttraumatic_stress_disorder_ptsd_numeric,
         mhd.bingeeating_disorder_numeric,
         mhd.purging_disorder_numeric,
         mhd.mania_hypomania_bipolar_or_manicdepression_numeric,                                                     
         autism_spectrum_disorder_numeric,                                                                     
         mhd.personality_disorder_numeric,                                                                          
         mhd.body_dysmorphic_disorder_bdd_numeric,                                                                                     
         mhd.atypical_anorexia_nervosa_numeric,                                                                                         
         mhd.atypical_bulimia_nervosa_numeric,
         mhd.pica_numeric,
         mhd.rumination_disorder_numeric,
         mhd.atypical_bingeeating_disorder_numeric,                                                                                    
         mhd.night_eating_syndrome_numeric,                                                                                                        
         mhd.avoidantrestrictive_food_intake_disorder_numeric,                                                                      
         mhd.feeding_eating_disorder_numeric,
    `edeq.deliberately_limit_amount_influence_.Waveretro_prepan`,                                            
         `edeq.deliberately_limit_amount_influence_.Wavebaseline`, 
     `edeq.deliberately_limit_amount_influence_.Wave 1`, 
         `edeq.deliberately_limit_amount_influence_.Wave 2`,                          
         `edeq.deliberately_limit_amount_influence_.Wave 3`,
         `edeq.deliberately_limit_amount_influence_.Wave 4`, 
         `edeq.deliberately_limit_amount_influence_.Wave 5`,                                                    
         `edeq.deliberately_limit_amount_influence_.Wave 6`,  
         `edeq.deliberately_limit_amount_influence_.Wave 7`,
         `edeq.deliberately_limit_amount_influence_.Wave 8`,
         `edeq.calories_made_body_shape_.Waveretro_prepan`,  
         `edeq.calories_made_body_shape_.Wavebaseline`,  
         `edeq.calories_made_body_shape_.Wave 1`,
         `edeq.calories_made_body_shape_.Wave 2`,                                     
         `edeq.calories_made_body_shape_.Wave 3`,                                                                          
         `edeq.calories_made_body_shape_.Wave 4`,
         `edeq.calories_made_body_shape_.Wave 5`, 
         `edeq.calories_made_body_shape_.Wave 6`,
         `edeq.calories_made_body_shape_.Wave 7`,
         `edeq.calories_made_body_shape_.Wave 8`,
         `edeq.weight_influenced_person_.Waveretro_prepan`,
         `edeq.weight_influenced_person_.Wavebaseline`, 
         `edeq.weight_influenced_person_.Wave 1`,
         `edeq.weight_influenced_person_.Wave 2`,                                     
         `edeq.weight_influenced_person_.Wave 3`, 
         `edeq.weight_influenced_person_.Wave 4`,  
         `edeq.weight_influenced_person_.Wave 5`,                                                                            
         `edeq.weight_influenced_person_.Wave 6`,
         `edeq.weight_influenced_person_.Wave 7`,
          `edeq.weight_influenced_person_.Wave 8`,
         `edeq.dissatisfied_shape_weight_.Waveretro_prepan`, 
         `edeq.dissatisfied_shape_weight_.Wavebaseline`, 
          `edeq.dissatisfied_shape_weight_.Wave 1`,
         `edeq.dissatisfied_shape_weight_.Wave 2`,                                    
         `edeq.dissatisfied_shape_weight_.Wave 3`,                                                                         
         `edeq.dissatisfied_shape_weight_.Wave 4`,                                                                          
         `edeq.dissatisfied_shape_weight_.Wave 5`, 
         `edeq.dissatisfied_shape_weight_.Wave 6`,
         `edeq.dissatisfied_shape_weight_.Wave 7`,
         `edeq.dissatisfied_shape_weight_.Wave 8`,
         `edeq.eating_behaviours_distressed_concerns_.Waveretro_prepan`,       
         `edeq.eating_behaviours_distressed_concerns_.Wavebaseline`,
         `edeq.eating_behaviours_distressed_concerns_.Wave 1`,
         `edeq.eating_behaviours_distressed_concerns_.Wave 2`,                        
         `edeq.eating_behaviours_distressed_concerns_.Wave 3`,
         `edeq.eating_behaviours_distressed_concerns_.Wave 4`,
         `edeq.eating_behaviours_distressed_concerns_.Wave 5`,
         `edeq.eating_behaviours_distressed_concerns_.Wave 6`,
          `edeq.eating_behaviours_distressed_concerns_.Wave 7`,
         `edeq.eating_behaviours_distressed_concerns_.Wave 8`,
         `edeq.actively_been_monitoring_your_shape_or_weight_numeric_.Waveretro_prepan`,                  
         `edeq.actively_been_monitoring_your_shape_or_weight_numeric_.Wavebaseline`,  
    `edeq.actively_been_monitoring_your_shape_or_weight_numeric_.Wave 1`,
         `edeq.actively_been_monitoring_your_shape_or_weight_numeric_.Wave 2`,        
         `edeq.actively_been_monitoring_your_shape_or_weight_numeric_.Wave 3`, 
         `edeq.actively_been_monitoring_your_shape_or_weight_numeric_.Wave 4`,
         `edeq.actively_been_monitoring_your_shape_or_weight_numeric_.Wave 5`,
         `edeq.actively_been_monitoring_your_shape_or_weight_numeric_.Wave 6`,
    `edeq.actively_been_monitoring_your_shape_or_weight_numeric_.Wave 7`,
         `edeq.actively_been_monitoring_your_shape_or_weight_numeric_.Wave 8`,
         `edeq.regard_lost_control_eaten_numeric_.Waveretro_prepan`,  
         `edeq.regard_lost_control_eaten_numeric_.Wavebaseline`,  
    `edeq.regard_lost_control_eaten_numeric_.Wave 1`,
         `edeq.regard_lost_control_eaten_numeric_.Wave 2`,                            
         `edeq.regard_lost_control_eaten_numeric_.Wave 3`, 
         `edeq.regard_lost_control_eaten_numeric_.Wave 4`,
         `edeq.regard_lost_control_eaten_numeric_.Wave 5`,
         `edeq.regard_lost_control_eaten_numeric_.Wave 6`,
    `edeq.regard_lost_control_eaten_numeric_.Wave 7`,
         `edeq.regard_lost_control_eaten_numeric_.Wave 8`,
         `edeq.sick_means_made_shape_numeric_.Waveretro_prepan`,                             
         `edeq.sick_means_made_shape_numeric_.Wavebaseline`, 
    `edeq.sick_means_made_shape_numeric_.Wave 1`,
         `edeq.sick_means_made_shape_numeric_.Wave 2`,                                
         `edeq.sick_means_made_shape_numeric_.Wave 3`,
         `edeq.sick_means_made_shape_numeric_.Wave 4`,
         `edeq.sick_means_made_shape_numeric_.Wave 5`,
         `edeq.sick_means_made_shape_numeric_.Wave 6`,
         `edeq.sick_means_made_shape_numeric_.Wave 7`,
         `edeq.sick_means_made_shape_numeric_.Wave 8`,
         `edeq.diuretics_laxatives_means_shape_numeric_.Waveretro_prepan`,       
         `edeq.diuretics_laxatives_means_shape_numeric_.Wavebaseline`, 
    `edeq.diuretics_laxatives_means_shape_numeric_.Wave 1`,
         `edeq.diuretics_laxatives_means_shape_numeric_.Wave 2`,                      
         `edeq.diuretics_laxatives_means_shape_numeric_.Wave 3`,
         `edeq.diuretics_laxatives_means_shape_numeric_.Wave 4`,
         `edeq.diuretics_laxatives_means_shape_numeric_.Wave 5`,
         `edeq.diuretics_laxatives_means_shape_numeric_.Wave 6`,
    `edeq.diuretics_laxatives_means_shape_numeric_.Wave 7`,
         `edeq.diuretics_laxatives_means_shape_numeric_.Wave 8`,
         `edeq.compulsive_driven_burn_calories_numeric_.Waveretro_prepan`,
         `edeq.compulsive_driven_burn_calories_numeric_.Wavebaseline`, 
     `edeq.compulsive_driven_burn_calories_numeric_.Wave 1`, 
         `edeq.compulsive_driven_burn_calories_numeric_.Wave 2`,                      
         `edeq.compulsive_driven_burn_calories_numeric_.Wave 3`,
         `edeq.compulsive_driven_burn_calories_numeric_.Wave 4`,
         `edeq.compulsive_driven_burn_calories_numeric_.Wave 5`,
         `edeq.compulsive_driven_burn_calories_numeric_.Wave 6`,
    `edeq.compulsive_driven_burn_calories_numeric_.Wave 7`,
         `edeq.compulsive_driven_burn_calories_numeric_.Wave 8`,
         `edeq.nibbled_picked_snacks_grazed_.Waveretro_prepan`,                                                   
         `edeq.nibbled_picked_snacks_grazed_.Wavebaseline`,    
     `edeq.nibbled_picked_snacks_grazed_.Wave 1`, 
         `edeq.nibbled_picked_snacks_grazed_.Wave 2`,                                 
         `edeq.nibbled_picked_snacks_grazed_.Wave 3`, 
         `edeq.nibbled_picked_snacks_grazed_.Wave 4`,
         `edeq.nibbled_picked_snacks_grazed_.Wave 5`,
         `edeq.nibbled_picked_snacks_grazed_.Wave 6`,
    `edeq.nibbled_picked_snacks_grazed_.Wave 7`,
         `edeq.nibbled_picked_snacks_grazed_.Wave 8`,
         `edeq.felt_anxious_blue_bored.1_.Waveretro_prepan`,     
         `edeq.felt_anxious_blue_bored.1_.Wavebaseline`,
    `edeq.felt_anxious_blue_bored.1_.Wave 1`,
         `edeq.felt_anxious_blue_bored.1_.Wave 2`,                                    
         `edeq.felt_anxious_blue_bored.1_.Wave 3`,
         `edeq.felt_anxious_blue_bored.1_.Wave 4`,
         `edeq.felt_anxious_blue_bored.1_.Wave 5`, 
         `edeq.felt_anxious_blue_bored.1_.Wave 6`,
         `edeq.felt_anxious_blue_bored.1_.Wave 7`,
         `edeq.felt_anxious_blue_bored.1_.Wave 8`,
         `edeq.felt_anxious_blue_bored_.Wavebaseline`,     
         `edeq.felt_anxious_blue_bored_.Waveretro_prepan`, 
    `edeq.felt_anxious_blue_bored_.Wave 1`,
         `edeq.felt_anxious_blue_bored_.Wave 2`,                                      
         `edeq.felt_anxious_blue_bored_.Wave 3`,
         `edeq.felt_anxious_blue_bored_.Wave 4`,
         `edeq.felt_anxious_blue_bored_.Wave 5`,
         `edeq.felt_anxious_blue_bored_.Wave 6`,
         `edeq.felt_anxious_blue_bored_.Wave 7`,
         `edeq.felt_anxious_blue_bored_.Wave 8`,
       `edeq.ed_scid5.regular_episodes_eating_binges_.Wave 1` ,
       `edeq.ed_scid5.regular_episodes_eating_binges_.Wave 2` ,
       `edeq.ed_scid5.regular_episodes_eating_binges_.Wave 3` ,
       `edeq.ed_scid5.regular_episodes_eating_binges_.Wave 4` ,
       `edeq.ed_scid5.regular_episodes_eating_binges_.Wave 5` ,
       `edeq.ed_scid5.regular_episodes_eating_binges_.Wave 6` ,
       `edeq.ed_scid5.regular_episodes_eating_binges_.Wave 7` ,
       `edeq.ed_scid5.regular_episodes_eating_binges_.Wave 8` ,
       `edeq.ed_scid5.weigh_weighed_past_month_.Wave 1` ,
       `edeq.ed_scid5.weigh_weighed_past_month_.Wave 2` ,
       `edeq.ed_scid5.weigh_weighed_past_month_.Wave 3` ,
       `edeq.ed_scid5.weigh_weighed_past_month_.Wave 4` ,
       `edeq.ed_scid5.weigh_weighed_past_month_.Wave 5` ,
       `edeq.ed_scid5.weigh_weighed_past_month_.Wave 6` ,
       `edeq.ed_scid5.weigh_weighed_past_month_.Wave 7` ,
       `edeq.ed_scid5.weigh_weighed_past_month_.Wave 8` ) 
    

```


##Change numerics to factor for restructuring to long       
```{r }
dat.edeq.screener$edeq.actively_been_monitoring_your_shape_or_weight_numeric_.Waveretro_prepan <- as.factor(dat.edeq.screener$edeq.actively_been_monitoring_your_shape_or_weight_numeric_.Waveretro_prepan)                 

dat.edeq.screener$edeq.actively_been_monitoring_your_shape_or_weight_numeric_.Wavebaseline <- as.factor(dat.edeq.screener$edeq.actively_been_monitoring_your_shape_or_weight_numeric_.Wavebaseline)                 

dat.edeq.screener$`edeq.actively_been_monitoring_your_shape_or_weight_numeric_.Wave 1` <- as.factor(dat.edeq.screener$`edeq.actively_been_monitoring_your_shape_or_weight_numeric_.Wave 1`)                 


dat.edeq.screener$`edeq.actively_been_monitoring_your_shape_or_weight_numeric_.Wave 2` <- as.factor(dat.edeq.screener$`edeq.actively_been_monitoring_your_shape_or_weight_numeric_.Wave 2`)                 

dat.edeq.screener$`edeq.actively_been_monitoring_your_shape_or_weight_numeric_.Wave 3` <- as.factor(dat.edeq.screener$`edeq.actively_been_monitoring_your_shape_or_weight_numeric_.Wave 3`)                 

dat.edeq.screener$`edeq.actively_been_monitoring_your_shape_or_weight_numeric_.Wave 4` <- as.factor(dat.edeq.screener$`edeq.actively_been_monitoring_your_shape_or_weight_numeric_.Wave 4`)                 

dat.edeq.screener$`edeq.actively_been_monitoring_your_shape_or_weight_numeric_.Wave 5` <- as.factor(dat.edeq.screener$`edeq.actively_been_monitoring_your_shape_or_weight_numeric_.Wave 5`)                 

dat.edeq.screener$`edeq.actively_been_monitoring_your_shape_or_weight_numeric_.Wave 6` <- as.factor(dat.edeq.screener$`edeq.actively_been_monitoring_your_shape_or_weight_numeric_.Wave 6`)   

dat.edeq.screener$`edeq.actively_been_monitoring_your_shape_or_weight_numeric_.Wave 7` <- as.factor(dat.edeq.screener$`edeq.actively_been_monitoring_your_shape_or_weight_numeric_.Wave 7`)                 


dat.edeq.screener$`edeq.actively_been_monitoring_your_shape_or_weight_numeric_.Wave 8` <- as.factor(dat.edeq.screener$`edeq.actively_been_monitoring_your_shape_or_weight_numeric_.Wave 8`)                 

dat.edeq.screener$`edeq.regard_lost_control_eaten_numeric_.Waveretro_prepan` <- as.factor(dat.edeq.screener$`edeq.regard_lost_control_eaten_numeric_.Waveretro_prepan`)                 

dat.edeq.screener$`edeq.regard_lost_control_eaten_numeric_.Wavebaseline` <- as.factor(dat.edeq.screener$`edeq.regard_lost_control_eaten_numeric_.Wavebaseline`) 

dat.edeq.screener$`edeq.regard_lost_control_eaten_numeric_.Wave 1` <- as.factor(dat.edeq.screener$`edeq.regard_lost_control_eaten_numeric_.Wave 1`)    


dat.edeq.screener$`edeq.regard_lost_control_eaten_numeric_.Wave 2` <- as.factor(dat.edeq.screener$`edeq.regard_lost_control_eaten_numeric_.Wave 2`)    

dat.edeq.screener$`edeq.regard_lost_control_eaten_numeric_.Wave 3` <- as.factor(dat.edeq.screener$`edeq.regard_lost_control_eaten_numeric_.Wave 3`)                 

dat.edeq.screener$`edeq.regard_lost_control_eaten_numeric_.Wave 4` <- as.factor(dat.edeq.screener$`edeq.regard_lost_control_eaten_numeric_.Wave 4`)                 

dat.edeq.screener$`edeq.regard_lost_control_eaten_numeric_.Wave 5` <- as.factor(dat.edeq.screener$`edeq.regard_lost_control_eaten_numeric_.Wave 5`)                 

dat.edeq.screener$`edeq.regard_lost_control_eaten_numeric_.Wave 6` <- as.factor(dat.edeq.screener$`edeq.regard_lost_control_eaten_numeric_.Wave 6`)

dat.edeq.screener$`edeq.regard_lost_control_eaten_numeric_.Wave 7` <- as.factor(dat.edeq.screener$`edeq.regard_lost_control_eaten_numeric_.Wave 7`)                 


dat.edeq.screener$`edeq.regard_lost_control_eaten_numeric_.Wave 8` <- as.factor(dat.edeq.screener$`edeq.regard_lost_control_eaten_numeric_.Wave 8`)                 

dat.edeq.screener$`edeq.sick_means_made_shape_numeric_.Waveretro_prepan` <- as.factor(dat.edeq.screener$`edeq.sick_means_made_shape_numeric_.Waveretro_prepan`)                 

dat.edeq.screener$`edeq.sick_means_made_shape_numeric_.Wavebaseline` <- as.factor(dat.edeq.screener$`edeq.sick_means_made_shape_numeric_.Wavebaseline`)    

dat.edeq.screener$`edeq.sick_means_made_shape_numeric_.Wave 1` <- as.factor(dat.edeq.screener$`edeq.sick_means_made_shape_numeric_.Wave 1`)  


dat.edeq.screener$`edeq.sick_means_made_shape_numeric_.Wave 2` <- as.factor(dat.edeq.screener$`edeq.sick_means_made_shape_numeric_.Wave 2`)  

dat.edeq.screener$`edeq.sick_means_made_shape_numeric_.Wave 3` <- as.factor(dat.edeq.screener$`edeq.sick_means_made_shape_numeric_.Wave 3`)      

dat.edeq.screener$`edeq.sick_means_made_shape_numeric_.Wave 4` <- as.factor(dat.edeq.screener$`edeq.sick_means_made_shape_numeric_.Wave 4`)     

dat.edeq.screener$`edeq.sick_means_made_shape_numeric_.Wave 5` <- as.factor(dat.edeq.screener$`edeq.sick_means_made_shape_numeric_.Wave 5`)     

dat.edeq.screener$`edeq.sick_means_made_shape_numeric_.Wave 6` <- as.factor(dat.edeq.screener$`edeq.sick_means_made_shape_numeric_.Wave 6`)   

dat.edeq.screener$`edeq.sick_means_made_shape_numeric_.Wave 7` <- as.factor(dat.edeq.screener$`edeq.sick_means_made_shape_numeric_.Wave 7`)   

dat.edeq.screener$`edeq.sick_means_made_shape_numeric_.Wave 8` <- as.factor(dat.edeq.screener$`edeq.sick_means_made_shape_numeric_.Wave 8`)                 

dat.edeq.screener$`edeq.diuretics_laxatives_means_shape_numeric_.Waveretro_prepan` <- as.factor(dat.edeq.screener$`edeq.diuretics_laxatives_means_shape_numeric_.Waveretro_prepan`)                 

dat.edeq.screener$`edeq.diuretics_laxatives_means_shape_numeric_.Wavebaseline` <- as.factor(dat.edeq.screener$`edeq.diuretics_laxatives_means_shape_numeric_.Wavebaseline`) 

dat.edeq.screener$`edeq.diuretics_laxatives_means_shape_numeric_.Wave 1` <- as.factor(dat.edeq.screener$`edeq.diuretics_laxatives_means_shape_numeric_.Wave 1`)     


dat.edeq.screener$`edeq.diuretics_laxatives_means_shape_numeric_.Wave 2` <- as.factor(dat.edeq.screener$`edeq.diuretics_laxatives_means_shape_numeric_.Wave 2`)     

dat.edeq.screener$`edeq.diuretics_laxatives_means_shape_numeric_.Wave 3` <- as.factor(dat.edeq.screener$`edeq.diuretics_laxatives_means_shape_numeric_.Wave 3`)      

dat.edeq.screener$`edeq.diuretics_laxatives_means_shape_numeric_.Wave 4` <- as.factor(dat.edeq.screener$`edeq.diuretics_laxatives_means_shape_numeric_.Wave 4`)    

dat.edeq.screener$`edeq.diuretics_laxatives_means_shape_numeric_.Wave 5` <- as.factor(dat.edeq.screener$`edeq.diuretics_laxatives_means_shape_numeric_.Wave 5`)   

dat.edeq.screener$`edeq.diuretics_laxatives_means_shape_numeric_.Wave 6` <- as.factor(dat.edeq.screener$`edeq.diuretics_laxatives_means_shape_numeric_.Wave 6`)  

dat.edeq.screener$`edeq.diuretics_laxatives_means_shape_numeric_.Wave 7` <- as.factor(dat.edeq.screener$`edeq.diuretics_laxatives_means_shape_numeric_.Wave 7`)  


dat.edeq.screener$`edeq.diuretics_laxatives_means_shape_numeric_.Wave 8` <- as.factor(dat.edeq.screener$`edeq.diuretics_laxatives_means_shape_numeric_.Wave 8`)                 

dat.edeq.screener$`edeq.compulsive_driven_burn_calories_numeric_.Waveretro_prepan` <- as.factor(dat.edeq.screener$`edeq.compulsive_driven_burn_calories_numeric_.Waveretro_prepan`)

dat.edeq.screener$`edeq.compulsive_driven_burn_calories_numeric_.Wavebaseline` <- as.factor(dat.edeq.screener$`edeq.compulsive_driven_burn_calories_numeric_.Wavebaseline`)       

dat.edeq.screener$`edeq.compulsive_driven_burn_calories_numeric_.Wave 1` <- as.factor(dat.edeq.screener$`edeq.compulsive_driven_burn_calories_numeric_.Wave 1`)    


dat.edeq.screener$`edeq.compulsive_driven_burn_calories_numeric_.Wave 2` <- as.factor(dat.edeq.screener$`edeq.compulsive_driven_burn_calories_numeric_.Wave 2`)    

dat.edeq.screener$`edeq.compulsive_driven_burn_calories_numeric_.Wave 3` <- as.factor(dat.edeq.screener$`edeq.compulsive_driven_burn_calories_numeric_.Wave 3`)      

dat.edeq.screener$`edeq.compulsive_driven_burn_calories_numeric_.Wave 4` <- as.factor(dat.edeq.screener$`edeq.compulsive_driven_burn_calories_numeric_.Wave 4`) 

dat.edeq.screener$`edeq.compulsive_driven_burn_calories_numeric_.Wave 5` <- as.factor(dat.edeq.screener$`edeq.compulsive_driven_burn_calories_numeric_.Wave 5`)

dat.edeq.screener$`edeq.compulsive_driven_burn_calories_numeric_.Wave 6` <- as.factor(dat.edeq.screener$`edeq.compulsive_driven_burn_calories_numeric_.Wave 6`)  

dat.edeq.screener$`edeq.compulsive_driven_burn_calories_numeric_.Wave 7` <- as.factor(dat.edeq.screener$`edeq.compulsive_driven_burn_calories_numeric_.Wave 7`)  

dat.edeq.screener$`edeq.compulsive_driven_burn_calories_numeric_.Wave 8` <- as.factor(dat.edeq.screener$`edeq.compulsive_driven_burn_calories_numeric_.Wave 8`)                 

```



## Restructure data into long ADD ID COLS = ID HERE ***HLD 
```{r }

dat.edeq.screener <- dat.edeq.screener %>%
  pivot_longer(
    cols = (starts_with("edeq") &
              contains(".Wave")),
    names_to = "wave_edeq",
    values_to = "value") %>%
  separate(wave_edeq, into = c("edeq", "wave"), sep = "_.Wave", remove = TRUE) %>%
  pivot_wider(
     names_from = "edeq",
     values_from = "value")

```



##Check how many participants answered each wave - BINGE EATING RAMP
```{r}

dat.edeq.1 <- dat.edeq.screener %>%
  filter(wave == " 1" &
           cohort_name == "ramp" &
           !is.na(edeq.ed_scid5.regular_episodes_eating_binges)
         )
  

table(dat.edeq.1$wave)


dat.edeq.2 <- dat.edeq.screener %>%
  filter(wave == " 2" &
           cohort_name == "ramp" &
           !is.na(edeq.ed_scid5.regular_episodes_eating_binges)
         )
  

table(dat.edeq.2$wave)

dat.edeq.3 <- dat.edeq.screener %>%
  filter(wave == " 3" &
           cohort_name == "ramp" &
           !is.na(edeq.ed_scid5.regular_episodes_eating_binges)
         )
  

table(dat.edeq.3$wave)


dat.edeq.4 <- dat.edeq.screener %>%
  filter(wave == " 4" &
           cohort_name == "ramp" &
           !is.na(edeq.ed_scid5.regular_episodes_eating_binges)
         )
  

table(dat.edeq.4$wave)

dat.edeq.5 <- dat.edeq.screener %>%
  filter(wave == " 5" &
           cohort_name == "ramp" &
           !is.na(edeq.ed_scid5.regular_episodes_eating_binges)
         )
  

table(dat.edeq.5$wave)


dat.edeq.6 <- dat.edeq.screener %>%
  filter(wave == " 6" &
           cohort_name == "ramp" &
           !is.na(edeq.ed_scid5.regular_episodes_eating_binges)
         )
  

table(dat.edeq.6$wave)

dat.edeq.7 <- dat.edeq.screener %>%
  filter(wave == " 7" &
           cohort_name == "ramp" &
           !is.na(edeq.ed_scid5.regular_episodes_eating_binges)
         )
  

table(dat.edeq.7$wave)

dat.edeq.8 <- dat.edeq.screener %>%
  filter(wave == " 8" &
           cohort_name == "ramp" &
           !is.na(edeq.ed_scid5.regular_episodes_eating_binges)
         )
  

table(dat.edeq.8$wave)
```
##Check how many participants answered each wave - BINGE EATING COPING
```{r}

dat.edeq.1 <- dat.edeq.screener %>%
  filter(wave == " 1" &
           (cohort_name == "nbr" |
           cohort_name == "coping_edgi" |
           cohort_name == "coping_glad") &
           !is.na(edeq.ed_scid5.regular_episodes_eating_binges)
         )
  

table(dat.edeq.1$wave)


dat.edeq.2 <- dat.edeq.screener %>%
  filter(wave == " 2" &
           (cohort_name == "nbr" |            cohort_name == "coping_edgi" |            cohort_name == "coping_glad") &
           !is.na(edeq.ed_scid5.regular_episodes_eating_binges)
         )
  

table(dat.edeq.2$wave)

dat.edeq.3 <- dat.edeq.screener %>%
  filter(wave == " 3" &
           (cohort_name == "nbr" |            cohort_name == "coping_edgi" |            cohort_name == "coping_glad") &
           !is.na(edeq.ed_scid5.regular_episodes_eating_binges)
         )
  

table(dat.edeq.3$wave)


dat.edeq.4 <- dat.edeq.screener %>%
  filter(wave == " 4" &
           (cohort_name == "nbr" |            cohort_name == "coping_edgi" |            cohort_name == "coping_glad") &
           !is.na(edeq.ed_scid5.regular_episodes_eating_binges)
         )
  

table(dat.edeq.4$wave)

dat.edeq.5 <- dat.edeq.screener %>%
  filter(wave == " 5" &
           (cohort_name == "nbr" |            cohort_name == "coping_edgi" |            cohort_name == "coping_glad") &
           !is.na(edeq.ed_scid5.regular_episodes_eating_binges)
         )
  

table(dat.edeq.5$wave)


dat.edeq.6 <- dat.edeq.screener %>%
  filter(wave == " 6" &
           (cohort_name == "nbr" |            cohort_name == "coping_edgi" |            cohort_name == "coping_glad") &
           !is.na(edeq.ed_scid5.regular_episodes_eating_binges)
         )
  

table(dat.edeq.6$wave)

dat.edeq.7 <- dat.edeq.screener %>%
  filter(wave == " 7" &
           (cohort_name == "nbr" |            cohort_name == "coping_edgi" |            cohort_name == "coping_glad") &
           !is.na(edeq.ed_scid5.regular_episodes_eating_binges)
         )
  

table(dat.edeq.7$wave)

dat.edeq.8 <- dat.edeq.screener %>%
  filter(wave == " 8" &
           (cohort_name == "nbr" |            cohort_name == "coping_edgi" |            cohort_name == "coping_glad") &
           !is.na(edeq.ed_scid5.regular_episodes_eating_binges)
         )
  

table(dat.edeq.8$wave)
```


##Check how many participants answered each wave - LOW WEIGHT RAMP
```{r}

dat.edeq.1 <- dat.edeq.screener %>%
  filter(wave == " 1" &
           cohort_name == "ramp" &
           !is.na(edeq.ed_scid5.weigh_weighed_past_month)
         )
  

table(dat.edeq.1$wave)


dat.edeq.2 <- dat.edeq.screener %>%
  filter(wave == " 2" &
           cohort_name == "ramp" &
           !is.na(edeq.ed_scid5.weigh_weighed_past_month)
         )
  

table(dat.edeq.2$wave)

dat.edeq.3 <- dat.edeq.screener %>%
  filter(wave == " 3" &
           cohort_name == "ramp" &
           !is.na(edeq.ed_scid5.weigh_weighed_past_month)
         )
  

table(dat.edeq.3$wave)


dat.edeq.4 <- dat.edeq.screener %>%
  filter(wave == " 4" &
           cohort_name == "ramp" &
           !is.na(edeq.ed_scid5.weigh_weighed_past_month)
         )
  

table(dat.edeq.4$wave)

dat.edeq.5 <- dat.edeq.screener %>%
  filter(wave == " 5" &
           cohort_name == "ramp" &
           !is.na(edeq.ed_scid5.weigh_weighed_past_month)
         )
  

table(dat.edeq.5$wave)


dat.edeq.6 <- dat.edeq.screener %>%
  filter(wave == " 6" &
           cohort_name == "ramp" &
           !is.na(edeq.ed_scid5.weigh_weighed_past_month)
         )
  

table(dat.edeq.6$wave)

dat.edeq.7 <- dat.edeq.screener %>%
  filter(wave == " 7" &
           cohort_name == "ramp" &
           !is.na(edeq.ed_scid5.weigh_weighed_past_month)
         )
  

table(dat.edeq.7$wave)

dat.edeq.8 <- dat.edeq.screener %>%
  filter(wave == " 8" &
           cohort_name == "ramp" &
           !is.na(edeq.ed_scid5.weigh_weighed_past_month)
         )
  

table(dat.edeq.8$wave)
```

##Check how many participants answered each wave - LOW WEIGHT COPING
```{r}

dat.edeq.1 <- dat.edeq.screener %>%
  filter(wave == " 1" &
           (cohort_name == "nbr" |
           cohort_name == "coping_edgi" |
           cohort_name == "coping_glad") &
           !is.na(edeq.ed_scid5.weigh_weighed_past_month)
         )
  

table(dat.edeq.1$wave)


dat.edeq.2 <- dat.edeq.screener %>%
  filter(wave == " 2" &
           (cohort_name == "nbr" |            cohort_name == "coping_edgi" |            cohort_name == "coping_glad") &
           !is.na(edeq.ed_scid5.weigh_weighed_past_month)
         )
  

table(dat.edeq.2$wave)

dat.edeq.3 <- dat.edeq.screener %>%
  filter(wave == " 3" &
           (cohort_name == "nbr" |            cohort_name == "coping_edgi" |            cohort_name == "coping_glad") &
           !is.na(edeq.ed_scid5.weigh_weighed_past_month)
         )
  

table(dat.edeq.3$wave)


dat.edeq.4 <- dat.edeq.screener %>%
  filter(wave == " 4" &
           (cohort_name == "nbr" |            cohort_name == "coping_edgi" |            cohort_name == "coping_glad") &
           !is.na(edeq.ed_scid5.weigh_weighed_past_month)
         )
  

table(dat.edeq.4$wave)

dat.edeq.5 <- dat.edeq.screener %>%
  filter(wave == " 5" &
           (cohort_name == "nbr" |            cohort_name == "coping_edgi" |            cohort_name == "coping_glad") &
           !is.na(edeq.ed_scid5.weigh_weighed_past_month)
         )
  

table(dat.edeq.5$wave)


dat.edeq.6 <- dat.edeq.screener %>%
  filter(wave == " 6" &
           (cohort_name == "nbr" |            cohort_name == "coping_edgi" |            cohort_name == "coping_glad") &
           !is.na(edeq.ed_scid5.weigh_weighed_past_month)
         )
  

table(dat.edeq.6$wave)

dat.edeq.7 <- dat.edeq.screener %>%
  filter(wave == " 7" &
           (cohort_name == "nbr" |            cohort_name == "coping_edgi" |            cohort_name == "coping_glad") &
           !is.na(edeq.ed_scid5.weigh_weighed_past_month)
         )
  

table(dat.edeq.7$wave)

dat.edeq.8 <- dat.edeq.screener %>%
  filter(wave == " 8" &
           (cohort_name == "nbr" |            cohort_name == "coping_edgi" |            cohort_name == "coping_glad") &
           !is.na(edeq.ed_scid5.weigh_weighed_past_month)
         )
  

table(dat.edeq.8$wave)
```






Drop empty factor levels across all columns 
```{r}

dat.edeq.screener <-  droplevels(dat.edeq.screener)

```


##PLOTS - Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time ?

#1. Get rid of NAs and change edeq to factor
```{r}
#get rid of nas
dat.no.nas <- dat.edeq.screener[!is.na(dat.edeq.screener$edeq.ed_scid5.regular_episodes_eating_binges),]

```

#1. Change wave to factor and re-order
```{r}

# change order of wave factor 1
dat.no.nas <- dat.no.nas %>%
 mutate(wave_factor = fct_relevel(wave,
                                  "1",
                                  "2",
                                  "3",
                           "4",
                           "5",
                           "6",
                           "7",
                           "8"))


#Check that this worked

summary(dat.no.nas$wave_factor)
```

#4. Rename waves to dates
```{r}

##Rename waves

levels(dat.no.nas$wave_factor)[1] <- "May"

levels(dat.no.nas$wave_factor)[2] <- "June" 

levels(dat.no.nas$wave_factor)[3] <- "July "

levels(dat.no.nas$wave_factor)[4] <- "August"

levels(dat.no.nas$wave_factor)[5] <- "September"

levels(dat.no.nas$wave_factor)[6] <- "October"

levels(dat.no.nas$wave_factor)[7] <- "November"

levels(dat.no.nas$wave_factor)[8] <- "December"


```


#5. Format data to plot
```{r}
#get data in format to plot
dat_plot <- dat.no.nas %>%
  group_by(wave_factor) %>%
  dplyr::summarise(wcount = table(edeq.ed_scid5.regular_episodes_eating_binges) / sum(table(edeq.ed_scid5.regular_episodes_eating_binges))) %>%
  ungroup() %>%
  mutate(edeq.ed_scid5.regular_episodes_eating_binges = rep(levels(dat.no.nas[["edeq.ed_scid5.regular_episodes_eating_binges"]]),
                    length(levels(dat.no.nas[["wave_factor"]]))))


```

6. Change edeq variable to ordered factor
```{r}
dat_plot <- dat_plot %>%
  mutate(edeq.ed_scid5.regular_episodes_eating_binges = fct_relevel(edeq.ed_scid5.regular_episodes_eating_binges,
                           "No",
                           "Yes"))


```


7. PLOT ! Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time
```{r}

ggplot(dat_plot,
       aes(x = edeq.ed_scid5.regular_episodes_eating_binges,
           y = wcount,
           fill = wave_factor)) +
  geom_bar(aes(group = wave_factor),
           stat = "identity",
           position = "dodge",
           colour = "black") + 
  scale_y_continuous(labels = scales::percent) +
  labs(title = str_wrap("Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time?", 60),
       x = "Binge eating",
       y = "Percentage of participants",
       fill = "Time of survey") +
scale_x_discrete(guide = guide_axis(n.dodge=3))

```

##PLOTS - Over the past month, have you weighed much less than other people thought you ought to weigh?

#1. Get rid of NAs and change edeq to factor
```{r}
#get rid of nas
dat.no.nas <- dat.edeq.screener[!is.na(dat.edeq.screener$edeq.ed_scid5.weigh_weighed_past_month),]

```

#1. Change wave to factor and re-order
```{r}

# change order of wave factor 1
dat.no.nas <- dat.no.nas %>%
 mutate(wave_factor = fct_relevel(wave,
                                  "1",
                                  "2",
                                  "3",
                           "4",
                           "5",
                           "6",
                           "7",
                           "8"))


#Check that this worked

summary(dat.no.nas$wave_factor)
```

#4. Rename waves to dates
```{r}

##Rename waves

levels(dat.no.nas$wave_factor)[1] <- "May"

levels(dat.no.nas$wave_factor)[2] <- "June" 

levels(dat.no.nas$wave_factor)[3] <- "July "

levels(dat.no.nas$wave_factor)[4] <- "August"

levels(dat.no.nas$wave_factor)[5] <- "September"

levels(dat.no.nas$wave_factor)[6] <- "October"

levels(dat.no.nas$wave_factor)[7] <- "November"

levels(dat.no.nas$wave_factor)[8] <- "December"


```


#5. Format data to plot
```{r}
#get data in format to plot
dat_plot <- dat.no.nas %>%
  group_by(wave_factor) %>%
  dplyr::summarise(wcount = table(edeq.ed_scid5.weigh_weighed_past_month) / sum(table(edeq.ed_scid5.weigh_weighed_past_month))) %>%
  ungroup() %>%
  mutate(edeq.ed_scid5.weigh_weighed_past_month = rep(levels(dat.no.nas[["edeq.ed_scid5.weigh_weighed_past_month"]]),
                    length(levels(dat.no.nas[["wave_factor"]]))))


```

6. Change edeq variable to ordered factor
```{r}
dat_plot <- dat_plot %>%
  mutate(edeq.ed_scid5.weigh_weighed_past_month = fct_relevel(edeq.ed_scid5.weigh_weighed_past_month,
                           "No",
                           "Yes"))


```


7. PLOT ! Over the past month, have you weighed much less than other people thought you ought to weigh?
```{r}

ggplot(dat_plot,
       aes(x = edeq.ed_scid5.weigh_weighed_past_month,
           y = wcount,
           fill = wave_factor)) +
  geom_bar(aes(group = wave_factor),
           stat = "identity",
           position = "dodge",
           colour = "black") + 
  scale_y_continuous(labels = scales::percent) +
  labs(title = str_wrap("Over the past month, have you weighed much less than other people thought you ought to weigh?", 60),
       x = "Low weight",
       y = "Percentage of participants",
       fill = "Time of survey") +
scale_x_discrete(guide = guide_axis(n.dodge=3))

```


##########STRATIFYING BY GROUP - BINGE EATING #################### 

##Filter by NOT CONTROLS, i.e., A PSYCH DISORDER
```{r}

dat.edeq.controls <- dat.edeq.screener %>%
  filter(control_numeric == 0)


```


##PLOTS - Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time ?

#1. Get rid of NAs and change edeq to factor
```{r}
#get rid of nas
dat.no.nas <- dat.edeq.controls[!is.na(dat.edeq.controls$edeq.ed_scid5.regular_episodes_eating_binges),]

```

#1. Change wave to factor and re-order
```{r}

# change order of wave factor 1
dat.no.nas <- dat.no.nas %>%
 mutate(wave_factor = fct_relevel(wave,
                                  "1",
                                  "2",
                                  "3",
                           "4",
                           "5",
                           "6",
                           "7",
                           "8"))


#Check that this worked

summary(dat.no.nas$wave_factor)
```

#4. Rename waves to dates
```{r}

##Rename waves

levels(dat.no.nas$wave_factor)[1] <- "May"

levels(dat.no.nas$wave_factor)[2] <- "June" 

levels(dat.no.nas$wave_factor)[3] <- "July "

levels(dat.no.nas$wave_factor)[4] <- "August"

levels(dat.no.nas$wave_factor)[5] <- "September"

levels(dat.no.nas$wave_factor)[6] <- "October"

levels(dat.no.nas$wave_factor)[7] <- "November"

levels(dat.no.nas$wave_factor)[8] <- "December"


```


#5. Format data to plot
```{r}
#get data in format to plot
dat_plot <- dat.no.nas %>%
  group_by(wave_factor) %>%
  dplyr::summarise(wcount = table(edeq.ed_scid5.regular_episodes_eating_binges) / sum(table(edeq.ed_scid5.regular_episodes_eating_binges))) %>%
  ungroup() %>%
  mutate(edeq.ed_scid5.regular_episodes_eating_binges = rep(levels(dat.no.nas[["edeq.ed_scid5.regular_episodes_eating_binges"]]),
                    length(levels(dat.no.nas[["wave_factor"]]))))


```

6. Change edeq variable to ordered factor
```{r}
dat_plot <- dat_plot %>%
  mutate(edeq.ed_scid5.regular_episodes_eating_binges = fct_relevel(edeq.ed_scid5.regular_episodes_eating_binges,
                           "No",
                           "Yes"))


```


7. PLOT ! Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time
```{r}

ggplot(dat_plot,
       aes(x = edeq.ed_scid5.regular_episodes_eating_binges,
           y = wcount,
           fill = wave_factor)) +
  geom_bar(aes(group = wave_factor),
           stat = "identity",
           position = "dodge",
           colour = "black") + 
  scale_y_continuous(labels = scales::percent) +
  labs(title = str_wrap("SELF-REPORTED DIAGNOSIS OF PSYCH DISORDER ONLY: Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time?", 60),
       x = "Binge eating",
       y = "Percentage of participants",
       fill = "Time of survey") +
scale_x_discrete(guide = guide_axis(n.dodge=3))

```

##Filter by CONTROLS, i.e., NO PSYCH DISORDER
```{r}

dat.edeq.controls2 <- dat.edeq.screener %>%
  filter(control_numeric == 1)

```


##PLOTS - Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time ?

#1. Get rid of NAs and change edeq to factor
```{r}
#get rid of nas
dat.no.nas <- dat.edeq.controls2[!is.na(dat.edeq.controls2$edeq.ed_scid5.regular_episodes_eating_binges),]

```

#1. Change wave to factor and re-order
```{r}

# change order of wave factor 1
dat.no.nas <- dat.no.nas %>%
 mutate(wave_factor = fct_relevel(wave,
                                  "1",
                                  "2",
                                  "3",
                           "4",
                           "5",
                           "6",
                           "7",
                           "8"))


#Check that this worked

summary(dat.no.nas$wave_factor)
```

#4. Rename waves to dates
```{r}

##Rename waves

levels(dat.no.nas$wave_factor)[1] <- "May"

levels(dat.no.nas$wave_factor)[2] <- "June" 

levels(dat.no.nas$wave_factor)[3] <- "July "

levels(dat.no.nas$wave_factor)[4] <- "August"

levels(dat.no.nas$wave_factor)[5] <- "September"

levels(dat.no.nas$wave_factor)[6] <- "October"

levels(dat.no.nas$wave_factor)[7] <- "November"

levels(dat.no.nas$wave_factor)[8] <- "December"


```


#5. Format data to plot
```{r}
#get data in format to plot
dat_plot <- dat.no.nas %>%
  group_by(wave_factor) %>%
  dplyr::summarise(wcount = table(edeq.ed_scid5.regular_episodes_eating_binges) / sum(table(edeq.ed_scid5.regular_episodes_eating_binges))) %>%
  ungroup() %>%
  mutate(edeq.ed_scid5.regular_episodes_eating_binges = rep(levels(dat.no.nas[["edeq.ed_scid5.regular_episodes_eating_binges"]]),
                    length(levels(dat.no.nas[["wave_factor"]]))))


```

6. Change edeq variable to ordered factor
```{r}
dat_plot <- dat_plot %>%
  mutate(edeq.ed_scid5.regular_episodes_eating_binges = fct_relevel(edeq.ed_scid5.regular_episodes_eating_binges,
                           "No",
                           "Yes"))


```


7. PLOT ! Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time
```{r}

ggplot(dat_plot,
       aes(x = edeq.ed_scid5.regular_episodes_eating_binges,
           y = wcount,
           fill = wave_factor)) +
  geom_bar(aes(group = wave_factor),
           stat = "identity",
           position = "dodge",
           colour = "black") + 
  scale_y_continuous(labels = scales::percent) +
  labs(title = str_wrap("NO SELF-REPORTED PSYCH DISORDER ONLY: Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time?", 60),
       x = "Binge eating",
       y = "Percentage of participants",
       fill = "Time of survey") +
scale_x_discrete(guide = guide_axis(n.dodge=3))

```




##Filter by EATING DISORDER CASES
```{r}

dat.edeq.eating.disorders <- dat.edeq.screener %>%
  filter(eating_disorders_numeric == 1)


```

##PLOTS - Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time ?

#1. Get rid of NAs and change edeq to factor
```{r}
#get rid of nas
dat.no.nas <- dat.edeq.eating.disorders[!is.na(dat.edeq.eating.disorders$edeq.ed_scid5.regular_episodes_eating_binges),]

```

#1. Change wave to factor and re-order
```{r}

# change order of wave factor 1
dat.no.nas <- dat.no.nas %>%
 mutate(wave_factor = fct_relevel(wave,
                                  "1",
                                  "2",
                                  "3",
                           "4",
                           "5",
                           "6",
                           "7",
                           "8"))


#Check that this worked

summary(dat.no.nas$wave_factor)
```

#4. Rename waves to dates
```{r}

##Rename waves

levels(dat.no.nas$wave_factor)[1] <- "May"

levels(dat.no.nas$wave_factor)[2] <- "June" 

levels(dat.no.nas$wave_factor)[3] <- "July "

levels(dat.no.nas$wave_factor)[4] <- "August"

levels(dat.no.nas$wave_factor)[5] <- "September"

levels(dat.no.nas$wave_factor)[6] <- "October"

levels(dat.no.nas$wave_factor)[7] <- "November"

levels(dat.no.nas$wave_factor)[8] <- "December"


```


#5. Format data to plot
```{r}
#get data in format to plot
dat_plot <- dat.no.nas %>%
  group_by(wave_factor) %>%
  dplyr::summarise(wcount = table(edeq.ed_scid5.regular_episodes_eating_binges) / sum(table(edeq.ed_scid5.regular_episodes_eating_binges))) %>%
  ungroup() %>%
  mutate(edeq.ed_scid5.regular_episodes_eating_binges = rep(levels(dat.no.nas[["edeq.ed_scid5.regular_episodes_eating_binges"]]),
                    length(levels(dat.no.nas[["wave_factor"]]))))


```

6. Change edeq variable to ordered factor
```{r}
dat_plot <- dat_plot %>%
  mutate(edeq.ed_scid5.regular_episodes_eating_binges = fct_relevel(edeq.ed_scid5.regular_episodes_eating_binges,
                           "No",
                           "Yes"))


```


7. PLOT ! Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time
```{r}

ggplot(dat_plot,
       aes(x = edeq.ed_scid5.regular_episodes_eating_binges,
           y = wcount,
           fill = wave_factor)) +
  geom_bar(aes(group = wave_factor),
           stat = "identity",
           position = "dodge",
           colour = "black") + 
  scale_y_continuous(labels = scales::percent) +
  labs(title = str_wrap("EATING DISORDER CASES ONLY: Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time?", 60),
       x = "Binge eating",
       y = "Percentage of participants",
       fill = "Time of survey") +
scale_x_discrete(guide = guide_axis(n.dodge=3))

```



##Filter by NO EATING DISORDER CASES
```{r}

dat.edeq.no.eating.disorders <- dat.edeq.screener %>%
  filter(eating_disorders_numeric == 0)


```

##PLOTS - Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time ?

#1. Get rid of NAs and change edeq to factor
```{r}
#get rid of nas
dat.no.nas <- dat.edeq.no.eating.disorders[!is.na(dat.edeq.no.eating.disorders$edeq.ed_scid5.regular_episodes_eating_binges),]

```

#1. Change wave to factor and re-order
```{r}

# change order of wave factor 1
dat.no.nas <- dat.no.nas %>%
 mutate(wave_factor = fct_relevel(wave,
                                  "1",
                                  "2",
                                  "3",
                           "4",
                           "5",
                           "6",
                           "7",
                           "8"))


#Check that this worked

summary(dat.no.nas$wave_factor)
```

#4. Rename waves to dates
```{r}

##Rename waves

levels(dat.no.nas$wave_factor)[1] <- "May"

levels(dat.no.nas$wave_factor)[2] <- "June" 

levels(dat.no.nas$wave_factor)[3] <- "July "

levels(dat.no.nas$wave_factor)[4] <- "August"

levels(dat.no.nas$wave_factor)[5] <- "September"

levels(dat.no.nas$wave_factor)[6] <- "October"

levels(dat.no.nas$wave_factor)[7] <- "November"

levels(dat.no.nas$wave_factor)[8] <- "December"


```


#5. Format data to plot
```{r}
#get data in format to plot
dat_plot <- dat.no.nas %>%
  group_by(wave_factor) %>%
  dplyr::summarise(wcount = table(edeq.ed_scid5.regular_episodes_eating_binges) / sum(table(edeq.ed_scid5.regular_episodes_eating_binges))) %>%
  ungroup() %>%
  mutate(edeq.ed_scid5.regular_episodes_eating_binges = rep(levels(dat.no.nas[["edeq.ed_scid5.regular_episodes_eating_binges"]]),
                    length(levels(dat.no.nas[["wave_factor"]]))))


```

6. Change edeq variable to ordered factor
```{r}
dat_plot <- dat_plot %>%
  mutate(edeq.ed_scid5.regular_episodes_eating_binges = fct_relevel(edeq.ed_scid5.regular_episodes_eating_binges,
                           "No",
                           "Yes"))


```


7. PLOT ! Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time
```{r}

ggplot(dat_plot,
       aes(x = edeq.ed_scid5.regular_episodes_eating_binges,
           y = wcount,
           fill = wave_factor)) +
  geom_bar(aes(group = wave_factor),
           stat = "identity",
           position = "dodge",
           colour = "black") + 
  scale_y_continuous(labels = scales::percent) +
  labs(title = str_wrap("NO EATING DISORDER CASES: Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time?", 60),
       x = "Binge eating",
       y = "Percentage of participants",
       fill = "Time of survey") +
scale_x_discrete(guide = guide_axis(n.dodge=3))

```

##Filter by FEMALE
```{r}

dat.edeq.females <- dat.edeq.screener %>%
  filter(gender_unc == "Female")



```

##PLOTS - Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time ?

#1. Get rid of NAs and change edeq to factor
```{r}
#get rid of nas
dat.no.nas <- dat.edeq.females[!is.na(dat.edeq.females$edeq.ed_scid5.regular_episodes_eating_binges),]

```

#1. Change wave to factor and re-order
```{r}

# change order of wave factor 1
dat.no.nas <- dat.no.nas %>%
 mutate(wave_factor = fct_relevel(wave,
                                  "1",
                                  "2",
                                  "3",
                           "4",
                           "5",
                           "6",
                           "7",
                           "8"))


#Check that this worked

summary(dat.no.nas$wave_factor)
```

#4. Rename waves to dates
```{r}

##Rename waves

levels(dat.no.nas$wave_factor)[1] <- "May"

levels(dat.no.nas$wave_factor)[2] <- "June" 

levels(dat.no.nas$wave_factor)[3] <- "July "

levels(dat.no.nas$wave_factor)[4] <- "August"

levels(dat.no.nas$wave_factor)[5] <- "September"

levels(dat.no.nas$wave_factor)[6] <- "October"

levels(dat.no.nas$wave_factor)[7] <- "November"

levels(dat.no.nas$wave_factor)[8] <- "December"


```


#5. Format data to plot
```{r}
#get data in format to plot
dat_plot <- dat.no.nas %>%
  group_by(wave_factor) %>%
  dplyr::summarise(wcount = table(edeq.ed_scid5.regular_episodes_eating_binges) / sum(table(edeq.ed_scid5.regular_episodes_eating_binges))) %>%
  ungroup() %>%
  mutate(edeq.ed_scid5.regular_episodes_eating_binges = rep(levels(dat.no.nas[["edeq.ed_scid5.regular_episodes_eating_binges"]]),
                    length(levels(dat.no.nas[["wave_factor"]]))))


```

6. Change edeq variable to ordered factor
```{r}
dat_plot <- dat_plot %>%
  mutate(edeq.ed_scid5.regular_episodes_eating_binges = fct_relevel(edeq.ed_scid5.regular_episodes_eating_binges,
                           "No",
                           "Yes"))


```


7. PLOT ! Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time
```{r}

ggplot(dat_plot,
       aes(x = edeq.ed_scid5.regular_episodes_eating_binges,
           y = wcount,
           fill = wave_factor)) +
  geom_bar(aes(group = wave_factor),
           stat = "identity",
           position = "dodge",
           colour = "black") + 
  scale_y_continuous(labels = scales::percent) +
  labs(title = str_wrap("WOMEN ONLY: Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time?", 60),
       x = "Binge eating",
       y = "Percentage of participants",
       fill = "Time of survey") +
scale_x_discrete(guide = guide_axis(n.dodge=3))

```


##Filter by MALE
```{r}

dat.edeq.males <- dat.edeq.screener %>%
  filter(gender_unc == "Male")



```

##PLOTS - Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time ?

#1. Get rid of NAs and change edeq to factor
```{r}
#get rid of nas
dat.no.nas <- dat.edeq.males[!is.na(dat.edeq.males$edeq.ed_scid5.regular_episodes_eating_binges),]

```

#1. Change wave to factor and re-order
```{r}

# change order of wave factor 1
dat.no.nas <- dat.no.nas %>%
 mutate(wave_factor = fct_relevel(wave,
                                  "1",
                                  "2",
                                  "3",
                           "4",
                           "5",
                           "6",
                           "7",
                           "8"))


#Check that this worked

summary(dat.no.nas$wave_factor)
```

#4. Rename waves to dates
```{r}

##Rename waves

levels(dat.no.nas$wave_factor)[1] <- "May"

levels(dat.no.nas$wave_factor)[2] <- "June" 

levels(dat.no.nas$wave_factor)[3] <- "July "

levels(dat.no.nas$wave_factor)[4] <- "August"

levels(dat.no.nas$wave_factor)[5] <- "September"

levels(dat.no.nas$wave_factor)[6] <- "October"

levels(dat.no.nas$wave_factor)[7] <- "November"

levels(dat.no.nas$wave_factor)[8] <- "December"


```


#5. Format data to plot
```{r}
#get data in format to plot
dat_plot <- dat.no.nas %>%
  group_by(wave_factor) %>%
  dplyr::summarise(wcount = table(edeq.ed_scid5.regular_episodes_eating_binges) / sum(table(edeq.ed_scid5.regular_episodes_eating_binges))) %>%
  ungroup() %>%
  mutate(edeq.ed_scid5.regular_episodes_eating_binges = rep(levels(dat.no.nas[["edeq.ed_scid5.regular_episodes_eating_binges"]]),
                    length(levels(dat.no.nas[["wave_factor"]]))))


```

6. Change edeq variable to ordered factor
```{r}
dat_plot <- dat_plot %>%
  mutate(edeq.ed_scid5.regular_episodes_eating_binges = fct_relevel(edeq.ed_scid5.regular_episodes_eating_binges,
                           "No",
                           "Yes"))


```


7. PLOT ! Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time
```{r}

ggplot(dat_plot,
       aes(x = edeq.ed_scid5.regular_episodes_eating_binges,
           y = wcount,
           fill = wave_factor)) +
  geom_bar(aes(group = wave_factor),
           stat = "identity",
           position = "dodge",
           colour = "black") + 
  scale_y_continuous(labels = scales::percent) +
  labs(title = str_wrap("MEN ONLY: Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time?", 60),
       x = "Binge eating",
       y = "Percentage of participants",
       fill = "Time of survey") +
scale_x_discrete(guide = guide_axis(n.dodge=3))

```



##Filter by AGE, 16-18

16-18     
19-25
26-35    
36-45    
46-55    
56-65    
66-70    
71-75  
76-80  
81-85  
86-90
91-100
 100+  
```{r}

dat.edeq.1618 <- dat.edeq.screener %>%
  filter(age_category == "16-18")

```

##PLOTS - Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time ?

#1. Get rid of NAs and change edeq to factor
```{r}
#get rid of nas
dat.no.nas <- dat.edeq.1618[!is.na(dat.edeq.1618$edeq.ed_scid5.regular_episodes_eating_binges),]

```

#1. Change wave to factor and re-order
```{r}

# change order of wave factor 1
dat.no.nas <- dat.no.nas %>%
 mutate(wave_factor = fct_relevel(wave,
                                  "1",
                                  "2",
                                  "3",
                           "4",
                           "5",
                           "6",
                           "7",
                           "8"))


#Check that this worked

summary(dat.no.nas$wave_factor)
```

#4. Rename waves to dates
```{r}

##Rename waves

levels(dat.no.nas$wave_factor)[1] <- "May"

levels(dat.no.nas$wave_factor)[2] <- "June" 

levels(dat.no.nas$wave_factor)[3] <- "July "

levels(dat.no.nas$wave_factor)[4] <- "August"

levels(dat.no.nas$wave_factor)[5] <- "September"

levels(dat.no.nas$wave_factor)[6] <- "October"

levels(dat.no.nas$wave_factor)[7] <- "November"

levels(dat.no.nas$wave_factor)[8] <- "December"


```


#5. Format data to plot
```{r}
#get data in format to plot
dat_plot <- dat.no.nas %>%
  group_by(wave_factor) %>%
  dplyr::summarise(wcount = table(edeq.ed_scid5.regular_episodes_eating_binges) / sum(table(edeq.ed_scid5.regular_episodes_eating_binges))) %>%
  ungroup() %>%
  mutate(edeq.ed_scid5.regular_episodes_eating_binges = rep(levels(dat.no.nas[["edeq.ed_scid5.regular_episodes_eating_binges"]]),
                    length(levels(dat.no.nas[["wave_factor"]]))))


```

6. Change edeq variable to ordered factor
```{r}
dat_plot <- dat_plot %>%
  mutate(edeq.ed_scid5.regular_episodes_eating_binges = fct_relevel(edeq.ed_scid5.regular_episodes_eating_binges,
                           "No",
                           "Yes"))


```


7. PLOT ! Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time
```{r}

ggplot(dat_plot,
       aes(x = edeq.ed_scid5.regular_episodes_eating_binges,
           y = wcount,
           fill = wave_factor)) +
  geom_bar(aes(group = wave_factor),
           stat = "identity",
           position = "dodge",
           colour = "black") + 
  scale_y_continuous(labels = scales::percent) +
  labs(title = str_wrap("16-18 year olds ONLY: Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time?", 60),
       x = "Binge eating",
       y = "Percentage of participants",
       fill = "Time of survey") +
scale_x_discrete(guide = guide_axis(n.dodge=3))

```

##Filter by AGE, 16-25

16-18     
19-25
26-35    
36-45    
46-55    
56-65    
66-70    
71-75  
76-80  
81-85  
86-90
91-100
 100+  
```{r}

dat.edeq.1625 <- dat.edeq.screener %>%
  filter(age_category == "16-18" |
           age_category == "19-25")

```

##PLOTS - Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time ?

#1. Get rid of NAs and change edeq to factor
```{r}
#get rid of nas
dat.no.nas <- dat.edeq.1625[!is.na(dat.edeq.1625$edeq.ed_scid5.regular_episodes_eating_binges),]

```

#1. Change wave to factor and re-order
```{r}

# change order of wave factor 1
dat.no.nas <- dat.no.nas %>%
 mutate(wave_factor = fct_relevel(wave,
                                  "1",
                                  "2",
                                  "3",
                           "4",
                           "5",
                           "6",
                           "7",
                           "8"))


#Check that this worked

summary(dat.no.nas$wave_factor)
```

#4. Rename waves to dates
```{r}

##Rename waves

levels(dat.no.nas$wave_factor)[1] <- "May"

levels(dat.no.nas$wave_factor)[2] <- "June" 

levels(dat.no.nas$wave_factor)[3] <- "July "

levels(dat.no.nas$wave_factor)[4] <- "August"

levels(dat.no.nas$wave_factor)[5] <- "September"

levels(dat.no.nas$wave_factor)[6] <- "October"

levels(dat.no.nas$wave_factor)[7] <- "November"

levels(dat.no.nas$wave_factor)[8] <- "December"


```


#5. Format data to plot
```{r}
#get data in format to plot
dat_plot <- dat.no.nas %>%
  group_by(wave_factor) %>%
  dplyr::summarise(wcount = table(edeq.ed_scid5.regular_episodes_eating_binges) / sum(table(edeq.ed_scid5.regular_episodes_eating_binges))) %>%
  ungroup() %>%
  mutate(edeq.ed_scid5.regular_episodes_eating_binges = rep(levels(dat.no.nas[["edeq.ed_scid5.regular_episodes_eating_binges"]]),
                    length(levels(dat.no.nas[["wave_factor"]]))))


```

6. Change edeq variable to ordered factor
```{r}
dat_plot <- dat_plot %>%
  mutate(edeq.ed_scid5.regular_episodes_eating_binges = fct_relevel(edeq.ed_scid5.regular_episodes_eating_binges,
                           "No",
                           "Yes"))


```


7. PLOT ! Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time
```{r}

ggplot(dat_plot,
       aes(x = edeq.ed_scid5.regular_episodes_eating_binges,
           y = wcount,
           fill = wave_factor)) +
  geom_bar(aes(group = wave_factor),
           stat = "identity",
           position = "dodge",
           colour = "black") + 
  scale_y_continuous(labels = scales::percent) +
  labs(title = str_wrap("16-25 year olds ONLY: Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time?", 60),
       x = "Binge eating",
       y = "Percentage of participants",
       fill = "Time of survey") +
scale_x_discrete(guide = guide_axis(n.dodge=3))

```



##Filter by AGE, 26-35

16-18     
19-25
26-35    
36-45    
46-55    
56-65    
66-70    
71-75  
76-80  
81-85  
86-90
91-100
 100+  
```{r}

dat.edeq.2635 <- dat.edeq.screener %>%
  filter(age_category == "26-35")

```

##PLOTS - Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time ?

#1. Get rid of NAs and change edeq to factor
```{r}
#get rid of nas
dat.no.nas <- dat.edeq.2635[!is.na(dat.edeq.2635$edeq.ed_scid5.regular_episodes_eating_binges),]

```

#1. Change wave to factor and re-order
```{r}

# change order of wave factor 1
dat.no.nas <- dat.no.nas %>%
 mutate(wave_factor = fct_relevel(wave,
                                  "1",
                                  "2",
                                  "3",
                           "4",
                           "5",
                           "6",
                           "7",
                           "8"))


#Check that this worked

summary(dat.no.nas$wave_factor)
```

#4. Rename waves to dates
```{r}

##Rename waves

levels(dat.no.nas$wave_factor)[1] <- "May"

levels(dat.no.nas$wave_factor)[2] <- "June" 

levels(dat.no.nas$wave_factor)[3] <- "July "

levels(dat.no.nas$wave_factor)[4] <- "August"

levels(dat.no.nas$wave_factor)[5] <- "September"

levels(dat.no.nas$wave_factor)[6] <- "October"

levels(dat.no.nas$wave_factor)[7] <- "November"

levels(dat.no.nas$wave_factor)[8] <- "December"


```


#5. Format data to plot
```{r}
#get data in format to plot
dat_plot <- dat.no.nas %>%
  group_by(wave_factor) %>%
  dplyr::summarise(wcount = table(edeq.ed_scid5.regular_episodes_eating_binges) / sum(table(edeq.ed_scid5.regular_episodes_eating_binges))) %>%
  ungroup() %>%
  mutate(edeq.ed_scid5.regular_episodes_eating_binges = rep(levels(dat.no.nas[["edeq.ed_scid5.regular_episodes_eating_binges"]]),
                    length(levels(dat.no.nas[["wave_factor"]]))))


```

6. Change edeq variable to ordered factor
```{r}
dat_plot <- dat_plot %>%
  mutate(edeq.ed_scid5.regular_episodes_eating_binges = fct_relevel(edeq.ed_scid5.regular_episodes_eating_binges,
                           "No",
                           "Yes"))


```


7. PLOT ! Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time
```{r}

ggplot(dat_plot,
       aes(x = edeq.ed_scid5.regular_episodes_eating_binges,
           y = wcount,
           fill = wave_factor)) +
  geom_bar(aes(group = wave_factor),
           stat = "identity",
           position = "dodge",
           colour = "black") + 
  scale_y_continuous(labels = scales::percent) +
  labs(title = str_wrap("26-35 year olds ONLY: Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time?", 60),
       x = "Binge eating",
       y = "Percentage of participants",
       fill = "Time of survey") +
scale_x_discrete(guide = guide_axis(n.dodge=3))

```

##Filter by AGE, 36-45

16-18     
19-25
26-35    
36-45    
46-55    
56-65    
66-70    
71-75  
76-80  
81-85  
86-90
91-100
 100+  
```{r}

dat.edeq.3645 <- dat.edeq.screener %>%
  filter(age_category == "36-45")

```

##PLOTS - Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time ?

#1. Get rid of NAs and change edeq to factor
```{r}
#get rid of nas
dat.no.nas <- dat.edeq.3645[!is.na(dat.edeq.3645$edeq.ed_scid5.regular_episodes_eating_binges),]

```

#1. Change wave to factor and re-order
```{r}

# change order of wave factor 1
dat.no.nas <- dat.no.nas %>%
 mutate(wave_factor = fct_relevel(wave,
                                  "1",
                                  "2",
                                  "3",
                           "4",
                           "5",
                           "6",
                           "7",
                           "8"))


#Check that this worked

summary(dat.no.nas$wave_factor)
```

#4. Rename waves to dates
```{r}

##Rename waves

levels(dat.no.nas$wave_factor)[1] <- "May"

levels(dat.no.nas$wave_factor)[2] <- "June" 

levels(dat.no.nas$wave_factor)[3] <- "July "

levels(dat.no.nas$wave_factor)[4] <- "August"

levels(dat.no.nas$wave_factor)[5] <- "September"

levels(dat.no.nas$wave_factor)[6] <- "October"

levels(dat.no.nas$wave_factor)[7] <- "November"

levels(dat.no.nas$wave_factor)[8] <- "December"


```


#5. Format data to plot
```{r}
#get data in format to plot
dat_plot <- dat.no.nas %>%
  group_by(wave_factor) %>%
  dplyr::summarise(wcount = table(edeq.ed_scid5.regular_episodes_eating_binges) / sum(table(edeq.ed_scid5.regular_episodes_eating_binges))) %>%
  ungroup() %>%
  mutate(edeq.ed_scid5.regular_episodes_eating_binges = rep(levels(dat.no.nas[["edeq.ed_scid5.regular_episodes_eating_binges"]]),
                    length(levels(dat.no.nas[["wave_factor"]]))))


```

6. Change edeq variable to ordered factor
```{r}
dat_plot <- dat_plot %>%
  mutate(edeq.ed_scid5.regular_episodes_eating_binges = fct_relevel(edeq.ed_scid5.regular_episodes_eating_binges,
                           "No",
                           "Yes"))


```


7. PLOT ! Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time
```{r}

ggplot(dat_plot,
       aes(x = edeq.ed_scid5.regular_episodes_eating_binges,
           y = wcount,
           fill = wave_factor)) +
  geom_bar(aes(group = wave_factor),
           stat = "identity",
           position = "dodge",
           colour = "black") + 
  scale_y_continuous(labels = scales::percent) +
  labs(title = str_wrap("36-45 year olds ONLY: Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time?", 60),
       x = "Binge eating",
       y = "Percentage of participants",
       fill = "Time of survey") +
scale_x_discrete(guide = guide_axis(n.dodge=3))

```

##Filter by AGE, 26-35

16-18     
19-25
26-35    
36-45    
46-55    
56-65    
66-70    
71-75  
76-80  
81-85  
86-90
91-100
 100+  
```{r}

dat.edeq.2635 <- dat.edeq.screener %>%
  filter(age_category == "26-35")

```

##PLOTS - Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time ?

#1. Get rid of NAs and change edeq to factor
```{r}
#get rid of nas
dat.no.nas <- dat.edeq.2635[!is.na(dat.edeq.2635$edeq.ed_scid5.regular_episodes_eating_binges),]

```

#1. Change wave to factor and re-order
```{r}

# change order of wave factor 1
dat.no.nas <- dat.no.nas %>%
 mutate(wave_factor = fct_relevel(wave,
                                  "1",
                                  "2",
                                  "3",
                           "4",
                           "5",
                           "6",
                           "7",
                           "8"))


#Check that this worked

summary(dat.no.nas$wave_factor)
```

#4. Rename waves to dates
```{r}

##Rename waves

levels(dat.no.nas$wave_factor)[1] <- "May"

levels(dat.no.nas$wave_factor)[2] <- "June" 

levels(dat.no.nas$wave_factor)[3] <- "July "

levels(dat.no.nas$wave_factor)[4] <- "August"

levels(dat.no.nas$wave_factor)[5] <- "September"

levels(dat.no.nas$wave_factor)[6] <- "October"

levels(dat.no.nas$wave_factor)[7] <- "November"

levels(dat.no.nas$wave_factor)[8] <- "December"


```


#5. Format data to plot
```{r}
#get data in format to plot
dat_plot <- dat.no.nas %>%
  group_by(wave_factor) %>%
  dplyr::summarise(wcount = table(edeq.ed_scid5.regular_episodes_eating_binges) / sum(table(edeq.ed_scid5.regular_episodes_eating_binges))) %>%
  ungroup() %>%
  mutate(edeq.ed_scid5.regular_episodes_eating_binges = rep(levels(dat.no.nas[["edeq.ed_scid5.regular_episodes_eating_binges"]]),
                    length(levels(dat.no.nas[["wave_factor"]]))))


```

6. Change edeq variable to ordered factor
```{r}
dat_plot <- dat_plot %>%
  mutate(edeq.ed_scid5.regular_episodes_eating_binges = fct_relevel(edeq.ed_scid5.regular_episodes_eating_binges,
                           "No",
                           "Yes"))


```


7. PLOT ! Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time
```{r}

ggplot(dat_plot,
       aes(x = edeq.ed_scid5.regular_episodes_eating_binges,
           y = wcount,
           fill = wave_factor)) +
  geom_bar(aes(group = wave_factor),
           stat = "identity",
           position = "dodge",
           colour = "black") + 
  scale_y_continuous(labels = scales::percent) +
  labs(title = str_wrap("26-35 year olds ONLY: Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time?", 60),
       x = "Binge eating",
       y = "Percentage of participants",
       fill = "Time of survey") +
scale_x_discrete(guide = guide_axis(n.dodge=3))

```

##Filter by AGE, 46-55

16-18     
19-25
26-35    
36-45    
46-55    
56-65    
66-70    
71-75  
76-80  
81-85  
86-90
91-100
 100+  
```{r}

dat.edeq.4655 <- dat.edeq.screener %>%
  filter(age_category == "46-55")

```

##PLOTS - Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time ?

#1. Get rid of NAs and change edeq to factor
```{r}
#get rid of nas
dat.no.nas <- dat.edeq.4655[!is.na(dat.edeq.4655$edeq.ed_scid5.regular_episodes_eating_binges),]

```

#1. Change wave to factor and re-order
```{r}

# change order of wave factor 1
dat.no.nas <- dat.no.nas %>%
 mutate(wave_factor = fct_relevel(wave,
                                  "1",
                                  "2",
                                  "3",
                           "4",
                           "5",
                           "6",
                           "7",
                           "8"))


#Check that this worked

summary(dat.no.nas$wave_factor)
```

#4. Rename waves to dates
```{r}

##Rename waves

levels(dat.no.nas$wave_factor)[1] <- "May"

levels(dat.no.nas$wave_factor)[2] <- "June" 

levels(dat.no.nas$wave_factor)[3] <- "July "

levels(dat.no.nas$wave_factor)[4] <- "August"

levels(dat.no.nas$wave_factor)[5] <- "September"

levels(dat.no.nas$wave_factor)[6] <- "October"

levels(dat.no.nas$wave_factor)[7] <- "November"

levels(dat.no.nas$wave_factor)[8] <- "December"


```


#5. Format data to plot
```{r}
#get data in format to plot
dat_plot <- dat.no.nas %>%
  group_by(wave_factor) %>%
  dplyr::summarise(wcount = table(edeq.ed_scid5.regular_episodes_eating_binges) / sum(table(edeq.ed_scid5.regular_episodes_eating_binges))) %>%
  ungroup() %>%
  mutate(edeq.ed_scid5.regular_episodes_eating_binges = rep(levels(dat.no.nas[["edeq.ed_scid5.regular_episodes_eating_binges"]]),
                    length(levels(dat.no.nas[["wave_factor"]]))))


```

6. Change edeq variable to ordered factor
```{r}
dat_plot <- dat_plot %>%
  mutate(edeq.ed_scid5.regular_episodes_eating_binges = fct_relevel(edeq.ed_scid5.regular_episodes_eating_binges,
                           "No",
                           "Yes"))


```


7. PLOT ! Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time
```{r}

ggplot(dat_plot,
       aes(x = edeq.ed_scid5.regular_episodes_eating_binges,
           y = wcount,
           fill = wave_factor)) +
  geom_bar(aes(group = wave_factor),
           stat = "identity",
           position = "dodge",
           colour = "black") + 
  scale_y_continuous(labels = scales::percent) +
  labs(title = str_wrap("46-55 year olds ONLY: Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time?", 60),
       x = "Binge eating",
       y = "Percentage of participants",
       fill = "Time of survey") +
scale_x_discrete(guide = guide_axis(n.dodge=3))

```



##Filter by AGE, 56-65  

16-18     
19-25
26-35    
36-45    
46-55    
56-65    
66-70    
71-75  
76-80  
81-85  
86-90
91-100
 100+  
```{r}

dat.edeq.5665 <- dat.edeq.screener %>%
  filter(age_category == "56-65")

```

##PLOTS - Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time ?

#1. Get rid of NAs and change edeq to factor
```{r}
#get rid of nas
dat.no.nas <- dat.edeq.5665[!is.na(dat.edeq.5665$edeq.ed_scid5.regular_episodes_eating_binges),]

```

#1. Change wave to factor and re-order
```{r}

# change order of wave factor 1
dat.no.nas <- dat.no.nas %>%
 mutate(wave_factor = fct_relevel(wave,
                                  "1",
                                  "2",
                                  "3",
                           "4",
                           "5",
                           "6",
                           "7",
                           "8"))


#Check that this worked

summary(dat.no.nas$wave_factor)
```

#4. Rename waves to dates
```{r}

##Rename waves

levels(dat.no.nas$wave_factor)[1] <- "May"

levels(dat.no.nas$wave_factor)[2] <- "June" 

levels(dat.no.nas$wave_factor)[3] <- "July "

levels(dat.no.nas$wave_factor)[4] <- "August"

levels(dat.no.nas$wave_factor)[5] <- "September"

levels(dat.no.nas$wave_factor)[6] <- "October"

levels(dat.no.nas$wave_factor)[7] <- "November"

levels(dat.no.nas$wave_factor)[8] <- "December"


```


#5. Format data to plot
```{r}
#get data in format to plot
dat_plot <- dat.no.nas %>%
  group_by(wave_factor) %>%
  dplyr::summarise(wcount = table(edeq.ed_scid5.regular_episodes_eating_binges) / sum(table(edeq.ed_scid5.regular_episodes_eating_binges))) %>%
  ungroup() %>%
  mutate(edeq.ed_scid5.regular_episodes_eating_binges = rep(levels(dat.no.nas[["edeq.ed_scid5.regular_episodes_eating_binges"]]),
                    length(levels(dat.no.nas[["wave_factor"]]))))


```

6. Change edeq variable to ordered factor
```{r}
dat_plot <- dat_plot %>%
  mutate(edeq.ed_scid5.regular_episodes_eating_binges = fct_relevel(edeq.ed_scid5.regular_episodes_eating_binges,
                           "No",
                           "Yes"))


```


7. PLOT ! Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time
```{r}

ggplot(dat_plot,
       aes(x = edeq.ed_scid5.regular_episodes_eating_binges,
           y = wcount,
           fill = wave_factor)) +
  geom_bar(aes(group = wave_factor),
           stat = "identity",
           position = "dodge",
           colour = "black") + 
  scale_y_continuous(labels = scales::percent) +
  labs(title = str_wrap("56-65 year olds ONLY: Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time?", 60),
       x = "Binge eating",
       y = "Percentage of participants",
       fill = "Time of survey") +
scale_x_discrete(guide = guide_axis(n.dodge=3))

```


##Filter by AGE, 70+

```{r}

dat.edeq.70 <- dat.edeq.screener %>%
  filter(age_category == "66-70" |
           age_category == "71-75" | 
           age_category == "76-80" | 
         age_category == "81-85" | 
         age_category == "86-90" |
           age_category == "91-100" |
           age_category == "100+")

```

##PLOTS - Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time ?

#1. Get rid of NAs and change edeq to factor
```{r}
#get rid of nas
dat.no.nas <- dat.edeq.70[!is.na(dat.edeq.70$edeq.ed_scid5.regular_episodes_eating_binges),]

```

#1. Change wave to factor and re-order
```{r}

# change order of wave factor 1
dat.no.nas <- dat.no.nas %>%
 mutate(wave_factor = fct_relevel(wave,
                                  "1",
                                  "2",
                                  "3",
                           "4",
                           "5",
                           "6",
                           "7",
                           "8"))


#Check that this worked

summary(dat.no.nas$wave_factor)
```

Drop empty factor levels across all columns 
```{r}

dat.no.nas <-  droplevels(dat.no.nas)

```


#4. Rename waves to dates
```{r}

##Rename waves

levels(dat.no.nas$wave_factor)[1] <- "May"

levels(dat.no.nas$wave_factor)[2] <- "June" 

levels(dat.no.nas$wave_factor)[3] <- "July "

levels(dat.no.nas$wave_factor)[4] <- "August"

levels(dat.no.nas$wave_factor)[5] <- "September"

levels(dat.no.nas$wave_factor)[6] <- "October"

levels(dat.no.nas$wave_factor)[7] <- "November"

levels(dat.no.nas$wave_factor)[8] <- "December"


```


#5. Format data to plot
```{r}
#get data in format to plot
dat_plot <- dat.no.nas %>%
  group_by(wave_factor) %>%
  dplyr::summarise(wcount = table(edeq.ed_scid5.regular_episodes_eating_binges) / sum(table(edeq.ed_scid5.regular_episodes_eating_binges))) %>%
  ungroup() %>%
  mutate(edeq.ed_scid5.regular_episodes_eating_binges = rep(levels(dat.no.nas[["edeq.ed_scid5.regular_episodes_eating_binges"]]),
                    length(levels(dat.no.nas[["wave_factor"]]))))


```

6. Change edeq variable to ordered factor
```{r}
dat_plot <- dat_plot %>%
  mutate(edeq.ed_scid5.regular_episodes_eating_binges = fct_relevel(edeq.ed_scid5.regular_episodes_eating_binges,
                           "No",
                           "Yes"))


```


7. PLOT ! Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time
```{r}

ggplot(dat_plot,
       aes(x = edeq.ed_scid5.regular_episodes_eating_binges,
           y = wcount,
           fill = wave_factor)) +
  geom_bar(aes(group = wave_factor),
           stat = "identity",
           position = "dodge",
           colour = "black") + 
  scale_y_continuous(labels = scales::percent) +
  labs(title = str_wrap("70+ year olds only: Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time?", 60),
       x = "Binge eating",
       y = "Percentage of participants",
       fill = "Time of survey") +
scale_x_discrete(guide = guide_axis(n.dodge=3))

```


##Filter by cohort - RAMP
```{r}

dat.edeq.ramp <- dat.edeq.screener %>%
  filter(cohort_name == "ramp")

```

##PLOTS - Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time ?

#1. Get rid of NAs and change edeq to factor
```{r}
#get rid of nas
dat.no.nas <- dat.edeq.ramp[!is.na(dat.edeq.ramp$edeq.ed_scid5.regular_episodes_eating_binges),]

```

#1. Change wave to factor and re-order
```{r}

# change order of wave factor 1
dat.no.nas <- dat.no.nas %>%
 mutate(wave_factor = fct_relevel(wave,
                                  "1",
                                  "2",
                                  "3",
                           "4",
                           "5",
                           "6",
                           "7",
                           "8"))


#Check that this worked

summary(dat.no.nas$wave_factor)
```

Drop empty factor levels across all columns 
```{r}

dat.no.nas <-  droplevels(dat.no.nas)

```


#4. Rename waves to dates
```{r}

##Rename waves

levels(dat.no.nas$wave_factor)[1] <- "May"

levels(dat.no.nas$wave_factor)[2] <- "June" 

levels(dat.no.nas$wave_factor)[3] <- "July "

levels(dat.no.nas$wave_factor)[4] <- "August"

levels(dat.no.nas$wave_factor)[5] <- "September"

levels(dat.no.nas$wave_factor)[6] <- "October"

levels(dat.no.nas$wave_factor)[7] <- "November"

levels(dat.no.nas$wave_factor)[8] <- "December"


```


#5. Format data to plot
```{r}
#get data in format to plot
dat_plot <- dat.no.nas %>%
  group_by(wave_factor) %>%
  dplyr::summarise(wcount = table(edeq.ed_scid5.regular_episodes_eating_binges) / sum(table(edeq.ed_scid5.regular_episodes_eating_binges))) %>%
  ungroup() %>%
  mutate(edeq.ed_scid5.regular_episodes_eating_binges = rep(levels(dat.no.nas[["edeq.ed_scid5.regular_episodes_eating_binges"]]),
                    length(levels(dat.no.nas[["wave_factor"]]))))


```

6. Change edeq variable to ordered factor
```{r}
dat_plot <- dat_plot %>%
  mutate(edeq.ed_scid5.regular_episodes_eating_binges = fct_relevel(edeq.ed_scid5.regular_episodes_eating_binges,
                           "No",
                           "Yes"))


```


7. PLOT ! Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time
```{r}

ggplot(dat_plot,
       aes(x = edeq.ed_scid5.regular_episodes_eating_binges,
           y = wcount,
           fill = wave_factor)) +
  geom_bar(aes(group = wave_factor),
           stat = "identity",
           position = "dodge",
           colour = "black") + 
  scale_y_continuous(labels = scales::percent) +
  labs(title = str_wrap("RAMP only: Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time?", 60),
       x = "Binge eating",
       y = "Percentage of participants",
       fill = "Time of survey") +
scale_x_discrete(guide = guide_axis(n.dodge=3))

```

##Filter by cohort - COPING
```{r}

dat.edeq.coping <- dat.edeq.screener %>%
  filter(cohort_name == "coping_edgi" | 
           cohort_name == "coping_glad" |
         cohort_name == "nbr")

```

##PLOTS - Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time ?

#1. Get rid of NAs and change edeq to factor
```{r}
#get rid of nas
dat.no.nas <- dat.edeq.coping[!is.na(dat.edeq.coping$edeq.ed_scid5.regular_episodes_eating_binges),]

```

#1. Change wave to factor and re-order
```{r}

# change order of wave factor 1
dat.no.nas <- dat.no.nas %>%
 mutate(wave_factor = fct_relevel(wave,
                                  "1",
                                  "2",
                                  "3",
                           "4",
                           "5",
                           "6",
                           "7",
                           "8"))


#Check that this worked

summary(dat.no.nas$wave_factor)
```

Drop empty factor levels across all columns 
```{r}

dat.no.nas <-  droplevels(dat.no.nas)

```


#4. Rename waves to dates
```{r}

##Rename waves

#levels(dat.no.nas$wave_factor)[1] <- "May"

levels(dat.no.nas$wave_factor)[1] <- "June" 

levels(dat.no.nas$wave_factor)[2] <- "July "

levels(dat.no.nas$wave_factor)[3] <- "August"

levels(dat.no.nas$wave_factor)[4] <- "September"

levels(dat.no.nas$wave_factor)[5] <- "October"

levels(dat.no.nas$wave_factor)[6] <- "November"

levels(dat.no.nas$wave_factor)[7] <- "December"


```


#5. Format data to plot
```{r}
#get data in format to plot
dat_plot <- dat.no.nas %>%
  group_by(wave_factor) %>%
  dplyr::summarise(wcount = table(edeq.ed_scid5.regular_episodes_eating_binges) / sum(table(edeq.ed_scid5.regular_episodes_eating_binges))) %>%
  ungroup() %>%
  mutate(edeq.ed_scid5.regular_episodes_eating_binges = rep(levels(dat.no.nas[["edeq.ed_scid5.regular_episodes_eating_binges"]]),
                    length(levels(dat.no.nas[["wave_factor"]]))))


```

6. Change edeq variable to ordered factor
```{r}
dat_plot <- dat_plot %>%
  mutate(edeq.ed_scid5.regular_episodes_eating_binges = fct_relevel(edeq.ed_scid5.regular_episodes_eating_binges,
                           "No",
                           "Yes"))


```


7. PLOT ! Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time
```{r}

ggplot(dat_plot,
       aes(x = edeq.ed_scid5.regular_episodes_eating_binges,
           y = wcount,
           fill = wave_factor)) +
  geom_bar(aes(group = wave_factor),
           stat = "identity",
           position = "dodge",
           colour = "black") + 
  scale_y_continuous(labels = scales::percent) +
  labs(title = str_wrap("COPING only: Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time?", 60),
       x = "Binge eating",
       y = "Percentage of participants",
       fill = "Time of survey") +
scale_x_discrete(guide = guide_axis(n.dodge=3))

```

                                                    ##########STRATIFYING BY GROUP - LOW WEIGHT #################### 
                                                    
                                                    

##Filter by NO CONTROLS, i.e., A PSYCH DISORDER
```{r}

dat.edeq.controls <- dat.edeq.screener %>%
  filter(control_numeric == 0)


```



##PLOTS - Over the past month, have you weighed much less than other people thought you ought to weigh ?

#1. Get rid of NAs and change edeq to factor
```{r}
#get rid of nas
dat.no.nas <- dat.edeq.controls[!is.na(dat.edeq.controls$edeq.ed_scid5.weigh_weighed_past_month),]

```

#1. Change wave to factor and re-order
```{r}

# change order of wave factor 1
dat.no.nas <- dat.no.nas %>%
 mutate(wave_factor = fct_relevel(wave,
                                  "1",
                                  "2",
                                  "3",
                           "4",
                           "5",
                           "6",
                           "7",
                           "8"))


#Check that this worked

summary(dat.no.nas$wave_factor)
```

#4. Rename waves to dates
```{r}

##Rename waves

levels(dat.no.nas$wave_factor)[1] <- "May"

levels(dat.no.nas$wave_factor)[2] <- "June" 

levels(dat.no.nas$wave_factor)[3] <- "July "

levels(dat.no.nas$wave_factor)[4] <- "August"

levels(dat.no.nas$wave_factor)[5] <- "September"

levels(dat.no.nas$wave_factor)[6] <- "October"

levels(dat.no.nas$wave_factor)[7] <- "November"

levels(dat.no.nas$wave_factor)[8] <- "December"


```


#5. Format data to plot
```{r}
#get data in format to plot
dat_plot <- dat.no.nas %>%
  group_by(wave_factor) %>%
  dplyr::summarise(wcount = table(edeq.ed_scid5.weigh_weighed_past_month) / sum(table(edeq.ed_scid5.weigh_weighed_past_month))) %>%
  ungroup() %>%
  mutate(edeq.ed_scid5.weigh_weighed_past_month = rep(levels(dat.no.nas[["edeq.ed_scid5.weigh_weighed_past_month"]]),
                    length(levels(dat.no.nas[["wave_factor"]]))))


```

6. Change edeq variable to ordered factor
```{r}
dat_plot <- dat_plot %>%
  mutate(edeq.ed_scid5.weigh_weighed_past_month = fct_relevel(edeq.ed_scid5.weigh_weighed_past_month,
                           "No",
                           "Yes"))


```


7. PLOT ! Over the past month, have you weighed much less than other people thought you ought to weigh
```{r}

ggplot(dat_plot,
       aes(x = edeq.ed_scid5.weigh_weighed_past_month,
           y = wcount,
           fill = wave_factor)) +
  geom_bar(aes(group = wave_factor),
           stat = "identity",
           position = "dodge",
           colour = "black") + 
  scale_y_continuous(labels = scales::percent) +
  labs(title = str_wrap("SELF-REPORTED DIAGNOSIS OF PSYCH DISORDER ONLY: Over the past month, have you weighed much less than other people thought you ought to weigh?", 60),
       x = "Low weight",
       y = "Percentage of participants",
       fill = "Time of survey") +
scale_x_discrete(guide = guide_axis(n.dodge=3))

```

##Filter by CONTROLS, i.e., NO PSYCH DISORDER
```{r}

dat.edeq.controls2 <- dat.edeq.screener %>%
  filter(control_numeric == 1)

```



##PLOTS - Over the past month, have you weighed much less than other people thought you ought to weigh ?

#1. Get rid of NAs and change edeq to factor
```{r}
#get rid of nas
dat.no.nas <- dat.edeq.controls2[!is.na(dat.edeq.controls2$edeq.ed_scid5.weigh_weighed_past_month),]

```

#1. Change wave to factor and re-order
```{r}

# change order of wave factor 1
dat.no.nas <- dat.no.nas %>%
 mutate(wave_factor = fct_relevel(wave,
                                  "1",
                                  "2",
                                  "3",
                           "4",
                           "5",
                           "6",
                           "7",
                           "8"))


#Check that this worked

summary(dat.no.nas$wave_factor)
```

#4. Rename waves to dates
```{r}

##Rename waves

levels(dat.no.nas$wave_factor)[1] <- "May"

levels(dat.no.nas$wave_factor)[2] <- "June" 

levels(dat.no.nas$wave_factor)[3] <- "July "

levels(dat.no.nas$wave_factor)[4] <- "August"

levels(dat.no.nas$wave_factor)[5] <- "September"

levels(dat.no.nas$wave_factor)[6] <- "October"

levels(dat.no.nas$wave_factor)[7] <- "November"

levels(dat.no.nas$wave_factor)[8] <- "December"


```


#5. Format data to plot
```{r}
#get data in format to plot
dat_plot <- dat.no.nas %>%
  group_by(wave_factor) %>%
  dplyr::summarise(wcount = table(edeq.ed_scid5.weigh_weighed_past_month) / sum(table(edeq.ed_scid5.weigh_weighed_past_month))) %>%
  ungroup() %>%
  mutate(edeq.ed_scid5.weigh_weighed_past_month = rep(levels(dat.no.nas[["edeq.ed_scid5.weigh_weighed_past_month"]]),
                    length(levels(dat.no.nas[["wave_factor"]]))))


```

6. Change edeq variable to ordered factor
```{r}
dat_plot <- dat_plot %>%
  mutate(edeq.ed_scid5.weigh_weighed_past_month = fct_relevel(edeq.ed_scid5.weigh_weighed_past_month,
                           "No",
                           "Yes"))


```


7. PLOT ! Over the past month, have you weighed much less than other people thought you ought to weigh
```{r}

ggplot(dat_plot,
       aes(x = edeq.ed_scid5.weigh_weighed_past_month,
           y = wcount,
           fill = wave_factor)) +
  geom_bar(aes(group = wave_factor),
           stat = "identity",
           position = "dodge",
           colour = "black") + 
  scale_y_continuous(labels = scales::percent) +
  labs(title = str_wrap("NO SELF-REPORTED PSYCH DISORDER ONLY: Over the past month, have you weighed much less than other people thought you ought to weigh?", 60),
       x = "Low weight",
       y = "Percentage of participants",
       fill = "Time of survey") +
scale_x_discrete(guide = guide_axis(n.dodge=3))

```


##Filter by EATING DISORDER CASES
```{r}

dat.edeq.eating.disorders <- dat.edeq.screener %>%
  filter(eating_disorders_numeric == 1)


```

##PLOTS - Over the past month, have you weighed much less than other people thought you ought to weigh ?

#1. Get rid of NAs and change edeq to factor
```{r}
#get rid of nas
dat.no.nas <- dat.edeq.eating.disorders[!is.na(dat.edeq.eating.disorders$edeq.ed_scid5.weigh_weighed_past_month),]

```

#1. Change wave to factor and re-order
```{r}

# change order of wave factor 1
dat.no.nas <- dat.no.nas %>%
 mutate(wave_factor = fct_relevel(wave,
                                  "1",
                                  "2",
                                  "3",
                           "4",
                           "5",
                           "6",
                           "7",
                           "8"))


#Check that this worked

summary(dat.no.nas$wave_factor)
```

#4. Rename waves to dates
```{r}

##Rename waves

levels(dat.no.nas$wave_factor)[1] <- "May"

levels(dat.no.nas$wave_factor)[2] <- "June" 

levels(dat.no.nas$wave_factor)[3] <- "July "

levels(dat.no.nas$wave_factor)[4] <- "August"

levels(dat.no.nas$wave_factor)[5] <- "September"

levels(dat.no.nas$wave_factor)[6] <- "October"

levels(dat.no.nas$wave_factor)[7] <- "November"

levels(dat.no.nas$wave_factor)[8] <- "December"


```


#5. Format data to plot
```{r}
#get data in format to plot
dat_plot <- dat.no.nas %>%
  group_by(wave_factor) %>%
  dplyr::summarise(wcount = table(edeq.ed_scid5.weigh_weighed_past_month) / sum(table(edeq.ed_scid5.weigh_weighed_past_month))) %>%
  ungroup() %>%
  mutate(edeq.ed_scid5.weigh_weighed_past_month = rep(levels(dat.no.nas[["edeq.ed_scid5.weigh_weighed_past_month"]]),
                    length(levels(dat.no.nas[["wave_factor"]]))))


```

6. Change edeq variable to ordered factor
```{r}
dat_plot <- dat_plot %>%
  mutate(edeq.ed_scid5.weigh_weighed_past_month = fct_relevel(edeq.ed_scid5.weigh_weighed_past_month,
                           "No",
                           "Yes"))


```


7. PLOT ! Over the past month, have you weighed much less than other people thought you ought to weigh
```{r}

ggplot(dat_plot,
       aes(x = edeq.ed_scid5.weigh_weighed_past_month,
           y = wcount,
           fill = wave_factor)) +
  geom_bar(aes(group = wave_factor),
           stat = "identity",
           position = "dodge",
           colour = "black") + 
  scale_y_continuous(labels = scales::percent) +
  labs(title = str_wrap("EATING DISORDER CASES ONLY: Over the past month, have you weighed much less than other people thought you ought to weigh?", 60),
       x = "Low weight",
       y = "Percentage of participants",
       fill = "Time of survey") +
scale_x_discrete(guide = guide_axis(n.dodge=3))

```



##Filter by NO EATING DISORDER CASES
```{r}

dat.edeq.no.eating.disorders <- dat.edeq.screener %>%
  filter(eating_disorders_numeric == 0)


```

##PLOTS - Over the past month, have you weighed much less than other people thought you ought to weigh ?

#1. Get rid of NAs and change edeq to factor
```{r}
#get rid of nas
dat.no.nas <- dat.edeq.no.eating.disorders[!is.na(dat.edeq.no.eating.disorders$edeq.ed_scid5.weigh_weighed_past_month),]

```

#1. Change wave to factor and re-order
```{r}

# change order of wave factor 1
dat.no.nas <- dat.no.nas %>%
 mutate(wave_factor = fct_relevel(wave,
                                  "1",
                                  "2",
                                  "3",
                           "4",
                           "5",
                           "6",
                           "7",
                           "8"))


#Check that this worked

summary(dat.no.nas$wave_factor)
```

#4. Rename waves to dates
```{r}

##Rename waves

levels(dat.no.nas$wave_factor)[1] <- "May"

levels(dat.no.nas$wave_factor)[2] <- "June" 

levels(dat.no.nas$wave_factor)[3] <- "July "

levels(dat.no.nas$wave_factor)[4] <- "August"

levels(dat.no.nas$wave_factor)[5] <- "September"

levels(dat.no.nas$wave_factor)[6] <- "October"

levels(dat.no.nas$wave_factor)[7] <- "November"

levels(dat.no.nas$wave_factor)[8] <- "December"


```


#5. Format data to plot
```{r}
#get data in format to plot
dat_plot <- dat.no.nas %>%
  group_by(wave_factor) %>%
  dplyr::summarise(wcount = table(edeq.ed_scid5.weigh_weighed_past_month) / sum(table(edeq.ed_scid5.weigh_weighed_past_month))) %>%
  ungroup() %>%
  mutate(edeq.ed_scid5.weigh_weighed_past_month = rep(levels(dat.no.nas[["edeq.ed_scid5.weigh_weighed_past_month"]]),
                    length(levels(dat.no.nas[["wave_factor"]]))))


```

6. Change edeq variable to ordered factor
```{r}
dat_plot <- dat_plot %>%
  mutate(edeq.ed_scid5.weigh_weighed_past_month = fct_relevel(edeq.ed_scid5.weigh_weighed_past_month,
                           "No",
                           "Yes"))


```


7. PLOT ! Over the past month, have you weighed much less than other people thought you ought to weigh
```{r}

ggplot(dat_plot,
       aes(x = edeq.ed_scid5.weigh_weighed_past_month,
           y = wcount,
           fill = wave_factor)) +
  geom_bar(aes(group = wave_factor),
           stat = "identity",
           position = "dodge",
           colour = "black") + 
  scale_y_continuous(labels = scales::percent) +
  labs(title = str_wrap("NO EATING DISORDER CASES: Over the past month, have you weighed much less than other people thought you ought to weigh?", 60),
       x = "Low weight",
       y = "Percentage of participants",
       fill = "Time of survey") +
scale_x_discrete(guide = guide_axis(n.dodge=3))

```

##Filter by FEMALE
```{r}

dat.edeq.females <- dat.edeq.screener %>%
  filter(gender_unc == "Female")



```

##PLOTS - Over the past month, have you weighed much less than other people thought you ought to weigh ?

#1. Get rid of NAs and change edeq to factor
```{r}
#get rid of nas
dat.no.nas <- dat.edeq.females[!is.na(dat.edeq.females$edeq.ed_scid5.weigh_weighed_past_month),]

```

#1. Change wave to factor and re-order
```{r}

# change order of wave factor 1
dat.no.nas <- dat.no.nas %>%
 mutate(wave_factor = fct_relevel(wave,
                                  "1",
                                  "2",
                                  "3",
                           "4",
                           "5",
                           "6",
                           "7",
                           "8"))


#Check that this worked

summary(dat.no.nas$wave_factor)
```

#4. Rename waves to dates
```{r}

##Rename waves

levels(dat.no.nas$wave_factor)[1] <- "May"

levels(dat.no.nas$wave_factor)[2] <- "June" 

levels(dat.no.nas$wave_factor)[3] <- "July "

levels(dat.no.nas$wave_factor)[4] <- "August"

levels(dat.no.nas$wave_factor)[5] <- "September"

levels(dat.no.nas$wave_factor)[6] <- "October"

levels(dat.no.nas$wave_factor)[7] <- "November"

levels(dat.no.nas$wave_factor)[8] <- "December"


```


#5. Format data to plot
```{r}
#get data in format to plot
dat_plot <- dat.no.nas %>%
  group_by(wave_factor) %>%
  dplyr::summarise(wcount = table(edeq.ed_scid5.weigh_weighed_past_month) / sum(table(edeq.ed_scid5.weigh_weighed_past_month))) %>%
  ungroup() %>%
  mutate(edeq.ed_scid5.weigh_weighed_past_month = rep(levels(dat.no.nas[["edeq.ed_scid5.weigh_weighed_past_month"]]),
                    length(levels(dat.no.nas[["wave_factor"]]))))


```

6. Change edeq variable to ordered factor
```{r}
dat_plot <- dat_plot %>%
  mutate(edeq.ed_scid5.weigh_weighed_past_month = fct_relevel(edeq.ed_scid5.weigh_weighed_past_month,
                           "No",
                           "Yes"))


```


7. PLOT ! Over the past month, have you weighed much less than other people thought you ought to weigh
```{r}

ggplot(dat_plot,
       aes(x = edeq.ed_scid5.weigh_weighed_past_month,
           y = wcount,
           fill = wave_factor)) +
  geom_bar(aes(group = wave_factor),
           stat = "identity",
           position = "dodge",
           colour = "black") + 
  scale_y_continuous(labels = scales::percent) +
  labs(title = str_wrap("WOMEN ONLY: Over the past month, have you weighed much less than other people thought you ought to weigh?", 60),
       x = "Low weight",
       y = "Percentage of participants",
       fill = "Time of survey") +
scale_x_discrete(guide = guide_axis(n.dodge=3))

```


##Filter by MALE
```{r}

dat.edeq.males <- dat.edeq.screener %>%
  filter(gender_unc == "Male")



```

##PLOTS - Over the past month, have you weighed much less than other people thought you ought to weigh ?

#1. Get rid of NAs and change edeq to factor
```{r}
#get rid of nas
dat.no.nas <- dat.edeq.males[!is.na(dat.edeq.males$edeq.ed_scid5.weigh_weighed_past_month),]

```

#1. Change wave to factor and re-order
```{r}

# change order of wave factor 1
dat.no.nas <- dat.no.nas %>%
 mutate(wave_factor = fct_relevel(wave,
                                  "1",
                                  "2",
                                  "3",
                           "4",
                           "5",
                           "6",
                           "7",
                           "8"))


#Check that this worked

summary(dat.no.nas$wave_factor)
```

#4. Rename waves to dates
```{r}

##Rename waves

levels(dat.no.nas$wave_factor)[1] <- "May"

levels(dat.no.nas$wave_factor)[2] <- "June" 

levels(dat.no.nas$wave_factor)[3] <- "July "

levels(dat.no.nas$wave_factor)[4] <- "August"

levels(dat.no.nas$wave_factor)[5] <- "September"

levels(dat.no.nas$wave_factor)[6] <- "October"

levels(dat.no.nas$wave_factor)[7] <- "November"

levels(dat.no.nas$wave_factor)[8] <- "December"


```


#5. Format data to plot
```{r}
#get data in format to plot
dat_plot <- dat.no.nas %>%
  group_by(wave_factor) %>%
  dplyr::summarise(wcount = table(edeq.ed_scid5.weigh_weighed_past_month) / sum(table(edeq.ed_scid5.weigh_weighed_past_month))) %>%
  ungroup() %>%
  mutate(edeq.ed_scid5.weigh_weighed_past_month = rep(levels(dat.no.nas[["edeq.ed_scid5.weigh_weighed_past_month"]]),
                    length(levels(dat.no.nas[["wave_factor"]]))))


```

6. Change edeq variable to ordered factor
```{r}
dat_plot <- dat_plot %>%
  mutate(edeq.ed_scid5.weigh_weighed_past_month = fct_relevel(edeq.ed_scid5.weigh_weighed_past_month,
                           "No",
                           "Yes"))


```


7. PLOT ! Over the past month, have you weighed much less than other people thought you ought to weigh
```{r}

ggplot(dat_plot,
       aes(x = edeq.ed_scid5.weigh_weighed_past_month,
           y = wcount,
           fill = wave_factor)) +
  geom_bar(aes(group = wave_factor),
           stat = "identity",
           position = "dodge",
           colour = "black") + 
  scale_y_continuous(labels = scales::percent) +
  labs(title = str_wrap("MEN ONLY: Over the past month, have you weighed much less than other people thought you ought to weigh?", 60),
       x = "Low weight",
       y = "Percentage of participants",
       fill = "Time of survey") +
scale_x_discrete(guide = guide_axis(n.dodge=3))

```



##Filter by AGE, 16-25

16-18     
19-25
26-35    
36-45    
46-55    
56-65    
66-70    
71-75  
76-80  
81-85  
86-90
91-100
 100+  
```{r}

dat.edeq.1625 <- dat.edeq.screener %>%
  filter(age_category == "16-18" |
           age_category == "19-25")

```

##PLOTS - Over the past month, have you weighed much less than other people thought you ought to weigh ?

#1. Get rid of NAs and change edeq to factor
```{r}
#get rid of nas
dat.no.nas <- dat.edeq.1625[!is.na(dat.edeq.1625$edeq.ed_scid5.weigh_weighed_past_month),]

```

#1. Change wave to factor and re-order
```{r}

# change order of wave factor 1
dat.no.nas <- dat.no.nas %>%
 mutate(wave_factor = fct_relevel(wave,
                                  "1",
                                  "2",
                                  "3",
                           "4",
                           "5",
                           "6",
                           "7",
                           "8"))


#Check that this worked

summary(dat.no.nas$wave_factor)
```

#4. Rename waves to dates
```{r}

##Rename waves

levels(dat.no.nas$wave_factor)[1] <- "May"

levels(dat.no.nas$wave_factor)[2] <- "June" 

levels(dat.no.nas$wave_factor)[3] <- "July "

levels(dat.no.nas$wave_factor)[4] <- "August"

levels(dat.no.nas$wave_factor)[5] <- "September"

levels(dat.no.nas$wave_factor)[6] <- "October"

levels(dat.no.nas$wave_factor)[7] <- "November"

levels(dat.no.nas$wave_factor)[8] <- "December"


```


#5. Format data to plot
```{r}
#get data in format to plot
dat_plot <- dat.no.nas %>%
  group_by(wave_factor) %>%
  dplyr::summarise(wcount = table(edeq.ed_scid5.weigh_weighed_past_month) / sum(table(edeq.ed_scid5.weigh_weighed_past_month))) %>%
  ungroup() %>%
  mutate(edeq.ed_scid5.weigh_weighed_past_month = rep(levels(dat.no.nas[["edeq.ed_scid5.weigh_weighed_past_month"]]),
                    length(levels(dat.no.nas[["wave_factor"]]))))


```

6. Change edeq variable to ordered factor
```{r}
dat_plot <- dat_plot %>%
  mutate(edeq.ed_scid5.weigh_weighed_past_month = fct_relevel(edeq.ed_scid5.weigh_weighed_past_month,
                           "No",
                           "Yes"))


```


7. PLOT ! Over the past month, have you weighed much less than other people thought you ought to weigh
```{r}

ggplot(dat_plot,
       aes(x = edeq.ed_scid5.weigh_weighed_past_month,
           y = wcount,
           fill = wave_factor)) +
  geom_bar(aes(group = wave_factor),
           stat = "identity",
           position = "dodge",
           colour = "black") + 
  scale_y_continuous(labels = scales::percent) +
  labs(title = str_wrap("16-25 year olds ONLY: Over the past month, have you weighed much less than other people thought you ought to weigh?", 60),
       x = "Low weight",
       y = "Percentage of participants",
       fill = "Time of survey") +
scale_x_discrete(guide = guide_axis(n.dodge=3))

```



##Filter by AGE, 26-35

16-18     
19-25
26-35    
36-45    
46-55    
56-65    
66-70    
71-75  
76-80  
81-85  
86-90
91-100
 100+  
```{r}

dat.edeq.2635 <- dat.edeq.screener %>%
  filter(age_category == "26-35")

```

##PLOTS - Over the past month, have you weighed much less than other people thought you ought to weigh ?

#1. Get rid of NAs and change edeq to factor
```{r}
#get rid of nas
dat.no.nas <- dat.edeq.2635[!is.na(dat.edeq.2635$edeq.ed_scid5.weigh_weighed_past_month),]

```

#1. Change wave to factor and re-order
```{r}

# change order of wave factor 1
dat.no.nas <- dat.no.nas %>%
 mutate(wave_factor = fct_relevel(wave,
                                  "1",
                                  "2",
                                  "3",
                           "4",
                           "5",
                           "6",
                           "7",
                           "8"))


#Check that this worked

summary(dat.no.nas$wave_factor)
```

#4. Rename waves to dates
```{r}

##Rename waves

levels(dat.no.nas$wave_factor)[1] <- "May"

levels(dat.no.nas$wave_factor)[2] <- "June" 

levels(dat.no.nas$wave_factor)[3] <- "July "

levels(dat.no.nas$wave_factor)[4] <- "August"

levels(dat.no.nas$wave_factor)[5] <- "September"

levels(dat.no.nas$wave_factor)[6] <- "October"

levels(dat.no.nas$wave_factor)[7] <- "November"

levels(dat.no.nas$wave_factor)[8] <- "December"


```


#5. Format data to plot
```{r}
#get data in format to plot
dat_plot <- dat.no.nas %>%
  group_by(wave_factor) %>%
  dplyr::summarise(wcount = table(edeq.ed_scid5.weigh_weighed_past_month) / sum(table(edeq.ed_scid5.weigh_weighed_past_month))) %>%
  ungroup() %>%
  mutate(edeq.ed_scid5.weigh_weighed_past_month = rep(levels(dat.no.nas[["edeq.ed_scid5.weigh_weighed_past_month"]]),
                    length(levels(dat.no.nas[["wave_factor"]]))))


```

6. Change edeq variable to ordered factor
```{r}
dat_plot <- dat_plot %>%
  mutate(edeq.ed_scid5.weigh_weighed_past_month = fct_relevel(edeq.ed_scid5.weigh_weighed_past_month,
                           "No",
                           "Yes"))


```


7. PLOT ! Over the past month, have you weighed much less than other people thought you ought to weigh
```{r}

ggplot(dat_plot,
       aes(x = edeq.ed_scid5.weigh_weighed_past_month,
           y = wcount,
           fill = wave_factor)) +
  geom_bar(aes(group = wave_factor),
           stat = "identity",
           position = "dodge",
           colour = "black") + 
  scale_y_continuous(labels = scales::percent) +
  labs(title = str_wrap("26-35 year olds ONLY: Over the past month, have you weighed much less than other people thought you ought to weigh?", 60),
       x = "Low weight",
       y = "Percentage of participants",
       fill = "Time of survey") +
scale_x_discrete(guide = guide_axis(n.dodge=3))

```

##Filter by AGE, 36-45

16-18     
19-25
26-35    
36-45    
46-55    
56-65    
66-70    
71-75  
76-80  
81-85  
86-90
91-100
 100+  
```{r}

dat.edeq.3645 <- dat.edeq.screener %>%
  filter(age_category == "36-45")

```

##PLOTS - Over the past month, have you weighed much less than other people thought you ought to weigh ?

#1. Get rid of NAs and change edeq to factor
```{r}
#get rid of nas
dat.no.nas <- dat.edeq.3645[!is.na(dat.edeq.3645$edeq.ed_scid5.weigh_weighed_past_month),]

```

#1. Change wave to factor and re-order
```{r}

# change order of wave factor 1
dat.no.nas <- dat.no.nas %>%
 mutate(wave_factor = fct_relevel(wave,
                                  "1",
                                  "2",
                                  "3",
                           "4",
                           "5",
                           "6",
                           "7",
                           "8"))


#Check that this worked

summary(dat.no.nas$wave_factor)
```

#4. Rename waves to dates
```{r}

##Rename waves

levels(dat.no.nas$wave_factor)[1] <- "May"

levels(dat.no.nas$wave_factor)[2] <- "June" 

levels(dat.no.nas$wave_factor)[3] <- "July "

levels(dat.no.nas$wave_factor)[4] <- "August"

levels(dat.no.nas$wave_factor)[5] <- "September"

levels(dat.no.nas$wave_factor)[6] <- "October"

levels(dat.no.nas$wave_factor)[7] <- "November"

levels(dat.no.nas$wave_factor)[8] <- "December"


```


#5. Format data to plot
```{r}
#get data in format to plot
dat_plot <- dat.no.nas %>%
  group_by(wave_factor) %>%
  dplyr::summarise(wcount = table(edeq.ed_scid5.weigh_weighed_past_month) / sum(table(edeq.ed_scid5.weigh_weighed_past_month))) %>%
  ungroup() %>%
  mutate(edeq.ed_scid5.weigh_weighed_past_month = rep(levels(dat.no.nas[["edeq.ed_scid5.weigh_weighed_past_month"]]),
                    length(levels(dat.no.nas[["wave_factor"]]))))


```

6. Change edeq variable to ordered factor
```{r}
dat_plot <- dat_plot %>%
  mutate(edeq.ed_scid5.weigh_weighed_past_month = fct_relevel(edeq.ed_scid5.weigh_weighed_past_month,
                           "No",
                           "Yes"))


```


7. PLOT ! Over the past month, have you weighed much less than other people thought you ought to weigh
```{r}

ggplot(dat_plot,
       aes(x = edeq.ed_scid5.weigh_weighed_past_month,
           y = wcount,
           fill = wave_factor)) +
  geom_bar(aes(group = wave_factor),
           stat = "identity",
           position = "dodge",
           colour = "black") + 
  scale_y_continuous(labels = scales::percent) +
  labs(title = str_wrap("36-45 year olds ONLY: Over the past month, have you weighed much less than other people thought you ought to weigh?", 60),
       x = "Low weight",
       y = "Percentage of participants",
       fill = "Time of survey") +
scale_x_discrete(guide = guide_axis(n.dodge=3))

```


##Filter by AGE, 46-55

16-18     
19-25
26-35    
36-45    
46-55    
56-65    
66-70    
71-75  
76-80  
81-85  
86-90
91-100
 100+  
```{r}

dat.edeq.4655 <- dat.edeq.screener %>%
  filter(age_category == "46-55")

```

##PLOTS - Over the past month, have you weighed much less than other people thought you ought to weigh ?

#1. Get rid of NAs and change edeq to factor
```{r}
#get rid of nas
dat.no.nas <- dat.edeq.4655[!is.na(dat.edeq.4655$edeq.ed_scid5.weigh_weighed_past_month),]

```

#1. Change wave to factor and re-order
```{r}

# change order of wave factor 1
dat.no.nas <- dat.no.nas %>%
 mutate(wave_factor = fct_relevel(wave,
                                  "1",
                                  "2",
                                  "3",
                           "4",
                           "5",
                           "6",
                           "7",
                           "8"))


#Check that this worked

summary(dat.no.nas$wave_factor)
```

#4. Rename waves to dates
```{r}

##Rename waves

levels(dat.no.nas$wave_factor)[1] <- "May"

levels(dat.no.nas$wave_factor)[2] <- "June" 

levels(dat.no.nas$wave_factor)[3] <- "July "

levels(dat.no.nas$wave_factor)[4] <- "August"

levels(dat.no.nas$wave_factor)[5] <- "September"

levels(dat.no.nas$wave_factor)[6] <- "October"

levels(dat.no.nas$wave_factor)[7] <- "November"

levels(dat.no.nas$wave_factor)[8] <- "December"


```


#5. Format data to plot
```{r}
#get data in format to plot
dat_plot <- dat.no.nas %>%
  group_by(wave_factor) %>%
  dplyr::summarise(wcount = table(edeq.ed_scid5.weigh_weighed_past_month) / sum(table(edeq.ed_scid5.weigh_weighed_past_month))) %>%
  ungroup() %>%
  mutate(edeq.ed_scid5.weigh_weighed_past_month = rep(levels(dat.no.nas[["edeq.ed_scid5.weigh_weighed_past_month"]]),
                    length(levels(dat.no.nas[["wave_factor"]]))))


```

6. Change edeq variable to ordered factor
```{r}
dat_plot <- dat_plot %>%
  mutate(edeq.ed_scid5.weigh_weighed_past_month = fct_relevel(edeq.ed_scid5.weigh_weighed_past_month,
                           "No",
                           "Yes"))


```


7. PLOT ! Over the past month, have you weighed much less than other people thought you ought to weigh
```{r}

ggplot(dat_plot,
       aes(x = edeq.ed_scid5.weigh_weighed_past_month,
           y = wcount,
           fill = wave_factor)) +
  geom_bar(aes(group = wave_factor),
           stat = "identity",
           position = "dodge",
           colour = "black") + 
  scale_y_continuous(labels = scales::percent) +
  labs(title = str_wrap("46-55 year olds ONLY: Over the past month, have you weighed much less than other people thought you ought to weigh?", 60),
       x = "Low weight",
       y = "Percentage of participants",
       fill = "Time of survey") +
scale_x_discrete(guide = guide_axis(n.dodge=3))

```



##Filter by AGE, 56-65  

16-18     
19-25
26-35    
36-45    
46-55    
56-65    
66-70    
71-75  
76-80  
81-85  
86-90
91-100
 100+  
```{r}

dat.edeq.5665 <- dat.edeq.screener %>%
  filter(age_category == "56-65")

```

##PLOTS - Over the past month, have you weighed much less than other people thought you ought to weigh ?

#1. Get rid of NAs and change edeq to factor
```{r}
#get rid of nas
dat.no.nas <- dat.edeq.5665[!is.na(dat.edeq.5665$edeq.ed_scid5.weigh_weighed_past_month),]

```

#1. Change wave to factor and re-order
```{r}

# change order of wave factor 1
dat.no.nas <- dat.no.nas %>%
 mutate(wave_factor = fct_relevel(wave,
                                  "1",
                                  "2",
                                  "3",
                           "4",
                           "5",
                           "6",
                           "7",
                           "8"))


#Check that this worked

summary(dat.no.nas$wave_factor)
```

#4. Rename waves to dates
```{r}

##Rename waves

levels(dat.no.nas$wave_factor)[1] <- "May"

levels(dat.no.nas$wave_factor)[2] <- "June" 

levels(dat.no.nas$wave_factor)[3] <- "July "

levels(dat.no.nas$wave_factor)[4] <- "August"

levels(dat.no.nas$wave_factor)[5] <- "September"

levels(dat.no.nas$wave_factor)[6] <- "October"

levels(dat.no.nas$wave_factor)[7] <- "November"

levels(dat.no.nas$wave_factor)[8] <- "December"


```


#5. Format data to plot
```{r}
#get data in format to plot
dat_plot <- dat.no.nas %>%
  group_by(wave_factor) %>%
  dplyr::summarise(wcount = table(edeq.ed_scid5.weigh_weighed_past_month) / sum(table(edeq.ed_scid5.weigh_weighed_past_month))) %>%
  ungroup() %>%
  mutate(edeq.ed_scid5.weigh_weighed_past_month = rep(levels(dat.no.nas[["edeq.ed_scid5.weigh_weighed_past_month"]]),
                    length(levels(dat.no.nas[["wave_factor"]]))))


```

6. Change edeq variable to ordered factor
```{r}
dat_plot <- dat_plot %>%
  mutate(edeq.ed_scid5.weigh_weighed_past_month = fct_relevel(edeq.ed_scid5.weigh_weighed_past_month,
                           "No",
                           "Yes"))


```


7. PLOT ! Over the past month, have you weighed much less than other people thought you ought to weigh
```{r}

ggplot(dat_plot,
       aes(x = edeq.ed_scid5.weigh_weighed_past_month,
           y = wcount,
           fill = wave_factor)) +
  geom_bar(aes(group = wave_factor),
           stat = "identity",
           position = "dodge",
           colour = "black") + 
  scale_y_continuous(labels = scales::percent) +
  labs(title = str_wrap("56-65 year olds ONLY: Over the past month, have you weighed much less than other people thought you ought to weigh?", 60),
       x = "Low weight",
       y = "Percentage of participants",
       fill = "Time of survey") +
scale_x_discrete(guide = guide_axis(n.dodge=3))

```


##Filter by AGE, 70+

```{r}

dat.edeq.70 <- dat.edeq.screener %>%
  filter(age_category == "66-70" |
           age_category == "71-75" | 
           age_category == "76-80" | 
         age_category == "81-85" | 
         age_category == "86-90" |
           age_category == "91-100" |
           age_category == "100+")

```

##PLOTS - Over the past month, have you weighed much less than other people thought you ought to weigh ?

#1. Get rid of NAs and change edeq to factor
```{r}
#get rid of nas
dat.no.nas <- dat.edeq.70[!is.na(dat.edeq.70$edeq.ed_scid5.weigh_weighed_past_month),]

```

#1. Change wave to factor and re-order
```{r}

# change order of wave factor 1
dat.no.nas <- dat.no.nas %>%
 mutate(wave_factor = fct_relevel(wave,
                                  "1",
                                  "2",
                                  "3",
                           "4",
                           "5",
                           "6",
                           "7",
                           "8"))


#Check that this worked

summary(dat.no.nas$wave_factor)
```

Drop empty factor levels across all columns 
```{r}

dat.no.nas <-  droplevels(dat.no.nas)

```


#4. Rename waves to dates
```{r}

##Rename waves

levels(dat.no.nas$wave_factor)[1] <- "May"

levels(dat.no.nas$wave_factor)[2] <- "June" 

levels(dat.no.nas$wave_factor)[3] <- "July "

levels(dat.no.nas$wave_factor)[4] <- "August"

levels(dat.no.nas$wave_factor)[5] <- "September"

levels(dat.no.nas$wave_factor)[6] <- "October"

levels(dat.no.nas$wave_factor)[7] <- "November"

levels(dat.no.nas$wave_factor)[8] <- "December"


```


#5. Format data to plot
```{r}
#get data in format to plot
dat_plot <- dat.no.nas %>%
  group_by(wave_factor) %>%
  dplyr::summarise(wcount = table(edeq.ed_scid5.weigh_weighed_past_month) / sum(table(edeq.ed_scid5.weigh_weighed_past_month))) %>%
  ungroup() %>%
  mutate(edeq.ed_scid5.weigh_weighed_past_month = rep(levels(dat.no.nas[["edeq.ed_scid5.weigh_weighed_past_month"]]),
                    length(levels(dat.no.nas[["wave_factor"]]))))


```

6. Change edeq variable to ordered factor
```{r}
dat_plot <- dat_plot %>%
  mutate(edeq.ed_scid5.weigh_weighed_past_month = fct_relevel(edeq.ed_scid5.weigh_weighed_past_month,
                           "No",
                           "Yes"))


```


7. PLOT ! Over the past month, have you weighed much less than other people thought you ought to weigh
```{r}

ggplot(dat_plot,
       aes(x = edeq.ed_scid5.weigh_weighed_past_month,
           y = wcount,
           fill = wave_factor)) +
  geom_bar(aes(group = wave_factor),
           stat = "identity",
           position = "dodge",
           colour = "black") + 
  scale_y_continuous(labels = scales::percent) +
  labs(title = str_wrap("70+ year olds only: Over the past month, have you weighed much less than other people thought you ought to weigh?", 60),
       x = "Low weight",
       y = "Percentage of participants",
       fill = "Time of survey") +
scale_x_discrete(guide = guide_axis(n.dodge=3))

```


##Filter by cohort - RAMP
```{r}

dat.edeq.ramp <- dat.edeq.screener %>%
  filter(cohort_name == "ramp")

```

##PLOTS - Over the past month, have you weighed much less than other people thought you ought to weigh ?

#1. Get rid of NAs and change edeq to factor
```{r}
#get rid of nas
dat.no.nas <- dat.edeq.ramp[!is.na(dat.edeq.ramp$edeq.ed_scid5.weigh_weighed_past_month),]

```

#1. Change wave to factor and re-order
```{r}

# change order of wave factor 1
dat.no.nas <- dat.no.nas %>%
 mutate(wave_factor = fct_relevel(wave,
                                  "1",
                                  "2",
                                  "3",
                           "4",
                           "5",
                           "6",
                           "7",
                           "8"))


#Check that this worked

summary(dat.no.nas$wave_factor)
```

Drop empty factor levels across all columns 
```{r}

dat.no.nas <-  droplevels(dat.no.nas)

```


#4. Rename waves to dates
```{r}

##Rename waves

levels(dat.no.nas$wave_factor)[1] <- "May"

levels(dat.no.nas$wave_factor)[2] <- "June" 

levels(dat.no.nas$wave_factor)[3] <- "July "

levels(dat.no.nas$wave_factor)[4] <- "August"

levels(dat.no.nas$wave_factor)[5] <- "September"

levels(dat.no.nas$wave_factor)[6] <- "October"

levels(dat.no.nas$wave_factor)[7] <- "November"

levels(dat.no.nas$wave_factor)[8] <- "December"


```


#5. Format data to plot
```{r}
#get data in format to plot
dat_plot <- dat.no.nas %>%
  group_by(wave_factor) %>%
  dplyr::summarise(wcount = table(edeq.ed_scid5.weigh_weighed_past_month) / sum(table(edeq.ed_scid5.weigh_weighed_past_month))) %>%
  ungroup() %>%
  mutate(edeq.ed_scid5.weigh_weighed_past_month = rep(levels(dat.no.nas[["edeq.ed_scid5.weigh_weighed_past_month"]]),
                    length(levels(dat.no.nas[["wave_factor"]]))))


```

6. Change edeq variable to ordered factor
```{r}
dat_plot <- dat_plot %>%
  mutate(edeq.ed_scid5.weigh_weighed_past_month = fct_relevel(edeq.ed_scid5.weigh_weighed_past_month,
                           "No",
                           "Yes"))


```


7. PLOT ! Over the past month, have you weighed much less than other people thought you ought to weigh
```{r}

ggplot(dat_plot,
       aes(x = edeq.ed_scid5.weigh_weighed_past_month,
           y = wcount,
           fill = wave_factor)) +
  geom_bar(aes(group = wave_factor),
           stat = "identity",
           position = "dodge",
           colour = "black") + 
  scale_y_continuous(labels = scales::percent) +
  labs(title = str_wrap("RAMP only: Over the past month, have you weighed much less than other people thought you ought to weigh?", 60),
       x = "Low weight",
       y = "Percentage of participants",
       fill = "Time of survey") +
scale_x_discrete(guide = guide_axis(n.dodge=3))

```


##Filter by cohort - COPING
```{r}

dat.edeq.coping <- dat.edeq.screener %>%
  filter(cohort_name == "coping_edgi" | 
           cohort_name == "coping_glad" |
         cohort_name == "nbr")

```

##PLOTS - Over the past month, have you weighed much less than other people thought you ought to weigh ?

#1. Get rid of NAs and change edeq to factor
```{r}
#get rid of nas
dat.no.nas <- dat.edeq.coping[!is.na(dat.edeq.coping$edeq.ed_scid5.weigh_weighed_past_month),]

```

#1. Change wave to factor and re-order
```{r}

# change order of wave factor 1
dat.no.nas <- dat.no.nas %>%
 mutate(wave_factor = fct_relevel(wave,
                                  "1",
                                  "2",
                                  "3",
                           "4",
                           "5",
                           "6",
                           "7",
                           "8"))


#Check that this worked

summary(dat.no.nas$wave_factor)
```

Drop empty factor levels across all columns 
```{r}

dat.no.nas <-  droplevels(dat.no.nas)

```


#4. Rename waves to dates
```{r}

##Rename waves

#levels(dat.no.nas$wave_factor)[1] <- "May"

levels(dat.no.nas$wave_factor)[1] <- "June" 

levels(dat.no.nas$wave_factor)[2] <- "July "

levels(dat.no.nas$wave_factor)[3] <- "August"

levels(dat.no.nas$wave_factor)[4] <- "September"

levels(dat.no.nas$wave_factor)[5] <- "October"

levels(dat.no.nas$wave_factor)[6] <- "November"

levels(dat.no.nas$wave_factor)[7] <- "December"


```


#5. Format data to plot
```{r}
#get data in format to plot
dat_plot <- dat.no.nas %>%
  group_by(wave_factor) %>%
  dplyr::summarise(wcount = table(edeq.ed_scid5.weigh_weighed_past_month) / sum(table(edeq.ed_scid5.weigh_weighed_past_month))) %>%
  ungroup() %>%
  mutate(edeq.ed_scid5.weigh_weighed_past_month = rep(levels(dat.no.nas[["edeq.ed_scid5.weigh_weighed_past_month"]]),
                    length(levels(dat.no.nas[["wave_factor"]]))))


```

6. Change edeq variable to ordered factor
```{r}
dat_plot <- dat_plot %>%
  mutate(edeq.ed_scid5.weigh_weighed_past_month = fct_relevel(edeq.ed_scid5.weigh_weighed_past_month,
                           "No",
                           "Yes"))


```


7. PLOT ! Over the past month, have you weighed much less than other people thought you ought to weigh
```{r}

ggplot(dat_plot,
       aes(x = edeq.ed_scid5.weigh_weighed_past_month,
           y = wcount,
           fill = wave_factor)) +
  geom_bar(aes(group = wave_factor),
           stat = "identity",
           position = "dodge",
           colour = "black") + 
  scale_y_continuous(labels = scales::percent) +
  labs(title = str_wrap("COPING only: Over the past month, have you weighed much less than other people thought you ought to weigh?", 60),
       x = "Low weight",
       y = "Percentage of participants",
       fill = "Time of survey") +
scale_x_discrete(guide = guide_axis(n.dodge=3))

```

##Filter by PREPANDEMIC AN GROUPING VARIABLE
```{r}

dat.edeq.AN <- dat.edeq.screener %>%
  filter(anorexia_group_numeric == 1 | 
           COPING_anorexia_group_numeric ==1)

```

##PLOTS - Over the past month, have you weighed much less than other people thought you ought to weigh ?

#1. Get rid of NAs and change edeq to factor
```{r}
#get rid of nas
dat.no.nas <- dat.edeq.AN[!is.na(dat.edeq.AN$edeq.ed_scid5.weigh_weighed_past_month),]

```

#1. Change wave to factor and re-order
```{r}

# change order of wave factor 1
dat.no.nas <- dat.no.nas %>%
 mutate(wave_factor = fct_relevel(wave,
                                  "1",
                                  "2",
                                  "3",
                           "4",
                           "5",
                           "6",
                           "7",
                           "8"))


#Check that this worked

summary(dat.no.nas$wave_factor)
```

Drop empty factor levels across all columns 
```{r}

dat.no.nas <-  droplevels(dat.no.nas)

```


#4. Rename waves to dates
```{r}

##Rename waves

levels(dat.no.nas$wave_factor)[1] <- "May"

levels(dat.no.nas$wave_factor)[2] <- "June" 

levels(dat.no.nas$wave_factor)[3] <- "July "

levels(dat.no.nas$wave_factor)[4] <- "August"

levels(dat.no.nas$wave_factor)[5] <- "September"

levels(dat.no.nas$wave_factor)[6] <- "October"

levels(dat.no.nas$wave_factor)[7] <- "November"

levels(dat.no.nas$wave_factor)[8] <- "December"

```


#5. Format data to plot
```{r}
#get data in format to plot
dat_plot <- dat.no.nas %>%
  group_by(wave_factor) %>%
  dplyr::summarise(wcount = table(edeq.ed_scid5.weigh_weighed_past_month) / sum(table(edeq.ed_scid5.weigh_weighed_past_month))) %>%
  ungroup() %>%
  mutate(edeq.ed_scid5.weigh_weighed_past_month = rep(levels(dat.no.nas[["edeq.ed_scid5.weigh_weighed_past_month"]]),
                    length(levels(dat.no.nas[["wave_factor"]]))))


```

6. Change edeq variable to ordered factor
```{r}
dat_plot <- dat_plot %>%
  mutate(edeq.ed_scid5.weigh_weighed_past_month = fct_relevel(edeq.ed_scid5.weigh_weighed_past_month,
                           "No",
                           "Yes"))


```


7. PLOT ! Over the past month, have you weighed much less than other people thought you ought to weigh
```{r}

ggplot(dat_plot,
       aes(x = edeq.ed_scid5.weigh_weighed_past_month,
           y = wcount,
           fill = wave_factor)) +
  geom_bar(aes(group = wave_factor),
           stat = "identity",
           position = "dodge",
           colour = "black") + 
  scale_y_continuous(labels = scales::percent) +
  labs(title = str_wrap("Pre-pandemic AN only: Over the past month, have you weighed much less than other people thought you ought to weigh?", 60),
       x = "Low weight",
       y = "Percentage of participants",
       fill = "Time of survey") +
scale_x_discrete(guide = guide_axis(n.dodge=3))

```

##Filter by PREPANDEMIC BN GROUPING VARIABLE

```{r}

dat.edeq.BN <- dat.edeq.screener %>%
  filter(bulimia_group_numeric == 1 | 
           COPING_bulimia_group_numeric ==1)

```

##PLOTS - Over the past month, have you weighed much less than other people thought you ought to weigh ?

#1. Get rid of NAs and change edeq to factor
```{r}
#get rid of nas
dat.no.nas <- dat.edeq.BN[!is.na(dat.edeq.BN$edeq.ed_scid5.weigh_weighed_past_month),]

```

#1. Change wave to factor and re-order
```{r}

# change order of wave factor 1
dat.no.nas <- dat.no.nas %>%
 mutate(wave_factor = fct_relevel(wave,
                                  "1",
                                  "2",
                                  "3",
                           "4",
                           "5",
                           "6",
                           "7",
                           "8"))


#Check that this worked

summary(dat.no.nas$wave_factor)
```

Drop empty factor levels across all columns 
```{r}

dat.no.nas <-  droplevels(dat.no.nas)

```


#4. Rename waves to dates
```{r}

##Rename waves

levels(dat.no.nas$wave_factor)[1] <- "May"

levels(dat.no.nas$wave_factor)[2] <- "June" 

levels(dat.no.nas$wave_factor)[3] <- "July "

levels(dat.no.nas$wave_factor)[4] <- "August"

levels(dat.no.nas$wave_factor)[5] <- "September"

levels(dat.no.nas$wave_factor)[6] <- "October"

levels(dat.no.nas$wave_factor)[7] <- "November"

levels(dat.no.nas$wave_factor)[8] <- "December"

```


#5. Format data to plot
```{r}
#get data in format to plot
dat_plot <- dat.no.nas %>%
  group_by(wave_factor) %>%
  dplyr::summarise(wcount = table(edeq.ed_scid5.weigh_weighed_past_month) / sum(table(edeq.ed_scid5.weigh_weighed_past_month))) %>%
  ungroup() %>%
  mutate(edeq.ed_scid5.weigh_weighed_past_month = rep(levels(dat.no.nas[["edeq.ed_scid5.weigh_weighed_past_month"]]),
                    length(levels(dat.no.nas[["wave_factor"]]))))


```

6. Change edeq variable to ordered factor
```{r}
dat_plot <- dat_plot %>%
  mutate(edeq.ed_scid5.weigh_weighed_past_month = fct_relevel(edeq.ed_scid5.weigh_weighed_past_month,
                           "No",
                           "Yes"))


```


7. PLOT ! Over the past month, have you weighed much less than other people thought you ought to weigh
```{r}

ggplot(dat_plot,
       aes(x = edeq.ed_scid5.weigh_weighed_past_month,
           y = wcount,
           fill = wave_factor)) +
  geom_bar(aes(group = wave_factor),
           stat = "identity",
           position = "dodge",
           colour = "black") + 
  scale_y_continuous(labels = scales::percent) +
  labs(title = str_wrap("Pre-pandemic BN only: Over the past month, have you weighed much less than other people thought you ought to weigh?", 60),
       x = "Low weight",
       y = "Percentage of participants",
       fill = "Time of survey") +
scale_x_discrete(guide = guide_axis(n.dodge=3))

```
##Filter by PREPANDEMIC BED GROUPING VARIABLE

```{r}

dat.edeq.BED <- dat.edeq.screener %>%
  filter(COPING_bed_group_numeric == 1 | 
           BED_group_numeric ==1)

```

##PLOTS - Over the past month, have you weighed much less than other people thought you ought to weigh ?

#1. Get rid of NAs and change edeq to factor
```{r}
#get rid of nas
dat.no.nas <- dat.edeq.BED[!is.na(dat.edeq.BED$edeq.ed_scid5.weigh_weighed_past_month),]

```

#1. Change wave to factor and re-order
```{r}

# change order of wave factor 1
dat.no.nas <- dat.no.nas %>%
 mutate(wave_factor = fct_relevel(wave,
                                  "1",
                                  "2",
                                  "3",
                           "4",
                           "5",
                           "6",
                           "7",
                           "8"))


#Check that this worked

summary(dat.no.nas$wave_factor)
```

Drop empty factor levels across all columns 
```{r}

dat.no.nas <-  droplevels(dat.no.nas)

```


#4. Rename waves to dates
```{r}

##Rename waves

levels(dat.no.nas$wave_factor)[1] <- "May"

levels(dat.no.nas$wave_factor)[2] <- "June" 

levels(dat.no.nas$wave_factor)[3] <- "July "

levels(dat.no.nas$wave_factor)[4] <- "August"

levels(dat.no.nas$wave_factor)[5] <- "September"

levels(dat.no.nas$wave_factor)[6] <- "October"

levels(dat.no.nas$wave_factor)[7] <- "November"

levels(dat.no.nas$wave_factor)[8] <- "December"

```


#5. Format data to plot
```{r}
#get data in format to plot
dat_plot <- dat.no.nas %>%
  group_by(wave_factor) %>%
  dplyr::summarise(wcount = table(edeq.ed_scid5.weigh_weighed_past_month) / sum(table(edeq.ed_scid5.weigh_weighed_past_month))) %>%
  ungroup() %>%
  mutate(edeq.ed_scid5.weigh_weighed_past_month = rep(levels(dat.no.nas[["edeq.ed_scid5.weigh_weighed_past_month"]]),
                    length(levels(dat.no.nas[["wave_factor"]]))))


```

6. Change edeq variable to ordered factor
```{r}
dat_plot <- dat_plot %>%
  mutate(edeq.ed_scid5.weigh_weighed_past_month = fct_relevel(edeq.ed_scid5.weigh_weighed_past_month,
                           "No",
                           "Yes"))


```


7. PLOT ! Over the past month, have you weighed much less than other people thought you ought to weigh
```{r}

ggplot(dat_plot,
       aes(x = edeq.ed_scid5.weigh_weighed_past_month,
           y = wcount,
           fill = wave_factor)) +
  geom_bar(aes(group = wave_factor),
           stat = "identity",
           position = "dodge",
           colour = "black") + 
  scale_y_continuous(labels = scales::percent) +
  labs(title = str_wrap("Pre-pandemic BED only: Over the past month, have you weighed much less than other people thought you ought to weigh?", 60),
       x = "Low weight",
       y = "Percentage of participants",
       fill = "Time of survey") +
scale_x_discrete(guide = guide_axis(n.dodge=3))

```

##Filter by prepandemic AN 
```{r}

dat.edeq.AN <- dat.edeq.screener %>%
  filter(anorexia_group_numeric == 1 |
           COPING_anorexia_group_numeric == 1)

```

##PLOTS - Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time ?

#1. Get rid of NAs and change edeq to factor
```{r}
#get rid of nas
dat.no.nas <- dat.edeq.AN[!is.na(dat.edeq.AN$edeq.ed_scid5.regular_episodes_eating_binges),]

```

#1. Change wave to factor and re-order
```{r}

# change order of wave factor 1
dat.no.nas <- dat.no.nas %>%
 mutate(wave_factor = fct_relevel(wave,
                                  "1",
                                  "2",
                                  "3",
                           "4",
                           "5",
                           "6",
                           "7",
                           "8"))


#Check that this worked

summary(dat.no.nas$wave_factor)
```

Drop empty factor levels across all columns 
```{r}

dat.no.nas <-  droplevels(dat.no.nas)

```


#4. Rename waves to dates
```{r}

##Rename waves

levels(dat.no.nas$wave_factor)[1] <- "May"

levels(dat.no.nas$wave_factor)[2] <- "June" 

levels(dat.no.nas$wave_factor)[3] <- "July "

levels(dat.no.nas$wave_factor)[4] <- "August"

levels(dat.no.nas$wave_factor)[5] <- "September"

levels(dat.no.nas$wave_factor)[6] <- "October"

levels(dat.no.nas$wave_factor)[7] <- "November"

levels(dat.no.nas$wave_factor)[8] <- "December"


```


#5. Format data to plot
```{r}
#get data in format to plot
dat_plot <- dat.no.nas %>%
  group_by(wave_factor) %>%
  dplyr::summarise(wcount = table(edeq.ed_scid5.regular_episodes_eating_binges) / sum(table(edeq.ed_scid5.regular_episodes_eating_binges))) %>%
  ungroup() %>%
  mutate(edeq.ed_scid5.regular_episodes_eating_binges = rep(levels(dat.no.nas[["edeq.ed_scid5.regular_episodes_eating_binges"]]),
                    length(levels(dat.no.nas[["wave_factor"]]))))


```

6. Change edeq variable to ordered factor
```{r}
dat_plot <- dat_plot %>%
  mutate(edeq.ed_scid5.regular_episodes_eating_binges = fct_relevel(edeq.ed_scid5.regular_episodes_eating_binges,
                           "No",
                           "Yes"))


```


7. PLOT ! Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time
```{r}

ggplot(dat_plot,
       aes(x = edeq.ed_scid5.regular_episodes_eating_binges,
           y = wcount,
           fill = wave_factor)) +
  geom_bar(aes(group = wave_factor),
           stat = "identity",
           position = "dodge",
           colour = "black") + 
  scale_y_continuous(labels = scales::percent) +
  labs(title = str_wrap("Pre-pandemic AN only: Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time?", 60),
       x = "Binge eating",
       y = "Percentage of participants",
       fill = "Time of survey") +
scale_x_discrete(guide = guide_axis(n.dodge=3))

```

##Filter by prepandemic BN 
```{r}

dat.edeq.BN <- dat.edeq.screener %>%
  filter(bulimia_group_numeric == 1 |
           COPING_bulimia_group_numeric == 1)

```

##PLOTS - Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time ?

#1. Get rid of NAs and change edeq to factor
```{r}
#get rid of nas
dat.no.nas <- dat.edeq.BN[!is.na(dat.edeq.BN$edeq.ed_scid5.regular_episodes_eating_binges),]

```

#1. Change wave to factor and re-order
```{r}

# change order of wave factor 1
dat.no.nas <- dat.no.nas %>%
 mutate(wave_factor = fct_relevel(wave,
                                  "1",
                                  "2",
                                  "3",
                           "4",
                           "5",
                           "6",
                           "7",
                           "8"))


#Check that this worked

summary(dat.no.nas$wave_factor)
```

Drop empty factor levels across all columns 
```{r}

dat.no.nas <-  droplevels(dat.no.nas)

```


#4. Rename waves to dates
```{r}

##Rename waves

levels(dat.no.nas$wave_factor)[1] <- "May"

levels(dat.no.nas$wave_factor)[2] <- "June" 

levels(dat.no.nas$wave_factor)[3] <- "July "

levels(dat.no.nas$wave_factor)[4] <- "August"

levels(dat.no.nas$wave_factor)[5] <- "September"

levels(dat.no.nas$wave_factor)[6] <- "October"

levels(dat.no.nas$wave_factor)[7] <- "November"

levels(dat.no.nas$wave_factor)[8] <- "December"


```


#5. Format data to plot
```{r}
#get data in format to plot
dat_plot <- dat.no.nas %>%
  group_by(wave_factor) %>%
  dplyr::summarise(wcount = table(edeq.ed_scid5.regular_episodes_eating_binges) / sum(table(edeq.ed_scid5.regular_episodes_eating_binges))) %>%
  ungroup() %>%
  mutate(edeq.ed_scid5.regular_episodes_eating_binges = rep(levels(dat.no.nas[["edeq.ed_scid5.regular_episodes_eating_binges"]]),
                    length(levels(dat.no.nas[["wave_factor"]]))))


```

6. Change edeq variable to ordered factor
```{r}
dat_plot <- dat_plot %>%
  mutate(edeq.ed_scid5.regular_episodes_eating_binges = fct_relevel(edeq.ed_scid5.regular_episodes_eating_binges,
                           "No",
                           "Yes"))


```


7. PLOT ! Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time
```{r}

ggplot(dat_plot,
       aes(x = edeq.ed_scid5.regular_episodes_eating_binges,
           y = wcount,
           fill = wave_factor)) +
  geom_bar(aes(group = wave_factor),
           stat = "identity",
           position = "dodge",
           colour = "black") + 
  scale_y_continuous(labels = scales::percent) +
  labs(title = str_wrap("Pre-pandemic BN only: Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time?", 60),
       x = "Binge eating",
       y = "Percentage of participants",
       fill = "Time of survey") +
scale_x_discrete(guide = guide_axis(n.dodge=3))

```

##Filter by prepandemic BED
```{r}

dat.edeq.BED <- dat.edeq.screener %>%
  filter(BED_group_numeric == 1 |
           COPING_bed_group_numeric == 1)

```

##PLOTS - Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time ?

#1. Get rid of NAs and change edeq to factor
```{r}
#get rid of nas
dat.no.nas <- dat.edeq.BED[!is.na(dat.edeq.BED$edeq.ed_scid5.regular_episodes_eating_binges),]

```

#1. Change wave to factor and re-order
```{r}

# change order of wave factor 1
dat.no.nas <- dat.no.nas %>%
 mutate(wave_factor = fct_relevel(wave,
                                  "1",
                                  "2",
                                  "3",
                           "4",
                           "5",
                           "6",
                           "7",
                           "8"))


#Check that this worked

summary(dat.no.nas$wave_factor)
```

Drop empty factor levels across all columns 
```{r}

dat.no.nas <-  droplevels(dat.no.nas)

```


#4. Rename waves to dates
```{r}

##Rename waves

levels(dat.no.nas$wave_factor)[1] <- "May"

levels(dat.no.nas$wave_factor)[2] <- "June" 

levels(dat.no.nas$wave_factor)[3] <- "July "

levels(dat.no.nas$wave_factor)[4] <- "August"

levels(dat.no.nas$wave_factor)[5] <- "September"

levels(dat.no.nas$wave_factor)[6] <- "October"

levels(dat.no.nas$wave_factor)[7] <- "November"

levels(dat.no.nas$wave_factor)[8] <- "December"


```


#5. Format data to plot
```{r}
#get data in format to plot
dat_plot <- dat.no.nas %>%
  group_by(wave_factor) %>%
  dplyr::summarise(wcount = table(edeq.ed_scid5.regular_episodes_eating_binges) / sum(table(edeq.ed_scid5.regular_episodes_eating_binges))) %>%
  ungroup() %>%
  mutate(edeq.ed_scid5.regular_episodes_eating_binges = rep(levels(dat.no.nas[["edeq.ed_scid5.regular_episodes_eating_binges"]]),
                    length(levels(dat.no.nas[["wave_factor"]]))))


```

6. Change edeq variable to ordered factor
```{r}
dat_plot <- dat_plot %>%
  mutate(edeq.ed_scid5.regular_episodes_eating_binges = fct_relevel(edeq.ed_scid5.regular_episodes_eating_binges,
                           "No",
                           "Yes"))


```


7. PLOT ! Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time
```{r}

ggplot(dat_plot,
       aes(x = edeq.ed_scid5.regular_episodes_eating_binges,
           y = wcount,
           fill = wave_factor)) +
  geom_bar(aes(group = wave_factor),
           stat = "identity",
           position = "dodge",
           colour = "black") + 
  scale_y_continuous(labels = scales::percent) +
  labs(title = str_wrap("Pre-pandemic BED only: Over the past month, have you had regular episodes of overeating or eating binges when you ate what most people would regard as an unusually large amount of food in a short period of time?", 60),
       x = "Binge eating",
       y = "Percentage of participants",
       fill = "Time of survey") +
scale_x_discrete(guide = guide_axis(n.dodge=3))

```