---
title: "Correcting dupicated entries"
author: "Helena Davies"
date: "21/02/2022"
output: html_document
---

This script takes into consideration duplicated entries within a single phase.

Configure global options for all chunks
```{r Setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,
  comment = '',
  prompt = FALSE,
  cache = FALSE
  )
```

Clear global environment prior to initiation
```{r Clear global environment}
remove(list = ls())
```

Add the add_numeric function - used to convert character variables into numeric variables
Add the remove_duplicates function - used to deduplicate and remove NAs from IDs
Add the sumscores function - used to generate sumscores
Add the package_check function - used to install and load dependencies
Add the imp_check function - used to check variables for implausible values
```{r Read in functions}
source(file = "/Users/helenadavies/werk/ilovedata/scripts/functions/add_numeric.R")
source(file = "/Users/helenadavies/werk/ilovedata/scripts/functions/remove_duplicates.R")
source(file = "/Users/helenadavies/werk/ilovedata/scripts/functions/package_check.R")
source("./functions.R")
```

Use package_check to install and load dependencies
Load tidyverse last
```{r Install load dependencies}
packages <- c("summarytools", "sjlabelled", "Amelia", "gtsummary", "tidyverse")
package_check(packages)
```

Retrieve recent date
We are using the recent date to save files with paste0() as an extension to not overwrite old versions
```{r Recent date}
date <- Sys.Date()
date
```

# Read in data
## data.final is generated from the "4.Merging" script
```{r Read in data}
dat <- readRDS(file = "../data_cleaned/all_dat2022-02-21.rds")

# Check
dim(dat)
colnames(dat)
```

# First, need to create single variables for those people who completed the same survey twice within a single phase
Any answers of "Yes" (i.e., endorsement of a behaviour) will mean that person is a "Yes" for that phase
Then, at least one "No" (and either missing or "No" for the other phase) will count as a "No"
Missing for both phases for the relevant variables = NA
## Demographics
```{r living situation creating single variables from duplicated IDs}
# Living sitation 
dat <- dat %>%
  mutate(dem.living_situation_.Wave_1a =
           case_when(dem.living_situation_.Wave_1a == "Living situation" |
                      dem.living_situation_.Wave_1a_dup == "Living situation" ~ "Living situation",
                     
                   dem.living_situation_.Wave_1a == "Not Living situation" |
                   dem.living_situation_.Wave_1a_dup == "Not Living situation" ~ "Not Living situation",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.living_situation_.Wave_1b =
           case_when(dem.living_situation_.Wave_1b == "Living situation" |
                      dem.living_situation_.Wave_1b_dup == "Living situation" ~ "Living situation",
                     
                   dem.living_situation_.Wave_1b == "Not Living situation" |
                   dem.living_situation_.Wave_1b_dup == "Not Living situation" ~ "Not Living situation",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.living_situation_.Wave_2a =
           case_when(dem.living_situation_.Wave_2a == "Living situation" |
                      dem.living_situation_.Wave_2a_dup == "Living situation" ~ "Living situation",
                     
                   dem.living_situation_.Wave_2a == "Not Living situation" |
                   dem.living_situation_.Wave_2a_dup == "Not Living situation" ~ "Not Living situation",
                     
                     )
         )


dat <- dat %>%
  mutate(dem.living_situation_.Wave_2b =
           case_when(dem.living_situation_.Wave_2b == "Living situation" |
                      dem.living_situation_.Wave_2b_dup == "Living situation" ~ "Living situation",
                     
                   dem.living_situation_.Wave_2b == "Not Living situation" |
                   dem.living_situation_.Wave_2b_dup == "Not Living situation" ~ "Not Living situation",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.living_situation_.Wave_3a =
           case_when(dem.living_situation_.Wave_3a == "Living situation" |
                      dem.living_situation_.Wave_3a_dup == "Living situation" ~ "Living situation",
                     
                   dem.living_situation_.Wave_3a == "Not Living situation" |
                   dem.living_situation_.Wave_3a_dup == "Not Living situation" ~ "Not Living situation",
                     
                     )
         )


dat <- dat %>%
  mutate(dem.living_situation_.Wave_3b =
           case_when(dem.living_situation_.Wave_3b == "Living situation" |
                      dem.living_situation_.Wave_3b_dup == "Living situation" ~ "Living situation",
                     
                   dem.living_situation_.Wave_3b == "Not Living situation" |
                   dem.living_situation_.Wave_3b_dup == "Not Living situation" ~ "Not Living situation",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.living_situation_.Wave_4a =
           case_when(dem.living_situation_.Wave_4a == "Living situation" |
                      dem.living_situation_.Wave_4a_dup == "Living situation" ~ "Living situation",
                     
                   dem.living_situation_.Wave_4a == "Not Living situation" |
                   dem.living_situation_.Wave_4a_dup == "Not Living situation" ~ "Not Living situation",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.living_situation_.Wave_4b =
           case_when(dem.living_situation_.Wave_4b == "Living situation" |
                      dem.living_situation_.Wave_4b_dup == "Living situation" ~ "Living situation",
                     
                   dem.living_situation_.Wave_4b == "Not Living situation" |
                   dem.living_situation_.Wave_4b_dup == "Not Living situation" ~ "Not Living situation",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.living_situation_.Wave_5a =
           case_when(dem.living_situation_.Wave_5a == "Living situation" |
                      dem.living_situation_.Wave_5a_dup == "Living situation" ~ "Living situation",
                     
                   dem.living_situation_.Wave_5a == "Not Living situation" |
                   dem.living_situation_.Wave_5a_dup == "Not Living situation" ~ "Not Living situation",
                     
                     )
         )


dat <- dat %>%
  mutate(dem.living_situation_.Wave_6b =
           case_when(dem.living_situation_.Wave_6b== "Living situation" |
                      dem.living_situation_.Wave_6b_dup == "Living situation" ~ "Living situation",
                     
                   dem.living_situation_.Wave_6b == "Not Living situation" |
                   dem.living_situation_.Wave_6b_dup == "Not Living situation" ~ "Not Living situation",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.living_situation_.Wave_7a =
           case_when(dem.living_situation_.Wave_7a == "Living situation" |
                      dem.living_situation_.Wave_7a_dup == "Living situation" ~ "Living situation",
                     
                   dem.living_situation_.Wave_7a == "Not Living situation" |
                   dem.living_situation_.Wave_7a_dup == "Not Living situation" ~ "Not Living situation",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.living_situation_.Wave_8b =
           case_when(dem.living_situation_.Wave_8b == "Living situation" |
                      dem.living_situation_.Wave_8b_dup == "Living situation" ~ "Living situation",
                     
                   dem.living_situation_.Wave_8b == "Not Living situation" |
                   dem.living_situation_.Wave_8b_dup == "Not Living situation" ~ "Not Living situation",
                     
                     )
         )


dat <- dat %>%
  mutate(dem.living_situation_.Wave_9a =
           case_when(dem.living_situation_.Wave_9a == "Living situation" |
                      dem.living_situation_.Wave_9a_dup == "Living situation" ~ "Living situation",
                     
                   dem.living_situation_.Wave_9a == "Not Living situation" |
                   dem.living_situation_.Wave_9a_dup == "Not Living situation" ~ "Not Living situation",
                     
                     )
         )


dat <- dat %>%
  mutate(dem.living_situation_.Wave_10b =
           case_when(dem.living_situation_.Wave_10b == "Living situation" |
                      dem.living_situation_.Wave_10b_dup == "Living situation" ~ "Living situation",
                     
                   dem.living_situation_.Wave_10b == "Not Living situation" |
                   dem.living_situation_.Wave_10b_dup == "Not Living situation" ~ "Not Living situation",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.living_situation_.Wave_11a =
           case_when(dem.living_situation_.Wave_11a == "Living situation" |
                      dem.living_situation_.Wave_11a_dup == "Living situation" ~ "Living situation",
                     
                   dem.living_situation_.Wave_11a== "Not Living situation" |
                   dem.living_situation_.Wave_11a_dup == "Not Living situation" ~ "Not Living situation",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.living_situation_.Wave_12b =
           case_when(dem.living_situation_.Wave_12b == "Living situation" |
                      dem.living_situation_.Wave_12b_dup == "Living situation" ~ "Living situation",
                     
                   dem.living_situation_.Wave_12b== "Not Living situation" |
                   dem.living_situation_.Wave_12b_dup == "Not Living situation" ~ "Not Living situation",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.living_situation_.Wave_13a =
           case_when(dem.living_situation_.Wave_13a == "Living situation" |
                      dem.living_situation_.Wave_13a_dup == "Living situation" ~ "Living situation",
                     
                   dem.living_situation_.Wave_13a== "Not Living situation" |
                  dem.living_situation_.Wave_13a_dup == "Not Living situation" ~ "Not Living situation",
                     
                     )
         )


dat <- dat %>%
  mutate(dem.living_situation_.Wave_14b =
           case_when(dem.living_situation_.Wave_14b == "Living situation" |
                      dem.living_situation_.Wave_14b_dup == "Living situation" ~ "Living situation",
                     
                   dem.living_situation_.Wave_14b== "Not Living situation" |
                 dem.living_situation_.Wave_14b_dup == "Not Living situation" ~ "Not Living situation",
                     
                     )
         )


dat <- dat %>%
  mutate(dem.living_situation_.Wave_15a =
           case_when(dem.living_situation_.Wave_15a == "Living situation" |
                      dem.living_situation_.Wave_15a_dup == "Living situation" ~ "Living situation",
                     
                   dem.living_situation_.Wave_15a== "Not Living situation" |
                 dem.living_situation_.Wave_15a_dup == "Not Living situation" ~ "Not Living situation",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.living_situation_.Wave_16b =
           case_when(dem.living_situation_.Wave_16b == "Living situation" |
                      dem.living_situation_.Wave_16b_dup == "Living situation" ~ "Living situation",
                     
                   dem.living_situation_.Wave_16b== "Not Living situation" |
                dem.living_situation_.Wave_16b_dup == "Not Living situation" ~ "Not Living situation",
                     
                     )
         )
```

```{r employment creating single variables from duplicated IDs}
# Employment
dat <- dat %>%
  mutate(dem.employment_.Wave_1a =
           case_when(dem.employment_.Wave_1a == "Employment" |
                      dem.employment_.Wave_1a_dup == "Employment" ~ "Employment",
                     
                   dem.employment_.Wave_1a == "Not Employment" |
                   dem.employment_.Wave_1a_dup == "Not Employment" ~ "Not Employment",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.employment_.Wave_1b =
           case_when(dem.employment_.Wave_1b == "Employment" |
                      dem.employment_.Wave_1b_dup == "Employment" ~ "Employment",
                     
                   dem.employment_.Wave_1b == "Not Employment" |
                   dem.employment_.Wave_1b_dup == "Not Employment" ~ "Not Employment",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.employment_.Wave_2a =
           case_when(dem.employment_.Wave_2a == "Employment" |
                      dem.employment_.Wave_2a_dup == "Employment" ~ "Employment",
                     
                   dem.employment_.Wave_2a == "Not Employment" |
                   dem.employment_.Wave_2a_dup == "Not Employment" ~ "Not Employment",
                     
                     )
         )


dat <- dat %>%
  mutate(dem.employment_.Wave_2b =
           case_when(dem.employment_.Wave_2b == "Employment" |
                      dem.employment_.Wave_2b_dup == "Employment" ~ "Employment",
                     
                   dem.employment_.Wave_2b == "Not Employment" |
                   dem.employment_.Wave_2b_dup == "Not Employment" ~ "Not Employment",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.employment_.Wave_3a =
           case_when(dem.employment_.Wave_3a == "Employment" |
                      dem.employment_.Wave_3a_dup == "Employment" ~ "Employment",
                     
                   dem.employment_.Wave_3a == "Not Employment" |
                   dem.employment_.Wave_3a_dup == "Not Employment" ~ "Not Employment",
                     
                     )
         )


dat <- dat %>%
  mutate(dem.employment_.Wave_3b =
           case_when(dem.employment_.Wave_3b == "Employment" |
                      dem.employment_.Wave_3b_dup == "Employment" ~ "Employment",
                     
                   dem.employment_.Wave_3b == "Not Employment" |
                   dem.employment_.Wave_3b_dup == "Not Employment" ~ "Not Employment",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.employment_.Wave_4a =
           case_when(dem.employment_.Wave_4a == "Employment" |
                      dem.employment_.Wave_4a_dup == "Employment" ~ "Employment",
                     
                   dem.employment_.Wave_4a == "Not Employment" |
                   dem.employment_.Wave_4a_dup == "Not Employment" ~ "Not Employment",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.employment_.Wave_4b =
           case_when(dem.employment_.Wave_4b == "Employment" |
                      dem.employment_.Wave_4b_dup == "Employment" ~ "Employment",
                     
                   dem.employment_.Wave_4b == "Not Employment" |
                   dem.employment_.Wave_4b_dup == "Not Employment" ~ "Not Employment",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.employment_.Wave_5a =
           case_when(dem.employment_.Wave_5a == "Employment" |
                      dem.employment_.Wave_5a_dup == "Employment" ~ "Employment",
                     
                   dem.employment_.Wave_5a == "Not Employment" |
                   dem.employment_.Wave_5a_dup == "Not Employment" ~ "Not Employment",
                     
                     )
         )


dat <- dat %>%
  mutate(dem.employment_.Wave_6b =
           case_when(dem.employment_.Wave_6b== "Employment" |
                      dem.employment_.Wave_6b_dup == "Employment" ~ "Employment",
                     
                   dem.employment_.Wave_6b == "Not Employment" |
                   dem.employment_.Wave_6b_dup == "Not Employment" ~ "Not Employment",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.employment_.Wave_7a =
           case_when(dem.employment_.Wave_7a == "Employment" |
                      dem.employment_.Wave_7a_dup == "Employment" ~ "Employment",
                     
                   dem.employment_.Wave_7a == "Not Employment" |
                   dem.employment_.Wave_7a_dup == "Not Employment" ~ "Not Employment",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.employment_.Wave_8b =
           case_when(dem.employment_.Wave_8b == "Employment" |
                      dem.employment_.Wave_8b_dup == "Employment" ~ "Employment",
                     
                   dem.employment_.Wave_8b == "Not Employment" |
                   dem.employment_.Wave_8b_dup == "Not Employment" ~ "Not Employment",
                     
                     )
         )


dat <- dat %>%
  mutate(dem.employment_.Wave_9a =
           case_when(dem.employment_.Wave_9a == "Employment" |
                      dem.employment_.Wave_9a_dup == "Employment" ~ "Employment",
                     
                   dem.employment_.Wave_9a == "Not Employment" |
                   dem.employment_.Wave_9a_dup == "Not Employment" ~ "Not Employment",
                     
                     )
         )


dat <- dat %>%
  mutate(dem.employment_.Wave_10b =
           case_when(dem.employment_.Wave_10b == "Employment" |
                      dem.employment_.Wave_10b_dup == "Employment" ~ "Employment",
                     
                   dem.employment_.Wave_10b == "Not Employment" |
                   dem.employment_.Wave_10b_dup == "Not Employment" ~ "Not Employment",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.employment_.Wave_11a =
           case_when(dem.employment_.Wave_11a == "Employment" |
                      dem.employment_.Wave_11a_dup == "Employment" ~ "Employment",
                     
                   dem.employment_.Wave_11a== "Not Employment" |
                   dem.employment_.Wave_11a_dup == "Not Employment" ~ "Not Employment",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.employment_.Wave_12b =
           case_when(dem.employment_.Wave_12b == "Employment" |
                      dem.employment_.Wave_12b_dup == "Employment" ~ "Employment",
                     
                   dem.employment_.Wave_12b== "Not Employment" |
                   dem.employment_.Wave_12b_dup == "Not Employment" ~ "Not Employment",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.employment_.Wave_13a =
           case_when(dem.employment_.Wave_13a == "Employment" |
                      dem.employment_.Wave_13a_dup == "Employment" ~ "Employment",
                     
                   dem.employment_.Wave_13a== "Not Employment" |
                  dem.employment_.Wave_13a_dup == "Not Employment" ~ "Not Employment",
                     
                     )
         )


dat <- dat %>%
  mutate(dem.employment_.Wave_14b =
           case_when(dem.employment_.Wave_14b == "Employment" |
                      dem.employment_.Wave_14b_dup == "Employment" ~ "Employment",
                     
                   dem.employment_.Wave_14b== "Not Employment" |
                 dem.employment_.Wave_14b_dup == "Not Employment" ~ "Not Employment",
                     
                     )
         )


dat <- dat %>%
  mutate(dem.employment_.Wave_15a =
           case_when(dem.employment_.Wave_15a == "Employment" |
                      dem.employment_.Wave_15a_dup == "Employment" ~ "Employment",
                     
                   dem.employment_.Wave_15a== "Not Employment" |
                 dem.employment_.Wave_15a_dup == "Not Employment" ~ "Not Employment",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.employment_.Wave_16b =
           case_when(dem.employment_.Wave_16b == "Employment" |
                      dem.employment_.Wave_16b_dup == "Employment" ~ "Employment",
                     
                   dem.employment_.Wave_16b== "Not Employment" |
                dem.employment_.Wave_16b_dup == "Not Employment" ~ "Not Employment",
                     
                     )
         )
```
      
```{r employment key earner creating single variables from duplicated IDs}
# Employment status of key earner in household
dat <- dat %>%
  mutate(dem.household_employment_status_key_.Wave_1a =
           case_when(dem.household_employment_status_key_.Wave_1a == "Employment status of a key earner in your household" |
                      dem.household_employment_status_key_.Wave_1a_dup == "Employment status of a key earner in your household" ~ "Employment status of a key earner in your household",
                     
                   dem.household_employment_status_key_.Wave_1a == "Not Employment status of a key earner in your household" |
                   dem.household_employment_status_key_.Wave_1a_dup == "Not Employment status of a key earner in your household" ~ "Not Employment status of a key earner in your household",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.household_employment_status_key_.Wave_1b =
           case_when(dem.household_employment_status_key_.Wave_1b == "Employment status of a key earner in your household" |
                      dem.household_employment_status_key_.Wave_1b_dup == "Employment status of a key earner in your household" ~ "Employment status of a key earner in your household",
                     
                   dem.household_employment_status_key_.Wave_1b == "Not Employment status of a key earner in your household" |
                   dem.household_employment_status_key_.Wave_1b_dup == "Not Employment status of a key earner in your household" ~ "Not Employment status of a key earner in your household",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.household_employment_status_key_.Wave_2a =
           case_when(dem.household_employment_status_key_.Wave_2a == "Employment status of a key earner in your household" |
                      dem.household_employment_status_key_.Wave_2a_dup == "Employment status of a key earner in your household" ~ "Employment status of a key earner in your household",
                     
                   dem.household_employment_status_key_.Wave_2a == "Not Employment status of a key earner in your household" |
                   dem.household_employment_status_key_.Wave_2a_dup == "Not Employment status of a key earner in your household" ~ "Not Employment status of a key earner in your household",
                     
                     )
         )


dat <- dat %>%
  mutate(dem.household_employment_status_key_.Wave_2b =
           case_when(dem.household_employment_status_key_.Wave_2b == "Employment status of a key earner in your household" |
                      dem.household_employment_status_key_.Wave_2b_dup == "Employment status of a key earner in your household" ~ "Employment status of a key earner in your household",
                     
                   dem.household_employment_status_key_.Wave_2b == "Not Employment status of a key earner in your household" |
                   dem.household_employment_status_key_.Wave_2b_dup == "Not Employment status of a key earner in your household" ~ "Not Employment status of a key earner in your household",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.household_employment_status_key_.Wave_3a =
           case_when(dem.household_employment_status_key_.Wave_3a == "Employment status of a key earner in your household" |
                      dem.household_employment_status_key_.Wave_3a_dup == "Employment status of a key earner in your household" ~ "Employment status of a key earner in your household",
                     
                   dem.household_employment_status_key_.Wave_3a == "Not Employment status of a key earner in your household" |
                   dem.household_employment_status_key_.Wave_3a_dup == "Not Employment status of a key earner in your household" ~ "Not Employment status of a key earner in your household",
                     
                     )
         )


dat <- dat %>%
  mutate(dem.household_employment_status_key_.Wave_3b =
           case_when(dem.household_employment_status_key_.Wave_3b == "Employment status of a key earner in your household" |
                      dem.household_employment_status_key_.Wave_3b_dup == "Employment status of a key earner in your household" ~ "Employment status of a key earner in your household",
                     
                   dem.household_employment_status_key_.Wave_3b == "Not Employment status of a key earner in your household" |
                   dem.household_employment_status_key_.Wave_3b_dup == "Not Employment status of a key earner in your household" ~ "Not Employment status of a key earner in your household",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.household_employment_status_key_.Wave_4a =
           case_when(dem.household_employment_status_key_.Wave_4a == "Employment status of a key earner in your household" |
                      dem.household_employment_status_key_.Wave_4a_dup == "Employment status of a key earner in your household" ~ "Employment status of a key earner in your household",
                     
                   dem.household_employment_status_key_.Wave_4a == "Not Employment status of a key earner in your household" |
                   dem.household_employment_status_key_.Wave_4a_dup == "Not Employment status of a key earner in your household" ~ "Not Employment status of a key earner in your household",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.household_employment_status_key_.Wave_4b =
           case_when(dem.household_employment_status_key_.Wave_4b == "Employment status of a key earner in your household" |
                      dem.household_employment_status_key_.Wave_4b_dup == "Employment status of a key earner in your household" ~ "Employment status of a key earner in your household",
                     
                   dem.household_employment_status_key_.Wave_4b == "Not Employment status of a key earner in your household" |
                   dem.household_employment_status_key_.Wave_4b_dup == "Not Employment status of a key earner in your household" ~ "Not Employment status of a key earner in your household",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.household_employment_status_key_.Wave_5a =
           case_when(dem.household_employment_status_key_.Wave_5a == "Employment status of a key earner in your household" |
                      dem.household_employment_status_key_.Wave_5a_dup == "Employment status of a key earner in your household" ~ "Employment status of a key earner in your household",
                     
                   dem.household_employment_status_key_.Wave_5a == "Not Employment status of a key earner in your household" |
                   dem.household_employment_status_key_.Wave_5a_dup == "Not Employment status of a key earner in your household" ~ "Not Employment status of a key earner in your household",
                     
                     )
         )


dat <- dat %>%
  mutate(dem.household_employment_status_key_.Wave_6b =
           case_when(dem.household_employment_status_key_.Wave_6b== "Employment status of a key earner in your household" |
                      dem.household_employment_status_key_.Wave_6b_dup == "Employment status of a key earner in your household" ~ "Employment status of a key earner in your household",
                     
                   dem.household_employment_status_key_.Wave_6b == "Not Employment status of a key earner in your household" |
                   dem.household_employment_status_key_.Wave_6b_dup == "Not Employment status of a key earner in your household" ~ "Not Employment status of a key earner in your household",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.household_employment_status_key_.Wave_7a =
           case_when(dem.household_employment_status_key_.Wave_7a == "Employment status of a key earner in your household" |
                      dem.household_employment_status_key_.Wave_7a_dup == "Employment status of a key earner in your household" ~ "Employment status of a key earner in your household",
                     
                   dem.household_employment_status_key_.Wave_7a == "Not Employment status of a key earner in your household" |
                   dem.household_employment_status_key_.Wave_7a_dup == "Not Employment status of a key earner in your household" ~ "Not Employment status of a key earner in your household",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.household_employment_status_key_.Wave_8b =
           case_when(dem.household_employment_status_key_.Wave_8b == "Employment status of a key earner in your household" |
                      dem.household_employment_status_key_.Wave_8b_dup == "Employment status of a key earner in your household" ~ "Employment status of a key earner in your household",
                     
                   dem.household_employment_status_key_.Wave_8b == "Not Employment status of a key earner in your household" |
                   dem.household_employment_status_key_.Wave_8b_dup == "Not Employment status of a key earner in your household" ~ "Not Employment status of a key earner in your household",
                     
                     )
         )


dat <- dat %>%
  mutate(dem.household_employment_status_key_.Wave_9a =
           case_when(dem.household_employment_status_key_.Wave_9a == "Employment status of a key earner in your household" |
                      dem.household_employment_status_key_.Wave_9a_dup == "Employment status of a key earner in your household" ~ "Employment status of a key earner in your household",
                     
                   dem.household_employment_status_key_.Wave_9a == "Not Employment status of a key earner in your household" |
                   dem.household_employment_status_key_.Wave_9a_dup == "Not Employment status of a key earner in your household" ~ "Not Employment status of a key earner in your household",
                     
                     )
         )


dat <- dat %>%
  mutate(dem.household_employment_status_key_.Wave_10b =
           case_when(dem.household_employment_status_key_.Wave_10b == "Employment status of a key earner in your household" |
                      dem.household_employment_status_key_.Wave_10b_dup == "Employment status of a key earner in your household" ~ "Employment status of a key earner in your household",
                     
                   dem.household_employment_status_key_.Wave_10b == "Not Employment status of a key earner in your household" |
                   dem.household_employment_status_key_.Wave_10b_dup == "Not Employment status of a key earner in your household" ~ "Not Employment status of a key earner in your household",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.household_employment_status_key_.Wave_11a =
           case_when(dem.household_employment_status_key_.Wave_11a == "Employment status of a key earner in your household" |
                      dem.household_employment_status_key_.Wave_11a_dup == "Employment status of a key earner in your household" ~ "Employment status of a key earner in your household",
                     
                   dem.household_employment_status_key_.Wave_11a== "Not Employment status of a key earner in your household" |
                   dem.household_employment_status_key_.Wave_11a_dup == "Not Employment status of a key earner in your household" ~ "Not Employment status of a key earner in your household",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.household_employment_status_key_.Wave_12b =
           case_when(dem.household_employment_status_key_.Wave_12b == "Employment status of a key earner in your household" |
                      dem.household_employment_status_key_.Wave_12b_dup == "Employment status of a key earner in your household" ~ "Employment status of a key earner in your household",
                     
                   dem.household_employment_status_key_.Wave_12b== "Not Employment status of a key earner in your household" |
                   dem.household_employment_status_key_.Wave_12b_dup == "Not Employment status of a key earner in your household" ~ "Not Employment status of a key earner in your household",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.household_employment_status_key_.Wave_13a =
           case_when(dem.household_employment_status_key_.Wave_13a == "Employment status of a key earner in your household" |
                      dem.household_employment_status_key_.Wave_13a_dup == "Employment status of a key earner in your household" ~ "Employment status of a key earner in your household",
                     
                   dem.household_employment_status_key_.Wave_13a== "Not Employment status of a key earner in your household" |
                  dem.household_employment_status_key_.Wave_13a_dup == "Not Employment status of a key earner in your household" ~ "Not Employment status of a key earner in your household",
                     
                     )
         )


dat <- dat %>%
  mutate(dem.household_employment_status_key_.Wave_14b =
           case_when(dem.household_employment_status_key_.Wave_14b == "Employment status of a key earner in your household" |
                      dem.household_employment_status_key_.Wave_14b_dup == "Employment status of a key earner in your household" ~ "Employment status of a key earner in your household",
                     
                   dem.household_employment_status_key_.Wave_14b== "Not Employment status of a key earner in your household" |
                 dem.household_employment_status_key_.Wave_14b_dup == "Not Employment status of a key earner in your household" ~ "Not Employment status of a key earner in your household",
                     
                     )
         )


dat <- dat %>%
  mutate(dem.household_employment_status_key_.Wave_15a =
           case_when(dem.household_employment_status_key_.Wave_15a == "Employment status of a key earner in your household" |
                      dem.household_employment_status_key_.Wave_15a_dup == "Employment status of a key earner in your household" ~ "Employment status of a key earner in your household",
                     
                   dem.household_employment_status_key_.Wave_15a== "Not Employment status of a key earner in your household" |
                 dem.household_employment_status_key_.Wave_15a_dup == "Not Employment status of a key earner in your household" ~ "Not Employment status of a key earner in your household",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.household_employment_status_key_.Wave_16b =
           case_when(dem.household_employment_status_key_.Wave_16b == "Employment status of a key earner in your household" |
                      dem.household_employment_status_key_.Wave_16b_dup == "Employment status of a key earner in your household" ~ "Employment status of a key earner in your household",
                     
                   dem.household_employment_status_key_.Wave_16b== "Not Employment status of a key earner in your household" |
                dem.household_employment_status_key_.Wave_16b_dup == "Not Employment status of a key earner in your household" ~ "Not Employment status of a key earner in your household",
                     
                     )
         )
```

+++ Why is there no data until wave 6b?! Check if screener?? (are people who are NA just people who did not have an ill relative?)
      
```{r ill health due to COVID creating single variables from duplicated IDs}
# Ill health due to COVID of key earner in household
dat <- dat %>%
  mutate(dem.unwell_coronavirus_weeks_physical_.Wave_1a =
           case_when(dem.unwell_coronavirus_weeks_physical_.Wave_1a == "Yes" |
                      dem.unwell_coronavirus_weeks_physical_.Wave_1a_dup == "Yes" ~ "Yes",
                     
                   dem.unwell_coronavirus_weeks_physical_.Wave_1a == "No" |
                   dem.unwell_coronavirus_weeks_physical_.Wave_1a_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.unwell_coronavirus_weeks_physical_.Wave_1b =
           case_when(dem.unwell_coronavirus_weeks_physical_.Wave_1b == "Yes" |
                      dem.unwell_coronavirus_weeks_physical_.Wave_1b_dup == "Yes" ~ "Yes",
                     
                   dem.unwell_coronavirus_weeks_physical_.Wave_1b == "No" |
                   dem.unwell_coronavirus_weeks_physical_.Wave_1b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.unwell_coronavirus_weeks_physical_.Wave_2a =
           case_when(dem.unwell_coronavirus_weeks_physical_.Wave_2a == "Yes" |
                      dem.unwell_coronavirus_weeks_physical_.Wave_2a_dup == "Yes" ~ "Yes",
                     
                   dem.unwell_coronavirus_weeks_physical_.Wave_2a == "No" |
                   dem.unwell_coronavirus_weeks_physical_.Wave_2a_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(dem.unwell_coronavirus_weeks_physical_.Wave_2b =
           case_when(dem.unwell_coronavirus_weeks_physical_.Wave_2b == "Yes" |
                      dem.unwell_coronavirus_weeks_physical_.Wave_2b_dup == "Yes" ~ "Yes",
                     
                   dem.unwell_coronavirus_weeks_physical_.Wave_2b == "No" |
                   dem.unwell_coronavirus_weeks_physical_.Wave_2b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.unwell_coronavirus_weeks_physical_.Wave_3a =
           case_when(dem.unwell_coronavirus_weeks_physical_.Wave_3a == "Yes" |
                      dem.unwell_coronavirus_weeks_physical_.Wave_3a_dup == "Yes" ~ "Yes",
                     
                   dem.unwell_coronavirus_weeks_physical_.Wave_3a == "No" |
                   dem.unwell_coronavirus_weeks_physical_.Wave_3a_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(dem.unwell_coronavirus_weeks_physical_.Wave_3b =
           case_when(dem.unwell_coronavirus_weeks_physical_.Wave_3b == "Yes" |
                      dem.unwell_coronavirus_weeks_physical_.Wave_3b_dup == "Yes" ~ "Yes",
                     
                   dem.unwell_coronavirus_weeks_physical_.Wave_3b == "No" |
                   dem.unwell_coronavirus_weeks_physical_.Wave_3b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.unwell_coronavirus_weeks_physical_.Wave_4a =
           case_when(dem.unwell_coronavirus_weeks_physical_.Wave_4a == "Yes" |
                      dem.unwell_coronavirus_weeks_physical_.Wave_4a_dup == "Yes" ~ "Yes",
                     
                   dem.unwell_coronavirus_weeks_physical_.Wave_4a == "No" |
                   dem.unwell_coronavirus_weeks_physical_.Wave_4a_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.unwell_coronavirus_weeks_physical_.Wave_4b =
           case_when(dem.unwell_coronavirus_weeks_physical_.Wave_4b == "Yes" |
                      dem.unwell_coronavirus_weeks_physical_.Wave_4b_dup == "Yes" ~ "Yes",
                     
                   dem.unwell_coronavirus_weeks_physical_.Wave_4b == "No" |
                   dem.unwell_coronavirus_weeks_physical_.Wave_4b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.unwell_coronavirus_weeks_physical_.Wave_5a =
           case_when(dem.unwell_coronavirus_weeks_physical_.Wave_5a == "Yes" |
                      dem.unwell_coronavirus_weeks_physical_.Wave_5a_dup == "Yes" ~ "Yes",
                     
                   dem.unwell_coronavirus_weeks_physical_.Wave_5a == "No" |
                   dem.unwell_coronavirus_weeks_physical_.Wave_5a_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(dem.unwell_coronavirus_weeks_physical_.Wave_6b =
           case_when(dem.unwell_coronavirus_weeks_physical_.Wave_6b== "Yes" |
                      dem.unwell_coronavirus_weeks_physical_.Wave_6b_dup == "Yes" ~ "Yes",
                     
                   dem.unwell_coronavirus_weeks_physical_.Wave_6b == "No" |
                   dem.unwell_coronavirus_weeks_physical_.Wave_6b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.unwell_coronavirus_weeks_physical_.Wave_7a =
           case_when(dem.unwell_coronavirus_weeks_physical_.Wave_7a == "Yes" |
                      dem.unwell_coronavirus_weeks_physical_.Wave_7a_dup == "Yes" ~ "Yes",
                     
                   dem.unwell_coronavirus_weeks_physical_.Wave_7a == "No" |
                   dem.unwell_coronavirus_weeks_physical_.Wave_7a_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.unwell_coronavirus_weeks_physical_.Wave_8b =
           case_when(dem.unwell_coronavirus_weeks_physical_.Wave_8b == "Yes" |
                      dem.unwell_coronavirus_weeks_physical_.Wave_8b_dup == "Yes" ~ "Yes",
                     
                   dem.unwell_coronavirus_weeks_physical_.Wave_8b == "No" |
                   dem.unwell_coronavirus_weeks_physical_.Wave_8b_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(dem.unwell_coronavirus_weeks_physical_.Wave_9a =
           case_when(dem.unwell_coronavirus_weeks_physical_.Wave_9a == "Yes" |
                      dem.unwell_coronavirus_weeks_physical_.Wave_9a_dup == "Yes" ~ "Yes",
                     
                   dem.unwell_coronavirus_weeks_physical_.Wave_9a == "No" |
                   dem.unwell_coronavirus_weeks_physical_.Wave_9a_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(dem.unwell_coronavirus_weeks_physical_.Wave_10b =
           case_when(dem.unwell_coronavirus_weeks_physical_.Wave_10b == "Yes" |
                      dem.unwell_coronavirus_weeks_physical_.Wave_10b_dup == "Yes" ~ "Yes",
                     
                   dem.unwell_coronavirus_weeks_physical_.Wave_10b == "No" |
                   dem.unwell_coronavirus_weeks_physical_.Wave_10b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.unwell_coronavirus_weeks_physical_.Wave_11a =
           case_when(dem.unwell_coronavirus_weeks_physical_.Wave_11a == "Yes" |
                      dem.unwell_coronavirus_weeks_physical_.Wave_11a_dup == "Yes" ~ "Yes",
                     
                   dem.unwell_coronavirus_weeks_physical_.Wave_11a== "No" |
                   dem.unwell_coronavirus_weeks_physical_.Wave_11a_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.unwell_coronavirus_weeks_physical_.Wave_12b =
           case_when(dem.unwell_coronavirus_weeks_physical_.Wave_12b == "Yes" |
                      dem.unwell_coronavirus_weeks_physical_.Wave_12b_dup == "Yes" ~ "Yes",
                     
                   dem.unwell_coronavirus_weeks_physical_.Wave_12b== "No" |
                   dem.unwell_coronavirus_weeks_physical_.Wave_12b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.unwell_coronavirus_weeks_physical_.Wave_13a =
           case_when(dem.unwell_coronavirus_weeks_physical_.Wave_13a == "Yes" |
                      dem.unwell_coronavirus_weeks_physical_.Wave_13a_dup == "Yes" ~ "Yes",
                     
                   dem.unwell_coronavirus_weeks_physical_.Wave_13a== "No" |
                  dem.unwell_coronavirus_weeks_physical_.Wave_13a_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(dem.unwell_coronavirus_weeks_physical_.Wave_14b =
           case_when(dem.unwell_coronavirus_weeks_physical_.Wave_14b == "Yes" |
                      dem.unwell_coronavirus_weeks_physical_.Wave_14b_dup == "Yes" ~ "Yes",
                     
                   dem.unwell_coronavirus_weeks_physical_.Wave_14b== "No" |
                 dem.unwell_coronavirus_weeks_physical_.Wave_14b_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(dem.unwell_coronavirus_weeks_physical_.Wave_15a =
           case_when(dem.unwell_coronavirus_weeks_physical_.Wave_15a == "Yes" |
                      dem.unwell_coronavirus_weeks_physical_.Wave_15a_dup == "Yes" ~ "Yes",
                     
                   dem.unwell_coronavirus_weeks_physical_.Wave_15a== "No" |
                 dem.unwell_coronavirus_weeks_physical_.Wave_15a_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.unwell_coronavirus_weeks_physical_.Wave_16b =
           case_when(dem.unwell_coronavirus_weeks_physical_.Wave_16b == "Yes" |
                      dem.unwell_coronavirus_weeks_physical_.Wave_16b_dup == "Yes" ~ "Yes",
                     
                   dem.unwell_coronavirus_weeks_physical_.Wave_16b== "No" |
                dem.unwell_coronavirus_weeks_physical_.Wave_16b_dup == "No" ~ "No",
                     
                     )
         )
```

```{r relative died of covid single variables from duplicated IDs}
# Relative died of COVID of key earner in household
dat <- dat %>%
  mutate(dem.coronavirus_relative_previously_ill.1_.Wave_1a =
           case_when(dem.coronavirus_relative_previously_ill.1_.Wave_1a == "Yes" |
                      dem.coronavirus_relative_previously_ill.1_.Wave_1a_dup == "Yes" ~ "Yes",
                     
                   dem.coronavirus_relative_previously_ill.1_.Wave_1a == "No" |
                   dem.coronavirus_relative_previously_ill.1_.Wave_1a_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.coronavirus_relative_previously_ill.1_.Wave_1b =
           case_when(dem.coronavirus_relative_previously_ill.1_.Wave_1b == "Yes" |
                      dem.coronavirus_relative_previously_ill.1_.Wave_1b_dup == "Yes" ~ "Yes",
                     
                   dem.coronavirus_relative_previously_ill.1_.Wave_1b == "No" |
                   dem.coronavirus_relative_previously_ill.1_.Wave_1b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.coronavirus_relative_previously_ill.1_.Wave_2a =
           case_when(dem.coronavirus_relative_previously_ill.1_.Wave_2a == "Yes" |
                      dem.coronavirus_relative_previously_ill.1_.Wave_2a_dup == "Yes" ~ "Yes",
                     
                   dem.coronavirus_relative_previously_ill.1_.Wave_2a == "No" |
                   dem.coronavirus_relative_previously_ill.1_.Wave_2a_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(dem.coronavirus_relative_previously_ill.1_.Wave_2b =
           case_when(dem.coronavirus_relative_previously_ill.1_.Wave_2b == "Yes" |
                      dem.coronavirus_relative_previously_ill.1_.Wave_2b_dup == "Yes" ~ "Yes",
                     
                   dem.coronavirus_relative_previously_ill.1_.Wave_2b == "No" |
                   dem.coronavirus_relative_previously_ill.1_.Wave_2b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.coronavirus_relative_previously_ill.1_.Wave_3a =
           case_when(dem.coronavirus_relative_previously_ill.1_.Wave_3a == "Yes" |
                      dem.coronavirus_relative_previously_ill.1_.Wave_3a_dup == "Yes" ~ "Yes",
                     
                   dem.coronavirus_relative_previously_ill.1_.Wave_3a == "No" |
                   dem.coronavirus_relative_previously_ill.1_.Wave_3a_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(dem.coronavirus_relative_previously_ill.1_.Wave_3b =
           case_when(dem.coronavirus_relative_previously_ill.1_.Wave_3b == "Yes" |
                      dem.coronavirus_relative_previously_ill.1_.Wave_3b_dup == "Yes" ~ "Yes",
                     
                   dem.coronavirus_relative_previously_ill.1_.Wave_3b == "No" |
                   dem.coronavirus_relative_previously_ill.1_.Wave_3b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.coronavirus_relative_previously_ill.1_.Wave_4a =
           case_when(dem.coronavirus_relative_previously_ill.1_.Wave_4a == "Yes" |
                      dem.coronavirus_relative_previously_ill.1_.Wave_4a_dup == "Yes" ~ "Yes",
                     
                   dem.coronavirus_relative_previously_ill.1_.Wave_4a == "No" |
                   dem.coronavirus_relative_previously_ill.1_.Wave_4a_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.coronavirus_relative_previously_ill.1_.Wave_4b =
           case_when(dem.coronavirus_relative_previously_ill.1_.Wave_4b == "Yes" |
                      dem.coronavirus_relative_previously_ill.1_.Wave_4b_dup == "Yes" ~ "Yes",
                     
                   dem.coronavirus_relative_previously_ill.1_.Wave_4b == "No" |
                   dem.coronavirus_relative_previously_ill.1_.Wave_4b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.coronavirus_relative_previously_ill.1_.Wave_5a =
           case_when(dem.coronavirus_relative_previously_ill.1_.Wave_5a == "Yes" |
                      dem.coronavirus_relative_previously_ill.1_.Wave_5a_dup == "Yes" ~ "Yes",
                     
                   dem.coronavirus_relative_previously_ill.1_.Wave_5a == "No" |
                   dem.coronavirus_relative_previously_ill.1_.Wave_5a_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(dem.coronavirus_relative_previously_ill.1_.Wave_6b =
           case_when(dem.coronavirus_relative_previously_ill.1_.Wave_6b== "Yes" |
                      dem.coronavirus_relative_previously_ill.1_.Wave_6b_dup == "Yes" ~ "Yes",
                     
                   dem.coronavirus_relative_previously_ill.1_.Wave_6b == "No" |
                   dem.coronavirus_relative_previously_ill.1_.Wave_6b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.coronavirus_relative_previously_ill.1_.Wave_7a =
           case_when(dem.coronavirus_relative_previously_ill.1_.Wave_7a == "Yes" |
                      dem.coronavirus_relative_previously_ill.1_.Wave_7a_dup == "Yes" ~ "Yes",
                     
                   dem.coronavirus_relative_previously_ill.1_.Wave_7a == "No" |
                   dem.coronavirus_relative_previously_ill.1_.Wave_7a_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.coronavirus_relative_previously_ill.1_.Wave_8b =
           case_when(dem.coronavirus_relative_previously_ill.1_.Wave_8b == "Yes" |
                      dem.coronavirus_relative_previously_ill.1_.Wave_8b_dup == "Yes" ~ "Yes",
                     
                   dem.coronavirus_relative_previously_ill.1_.Wave_8b == "No" |
                   dem.coronavirus_relative_previously_ill.1_.Wave_8b_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(dem.coronavirus_relative_previously_ill.1_.Wave_9a =
           case_when(dem.coronavirus_relative_previously_ill.1_.Wave_9a == "Yes" |
                      dem.coronavirus_relative_previously_ill.1_.Wave_9a_dup == "Yes" ~ "Yes",
                     
                   dem.coronavirus_relative_previously_ill.1_.Wave_9a == "No" |
                   dem.coronavirus_relative_previously_ill.1_.Wave_9a_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(dem.coronavirus_relative_previously_ill.1_.Wave_10b =
           case_when(dem.coronavirus_relative_previously_ill.1_.Wave_10b == "Yes" |
                      dem.coronavirus_relative_previously_ill.1_.Wave_10b_dup == "Yes" ~ "Yes",
                     
                   dem.coronavirus_relative_previously_ill.1_.Wave_10b == "No" |
                   dem.coronavirus_relative_previously_ill.1_.Wave_10b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.coronavirus_relative_previously_ill.1_.Wave_11a =
           case_when(dem.coronavirus_relative_previously_ill.1_.Wave_11a == "Yes" |
                      dem.coronavirus_relative_previously_ill.1_.Wave_11a_dup == "Yes" ~ "Yes",
                     
                   dem.coronavirus_relative_previously_ill.1_.Wave_11a== "No" |
                   dem.coronavirus_relative_previously_ill.1_.Wave_11a_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.coronavirus_relative_previously_ill.1_.Wave_12b =
           case_when(dem.coronavirus_relative_previously_ill.1_.Wave_12b == "Yes" |
                      dem.coronavirus_relative_previously_ill.1_.Wave_12b_dup == "Yes" ~ "Yes",
                     
                   dem.coronavirus_relative_previously_ill.1_.Wave_12b== "No" |
                   dem.coronavirus_relative_previously_ill.1_.Wave_12b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.coronavirus_relative_previously_ill.1_.Wave_13a =
           case_when(dem.coronavirus_relative_previously_ill.1_.Wave_13a == "Yes" |
                      dem.coronavirus_relative_previously_ill.1_.Wave_13a_dup == "Yes" ~ "Yes",
                     
                   dem.coronavirus_relative_previously_ill.1_.Wave_13a== "No" |
                  dem.coronavirus_relative_previously_ill.1_.Wave_13a_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(dem.coronavirus_relative_previously_ill.1_.Wave_14b =
           case_when(dem.coronavirus_relative_previously_ill.1_.Wave_14b == "Yes" |
                      dem.coronavirus_relative_previously_ill.1_.Wave_14b_dup == "Yes" ~ "Yes",
                     
                   dem.coronavirus_relative_previously_ill.1_.Wave_14b== "No" |
                 dem.coronavirus_relative_previously_ill.1_.Wave_14b_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(dem.coronavirus_relative_previously_ill.1_.Wave_15a =
           case_when(dem.coronavirus_relative_previously_ill.1_.Wave_15a == "Yes" |
                      dem.coronavirus_relative_previously_ill.1_.Wave_15a_dup == "Yes" ~ "Yes",
                     
                   dem.coronavirus_relative_previously_ill.1_.Wave_15a== "No" |
                 dem.coronavirus_relative_previously_ill.1_.Wave_15a_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.coronavirus_relative_previously_ill.1_.Wave_16b =
           case_when(dem.coronavirus_relative_previously_ill.1_.Wave_16b == "Yes" |
                      dem.coronavirus_relative_previously_ill.1_.Wave_16b_dup == "Yes" ~ "Yes",
                     
                   dem.coronavirus_relative_previously_ill.1_.Wave_16b== "No" |
                dem.coronavirus_relative_previously_ill.1_.Wave_16b_dup == "No" ~ "No",
                     
                     )
         )
```

```{r relative ill with covid single variables from duplicated IDs}
# Relative ill with COVID of key earner in household
dat <- dat %>%
  mutate(dem.coronavirus_relative_ill_suspected_.Wave_1a =
           case_when(dem.coronavirus_relative_ill_suspected_.Wave_1a == "Yes" |
                      dem.coronavirus_relative_ill_suspected_.Wave_1a_dup == "Yes" ~ "Yes",
                     
                   dem.coronavirus_relative_ill_suspected_.Wave_1a == "No" |
                   dem.coronavirus_relative_ill_suspected_.Wave_1a_dup == "No" ~ "No",
                   
                   dem.coronavirus_relative_ill_suspected_.Wave_1a == "Unsure" |
                   dem.coronavirus_relative_ill_suspected_.Wave_1a_dup == "Unsure" ~ "Unsure",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.coronavirus_relative_ill_suspected_.Wave_1b =
           case_when(dem.coronavirus_relative_ill_suspected_.Wave_1b == "Yes" |
                      dem.coronavirus_relative_ill_suspected_.Wave_1b_dup == "Yes" ~ "Yes",
                     
                   dem.coronavirus_relative_ill_suspected_.Wave_1b == "No" |
                   dem.coronavirus_relative_ill_suspected_.Wave_1b_dup == "No" ~ "No",
                   
                   dem.coronavirus_relative_ill_suspected_.Wave_1b == "Unsure" |
                   dem.coronavirus_relative_ill_suspected_.Wave_1b_dup == "Unsure" ~ "Unsure",
                     
                     )
         )

dat <- dat %>%
  mutate(dem.coronavirus_relative_ill_suspected_.Wave_2a =
           case_when(dem.coronavirus_relative_ill_suspected_.Wave_2a == "Yes" |
                      dem.coronavirus_relative_ill_suspected_.Wave_2a_dup == "Yes" ~ "Yes",
                     
                   dem.coronavirus_relative_ill_suspected_.Wave_2a == "No" |
                   dem.coronavirus_relative_ill_suspected_.Wave_2a_dup == "No" ~ "No",
                   
                     dem.coronavirus_relative_ill_suspected_.Wave_2a == "Unsure" |
                   dem.coronavirus_relative_ill_suspected_.Wave_2a_dup == "Unsure" ~ "Unsure"
                     
                     
                     )
         )


dat <- dat %>%
  mutate(dem.coronavirus_relative_ill_suspected_.Wave_2b =
           case_when(dem.coronavirus_relative_ill_suspected_.Wave_2b == "Yes" |
                      dem.coronavirus_relative_ill_suspected_.Wave_2b_dup == "Yes" ~ "Yes",
                     
                   dem.coronavirus_relative_ill_suspected_.Wave_2b == "No" |
                   dem.coronavirus_relative_ill_suspected_.Wave_2b_dup == "No" ~ "No",
                   
                      dem.coronavirus_relative_ill_suspected_.Wave_2b == "Unsure" |
                   dem.coronavirus_relative_ill_suspected_.Wave_2b_dup == "Unsure" ~ "Unsure"
                     
                     )
         )

dat <- dat %>%
  mutate(dem.coronavirus_relative_ill_suspected_.Wave_3a =
           case_when(dem.coronavirus_relative_ill_suspected_.Wave_3a == "Yes" |
                      dem.coronavirus_relative_ill_suspected_.Wave_3a_dup == "Yes" ~ "Yes",
                     
                   dem.coronavirus_relative_ill_suspected_.Wave_3a == "No" |
                   dem.coronavirus_relative_ill_suspected_.Wave_3a_dup == "No" ~ "No",
                   
                   dem.coronavirus_relative_ill_suspected_.Wave_3a == "Unsure" |
                   dem.coronavirus_relative_ill_suspected_.Wave_3a_dup == "Unsure" ~ "Unsure"
                     
                     )
         )


dat <- dat %>%
  mutate(dem.coronavirus_relative_ill_suspected_.Wave_3b =
           case_when(dem.coronavirus_relative_ill_suspected_.Wave_3b == "Yes" |
                      dem.coronavirus_relative_ill_suspected_.Wave_3b_dup == "Yes" ~ "Yes",
                     
                   dem.coronavirus_relative_ill_suspected_.Wave_3b == "No" |
                   dem.coronavirus_relative_ill_suspected_.Wave_3b_dup == "No" ~ "No",
                   
                   dem.coronavirus_relative_ill_suspected_.Wave_3b == "Unsure" |
                   dem.coronavirus_relative_ill_suspected_.Wave_3b_dup == "Unsure" ~ "Unsure"
                     
                     )
         )

dat <- dat %>%
  mutate(dem.coronavirus_relative_ill_suspected_.Wave_4a =
           case_when(dem.coronavirus_relative_ill_suspected_.Wave_4a == "Yes" |
                      dem.coronavirus_relative_ill_suspected_.Wave_4a_dup == "Yes" ~ "Yes",
                     
                   dem.coronavirus_relative_ill_suspected_.Wave_4a == "No" |
                   dem.coronavirus_relative_ill_suspected_.Wave_4a_dup == "No" ~ "No",
                   
                   dem.coronavirus_relative_ill_suspected_.Wave_4a == "Unsure" |
                   dem.coronavirus_relative_ill_suspected_.Wave_4a_dup == "Unsure" ~ "Unsure"
                     
                     )
         )

dat <- dat %>%
  mutate(dem.coronavirus_relative_ill_suspected_.Wave_4b =
           case_when(dem.coronavirus_relative_ill_suspected_.Wave_4b == "Yes" |
                      dem.coronavirus_relative_ill_suspected_.Wave_4b_dup == "Yes" ~ "Yes",
                     
                   dem.coronavirus_relative_ill_suspected_.Wave_4b == "No" |
                   dem.coronavirus_relative_ill_suspected_.Wave_4b_dup == "No" ~ "No",
                   
                   dem.coronavirus_relative_ill_suspected_.Wave_4b == "Unsure" |
                   dem.coronavirus_relative_ill_suspected_.Wave_4b_dup == "Unsure" ~ "Unsure"
                     
                     )
         )

dat <- dat %>%
  mutate(dem.coronavirus_relative_ill_suspected_.Wave_5a =
           case_when(dem.coronavirus_relative_ill_suspected_.Wave_5a == "Yes" |
                      dem.coronavirus_relative_ill_suspected_.Wave_5a_dup == "Yes" ~ "Yes",
                     
                   dem.coronavirus_relative_ill_suspected_.Wave_5a == "No" |
                   dem.coronavirus_relative_ill_suspected_.Wave_5a_dup == "No" ~ "No",
                   
                   dem.coronavirus_relative_ill_suspected_.Wave_5a == "Unsure" |
                   dem.coronavirus_relative_ill_suspected_.Wave_5a_dup == "Unsure" ~ "Unsure"
                     
                     )
         )


dat <- dat %>%
  mutate(dem.coronavirus_relative_ill_suspected_.Wave_6b =
           case_when(dem.coronavirus_relative_ill_suspected_.Wave_6b== "Yes" |
                      dem.coronavirus_relative_ill_suspected_.Wave_6b_dup == "Yes" ~ "Yes",
                     
                   dem.coronavirus_relative_ill_suspected_.Wave_6b == "No" |
                   dem.coronavirus_relative_ill_suspected_.Wave_6b_dup == "No" ~ "No",
                   
                   dem.coronavirus_relative_ill_suspected_.Wave_6b == "Unsure" |
                   dem.coronavirus_relative_ill_suspected_.Wave_6b_dup == "Unsure" ~ "Unsure"
                     
                     )
         )

dat <- dat %>%
  mutate(dem.coronavirus_relative_ill_suspected_.Wave_7a =
           case_when(dem.coronavirus_relative_ill_suspected_.Wave_7a == "Yes" |
                      dem.coronavirus_relative_ill_suspected_.Wave_7a_dup == "Yes" ~ "Yes",
                     
                   dem.coronavirus_relative_ill_suspected_.Wave_7a == "No" |
                   dem.coronavirus_relative_ill_suspected_.Wave_7a_dup == "No" ~ "No",
                   
                   dem.coronavirus_relative_ill_suspected_.Wave_7a == "Unsure" |
                   dem.coronavirus_relative_ill_suspected_.Wave_7a_dup == "Unsure" ~ "Unsure"
                     
                     )
         )

dat <- dat %>%
  mutate(dem.coronavirus_relative_ill_suspected_.Wave_8b =
           case_when(dem.coronavirus_relative_ill_suspected_.Wave_8b == "Yes" |
                      dem.coronavirus_relative_ill_suspected_.Wave_8b_dup == "Yes" ~ "Yes",
                     
                   dem.coronavirus_relative_ill_suspected_.Wave_8b == "No" |
                   dem.coronavirus_relative_ill_suspected_.Wave_8b_dup == "No" ~ "No",
                   
                   dem.coronavirus_relative_ill_suspected_.Wave_8b == "Unsure" |
                   dem.coronavirus_relative_ill_suspected_.Wave_8b_dup == "Unsure" ~ "Unsure"
                     
                     )
         )


dat <- dat %>%
  mutate(dem.coronavirus_relative_ill_suspected_.Wave_9a =
           case_when(dem.coronavirus_relative_ill_suspected_.Wave_9a == "Yes" |
                      dem.coronavirus_relative_ill_suspected_.Wave_9a_dup == "Yes" ~ "Yes",
                     
                   dem.coronavirus_relative_ill_suspected_.Wave_9a == "No" |
                   dem.coronavirus_relative_ill_suspected_.Wave_9a_dup == "No" ~ "No",
                   
                   dem.coronavirus_relative_ill_suspected_.Wave_9a == "Unsure" |
                   dem.coronavirus_relative_ill_suspected_.Wave_9a_dup == "Unsure" ~ "Unsure"
                     
                     )
         )


dat <- dat %>%
  mutate(dem.coronavirus_relative_ill_suspected_.Wave_10b =
           case_when(dem.coronavirus_relative_ill_suspected_.Wave_10b == "Yes" |
                      dem.coronavirus_relative_ill_suspected_.Wave_10b_dup == "Yes" ~ "Yes",
                     
                   dem.coronavirus_relative_ill_suspected_.Wave_10b == "No" |
                   dem.coronavirus_relative_ill_suspected_.Wave_10b_dup == "No" ~ "No",
                   
                   dem.coronavirus_relative_ill_suspected_.Wave_10b == "Unsure" |
                   dem.coronavirus_relative_ill_suspected_.Wave_10b_dup == "Unsure" ~ "Unsure"
                     
                     )
         )

dat <- dat %>%
  mutate(dem.coronavirus_relative_ill_suspected_.Wave_11a =
           case_when(dem.coronavirus_relative_ill_suspected_.Wave_11a == "Yes" |
                      dem.coronavirus_relative_ill_suspected_.Wave_11a_dup == "Yes" ~ "Yes",
                     
                   dem.coronavirus_relative_ill_suspected_.Wave_11a== "No" |
                   dem.coronavirus_relative_ill_suspected_.Wave_11a_dup == "No" ~ "No",
                   
                   dem.coronavirus_relative_ill_suspected_.Wave_11a == "Unsure" |
                   dem.coronavirus_relative_ill_suspected_.Wave_11a_dup == "Unsure" ~ "Unsure"
                     
                     )
         )

dat <- dat %>%
  mutate(dem.coronavirus_relative_ill_suspected_.Wave_12b =
           case_when(dem.coronavirus_relative_ill_suspected_.Wave_12b == "Yes" |
                      dem.coronavirus_relative_ill_suspected_.Wave_12b_dup == "Yes" ~ "Yes",
                     
                   dem.coronavirus_relative_ill_suspected_.Wave_12b== "No" |
                   dem.coronavirus_relative_ill_suspected_.Wave_12b_dup == "No" ~ "No",
                   
                   dem.coronavirus_relative_ill_suspected_.Wave_12b == "Unsure" |
                   dem.coronavirus_relative_ill_suspected_.Wave_12b_dup == "Unsure" ~ "Unsure"
                     
                     )
         )

dat <- dat %>%
  mutate(dem.coronavirus_relative_ill_suspected_.Wave_13a =
           case_when(dem.coronavirus_relative_ill_suspected_.Wave_13a == "Yes" |
                      dem.coronavirus_relative_ill_suspected_.Wave_13a_dup == "Yes" ~ "Yes",
                     
                   dem.coronavirus_relative_ill_suspected_.Wave_13a== "No" |
                  dem.coronavirus_relative_ill_suspected_.Wave_13a_dup == "No" ~ "No",
                  
                  dem.coronavirus_relative_ill_suspected_.Wave_13a == "Unsure" |
                   dem.coronavirus_relative_ill_suspected_.Wave_13a_dup == "Unsure" ~ "Unsure"
                     
                     )
         )


dat <- dat %>%
  mutate(dem.coronavirus_relative_ill_suspected_.Wave_14b =
           case_when(dem.coronavirus_relative_ill_suspected_.Wave_14b == "Yes" |
                      dem.coronavirus_relative_ill_suspected_.Wave_14b_dup == "Yes" ~ "Yes",
                     
                   dem.coronavirus_relative_ill_suspected_.Wave_14b== "No" |
                 dem.coronavirus_relative_ill_suspected_.Wave_14b_dup == "No" ~ "No",
                 
                 dem.coronavirus_relative_ill_suspected_.Wave_14b == "Unsure" |
                   dem.coronavirus_relative_ill_suspected_.Wave_14b_dup == "Unsure" ~ "Unsure"
                     
                     )
         )


dat <- dat %>%
  mutate(dem.coronavirus_relative_ill_suspected_.Wave_15a =
           case_when(dem.coronavirus_relative_ill_suspected_.Wave_15a == "Yes" |
                      dem.coronavirus_relative_ill_suspected_.Wave_15a_dup == "Yes" ~ "Yes",
                     
                   dem.coronavirus_relative_ill_suspected_.Wave_15a== "No" |
                 dem.coronavirus_relative_ill_suspected_.Wave_15a_dup == "No" ~ "No",
                 
                 dem.coronavirus_relative_ill_suspected_.Wave_15a == "Unsure" |
                   dem.coronavirus_relative_ill_suspected_.Wave_15a_dup == "Unsure" ~ "Unsure"
                     
                     )
         )

dat <- dat %>%
  mutate(dem.coronavirus_relative_ill_suspected_.Wave_16b =
           case_when(dem.coronavirus_relative_ill_suspected_.Wave_16b == "Yes" |
                      dem.coronavirus_relative_ill_suspected_.Wave_16b_dup == "Yes" ~ "Yes",
                     
                   dem.coronavirus_relative_ill_suspected_.Wave_16b== "No" |
                dem.coronavirus_relative_ill_suspected_.Wave_16b_dup == "No" ~ "No",
                
                dem.coronavirus_relative_ill_suspected_.Wave_16b == "Unsure" |
                   dem.coronavirus_relative_ill_suspected_.Wave_16b_dup == "Unsure" ~ "Unsure"
                     
                     )
         )
```

## Thoughts and feelings (i.e., self-harm thoughts and behaviours)
NB: 'Yes once' and 'Yes, more than once' both get coded to just 'Yes'
```{r life not worth living single variables from duplicated IDs}
# Life not worth living
dat <- dat %>%
  mutate(taf.worth_living_life_people_.Wave_1a =
           case_when(taf.worth_living_life_people_.Wave_1a == "Yes, once" |
                      taf.worth_living_life_people_.Wave_1a_dup == "Yes, once" ~ "Yes, once",
                     
                     taf.worth_living_life_people_.Wave_1a == "Yes, more than once" |
                      taf.worth_living_life_people_.Wave_1a_dup == "Yes, more than once" ~ "Yes, more than once",
                     
                   taf.worth_living_life_people_.Wave_1a == "No" |
                   taf.worth_living_life_people_.Wave_1a_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.worth_living_life_people_.Wave_1b =
           case_when(taf.worth_living_life_people_.Wave_1b == "Yes, once" |
                      taf.worth_living_life_people_.Wave_1b_dup == "Yes, once" ~ "Yes, once",
                     
                     taf.worth_living_life_people_.Wave_1b == "Yes, more than once" |
                      taf.worth_living_life_people_.Wave_1b_dup == "Yes, more than once" ~ "Yes, more than once",
                     
                   taf.worth_living_life_people_.Wave_1b == "No" |
                   taf.worth_living_life_people_.Wave_1b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.worth_living_life_people_.Wave_2a =
           case_when(taf.worth_living_life_people_.Wave_2a == "Yes, once" |
                      taf.worth_living_life_people_.Wave_2a_dup == "Yes, once" ~ "Yes, once",
                     
                      taf.worth_living_life_people_.Wave_2a == "Yes, more than once" |
                      taf.worth_living_life_people_.Wave_2a_dup == "Yes, more than once" ~ "Yes, more than once",
                     
                     
                   taf.worth_living_life_people_.Wave_2a == "No" |
                   taf.worth_living_life_people_.Wave_2a_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(taf.worth_living_life_people_.Wave_2b =
           case_when(taf.worth_living_life_people_.Wave_2b == "Yes, once" |
                      taf.worth_living_life_people_.Wave_2b_dup == "Yes, once" ~ "Yes, once",
                     
                      taf.worth_living_life_people_.Wave_2b == "Yes, more than once" |
                      taf.worth_living_life_people_.Wave_2b_dup == "Yes, more than once" ~ "Yes, more than once",
                     
                     
                   taf.worth_living_life_people_.Wave_2b == "No" |
                   taf.worth_living_life_people_.Wave_2b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.worth_living_life_people_.Wave_3a =
           case_when(taf.worth_living_life_people_.Wave_3a == "Yes, once" |
                      taf.worth_living_life_people_.Wave_3a_dup == "Yes, once" ~ "Yes, once",
                     
                      taf.worth_living_life_people_.Wave_3a == "Yes, more than once" |
                      taf.worth_living_life_people_.Wave_3a_dup == "Yes, more than once" ~ "Yes, more than once",
                     
                   taf.worth_living_life_people_.Wave_3a == "No" |
                   taf.worth_living_life_people_.Wave_3a_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(taf.worth_living_life_people_.Wave_3b =
           case_when(taf.worth_living_life_people_.Wave_3b == "Yes, once" |
                      taf.worth_living_life_people_.Wave_3b_dup == "Yes, once" ~ "Yes, once",
                     
                      taf.worth_living_life_people_.Wave_3b == "Yes, more than once" |
                      taf.worth_living_life_people_.Wave_3b_dup == "Yes, more than once" ~ "Yes, more than once",
                     
                   taf.worth_living_life_people_.Wave_3b == "No" |
                   taf.worth_living_life_people_.Wave_3b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.worth_living_life_people_.Wave_4a =
           case_when(taf.worth_living_life_people_.Wave_4a == "Yes, once" |
                      taf.worth_living_life_people_.Wave_4a_dup == "Yes, once" ~ "Yes, once",
                      
                     taf.worth_living_life_people_.Wave_4a == "Yes, more than once" |
                      taf.worth_living_life_people_.Wave_4a_dup == "Yes, more than once" ~ "Yes, more than once",
                     
                   taf.worth_living_life_people_.Wave_4a == "No" |
                   taf.worth_living_life_people_.Wave_4a_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.worth_living_life_people_.Wave_4b =
           case_when(taf.worth_living_life_people_.Wave_4b == "Yes, once" |
                      taf.worth_living_life_people_.Wave_4b_dup == "Yes, once" ~ "Yes, once",
                     
                      taf.worth_living_life_people_.Wave_4b == "Yes, more than once" |
                      taf.worth_living_life_people_.Wave_4b_dup == "Yes, more than once" ~ "Yes, more than once",
                     
                   taf.worth_living_life_people_.Wave_4b == "No" |
                   taf.worth_living_life_people_.Wave_4b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.worth_living_life_people_.Wave_5a =
           case_when(taf.worth_living_life_people_.Wave_5a == "Yes, once" |
                      taf.worth_living_life_people_.Wave_5a_dup == "Yes, once" ~ "Yes, once",
                     
                      taf.worth_living_life_people_.Wave_5a == "Yes, more than once" |
                      taf.worth_living_life_people_.Wave_5a_dup == "Yes, more than once" ~ "Yes, more than once",
                     
                   taf.worth_living_life_people_.Wave_5a == "No" |
                   taf.worth_living_life_people_.Wave_5a_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(taf.worth_living_life_people_.Wave_6b =
           case_when(taf.worth_living_life_people_.Wave_6b== "Yes, once" |
                      taf.worth_living_life_people_.Wave_6b_dup == "Yes, once" ~ "Yes, once",
                     
                      taf.worth_living_life_people_.Wave_6b == "Yes, more than once" |
                      taf.worth_living_life_people_.Wave_6b_dup == "Yes, more than once" ~ "Yes, more than once",
                     
                   taf.worth_living_life_people_.Wave_6b == "No" |
                   taf.worth_living_life_people_.Wave_6b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.worth_living_life_people_.Wave_7a =
           case_when(taf.worth_living_life_people_.Wave_7a == "Yes, once" |
                      taf.worth_living_life_people_.Wave_7a_dup == "Yes, once" ~ "Yes, once",
                     
                      taf.worth_living_life_people_.Wave_7a == "Yes, more than once" |
                      taf.worth_living_life_people_.Wave_7a_dup == "Yes, more than once" ~ "Yes, more than once",
                    
                    taf.worth_living_life_people_.Wave_7a == "No" |
                   taf.worth_living_life_people_.Wave_7a_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.worth_living_life_people_.Wave_8b =
           case_when(taf.worth_living_life_people_.Wave_8b == "Yes, once" |
                      taf.worth_living_life_people_.Wave_8b_dup == "Yes, once" ~ "Yes, once",
                     
                      taf.worth_living_life_people_.Wave_8b == "Yes, more than once" |
                      taf.worth_living_life_people_.Wave_8b_dup == "Yes, more than once" ~ "Yes, more than once",
                     
                     taf.worth_living_life_people_.Wave_8b == "No" |
                   taf.worth_living_life_people_.Wave_8b_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(taf.worth_living_life_people_.Wave_9a =
           case_when(taf.worth_living_life_people_.Wave_9a == "Yes, once" |
                      taf.worth_living_life_people_.Wave_9a_dup == "Yes, once" ~ "Yes, once",
                     
                      taf.worth_living_life_people_.Wave_9a == "Yes, more than once" |
                      taf.worth_living_life_people_.Wave_9a_dup == "Yes, more than once" ~ "Yes, more than once",
                     
                   taf.worth_living_life_people_.Wave_9a == "No" |
                   taf.worth_living_life_people_.Wave_9a_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(taf.worth_living_life_people_.Wave_10b =
           case_when(taf.worth_living_life_people_.Wave_10b == "Yes, once" |
                      taf.worth_living_life_people_.Wave_10b_dup == "Yes, once" ~ "Yes, once",
                     
                      taf.worth_living_life_people_.Wave_10b == "Yes, more than once" |
                      taf.worth_living_life_people_.Wave_10b_dup == "Yes, more than once" ~ "Yes, more than once",
                     
                   taf.worth_living_life_people_.Wave_10b == "No" |
                   taf.worth_living_life_people_.Wave_10b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.worth_living_life_people_.Wave_11a =
           case_when(taf.worth_living_life_people_.Wave_11a == "Yes, once" |
                      taf.worth_living_life_people_.Wave_11a_dup == "Yes, once" ~ "Yes, once",
                     
                      taf.worth_living_life_people_.Wave_11a == "Yes, more than once" |
                      taf.worth_living_life_people_.Wave_11a_dup == "Yes, more than once" ~ "Yes, more than once",
                     
                   taf.worth_living_life_people_.Wave_11a== "No" |
                   taf.worth_living_life_people_.Wave_11a_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.worth_living_life_people_.Wave_12b =
           case_when(taf.worth_living_life_people_.Wave_12b == "Yes, once" |
                      taf.worth_living_life_people_.Wave_12b_dup == "Yes, once" ~ "Yes, once",
                     
                      taf.worth_living_life_people_.Wave_12b == "Yes, more than once" |
                      taf.worth_living_life_people_.Wave_12b_dup == "Yes, more than once" ~ "Yes, more than once",
                     
                   taf.worth_living_life_people_.Wave_12b== "No" |
                   taf.worth_living_life_people_.Wave_12b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.worth_living_life_people_.Wave_13a =
           case_when(taf.worth_living_life_people_.Wave_13a == "Yes, once" |
                      taf.worth_living_life_people_.Wave_13a_dup == "Yes, once" ~ "Yes, once",
                     
                      taf.worth_living_life_people_.Wave_13a == "Yes, more than once" |
                      taf.worth_living_life_people_.Wave_13a_dup == "Yes, more than once" ~ "Yes, more than once",
                     
                   taf.worth_living_life_people_.Wave_13a== "No" |
                  taf.worth_living_life_people_.Wave_13a_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(taf.worth_living_life_people_.Wave_14b =
           case_when(taf.worth_living_life_people_.Wave_14b == "Yes, once" |
                      taf.worth_living_life_people_.Wave_14b_dup == "Yes, once" ~ "Yes, once",
                     
                      taf.worth_living_life_people_.Wave_14b == "Yes, more than once" |
                      taf.worth_living_life_people_.Wave_14b_dup == "Yes, more than once" ~ "Yes, more than once",
                     
                   taf.worth_living_life_people_.Wave_14b== "No" |
                 taf.worth_living_life_people_.Wave_14b_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(taf.worth_living_life_people_.Wave_15a =
           case_when(taf.worth_living_life_people_.Wave_15a == "Yes, once" |
                      taf.worth_living_life_people_.Wave_15a_dup == "Yes, once" ~ "Yes, once",
                     
                      taf.worth_living_life_people_.Wave_15a == "Yes, more than once" |
                      taf.worth_living_life_people_.Wave_15a_dup == "Yes, more than once" ~ "Yes, more than once",
                     
                   taf.worth_living_life_people_.Wave_15a== "No" |
                 taf.worth_living_life_people_.Wave_15a_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.worth_living_life_people_.Wave_16b =
           case_when(taf.worth_living_life_people_.Wave_16b == "Yes, once" |
                      taf.worth_living_life_people_.Wave_16b_dup == "Yes, once" ~ "Yes, once",
                     
                      taf.worth_living_life_people_.Wave_16b == "Yes, more than once" |
                      taf.worth_living_life_people_.Wave_16b_dup == "Yes, more than once" ~ "Yes, more than once",
                     
                   taf.worth_living_life_people_.Wave_16b== "No" |
                taf.worth_living_life_people_.Wave_16b_dup == "No" ~ "No",
                     
                     )
         )
```

```{r felt weeks past self single variables from duplicated IDs}
# Felt weeks past
dat <- dat %>%
  mutate(taf.felt_weeks_past_.Wave_1a =
           case_when(taf.felt_weeks_past_.Wave_1a == "Yes" |
                      taf.felt_weeks_past_.Wave_1a_dup == "Yes" ~ "Yes",
                     
                   taf.felt_weeks_past_.Wave_1a == "No" |
                   taf.felt_weeks_past_.Wave_1a_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.felt_weeks_past_.Wave_1b =
           case_when(taf.felt_weeks_past_.Wave_1b == "Yes" |
                      taf.felt_weeks_past_.Wave_1b_dup == "Yes" ~ "Yes",
                     
                   taf.felt_weeks_past_.Wave_1b == "No" |
                   taf.felt_weeks_past_.Wave_1b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.felt_weeks_past_.Wave_2a =
           case_when(taf.felt_weeks_past_.Wave_2a == "Yes" |
                      taf.felt_weeks_past_.Wave_2a_dup == "Yes" ~ "Yes",
                     
                   taf.felt_weeks_past_.Wave_2a == "No" |
                   taf.felt_weeks_past_.Wave_2a_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(taf.felt_weeks_past_.Wave_2b =
           case_when(taf.felt_weeks_past_.Wave_2b == "Yes" |
                      taf.felt_weeks_past_.Wave_2b_dup == "Yes" ~ "Yes",
                     
                    taf.felt_weeks_past_.Wave_2b == "No" |
                   taf.felt_weeks_past_.Wave_2b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.felt_weeks_past_.Wave_3a =
           case_when(taf.felt_weeks_past_.Wave_3a == "Yes" |
                      taf.felt_weeks_past_.Wave_3a_dup == "Yes" ~ "Yes",
                     
                    taf.felt_weeks_past_.Wave_3a == "No" |
                   taf.felt_weeks_past_.Wave_3a_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(taf.felt_weeks_past_.Wave_3b =
           case_when(taf.felt_weeks_past_.Wave_3b == "Yes" |
                      taf.felt_weeks_past_.Wave_3b_dup == "Yes" ~ "Yes",
                   
                     taf.felt_weeks_past_.Wave_3b == "No" |
                   taf.felt_weeks_past_.Wave_3b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.felt_weeks_past_.Wave_4a =
           case_when(taf.felt_weeks_past_.Wave_4a == "Yes" |
                      taf.felt_weeks_past_.Wave_4a_dup == "Yes" ~ "Yes",
                      
                   taf.felt_weeks_past_.Wave_4a == "No" |
                   taf.felt_weeks_past_.Wave_4a_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.felt_weeks_past_.Wave_4b =
           case_when(taf.felt_weeks_past_.Wave_4b == "Yes" |
                      taf.felt_weeks_past_.Wave_4b_dup == "Yes" ~ "Yes",
                     
                     taf.felt_weeks_past_.Wave_4b == "No" |
                   taf.felt_weeks_past_.Wave_4b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.felt_weeks_past_.Wave_5a =
           case_when(taf.felt_weeks_past_.Wave_5a == "Yes" |
                      taf.felt_weeks_past_.Wave_5a_dup == "Yes" ~ "Yes",
                     
                   taf.felt_weeks_past_.Wave_5a == "No" |
                   taf.felt_weeks_past_.Wave_5a_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(taf.felt_weeks_past_.Wave_6b =
           case_when(taf.felt_weeks_past_.Wave_6b== "Yes" |
                      taf.felt_weeks_past_.Wave_6b_dup == "Yes" ~ "Yes",
                     
                   taf.felt_weeks_past_.Wave_6b == "No" |
                   taf.felt_weeks_past_.Wave_6b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.felt_weeks_past_.Wave_7a =
           case_when(taf.felt_weeks_past_.Wave_7a == "Yes" |
                      taf.felt_weeks_past_.Wave_7a_dup == "Yes" ~ "Yes",
                     
                    taf.felt_weeks_past_.Wave_7a == "No" |
                   taf.felt_weeks_past_.Wave_7a_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.felt_weeks_past_.Wave_8b =
           case_when(taf.felt_weeks_past_.Wave_8b == "Yes" |
                      taf.felt_weeks_past_.Wave_8b_dup == "Yes" ~ "Yes",
                     
                     taf.felt_weeks_past_.Wave_8b == "No" |
                   taf.felt_weeks_past_.Wave_8b_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(taf.felt_weeks_past_.Wave_9a =
           case_when(taf.felt_weeks_past_.Wave_9a == "Yes" |
                      taf.felt_weeks_past_.Wave_9a_dup == "Yes" ~ "Yes",
                     
                   taf.felt_weeks_past_.Wave_9a == "No" |
                   taf.felt_weeks_past_.Wave_9a_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(taf.felt_weeks_past_.Wave_10b =
           case_when(taf.felt_weeks_past_.Wave_10b == "Yes" |
                      taf.felt_weeks_past_.Wave_10b_dup == "Yes" ~ "Yes",
                     
                   taf.felt_weeks_past_.Wave_10b == "No" |
                   taf.felt_weeks_past_.Wave_10b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.felt_weeks_past_.Wave_11a =
           case_when(taf.felt_weeks_past_.Wave_11a == "Yes" |
                      taf.felt_weeks_past_.Wave_11a_dup == "Yes" ~ "Yes",
                     
                   taf.felt_weeks_past_.Wave_11a== "No" |
                   taf.felt_weeks_past_.Wave_11a_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.felt_weeks_past_.Wave_12b =
           case_when(taf.felt_weeks_past_.Wave_12b == "Yes" |
                      taf.felt_weeks_past_.Wave_12b_dup == "Yes" ~ "Yes",
                     
                   taf.felt_weeks_past_.Wave_12b== "No" |
                   taf.felt_weeks_past_.Wave_12b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.felt_weeks_past_.Wave_13a =
           case_when(taf.felt_weeks_past_.Wave_13a == "Yes" |
                      taf.felt_weeks_past_.Wave_13a_dup == "Yes" ~ "Yes",
                     
                   taf.felt_weeks_past_.Wave_13a== "No" |
                  taf.felt_weeks_past_.Wave_13a_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(taf.felt_weeks_past_.Wave_14b =
           case_when(taf.felt_weeks_past_.Wave_14b == "Yes" |
                      taf.felt_weeks_past_.Wave_14b_dup == "Yes" ~ "Yes",
                     
                   taf.felt_weeks_past_.Wave_14b== "No" |
                 taf.felt_weeks_past_.Wave_14b_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(taf.felt_weeks_past_.Wave_15a =
           case_when(taf.felt_weeks_past_.Wave_15a == "Yes" |
                      taf.felt_weeks_past_.Wave_15a_dup == "Yes" ~ "Yes",
                     
                   taf.felt_weeks_past_.Wave_15a== "No" |
                 taf.felt_weeks_past_.Wave_15a_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.felt_weeks_past_.Wave_16b =
           case_when(taf.felt_weeks_past_.Wave_16b == "Yes" |
                      taf.felt_weeks_past_.Wave_16b_dup == "Yes" ~ "Yes",
                     
                   taf.felt_weeks_past_.Wave_16b== "No" |
                taf.felt_weeks_past_.Wave_16b_dup == "No" ~ "No",
                     
                     )
         )
```

```{r contemplated harming self single variables from duplicated IDs}
# Contemplated harming self
dat <- dat %>%
  mutate(taf.have_you_contemplated_harming_yourself_.Wave_1a =
           case_when(taf.have_you_contemplated_harming_yourself_.Wave_1a == "Yes, once" |
                      taf.have_you_contemplated_harming_yourself_.Wave_1a_dup == "Yes, once" ~ "Yes, once",
                     
                     taf.have_you_contemplated_harming_yourself_.Wave_1a == "Yes, more than once" |
                      taf.have_you_contemplated_harming_yourself_.Wave_1a_dup == "Yes, more than once" ~ "Yes, more than once",
                     
                   taf.have_you_contemplated_harming_yourself_.Wave_1a == "No" |
                   taf.have_you_contemplated_harming_yourself_.Wave_1a_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.have_you_contemplated_harming_yourself_.Wave_1b =
           case_when(taf.have_you_contemplated_harming_yourself_.Wave_1b == "Yes, once" |
                      taf.have_you_contemplated_harming_yourself_.Wave_1b_dup == "Yes, once" ~ "Yes, once",
                     
                     taf.have_you_contemplated_harming_yourself_.Wave_1b == "Yes, more than once" |
                      taf.have_you_contemplated_harming_yourself_.Wave_1b_dup == "Yes, more than once" ~ "Yes, more than once",
                     
                   taf.have_you_contemplated_harming_yourself_.Wave_1b == "No" |
                   taf.have_you_contemplated_harming_yourself_.Wave_1b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.have_you_contemplated_harming_yourself_.Wave_2a =
           case_when(taf.have_you_contemplated_harming_yourself_.Wave_2a == "Yes, once" |
                      taf.have_you_contemplated_harming_yourself_.Wave_2a_dup == "Yes, once" ~ "Yes, once",
                     
                      taf.have_you_contemplated_harming_yourself_.Wave_2a == "Yes, more than once" |
                      taf.have_you_contemplated_harming_yourself_.Wave_2a_dup == "Yes, more than once" ~ "Yes, more than once",
                     
                     
                   taf.have_you_contemplated_harming_yourself_.Wave_2a == "No" |
                   taf.have_you_contemplated_harming_yourself_.Wave_2a_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(taf.have_you_contemplated_harming_yourself_.Wave_2b =
           case_when(taf.have_you_contemplated_harming_yourself_.Wave_2b == "Yes, once" |
                      taf.have_you_contemplated_harming_yourself_.Wave_2b_dup == "Yes, once" ~ "Yes, once",
                     
                      taf.have_you_contemplated_harming_yourself_.Wave_2b == "Yes, more than once" |
                      taf.have_you_contemplated_harming_yourself_.Wave_2b_dup == "Yes, more than once" ~ "Yes, more than once",
                     
                     
                   taf.have_you_contemplated_harming_yourself_.Wave_2b == "No" |
                   taf.have_you_contemplated_harming_yourself_.Wave_2b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.have_you_contemplated_harming_yourself_.Wave_3a =
           case_when(taf.have_you_contemplated_harming_yourself_.Wave_3a == "Yes, once" |
                      taf.have_you_contemplated_harming_yourself_.Wave_3a_dup == "Yes, once" ~ "Yes, once",
                     
                      taf.have_you_contemplated_harming_yourself_.Wave_3a == "Yes, more than once" |
                      taf.have_you_contemplated_harming_yourself_.Wave_3a_dup == "Yes, more than once" ~ "Yes, more than once",
                     
                   taf.have_you_contemplated_harming_yourself_.Wave_3a == "No" |
                   taf.have_you_contemplated_harming_yourself_.Wave_3a_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(taf.have_you_contemplated_harming_yourself_.Wave_3b =
           case_when(taf.have_you_contemplated_harming_yourself_.Wave_3b == "Yes, once" |
                      taf.have_you_contemplated_harming_yourself_.Wave_3b_dup == "Yes, once" ~ "Yes, once",
                     
                      taf.have_you_contemplated_harming_yourself_.Wave_3b == "Yes, more than once" |
                      taf.have_you_contemplated_harming_yourself_.Wave_3b_dup == "Yes, more than once" ~ "Yes, more than once",
                     
                   taf.have_you_contemplated_harming_yourself_.Wave_3b == "No" |
                   taf.have_you_contemplated_harming_yourself_.Wave_3b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.have_you_contemplated_harming_yourself_.Wave_4a =
           case_when(taf.have_you_contemplated_harming_yourself_.Wave_4a == "Yes, once" |
                      taf.have_you_contemplated_harming_yourself_.Wave_4a_dup == "Yes, once" ~ "Yes, once",
                      
                     taf.have_you_contemplated_harming_yourself_.Wave_4a == "Yes, more than once" |
                      taf.have_you_contemplated_harming_yourself_.Wave_4a_dup == "Yes, more than once" ~ "Yes, more than once",
                     
                   taf.have_you_contemplated_harming_yourself_.Wave_4a == "No" |
                   taf.have_you_contemplated_harming_yourself_.Wave_4a_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.have_you_contemplated_harming_yourself_.Wave_4b =
           case_when(taf.have_you_contemplated_harming_yourself_.Wave_4b == "Yes, once" |
                      taf.have_you_contemplated_harming_yourself_.Wave_4b_dup == "Yes, once" ~ "Yes, once",
                     
                      taf.have_you_contemplated_harming_yourself_.Wave_4b == "Yes, more than once" |
                      taf.have_you_contemplated_harming_yourself_.Wave_4b_dup == "Yes, more than once" ~ "Yes, more than once",
                     
                   taf.have_you_contemplated_harming_yourself_.Wave_4b == "No" |
                   taf.have_you_contemplated_harming_yourself_.Wave_4b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.have_you_contemplated_harming_yourself_.Wave_5a =
           case_when(taf.have_you_contemplated_harming_yourself_.Wave_5a == "Yes, once" |
                      taf.have_you_contemplated_harming_yourself_.Wave_5a_dup == "Yes, once" ~ "Yes, once",
                     
                      taf.have_you_contemplated_harming_yourself_.Wave_5a == "Yes, more than once" |
                      taf.have_you_contemplated_harming_yourself_.Wave_5a_dup == "Yes, more than once" ~ "Yes, more than once",
                     
                   taf.have_you_contemplated_harming_yourself_.Wave_5a == "No" |
                   taf.have_you_contemplated_harming_yourself_.Wave_5a_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(taf.have_you_contemplated_harming_yourself_.Wave_6b =
           case_when(taf.have_you_contemplated_harming_yourself_.Wave_6b== "Yes, once" |
                      taf.have_you_contemplated_harming_yourself_.Wave_6b_dup == "Yes, once" ~ "Yes, once",
                     
                      taf.have_you_contemplated_harming_yourself_.Wave_6b == "Yes, more than once" |
                      taf.have_you_contemplated_harming_yourself_.Wave_6b_dup == "Yes, more than once" ~ "Yes, more than once",
                     
                   taf.have_you_contemplated_harming_yourself_.Wave_6b == "No" |
                   taf.have_you_contemplated_harming_yourself_.Wave_6b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.have_you_contemplated_harming_yourself_.Wave_7a =
           case_when(taf.have_you_contemplated_harming_yourself_.Wave_7a == "Yes, once" |
                      taf.have_you_contemplated_harming_yourself_.Wave_7a_dup == "Yes, once" ~ "Yes, once",
                     
                      taf.have_you_contemplated_harming_yourself_.Wave_7a == "Yes, more than once" |
                      taf.have_you_contemplated_harming_yourself_.Wave_7a_dup == "Yes, more than once" ~ "Yes, more than once",
                    
                    taf.have_you_contemplated_harming_yourself_.Wave_7a == "No" |
                   taf.have_you_contemplated_harming_yourself_.Wave_7a_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.have_you_contemplated_harming_yourself_.Wave_8b =
           case_when(taf.have_you_contemplated_harming_yourself_.Wave_8b == "Yes, once" |
                      taf.have_you_contemplated_harming_yourself_.Wave_8b_dup == "Yes, once" ~ "Yes, once",
                     
                      taf.have_you_contemplated_harming_yourself_.Wave_8b == "Yes, more than once" |
                      taf.have_you_contemplated_harming_yourself_.Wave_8b_dup == "Yes, more than once" ~ "Yes, more than once",
                     
                     taf.have_you_contemplated_harming_yourself_.Wave_8b == "No" |
                   taf.have_you_contemplated_harming_yourself_.Wave_8b_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(taf.have_you_contemplated_harming_yourself_.Wave_9a =
           case_when(taf.have_you_contemplated_harming_yourself_.Wave_9a == "Yes, once" |
                      taf.have_you_contemplated_harming_yourself_.Wave_9a_dup == "Yes, once" ~ "Yes, once",
                     
                      taf.have_you_contemplated_harming_yourself_.Wave_9a == "Yes, more than once" |
                      taf.have_you_contemplated_harming_yourself_.Wave_9a_dup == "Yes, more than once" ~ "Yes, more than once",
                     
                   taf.have_you_contemplated_harming_yourself_.Wave_9a == "No" |
                   taf.have_you_contemplated_harming_yourself_.Wave_9a_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(taf.have_you_contemplated_harming_yourself_.Wave_10b =
           case_when(taf.have_you_contemplated_harming_yourself_.Wave_10b == "Yes, once" |
                      taf.have_you_contemplated_harming_yourself_.Wave_10b_dup == "Yes, once" ~ "Yes, once",
                     
                      taf.have_you_contemplated_harming_yourself_.Wave_10b == "Yes, more than once" |
                      taf.have_you_contemplated_harming_yourself_.Wave_10b_dup == "Yes, more than once" ~ "Yes, more than once",
                     
                   taf.have_you_contemplated_harming_yourself_.Wave_10b == "No" |
                   taf.have_you_contemplated_harming_yourself_.Wave_10b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.have_you_contemplated_harming_yourself_.Wave_11a =
           case_when(taf.have_you_contemplated_harming_yourself_.Wave_11a == "Yes, once" |
                      taf.have_you_contemplated_harming_yourself_.Wave_11a_dup == "Yes, once" ~ "Yes, once",
                     
                      taf.have_you_contemplated_harming_yourself_.Wave_11a == "Yes, more than once" |
                      taf.have_you_contemplated_harming_yourself_.Wave_11a_dup == "Yes, more than once" ~ "Yes, more than once",
                     
                   taf.have_you_contemplated_harming_yourself_.Wave_11a== "No" |
                   taf.have_you_contemplated_harming_yourself_.Wave_11a_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.have_you_contemplated_harming_yourself_.Wave_12b =
           case_when(taf.have_you_contemplated_harming_yourself_.Wave_12b == "Yes, once" |
                      taf.have_you_contemplated_harming_yourself_.Wave_12b_dup == "Yes, once" ~ "Yes, once",
                     
                      taf.have_you_contemplated_harming_yourself_.Wave_12b == "Yes, more than once" |
                      taf.have_you_contemplated_harming_yourself_.Wave_12b_dup == "Yes, more than once" ~ "Yes, more than once",
                     
                   taf.have_you_contemplated_harming_yourself_.Wave_12b== "No" |
                   taf.have_you_contemplated_harming_yourself_.Wave_12b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.have_you_contemplated_harming_yourself_.Wave_13a =
           case_when(taf.have_you_contemplated_harming_yourself_.Wave_13a == "Yes, once" |
                      taf.have_you_contemplated_harming_yourself_.Wave_13a_dup == "Yes, once" ~ "Yes, once",
                     
                      taf.have_you_contemplated_harming_yourself_.Wave_13a == "Yes, more than once" |
                      taf.have_you_contemplated_harming_yourself_.Wave_13a_dup == "Yes, more than once" ~ "Yes, more than once",
                     
                   taf.have_you_contemplated_harming_yourself_.Wave_13a== "No" |
                  taf.have_you_contemplated_harming_yourself_.Wave_13a_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(taf.have_you_contemplated_harming_yourself_.Wave_14b =
           case_when(taf.have_you_contemplated_harming_yourself_.Wave_14b == "Yes, once" |
                      taf.have_you_contemplated_harming_yourself_.Wave_14b_dup == "Yes, once" ~ "Yes, once",
                     
                      taf.have_you_contemplated_harming_yourself_.Wave_14b == "Yes, more than once" |
                      taf.have_you_contemplated_harming_yourself_.Wave_14b_dup == "Yes, more than once" ~ "Yes, more than once",
                     
                   taf.have_you_contemplated_harming_yourself_.Wave_14b== "No" |
                 taf.have_you_contemplated_harming_yourself_.Wave_14b_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(taf.have_you_contemplated_harming_yourself_.Wave_15a =
           case_when(taf.have_you_contemplated_harming_yourself_.Wave_15a == "Yes, once" |
                      taf.have_you_contemplated_harming_yourself_.Wave_15a_dup == "Yes, once" ~ "Yes, once",
                     
                      taf.have_you_contemplated_harming_yourself_.Wave_15a == "Yes, more than once" |
                      taf.have_you_contemplated_harming_yourself_.Wave_15a_dup == "Yes, more than once" ~ "Yes, more than once",
                     
                   taf.have_you_contemplated_harming_yourself_.Wave_15a== "No" |
                 taf.have_you_contemplated_harming_yourself_.Wave_15a_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.have_you_contemplated_harming_yourself_.Wave_16b =
           case_when(taf.have_you_contemplated_harming_yourself_.Wave_16b == "Yes, once" |
                      taf.have_you_contemplated_harming_yourself_.Wave_16b_dup == "Yes, once" ~ "Yes, once",
                     
                      taf.have_you_contemplated_harming_yourself_.Wave_16b == "Yes, more than once" |
                      taf.have_you_contemplated_harming_yourself_.Wave_16b_dup == "Yes, more than once" ~ "Yes, more than once",
                     
                   taf.have_you_contemplated_harming_yourself_.Wave_16b== "No" |
                taf.have_you_contemplated_harming_yourself_.Wave_16b_dup == "No" ~ "No",
                     
                     )
         )
```
         
       
```{r Felt weeks past 1 self single variables from duplicated IDs}
# Felt weeks past 1 
dat <- dat %>%
  mutate(taf.felt_weeks_past.1_.Wave_1a =
           case_when(taf.felt_weeks_past.1_.Wave_1a == "Yes" |
                      taf.felt_weeks_past.1_.Wave_1a_dup == "Yes" ~ "Yes",
                     
                   taf.felt_weeks_past.1_.Wave_1a == "No" |
                   taf.felt_weeks_past.1_.Wave_1a_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.felt_weeks_past.1_.Wave_1b =
           case_when(taf.felt_weeks_past.1_.Wave_1b == "Yes" |
                      taf.felt_weeks_past.1_.Wave_1b_dup == "Yes" ~ "Yes",
                     
                   taf.felt_weeks_past.1_.Wave_1b == "No" |
                   taf.felt_weeks_past.1_.Wave_1b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.felt_weeks_past.1_.Wave_2a =
           case_when(taf.felt_weeks_past.1_.Wave_2a == "Yes" |
                      taf.felt_weeks_past.1_.Wave_2a_dup == "Yes" ~ "Yes",
                     
                   taf.felt_weeks_past.1_.Wave_2a == "No" |
                   taf.felt_weeks_past.1_.Wave_2a_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(taf.felt_weeks_past.1_.Wave_2b =
           case_when(taf.felt_weeks_past.1_.Wave_2b == "Yes" |
                      taf.felt_weeks_past.1_.Wave_2b_dup == "Yes" ~ "Yes",
                     
                    taf.felt_weeks_past.1_.Wave_2b == "No" |
                   taf.felt_weeks_past.1_.Wave_2b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.felt_weeks_past.1_.Wave_3a =
           case_when(taf.felt_weeks_past.1_.Wave_3a == "Yes" |
                      taf.felt_weeks_past.1_.Wave_3a_dup == "Yes" ~ "Yes",
                     
                    taf.felt_weeks_past.1_.Wave_3a == "No" |
                   taf.felt_weeks_past.1_.Wave_3a_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(taf.felt_weeks_past.1_.Wave_3b =
           case_when(taf.felt_weeks_past.1_.Wave_3b == "Yes" |
                      taf.felt_weeks_past.1_.Wave_3b_dup == "Yes" ~ "Yes",
                   
                     taf.felt_weeks_past.1_.Wave_3b == "No" |
                   taf.felt_weeks_past.1_.Wave_3b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.felt_weeks_past.1_.Wave_4a =
           case_when(taf.felt_weeks_past.1_.Wave_4a == "Yes" |
                      taf.felt_weeks_past.1_.Wave_4a_dup == "Yes" ~ "Yes",
                      
                   taf.felt_weeks_past.1_.Wave_4a == "No" |
                   taf.felt_weeks_past.1_.Wave_4a_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.felt_weeks_past.1_.Wave_4b =
           case_when(taf.felt_weeks_past.1_.Wave_4b == "Yes" |
                      taf.felt_weeks_past.1_.Wave_4b_dup == "Yes" ~ "Yes",
                     
                     taf.felt_weeks_past.1_.Wave_4b == "No" |
                   taf.felt_weeks_past.1_.Wave_4b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.felt_weeks_past.1_.Wave_5a =
           case_when(taf.felt_weeks_past.1_.Wave_5a == "Yes" |
                      taf.felt_weeks_past.1_.Wave_5a_dup == "Yes" ~ "Yes",
                     
                   taf.felt_weeks_past.1_.Wave_5a == "No" |
                   taf.felt_weeks_past.1_.Wave_5a_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(taf.felt_weeks_past.1_.Wave_6b =
           case_when(taf.felt_weeks_past.1_.Wave_6b== "Yes" |
                      taf.felt_weeks_past.1_.Wave_6b_dup == "Yes" ~ "Yes",
                     
                   taf.felt_weeks_past.1_.Wave_6b == "No" |
                   taf.felt_weeks_past.1_.Wave_6b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.felt_weeks_past.1_.Wave_7a =
           case_when(taf.felt_weeks_past.1_.Wave_7a == "Yes" |
                      taf.felt_weeks_past.1_.Wave_7a_dup == "Yes" ~ "Yes",
                     
                    taf.felt_weeks_past.1_.Wave_7a == "No" |
                   taf.felt_weeks_past.1_.Wave_7a_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.felt_weeks_past.1_.Wave_8b =
           case_when(taf.felt_weeks_past.1_.Wave_8b == "Yes" |
                      taf.felt_weeks_past.1_.Wave_8b_dup == "Yes" ~ "Yes",
                     
                     taf.felt_weeks_past.1_.Wave_8b == "No" |
                   taf.felt_weeks_past.1_.Wave_8b_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(taf.felt_weeks_past.1_.Wave_9a =
           case_when(taf.felt_weeks_past.1_.Wave_9a == "Yes" |
                      taf.felt_weeks_past.1_.Wave_9a_dup == "Yes" ~ "Yes",
                     
                   taf.felt_weeks_past.1_.Wave_9a == "No" |
                   taf.felt_weeks_past.1_.Wave_9a_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(taf.felt_weeks_past.1_.Wave_10b =
           case_when(taf.felt_weeks_past.1_.Wave_10b == "Yes" |
                      taf.felt_weeks_past.1_.Wave_10b_dup == "Yes" ~ "Yes",
                     
                   taf.felt_weeks_past.1_.Wave_10b == "No" |
                   taf.felt_weeks_past.1_.Wave_10b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.felt_weeks_past.1_.Wave_11a =
           case_when(taf.felt_weeks_past.1_.Wave_11a == "Yes" |
                      taf.felt_weeks_past.1_.Wave_11a_dup == "Yes" ~ "Yes",
                     
                   taf.felt_weeks_past.1_.Wave_11a== "No" |
                   taf.felt_weeks_past.1_.Wave_11a_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.felt_weeks_past.1_.Wave_12b =
           case_when(taf.felt_weeks_past.1_.Wave_12b == "Yes" |
                      taf.felt_weeks_past.1_.Wave_12b_dup == "Yes" ~ "Yes",
                     
                   taf.felt_weeks_past.1_.Wave_12b== "No" |
                   taf.felt_weeks_past.1_.Wave_12b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.felt_weeks_past.1_.Wave_13a =
           case_when(taf.felt_weeks_past.1_.Wave_13a == "Yes" |
                      taf.felt_weeks_past.1_.Wave_13a_dup == "Yes" ~ "Yes",
                     
                   taf.felt_weeks_past.1_.Wave_13a== "No" |
                  taf.felt_weeks_past.1_.Wave_13a_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(taf.felt_weeks_past.1_.Wave_14b =
           case_when(taf.felt_weeks_past.1_.Wave_14b == "Yes" |
                      taf.felt_weeks_past.1_.Wave_14b_dup == "Yes" ~ "Yes",
                     
                   taf.felt_weeks_past.1_.Wave_14b== "No" |
                 taf.felt_weeks_past.1_.Wave_14b_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(taf.felt_weeks_past.1_.Wave_15a =
           case_when(taf.felt_weeks_past.1_.Wave_15a == "Yes" |
                      taf.felt_weeks_past.1_.Wave_15a_dup == "Yes" ~ "Yes",
                     
                   taf.felt_weeks_past.1_.Wave_15a== "No" |
                 taf.felt_weeks_past.1_.Wave_15a_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.felt_weeks_past.1_.Wave_16b =
           case_when(taf.felt_weeks_past.1_.Wave_16b == "Yes" |
                      taf.felt_weeks_past.1_.Wave_16b_dup == "Yes" ~ "Yes",
                     
                   taf.felt_weeks_past.1_.Wave_16b== "No" |
                taf.felt_weeks_past.1_.Wave_16b_dup == "No" ~ "No",
                     
                     )
         )
```    
          
      
```{r Self-harm self single variables from duplicated IDs}
# Self-harm
dat <- dat %>%
  mutate(taf.meant_life_end_weeks_.Wave_1a =
           case_when(taf.meant_life_end_weeks_.Wave_1a == "Yes" |
                      taf.meant_life_end_weeks_.Wave_1a_dup == "Yes" ~ "Yes",
                     
                   taf.meant_life_end_weeks_.Wave_1a == "No" |
                   taf.meant_life_end_weeks_.Wave_1a_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.meant_life_end_weeks_.Wave_1b =
           case_when(taf.meant_life_end_weeks_.Wave_1b == "Yes" |
                      taf.meant_life_end_weeks_.Wave_1b_dup == "Yes" ~ "Yes",
                     
                   taf.meant_life_end_weeks_.Wave_1b == "No" |
                   taf.meant_life_end_weeks_.Wave_1b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.meant_life_end_weeks_.Wave_2a =
           case_when(taf.meant_life_end_weeks_.Wave_2a == "Yes" |
                      taf.meant_life_end_weeks_.Wave_2a_dup == "Yes" ~ "Yes",
                     
                   taf.meant_life_end_weeks_.Wave_2a == "No" |
                   taf.meant_life_end_weeks_.Wave_2a_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(taf.meant_life_end_weeks_.Wave_2b =
           case_when(taf.meant_life_end_weeks_.Wave_2b == "Yes" |
                      taf.meant_life_end_weeks_.Wave_2b_dup == "Yes" ~ "Yes",
                     
                    taf.meant_life_end_weeks_.Wave_2b == "No" |
                   taf.meant_life_end_weeks_.Wave_2b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.meant_life_end_weeks_.Wave_3a =
           case_when(taf.meant_life_end_weeks_.Wave_3a == "Yes" |
                      taf.meant_life_end_weeks_.Wave_3a_dup == "Yes" ~ "Yes",
                     
                    taf.meant_life_end_weeks_.Wave_3a == "No" |
                   taf.meant_life_end_weeks_.Wave_3a_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(taf.meant_life_end_weeks_.Wave_3b =
           case_when(taf.meant_life_end_weeks_.Wave_3b == "Yes" |
                      taf.meant_life_end_weeks_.Wave_3b_dup == "Yes" ~ "Yes",
                   
                     taf.meant_life_end_weeks_.Wave_3b == "No" |
                   taf.meant_life_end_weeks_.Wave_3b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.meant_life_end_weeks_.Wave_4a =
           case_when(taf.meant_life_end_weeks_.Wave_4a == "Yes" |
                      taf.meant_life_end_weeks_.Wave_4a_dup == "Yes" ~ "Yes",
                      
                   taf.meant_life_end_weeks_.Wave_4a == "No" |
                   taf.meant_life_end_weeks_.Wave_4a_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.meant_life_end_weeks_.Wave_4b =
           case_when(taf.meant_life_end_weeks_.Wave_4b == "Yes" |
                      taf.meant_life_end_weeks_.Wave_4b_dup == "Yes" ~ "Yes",
                     
                     taf.meant_life_end_weeks_.Wave_4b == "No" |
                   taf.meant_life_end_weeks_.Wave_4b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.meant_life_end_weeks_.Wave_5a =
           case_when(taf.meant_life_end_weeks_.Wave_5a == "Yes" |
                      taf.meant_life_end_weeks_.Wave_5a_dup == "Yes" ~ "Yes",
                     
                   taf.meant_life_end_weeks_.Wave_5a == "No" |
                   taf.meant_life_end_weeks_.Wave_5a_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(taf.meant_life_end_weeks_.Wave_6b =
           case_when(taf.meant_life_end_weeks_.Wave_6b== "Yes" |
                      taf.meant_life_end_weeks_.Wave_6b_dup == "Yes" ~ "Yes",
                     
                   taf.meant_life_end_weeks_.Wave_6b == "No" |
                   taf.meant_life_end_weeks_.Wave_6b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.meant_life_end_weeks_.Wave_7a =
           case_when(taf.meant_life_end_weeks_.Wave_7a == "Yes" |
                      taf.meant_life_end_weeks_.Wave_7a_dup == "Yes" ~ "Yes",
                     
                    taf.meant_life_end_weeks_.Wave_7a == "No" |
                   taf.meant_life_end_weeks_.Wave_7a_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.meant_life_end_weeks_.Wave_8b =
           case_when(taf.meant_life_end_weeks_.Wave_8b == "Yes" |
                      taf.meant_life_end_weeks_.Wave_8b_dup == "Yes" ~ "Yes",
                     
                     taf.meant_life_end_weeks_.Wave_8b == "No" |
                   taf.meant_life_end_weeks_.Wave_8b_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(taf.meant_life_end_weeks_.Wave_9a =
           case_when(taf.meant_life_end_weeks_.Wave_9a == "Yes" |
                      taf.meant_life_end_weeks_.Wave_9a_dup == "Yes" ~ "Yes",
                     
                   taf.meant_life_end_weeks_.Wave_9a == "No" |
                   taf.meant_life_end_weeks_.Wave_9a_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(taf.meant_life_end_weeks_.Wave_10b =
           case_when(taf.meant_life_end_weeks_.Wave_10b == "Yes" |
                      taf.meant_life_end_weeks_.Wave_10b_dup == "Yes" ~ "Yes",
                     
                   taf.meant_life_end_weeks_.Wave_10b == "No" |
                   taf.meant_life_end_weeks_.Wave_10b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.meant_life_end_weeks_.Wave_11a =
           case_when(taf.meant_life_end_weeks_.Wave_11a == "Yes" |
                      taf.meant_life_end_weeks_.Wave_11a_dup == "Yes" ~ "Yes",
                     
                   taf.meant_life_end_weeks_.Wave_11a== "No" |
                   taf.meant_life_end_weeks_.Wave_11a_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.meant_life_end_weeks_.Wave_12b =
           case_when(taf.meant_life_end_weeks_.Wave_12b == "Yes" |
                      taf.meant_life_end_weeks_.Wave_12b_dup == "Yes" ~ "Yes",
                     
                   taf.meant_life_end_weeks_.Wave_12b== "No" |
                   taf.meant_life_end_weeks_.Wave_12b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.meant_life_end_weeks_.Wave_13a =
           case_when(taf.meant_life_end_weeks_.Wave_13a == "Yes" |
                      taf.meant_life_end_weeks_.Wave_13a_dup == "Yes" ~ "Yes",
                     
                   taf.meant_life_end_weeks_.Wave_13a== "No" |
                  taf.meant_life_end_weeks_.Wave_13a_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(taf.meant_life_end_weeks_.Wave_14b =
           case_when(taf.meant_life_end_weeks_.Wave_14b == "Yes" |
                      taf.meant_life_end_weeks_.Wave_14b_dup == "Yes" ~ "Yes",
                     
                   taf.meant_life_end_weeks_.Wave_14b== "No" |
                 taf.meant_life_end_weeks_.Wave_14b_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(taf.meant_life_end_weeks_.Wave_15a =
           case_when(taf.meant_life_end_weeks_.Wave_15a == "Yes" |
                      taf.meant_life_end_weeks_.Wave_15a_dup == "Yes" ~ "Yes",
                     
                   taf.meant_life_end_weeks_.Wave_15a== "No" |
                 taf.meant_life_end_weeks_.Wave_15a_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(taf.meant_life_end_weeks_.Wave_16b =
           case_when(taf.meant_life_end_weeks_.Wave_16b == "Yes" |
                      taf.meant_life_end_weeks_.Wave_16b_dup == "Yes" ~ "Yes",
                     
                   taf.meant_life_end_weeks_.Wave_16b== "No" |
                taf.meant_life_end_weeks_.Wave_16b_dup == "No" ~ "No",
                     
                     )
         )
```

## EDEQ screener (binge eating and low weight)
```{r binge eating self single variables from duplicated IDs}
# Binge eating
dat <- dat %>%
  mutate(ed_scid5.regular_episodes_eating_binges_.Wave_1b =
           case_when(ed_scid5.regular_episodes_eating_binges_.Wave_1b == "Yes" |
                      ed_scid5.regular_episodes_eating_binges_.Wave_1b_dup == "Yes" ~ "Yes",
                     
                   ed_scid5.regular_episodes_eating_binges_.Wave_1b == "No" |
                   ed_scid5.regular_episodes_eating_binges_.Wave_1b_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(ed_scid5.regular_episodes_eating_binges_.Wave_2b =
           case_when(ed_scid5.regular_episodes_eating_binges_.Wave_2b == "Yes" |
                      ed_scid5.regular_episodes_eating_binges_.Wave_2b_dup == "Yes" ~ "Yes",
                     
                    ed_scid5.regular_episodes_eating_binges_.Wave_2b == "No" |
                   ed_scid5.regular_episodes_eating_binges_.Wave_2b_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(ed_scid5.regular_episodes_eating_binges_.Wave_3b =
           case_when(ed_scid5.regular_episodes_eating_binges_.Wave_3b == "Yes" |
                      ed_scid5.regular_episodes_eating_binges_.Wave_3b_dup == "Yes" ~ "Yes",
                   
                     ed_scid5.regular_episodes_eating_binges_.Wave_3b == "No" |
                   ed_scid5.regular_episodes_eating_binges_.Wave_3b_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(ed_scid5.regular_episodes_eating_binges_.Wave_4b =
           case_when(ed_scid5.regular_episodes_eating_binges_.Wave_4b == "Yes" |
                      ed_scid5.regular_episodes_eating_binges_.Wave_4b_dup == "Yes" ~ "Yes",
                     
                     ed_scid5.regular_episodes_eating_binges_.Wave_4b == "No" |
                   ed_scid5.regular_episodes_eating_binges_.Wave_4b_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(ed_scid5.regular_episodes_eating_binges_.Wave_6b =
           case_when(ed_scid5.regular_episodes_eating_binges_.Wave_6b== "Yes" |
                      ed_scid5.regular_episodes_eating_binges_.Wave_6b_dup == "Yes" ~ "Yes",
                     
                   ed_scid5.regular_episodes_eating_binges_.Wave_6b == "No" |
                   ed_scid5.regular_episodes_eating_binges_.Wave_6b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(ed_scid5.regular_episodes_eating_binges_.Wave_8b =
           case_when(ed_scid5.regular_episodes_eating_binges_.Wave_8b == "Yes" |
                      ed_scid5.regular_episodes_eating_binges_.Wave_8b_dup == "Yes" ~ "Yes",
                     
                     ed_scid5.regular_episodes_eating_binges_.Wave_8b == "No" |
                   ed_scid5.regular_episodes_eating_binges_.Wave_8b_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(ed_scid5.regular_episodes_eating_binges_.Wave_10b =
           case_when(ed_scid5.regular_episodes_eating_binges_.Wave_10b == "Yes" |
                      ed_scid5.regular_episodes_eating_binges_.Wave_10b_dup == "Yes" ~ "Yes",
                     
                   ed_scid5.regular_episodes_eating_binges_.Wave_10b == "No" |
                   ed_scid5.regular_episodes_eating_binges_.Wave_10b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(ed_scid5.regular_episodes_eating_binges_.Wave_12b =
           case_when(ed_scid5.regular_episodes_eating_binges_.Wave_12b == "Yes" |
                      ed_scid5.regular_episodes_eating_binges_.Wave_12b_dup == "Yes" ~ "Yes",
                     
                   ed_scid5.regular_episodes_eating_binges_.Wave_12b== "No" |
                   ed_scid5.regular_episodes_eating_binges_.Wave_12b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(ed_scid5.regular_episodes_eating_binges_.Wave_14b =
           case_when(ed_scid5.regular_episodes_eating_binges_.Wave_14b == "Yes" |
                      ed_scid5.regular_episodes_eating_binges_.Wave_14b_dup == "Yes" ~ "Yes",
                     
                   ed_scid5.regular_episodes_eating_binges_.Wave_14b== "No" |
                 ed_scid5.regular_episodes_eating_binges_.Wave_14b_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(ed_scid5.regular_episodes_eating_binges_.Wave_16b =
           case_when(ed_scid5.regular_episodes_eating_binges_.Wave_16b == "Yes" |
                      ed_scid5.regular_episodes_eating_binges_.Wave_16b_dup == "Yes" ~ "Yes",
                     
                   ed_scid5.regular_episodes_eating_binges_.Wave_16b== "No" |
                ed_scid5.regular_episodes_eating_binges_.Wave_16b_dup == "No" ~ "No",
                     
                     )
         )
```

```{r low weight self single variables from duplicated IDs}
# Low weight
dat <- dat %>%
  mutate(ed_scid5.weigh_weighed_past_month_.Wave_1b =
           case_when(ed_scid5.weigh_weighed_past_month_.Wave_1b == "Yes" |
                      ed_scid5.weigh_weighed_past_month_.Wave_1b_dup == "Yes" ~ "Yes",
                     
                   ed_scid5.weigh_weighed_past_month_.Wave_1b == "No" |
                   ed_scid5.weigh_weighed_past_month_.Wave_1b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(ed_scid5.weigh_weighed_past_month_.Wave_2b =
           case_when(ed_scid5.weigh_weighed_past_month_.Wave_2b == "Yes" |
                      ed_scid5.weigh_weighed_past_month_.Wave_2b_dup == "Yes" ~ "Yes",
                     
                    ed_scid5.weigh_weighed_past_month_.Wave_2b == "No" |
                   ed_scid5.weigh_weighed_past_month_.Wave_2b_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(ed_scid5.weigh_weighed_past_month_.Wave_3b =
           case_when(ed_scid5.weigh_weighed_past_month_.Wave_3b == "Yes" |
                      ed_scid5.weigh_weighed_past_month_.Wave_3b_dup == "Yes" ~ "Yes",
                   
                     ed_scid5.weigh_weighed_past_month_.Wave_3b == "No" |
                   ed_scid5.weigh_weighed_past_month_.Wave_3b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(ed_scid5.weigh_weighed_past_month_.Wave_4b =
           case_when(ed_scid5.weigh_weighed_past_month_.Wave_4b == "Yes" |
                      ed_scid5.weigh_weighed_past_month_.Wave_4b_dup == "Yes" ~ "Yes",
                     
                     ed_scid5.weigh_weighed_past_month_.Wave_4b == "No" |
                   ed_scid5.weigh_weighed_past_month_.Wave_4b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(ed_scid5.weigh_weighed_past_month_.Wave_6b =
           case_when(ed_scid5.weigh_weighed_past_month_.Wave_6b== "Yes" |
                      ed_scid5.weigh_weighed_past_month_.Wave_6b_dup == "Yes" ~ "Yes",
                     
                   ed_scid5.weigh_weighed_past_month_.Wave_6b == "No" |
                   ed_scid5.weigh_weighed_past_month_.Wave_6b_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(ed_scid5.weigh_weighed_past_month_.Wave_8b =
           case_when(ed_scid5.weigh_weighed_past_month_.Wave_8b == "Yes" |
                      ed_scid5.weigh_weighed_past_month_.Wave_8b_dup == "Yes" ~ "Yes",
                     
                     ed_scid5.weigh_weighed_past_month_.Wave_8b == "No" |
                   ed_scid5.weigh_weighed_past_month_.Wave_8b_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(ed_scid5.weigh_weighed_past_month_.Wave_10b =
           case_when(ed_scid5.weigh_weighed_past_month_.Wave_10b == "Yes" |
                      ed_scid5.weigh_weighed_past_month_.Wave_10b_dup == "Yes" ~ "Yes",
                     
                   ed_scid5.weigh_weighed_past_month_.Wave_10b == "No" |
                   ed_scid5.weigh_weighed_past_month_.Wave_10b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(ed_scid5.weigh_weighed_past_month_.Wave_12b =
           case_when(ed_scid5.weigh_weighed_past_month_.Wave_12b == "Yes" |
                      ed_scid5.weigh_weighed_past_month_.Wave_12b_dup == "Yes" ~ "Yes",
                     
                   ed_scid5.weigh_weighed_past_month_.Wave_12b== "No" |
                   ed_scid5.weigh_weighed_past_month_.Wave_12b_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(ed_scid5.weigh_weighed_past_month_.Wave_14b =
           case_when(ed_scid5.weigh_weighed_past_month_.Wave_14b == "Yes" |
                      ed_scid5.weigh_weighed_past_month_.Wave_14b_dup == "Yes" ~ "Yes",
                     
                   ed_scid5.weigh_weighed_past_month_.Wave_14b== "No" |
                 ed_scid5.weigh_weighed_past_month_.Wave_14b_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(ed_scid5.weigh_weighed_past_month_.Wave_16b =
           case_when(ed_scid5.weigh_weighed_past_month_.Wave_16b == "Yes" |
                      ed_scid5.weigh_weighed_past_month_.Wave_16b_dup == "Yes" ~ "Yes",
                     
                   ed_scid5.weigh_weighed_past_month_.Wave_16b== "No" |
                ed_scid5.weigh_weighed_past_month_.Wave_16b_dup == "No" ~ "No",
                     
                     )
         )
```
  
## Grief questionnaire 
```{r lost loved one due to covid self single variables from duplicated IDs}
# Lost loved one due to COVID
dat <- dat %>%
  mutate(grief.due_past_month_lost_.Wave_1b =
           case_when(grief.due_past_month_lost_.Wave_1b == "Yes" |
                      grief.due_past_month_lost_.Wave_1b_dup == "Yes" ~ "Yes",
                     
                   grief.due_past_month_lost_.Wave_1b == "No" |
                   grief.due_past_month_lost_.Wave_1b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(grief.due_past_month_lost_.Wave_2b =
           case_when(grief.due_past_month_lost_.Wave_2b == "Yes" |
                      grief.due_past_month_lost_.Wave_2b_dup == "Yes" ~ "Yes",
                     
                    grief.due_past_month_lost_.Wave_2b == "No" |
                   grief.due_past_month_lost_.Wave_2b_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(grief.due_past_month_lost_.Wave_3b =
           case_when(grief.due_past_month_lost_.Wave_3b == "Yes" |
                      grief.due_past_month_lost_.Wave_3b_dup == "Yes" ~ "Yes",
                   
                     grief.due_past_month_lost_.Wave_3b == "No" |
                   grief.due_past_month_lost_.Wave_3b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(grief.due_past_month_lost_.Wave_4b =
           case_when(grief.due_past_month_lost_.Wave_4b == "Yes" |
                      grief.due_past_month_lost_.Wave_4b_dup == "Yes" ~ "Yes",
                     
                     grief.due_past_month_lost_.Wave_4b == "No" |
                   grief.due_past_month_lost_.Wave_4b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(grief.due_past_month_lost_.Wave_6b =
           case_when(grief.due_past_month_lost_.Wave_6b== "Yes" |
                      grief.due_past_month_lost_.Wave_6b_dup == "Yes" ~ "Yes",
                     
                   grief.due_past_month_lost_.Wave_6b == "No" |
                   grief.due_past_month_lost_.Wave_6b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(grief.due_past_month_lost_.Wave_8b =
           case_when(grief.due_past_month_lost_.Wave_8b == "Yes" |
                      grief.due_past_month_lost_.Wave_8b_dup == "Yes" ~ "Yes",
                     
                     grief.due_past_month_lost_.Wave_8b == "No" |
                   grief.due_past_month_lost_.Wave_8b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(grief.due_past_month_lost_.Wave_10b =
           case_when(grief.due_past_month_lost_.Wave_10b == "Yes" |
                      grief.due_past_month_lost_.Wave_10b_dup == "Yes" ~ "Yes",
                     
                   grief.due_past_month_lost_.Wave_10b == "No" |
                   grief.due_past_month_lost_.Wave_10b_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(grief.due_past_month_lost_.Wave_12b =
           case_when(grief.due_past_month_lost_.Wave_12b == "Yes" |
                      grief.due_past_month_lost_.Wave_12b_dup == "Yes" ~ "Yes",
                     
                   grief.due_past_month_lost_.Wave_12b== "No" |
                   grief.due_past_month_lost_.Wave_12b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(grief.due_past_month_lost_.Wave_14b =
           case_when(grief.due_past_month_lost_.Wave_14b == "Yes" |
                      grief.due_past_month_lost_.Wave_14b_dup == "Yes" ~ "Yes",
                     
                   grief.due_past_month_lost_.Wave_14b== "No" |
                 grief.due_past_month_lost_.Wave_14b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(grief.due_past_month_lost_.Wave_16b =
           case_when(grief.due_past_month_lost_.Wave_16b == "Yes" |
                      grief.due_past_month_lost_.Wave_16b_dup == "Yes" ~ "Yes",
                     
                   grief.due_past_month_lost_.Wave_16b== "No" |
                grief.due_past_month_lost_.Wave_16b_dup == "No" ~ "No",
                     
                     )
         )
```

## Respiratory questionniare
      
```{r done nose/throat covid test self single variables from duplicated IDs}
# Done covid test (nose/throat swab)
dat <- dat %>%
  mutate(resp.coronavirus_test_nosethroat_swab_.Wave_1a =
           case_when(resp.coronavirus_test_nosethroat_swab_.Wave_1a == "Yes" |
                      resp.coronavirus_test_nosethroat_swab_.Wave_1a_dup == "Yes" ~ "Yes",
                     
                   resp.coronavirus_test_nosethroat_swab_.Wave_1a == "No" |
                   resp.coronavirus_test_nosethroat_swab_.Wave_1a_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(resp.coronavirus_test_nosethroat_swab_.Wave_1b =
           case_when(resp.coronavirus_test_nosethroat_swab_.Wave_1b == "Yes" |
                      resp.coronavirus_test_nosethroat_swab_.Wave_1b_dup == "Yes" ~ "Yes",
                     
                   resp.coronavirus_test_nosethroat_swab_.Wave_1b == "No" |
                   resp.coronavirus_test_nosethroat_swab_.Wave_1b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(resp.coronavirus_test_nosethroat_swab_.Wave_2a =
           case_when(resp.coronavirus_test_nosethroat_swab_.Wave_2a == "Yes" |
                      resp.coronavirus_test_nosethroat_swab_.Wave_2a_dup == "Yes" ~ "Yes",
                     
                   resp.coronavirus_test_nosethroat_swab_.Wave_2a == "No" |
                   resp.coronavirus_test_nosethroat_swab_.Wave_2a_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(resp.coronavirus_test_nosethroat_swab_.Wave_2b =
           case_when(resp.coronavirus_test_nosethroat_swab_.Wave_2b == "Yes" |
                      resp.coronavirus_test_nosethroat_swab_.Wave_2b_dup == "Yes" ~ "Yes",
                     
                    resp.coronavirus_test_nosethroat_swab_.Wave_2b == "No" |
                   resp.coronavirus_test_nosethroat_swab_.Wave_2b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(resp.coronavirus_test_nosethroat_swab_.Wave_3a =
           case_when(resp.coronavirus_test_nosethroat_swab_.Wave_3a == "Yes" |
                      resp.coronavirus_test_nosethroat_swab_.Wave_3a_dup == "Yes" ~ "Yes",
                     
                    resp.coronavirus_test_nosethroat_swab_.Wave_3a == "No" |
                   resp.coronavirus_test_nosethroat_swab_.Wave_3a_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(resp.coronavirus_test_nosethroat_swab_.Wave_3b =
           case_when(resp.coronavirus_test_nosethroat_swab_.Wave_3b == "Yes" |
                      resp.coronavirus_test_nosethroat_swab_.Wave_3b_dup == "Yes" ~ "Yes",
                   
                     resp.coronavirus_test_nosethroat_swab_.Wave_3b == "No" |
                   resp.coronavirus_test_nosethroat_swab_.Wave_3b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(resp.coronavirus_test_nosethroat_swab_.Wave_4a =
           case_when(resp.coronavirus_test_nosethroat_swab_.Wave_4a == "Yes" |
                      resp.coronavirus_test_nosethroat_swab_.Wave_4a_dup == "Yes" ~ "Yes",
                      
                   resp.coronavirus_test_nosethroat_swab_.Wave_4a == "No" |
                   resp.coronavirus_test_nosethroat_swab_.Wave_4a_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(resp.coronavirus_test_nosethroat_swab_.Wave_4b =
           case_when(resp.coronavirus_test_nosethroat_swab_.Wave_4b == "Yes" |
                      resp.coronavirus_test_nosethroat_swab_.Wave_4b_dup == "Yes" ~ "Yes",
                     
                     resp.coronavirus_test_nosethroat_swab_.Wave_4b == "No" |
                   resp.coronavirus_test_nosethroat_swab_.Wave_4b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(resp.coronavirus_test_nosethroat_swab_.Wave_5a =
           case_when(resp.coronavirus_test_nosethroat_swab_.Wave_5a == "Yes" |
                      resp.coronavirus_test_nosethroat_swab_.Wave_5a_dup == "Yes" ~ "Yes",
                     
                   resp.coronavirus_test_nosethroat_swab_.Wave_5a == "No" |
                   resp.coronavirus_test_nosethroat_swab_.Wave_5a_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(resp.coronavirus_test_nosethroat_swab_.Wave_6b =
           case_when(resp.coronavirus_test_nosethroat_swab_.Wave_6b== "Yes" |
                      resp.coronavirus_test_nosethroat_swab_.Wave_6b_dup == "Yes" ~ "Yes",
                     
                   resp.coronavirus_test_nosethroat_swab_.Wave_6b == "No" |
                   resp.coronavirus_test_nosethroat_swab_.Wave_6b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(resp.coronavirus_test_nosethroat_swab_.Wave_7a =
           case_when(resp.coronavirus_test_nosethroat_swab_.Wave_7a == "Yes" |
                      resp.coronavirus_test_nosethroat_swab_.Wave_7a_dup == "Yes" ~ "Yes",
                     
                    resp.coronavirus_test_nosethroat_swab_.Wave_7a == "No" |
                   resp.coronavirus_test_nosethroat_swab_.Wave_7a_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(resp.coronavirus_test_nosethroat_swab_.Wave_8b =
           case_when(resp.coronavirus_test_nosethroat_swab_.Wave_8b == "Yes" |
                      resp.coronavirus_test_nosethroat_swab_.Wave_8b_dup == "Yes" ~ "Yes",
                     
                     resp.coronavirus_test_nosethroat_swab_.Wave_8b == "No" |
                   resp.coronavirus_test_nosethroat_swab_.Wave_8b_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(resp.coronavirus_test_nosethroat_swab_.Wave_9a =
           case_when(resp.coronavirus_test_nosethroat_swab_.Wave_9a == "Yes" |
                      resp.coronavirus_test_nosethroat_swab_.Wave_9a_dup == "Yes" ~ "Yes",
                     
                   resp.coronavirus_test_nosethroat_swab_.Wave_9a == "No" |
                   resp.coronavirus_test_nosethroat_swab_.Wave_9a_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(resp.coronavirus_test_nosethroat_swab_.Wave_10b =
           case_when(resp.coronavirus_test_nosethroat_swab_.Wave_10b == "Yes" |
                      resp.coronavirus_test_nosethroat_swab_.Wave_10b_dup == "Yes" ~ "Yes",
                     
                   resp.coronavirus_test_nosethroat_swab_.Wave_10b == "No" |
                   resp.coronavirus_test_nosethroat_swab_.Wave_10b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(resp.coronavirus_test_nosethroat_swab_.Wave_11a =
           case_when(resp.coronavirus_test_nosethroat_swab_.Wave_11a == "Yes" |
                      resp.coronavirus_test_nosethroat_swab_.Wave_11a_dup == "Yes" ~ "Yes",
                     
                   resp.coronavirus_test_nosethroat_swab_.Wave_11a== "No" |
                   resp.coronavirus_test_nosethroat_swab_.Wave_11a_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(resp.coronavirus_test_nosethroat_swab_.Wave_12b =
           case_when(resp.coronavirus_test_nosethroat_swab_.Wave_12b == "Yes" |
                      resp.coronavirus_test_nosethroat_swab_.Wave_12b_dup == "Yes" ~ "Yes",
                     
                   resp.coronavirus_test_nosethroat_swab_.Wave_12b== "No" |
                   resp.coronavirus_test_nosethroat_swab_.Wave_12b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(resp.coronavirus_test_nosethroat_swab_.Wave_13a =
           case_when(resp.coronavirus_test_nosethroat_swab_.Wave_13a == "Yes" |
                      resp.coronavirus_test_nosethroat_swab_.Wave_13a_dup == "Yes" ~ "Yes",
                     
                   resp.coronavirus_test_nosethroat_swab_.Wave_13a== "No" |
                  resp.coronavirus_test_nosethroat_swab_.Wave_13a_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(resp.coronavirus_test_nosethroat_swab_.Wave_14b =
           case_when(resp.coronavirus_test_nosethroat_swab_.Wave_14b == "Yes" |
                      resp.coronavirus_test_nosethroat_swab_.Wave_14b_dup == "Yes" ~ "Yes",
                     
                   resp.coronavirus_test_nosethroat_swab_.Wave_14b== "No" |
                 resp.coronavirus_test_nosethroat_swab_.Wave_14b_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(resp.coronavirus_test_nosethroat_swab_.Wave_15a =
           case_when(resp.coronavirus_test_nosethroat_swab_.Wave_15a == "Yes" |
                      resp.coronavirus_test_nosethroat_swab_.Wave_15a_dup == "Yes" ~ "Yes",
                     
                   resp.coronavirus_test_nosethroat_swab_.Wave_15a== "No" |
                 resp.coronavirus_test_nosethroat_swab_.Wave_15a_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(resp.coronavirus_test_nosethroat_swab_.Wave_16b =
           case_when(resp.coronavirus_test_nosethroat_swab_.Wave_16b == "Yes" |
                      resp.coronavirus_test_nosethroat_swab_.Wave_16b_dup == "Yes" ~ "Yes",
                     
                   resp.coronavirus_test_nosethroat_swab_.Wave_16b== "No" |
                resp.coronavirus_test_nosethroat_swab_.Wave_16b_dup == "No" ~ "No",
                     
                     )
         )
```
         
      
```{r results nose/throat covid test self single variables from duplicated IDs}
# Result covid test (nose/throat swab)
dat <- dat %>%
  mutate(resp.results_nosethroat_swab_test_.Wave_1a =
           case_when(resp.results_nosethroat_swab_test_.Wave_1a == "Positive" |
                      resp.results_nosethroat_swab_test_.Wave_1a_dup == "Positive" ~ "Positive",
                     
                   resp.results_nosethroat_swab_test_.Wave_1a == "Negative" |
                   resp.results_nosethroat_swab_test_.Wave_1a_dup == "Negative" ~ "Negative",
                   
                   resp.results_nosethroat_swab_test_.Wave_1a == "Result awaited" |
                   resp.results_nosethroat_swab_test_.Wave_1a_dup == "Result awaited" ~ "Result awaited",
                     
                     
                     )
         )

dat <- dat %>%
  mutate(resp.results_nosethroat_swab_test_.Wave_1b =
           case_when(resp.results_nosethroat_swab_test_.Wave_1b == "Positive" |
                      resp.results_nosethroat_swab_test_.Wave_1b_dup == "Positive" ~ "Positive",
                     
                   resp.results_nosethroat_swab_test_.Wave_1b == "Negative" |
                   resp.results_nosethroat_swab_test_.Wave_1b_dup == "Negative" ~ "Negative",
                   
                     resp.results_nosethroat_swab_test_.Wave_1b == "Result awaited" |
                   resp.results_nosethroat_swab_test_.Wave_1b_dup == "Result awaited" ~ "Result awaited",
                     
                     )
         )

dat <- dat %>%
  mutate(resp.results_nosethroat_swab_test_.Wave_2a =
           case_when(resp.results_nosethroat_swab_test_.Wave_2a == "Positive" |
                      resp.results_nosethroat_swab_test_.Wave_2a_dup == "Positive" ~ "Positive",
                     
                   resp.results_nosethroat_swab_test_.Wave_2a == "Negative" |
                   resp.results_nosethroat_swab_test_.Wave_2a_dup == "Negative" ~ "Negative",
                   
                     resp.results_nosethroat_swab_test_.Wave_2a == "Result awaited" |
                   resp.results_nosethroat_swab_test_.Wave_2a_dup == "Result awaited" ~ "Result awaited",
                     
                     )
         )


dat <- dat %>%
  mutate(resp.results_nosethroat_swab_test_.Wave_2b =
           case_when(resp.results_nosethroat_swab_test_.Wave_2b == "Positive" |
                      resp.results_nosethroat_swab_test_.Wave_2b_dup == "Positive" ~ "Positive",
                     
                    resp.results_nosethroat_swab_test_.Wave_2b == "Negative" |
                   resp.results_nosethroat_swab_test_.Wave_2b_dup == "Negative" ~ "Negative",
                   
                     resp.results_nosethroat_swab_test_.Wave_2b == "Result awaited" |
                   resp.results_nosethroat_swab_test_.Wave_2b_dup == "Result awaited" ~ "Result awaited",
                     
                     )
         )

dat <- dat %>%
  mutate(resp.results_nosethroat_swab_test_.Wave_3a =
           case_when(resp.results_nosethroat_swab_test_.Wave_3a == "Positive" |
                      resp.results_nosethroat_swab_test_.Wave_3a_dup == "Positive" ~ "Positive",
                     
                    resp.results_nosethroat_swab_test_.Wave_3a == "Negative" |
                   resp.results_nosethroat_swab_test_.Wave_3a_dup == "Negative" ~ "Negative",
                   
                     resp.results_nosethroat_swab_test_.Wave_3a == "Result awaited" |
                   resp.results_nosethroat_swab_test_.Wave_3a_dup == "Result awaited" ~ "Result awaited",
                     
                     )
         )


dat <- dat %>%
  mutate(resp.results_nosethroat_swab_test_.Wave_3b =
           case_when(resp.results_nosethroat_swab_test_.Wave_3b == "Positive" |
                      resp.results_nosethroat_swab_test_.Wave_3b_dup == "Positive" ~ "Positive",
                   
                     resp.results_nosethroat_swab_test_.Wave_3b == "Negative" |
                   resp.results_nosethroat_swab_test_.Wave_3b_dup == "Negative" ~ "Negative",
                   
                     resp.results_nosethroat_swab_test_.Wave_3b == "Result awaited" |
                   resp.results_nosethroat_swab_test_.Wave_3b_dup == "Result awaited" ~ "Result awaited",
                     
                     )
         )

dat <- dat %>%
  mutate(resp.results_nosethroat_swab_test_.Wave_4a =
           case_when(resp.results_nosethroat_swab_test_.Wave_4a == "Positive" |
                      resp.results_nosethroat_swab_test_.Wave_4a_dup == "Positive" ~ "Positive",
                      
                   resp.results_nosethroat_swab_test_.Wave_4a == "Negative" |
                   resp.results_nosethroat_swab_test_.Wave_4a_dup == "Negative" ~ "Negative",
                   
                     resp.results_nosethroat_swab_test_.Wave_4a == "Result awaited" |
                   resp.results_nosethroat_swab_test_.Wave_4a_dup == "Result awaited" ~ "Result awaited",
                     
                     )
         )

dat <- dat %>%
  mutate(resp.results_nosethroat_swab_test_.Wave_4b =
           case_when(resp.results_nosethroat_swab_test_.Wave_4b == "Positive" |
                      resp.results_nosethroat_swab_test_.Wave_4b_dup == "Positive" ~ "Positive",
                     
                     resp.results_nosethroat_swab_test_.Wave_4b == "Negative" |
                   resp.results_nosethroat_swab_test_.Wave_4b_dup == "Negative" ~ "Negative",
                   
                     resp.results_nosethroat_swab_test_.Wave_4b == "Result awaited" |
                   resp.results_nosethroat_swab_test_.Wave_4b_dup == "Result awaited" ~ "Result awaited",
                     
                     )
         )

dat <- dat %>%
  mutate(resp.results_nosethroat_swab_test_.Wave_5a =
           case_when(resp.results_nosethroat_swab_test_.Wave_5a == "Positive" |
                      resp.results_nosethroat_swab_test_.Wave_5a_dup == "Positive" ~ "Positive",
                     
                   resp.results_nosethroat_swab_test_.Wave_5a == "Negative" |
                   resp.results_nosethroat_swab_test_.Wave_5a_dup == "Negative" ~ "Negative",
                   
                     resp.results_nosethroat_swab_test_.Wave_5a == "Result awaited" |
                   resp.results_nosethroat_swab_test_.Wave_5a_dup == "Result awaited" ~ "Result awaited",
                     
                     )
         )


dat <- dat %>%
  mutate(resp.results_nosethroat_swab_test_.Wave_6b =
           case_when(resp.results_nosethroat_swab_test_.Wave_6b== "Positive" |
                      resp.results_nosethroat_swab_test_.Wave_6b_dup == "Positive" ~ "Positive",
                     
                   resp.results_nosethroat_swab_test_.Wave_6b == "Negative" |
                   resp.results_nosethroat_swab_test_.Wave_6b_dup == "Negative" ~ "Negative",
                   
                     resp.results_nosethroat_swab_test_.Wave_6b == "Result awaited" |
                   resp.results_nosethroat_swab_test_.Wave_6b_dup == "Result awaited" ~ "Result awaited",
                     
                     )
         )

dat <- dat %>%
  mutate(resp.results_nosethroat_swab_test_.Wave_7a =
           case_when(resp.results_nosethroat_swab_test_.Wave_7a == "Positive" |
                      resp.results_nosethroat_swab_test_.Wave_7a_dup == "Positive" ~ "Positive",
                     
                    resp.results_nosethroat_swab_test_.Wave_7a == "Negative" |
                   resp.results_nosethroat_swab_test_.Wave_7a_dup == "Negative" ~ "Negative",
                   
                     resp.results_nosethroat_swab_test_.Wave_7a == "Result awaited" |
                   resp.results_nosethroat_swab_test_.Wave_7a_dup == "Result awaited" ~ "Result awaited",
                     
                     )
         )

dat <- dat %>%
  mutate(resp.results_nosethroat_swab_test_.Wave_8b =
           case_when(resp.results_nosethroat_swab_test_.Wave_8b == "Positive" |
                      resp.results_nosethroat_swab_test_.Wave_8b_dup == "Positive" ~ "Positive",
                     
                     resp.results_nosethroat_swab_test_.Wave_8b == "Negative" |
                   resp.results_nosethroat_swab_test_.Wave_8b_dup == "Negative" ~ "Negative",
                   
                     resp.results_nosethroat_swab_test_.Wave_8b == "Result awaited" |
                   resp.results_nosethroat_swab_test_.Wave_8b_dup == "Result awaited" ~ "Result awaited",
                     
                     )
         )


dat <- dat %>%
  mutate(resp.results_nosethroat_swab_test_.Wave_9a =
           case_when(resp.results_nosethroat_swab_test_.Wave_9a == "Positive" |
                      resp.results_nosethroat_swab_test_.Wave_9a_dup == "Positive" ~ "Positive",
                     
                   resp.results_nosethroat_swab_test_.Wave_9a == "Negative" |
                   resp.results_nosethroat_swab_test_.Wave_9a_dup == "Negative" ~ "Negative",
                   
                     resp.results_nosethroat_swab_test_.Wave_9a == "Result awaited" |
                   resp.results_nosethroat_swab_test_.Wave_9a_dup == "Result awaited" ~ "Result awaited",
                     
                     )
         )


dat <- dat %>%
  mutate(resp.results_nosethroat_swab_test_.Wave_10b =
           case_when(resp.results_nosethroat_swab_test_.Wave_10b == "Positive" |
                      resp.results_nosethroat_swab_test_.Wave_10b_dup == "Positive" ~ "Positive",
                     
                   resp.results_nosethroat_swab_test_.Wave_10b == "Negative" |
                   resp.results_nosethroat_swab_test_.Wave_10b_dup == "Negative" ~ "Negative",
                   
                     resp.results_nosethroat_swab_test_.Wave_10b == "Result awaited" |
                   resp.results_nosethroat_swab_test_.Wave_10b_dup == "Result awaited" ~ "Result awaited",
                     
                     )
         )

dat <- dat %>%
  mutate(resp.results_nosethroat_swab_test_.Wave_11a =
           case_when(resp.results_nosethroat_swab_test_.Wave_11a == "Positive" |
                      resp.results_nosethroat_swab_test_.Wave_11a_dup == "Positive" ~ "Positive",
                     
                   resp.results_nosethroat_swab_test_.Wave_11a== "Negative" |
                   resp.results_nosethroat_swab_test_.Wave_11a_dup == "Negative" ~ "Negative",
                   
                     resp.results_nosethroat_swab_test_.Wave_11a == "Result awaited" |
                   resp.results_nosethroat_swab_test_.Wave_11a_dup == "Result awaited" ~ "Result awaited",
                     
                     )
         )

dat <- dat %>%
  mutate(resp.results_nosethroat_swab_test_.Wave_12b =
           case_when(resp.results_nosethroat_swab_test_.Wave_12b == "Positive" |
                      resp.results_nosethroat_swab_test_.Wave_12b_dup == "Positive" ~ "Positive",
                     
                   resp.results_nosethroat_swab_test_.Wave_12b== "Negative" |
                   resp.results_nosethroat_swab_test_.Wave_12b_dup == "Negative" ~ "Negative",
                   
                     resp.results_nosethroat_swab_test_.Wave_12b == "Result awaited" |
                   resp.results_nosethroat_swab_test_.Wave_12b_dup == "Result awaited" ~ "Result awaited",
                     
                     )
         )

dat <- dat %>%
  mutate(resp.results_nosethroat_swab_test_.Wave_13a =
           case_when(resp.results_nosethroat_swab_test_.Wave_13a == "Positive" |
                      resp.results_nosethroat_swab_test_.Wave_13a_dup == "Positive" ~ "Positive",
                     
                   resp.results_nosethroat_swab_test_.Wave_13a== "Negative" |
                  resp.results_nosethroat_swab_test_.Wave_13a_dup == "Negative" ~ "Negative",
                  
                    resp.results_nosethroat_swab_test_.Wave_13a == "Result awaited" |
                   resp.results_nosethroat_swab_test_.Wave_13a_dup == "Result awaited" ~ "Result awaited",
                     
                     )
         )


dat <- dat %>%
  mutate(resp.results_nosethroat_swab_test_.Wave_14b =
           case_when(resp.results_nosethroat_swab_test_.Wave_14b == "Positive" |
                      resp.results_nosethroat_swab_test_.Wave_14b_dup == "Positive" ~ "Positive",
                     
                   resp.results_nosethroat_swab_test_.Wave_14b== "Negative" |
                 resp.results_nosethroat_swab_test_.Wave_14b_dup == "Negative" ~ "Negative",
                 
                   resp.results_nosethroat_swab_test_.Wave_14b == "Result awaited" |
                   resp.results_nosethroat_swab_test_.Wave_14b_dup == "Result awaited" ~ "Result awaited",
                     
                     )
         )


dat <- dat %>%
  mutate(resp.results_nosethroat_swab_test_.Wave_15a =
           case_when(resp.results_nosethroat_swab_test_.Wave_15a == "Positive" |
                      resp.results_nosethroat_swab_test_.Wave_15a_dup == "Positive" ~ "Positive",
                     
                   resp.results_nosethroat_swab_test_.Wave_15a== "Negative" |
                 resp.results_nosethroat_swab_test_.Wave_15a_dup == "Negative" ~ "Negative",
                 
                   resp.results_nosethroat_swab_test_.Wave_15a == "Result awaited" |
                   resp.results_nosethroat_swab_test_.Wave_15a_dup == "Result awaited" ~ "Result awaited",
                     
                     )
         )

dat <- dat %>%
  mutate(resp.results_nosethroat_swab_test_.Wave_16b =
           case_when(resp.results_nosethroat_swab_test_.Wave_16b == "Positive" |
                      resp.results_nosethroat_swab_test_.Wave_16b_dup == "Positive" ~ "Positive",
                     
                   resp.results_nosethroat_swab_test_.Wave_16b== "Negative" |
                resp.results_nosethroat_swab_test_.Wave_16b_dup == "Negative" ~ "Negative",
                
                  resp.results_nosethroat_swab_test_.Wave_16b == "Result awaited" |
                   resp.results_nosethroat_swab_test_.Wave_16b_dup == "Result awaited" ~ "Result awaited",
                     
                     )
         )
```
       
      
```{r done antibody covid test self single variables from duplicated IDs}
# Done covid test (antibody)
dat <- dat %>%
  mutate(resp.coronavirus_antibody_test_.Wave_1a =
           case_when(resp.coronavirus_antibody_test_.Wave_1a == "Yes" |
                      resp.coronavirus_antibody_test_.Wave_1a_dup == "Yes" ~ "Yes",
                     
                   resp.coronavirus_antibody_test_.Wave_1a == "No" |
                   resp.coronavirus_antibody_test_.Wave_1a_dup == "No" ~ "No"   
                     )
         )

dat <- dat %>%
  mutate(resp.coronavirus_antibody_test_.Wave_1b =
           case_when(resp.coronavirus_antibody_test_.Wave_1b == "Yes" |
                      resp.coronavirus_antibody_test_.Wave_1b_dup == "Yes" ~ "Yes",
                     
                   resp.coronavirus_antibody_test_.Wave_1b == "No" |
                   resp.coronavirus_antibody_test_.Wave_1b_dup == "No" ~ "No"
                     
                     )
         )

dat <- dat %>%
  mutate(resp.coronavirus_antibody_test_.Wave_2a =
           case_when(resp.coronavirus_antibody_test_.Wave_2a == "Yes" |
                      resp.coronavirus_antibody_test_.Wave_2a_dup == "Yes" ~ "Yes",
                     
                   resp.coronavirus_antibody_test_.Wave_2a == "No" |
                   resp.coronavirus_antibody_test_.Wave_2a_dup == "No" ~ "No"
                     )
         )


dat <- dat %>%
  mutate(resp.coronavirus_antibody_test_.Wave_2b =
           case_when(resp.coronavirus_antibody_test_.Wave_2b == "Yes" |
                      resp.coronavirus_antibody_test_.Wave_2b_dup == "Yes" ~ "Yes",
                     
                    resp.coronavirus_antibody_test_.Wave_2b == "No" |
                   resp.coronavirus_antibody_test_.Wave_2b_dup == "No" ~ "No"
                  
                     
                     )
         )

dat <- dat %>%
  mutate(resp.coronavirus_antibody_test_.Wave_3a =
           case_when(resp.coronavirus_antibody_test_.Wave_3a == "Yes" |
                      resp.coronavirus_antibody_test_.Wave_3a_dup == "Yes" ~ "Yes",
                     
                    resp.coronavirus_antibody_test_.Wave_3a == "No" |
                   resp.coronavirus_antibody_test_.Wave_3a_dup == "No" ~ "No"
                     
                     )
         )


dat <- dat %>%
  mutate(resp.coronavirus_antibody_test_.Wave_3b =
           case_when(resp.coronavirus_antibody_test_.Wave_3b == "Yes" |
                      resp.coronavirus_antibody_test_.Wave_3b_dup == "Yes" ~ "Yes",
                   
                     resp.coronavirus_antibody_test_.Wave_3b == "No" |
                   resp.coronavirus_antibody_test_.Wave_3b_dup == "No" ~ "No"
                     )
         )

dat <- dat %>%
  mutate(resp.coronavirus_antibody_test_.Wave_4a =
           case_when(resp.coronavirus_antibody_test_.Wave_4a == "Yes" |
                      resp.coronavirus_antibody_test_.Wave_4a_dup == "Yes" ~ "Yes",
                      
                   resp.coronavirus_antibody_test_.Wave_4a == "No" |
                   resp.coronavirus_antibody_test_.Wave_4a_dup == "No" ~ "No"
                     
                     )
         )

dat <- dat %>%
  mutate(resp.coronavirus_antibody_test_.Wave_4b =
           case_when(resp.coronavirus_antibody_test_.Wave_4b == "Yes" |
                      resp.coronavirus_antibody_test_.Wave_4b_dup == "Yes" ~ "Yes",
                     
                     resp.coronavirus_antibody_test_.Wave_4b == "No" |
                   resp.coronavirus_antibody_test_.Wave_4b_dup == "No" ~ "No"
                     )
         )

dat <- dat %>%
  mutate(resp.coronavirus_antibody_test_.Wave_5a =
           case_when(resp.coronavirus_antibody_test_.Wave_5a == "Yes" |
                      resp.coronavirus_antibody_test_.Wave_5a_dup == "Yes" ~ "Yes",
                     
                   resp.coronavirus_antibody_test_.Wave_5a == "No" |
                   resp.coronavirus_antibody_test_.Wave_5a_dup == "No" ~ "No"
                     
                     )
         )


dat <- dat %>%
  mutate(resp.coronavirus_antibody_test_.Wave_6b =
           case_when(resp.coronavirus_antibody_test_.Wave_6b== "Yes" |
                      resp.coronavirus_antibody_test_.Wave_6b_dup == "Yes" ~ "Yes",
                     
                   resp.coronavirus_antibody_test_.Wave_6b == "No" |
                   resp.coronavirus_antibody_test_.Wave_6b_dup == "No" ~ "No"
                     
                     )
         )

dat <- dat %>%
  mutate(resp.coronavirus_antibody_test_.Wave_7a =
           case_when(resp.coronavirus_antibody_test_.Wave_7a == "Yes" |
                      resp.coronavirus_antibody_test_.Wave_7a_dup == "Yes" ~ "Yes",
                     
                    resp.coronavirus_antibody_test_.Wave_7a == "No" |
                   resp.coronavirus_antibody_test_.Wave_7a_dup == "No" ~ "No"
                     
                     )
         )

dat <- dat %>%
  mutate(resp.coronavirus_antibody_test_.Wave_8b =
           case_when(resp.coronavirus_antibody_test_.Wave_8b == "Yes" |
                      resp.coronavirus_antibody_test_.Wave_8b_dup == "Yes" ~ "Yes",
                     
                     resp.coronavirus_antibody_test_.Wave_8b == "No" |
                   resp.coronavirus_antibody_test_.Wave_8b_dup == "No" ~ "No"
                     
                     )
         )


dat <- dat %>%
  mutate(resp.coronavirus_antibody_test_.Wave_9a =
           case_when(resp.coronavirus_antibody_test_.Wave_9a == "Yes" |
                      resp.coronavirus_antibody_test_.Wave_9a_dup == "Yes" ~ "Yes",
                     
                   resp.coronavirus_antibody_test_.Wave_9a == "No" |
                   resp.coronavirus_antibody_test_.Wave_9a_dup == "No" ~ "No"
                     
                     )
         )


dat <- dat %>%
  mutate(resp.coronavirus_antibody_test_.Wave_10b =
           case_when(resp.coronavirus_antibody_test_.Wave_10b == "Yes" |
                      resp.coronavirus_antibody_test_.Wave_10b_dup == "Yes" ~ "Yes",
                     
                   resp.coronavirus_antibody_test_.Wave_10b == "No" |
                   resp.coronavirus_antibody_test_.Wave_10b_dup == "No" ~ "No"
                     
                     )
         )

dat <- dat %>%
  mutate(resp.coronavirus_antibody_test_.Wave_11a =
           case_when(resp.coronavirus_antibody_test_.Wave_11a == "Yes" |
                      resp.coronavirus_antibody_test_.Wave_11a_dup == "Yes" ~ "Yes",
                     
                   resp.coronavirus_antibody_test_.Wave_11a== "No" |
                   resp.coronavirus_antibody_test_.Wave_11a_dup == "No" ~ "No"
                     
                     )
         )

dat <- dat %>%
  mutate(resp.coronavirus_antibody_test_.Wave_12b =
           case_when(resp.coronavirus_antibody_test_.Wave_12b == "Yes" |
                      resp.coronavirus_antibody_test_.Wave_12b_dup == "Yes" ~ "Yes",
                     
                   resp.coronavirus_antibody_test_.Wave_12b== "No" |
                   resp.coronavirus_antibody_test_.Wave_12b_dup == "No" ~ "No"
                     
                     )
         )

dat <- dat %>%
  mutate(resp.coronavirus_antibody_test_.Wave_13a =
           case_when(resp.coronavirus_antibody_test_.Wave_13a == "Yes" |
                      resp.coronavirus_antibody_test_.Wave_13a_dup == "Yes" ~ "Yes",
                     
                   resp.coronavirus_antibody_test_.Wave_13a== "No" |
                  resp.coronavirus_antibody_test_.Wave_13a_dup == "No" ~ "No"
                     
                     )
         )


dat <- dat %>%
  mutate(resp.coronavirus_antibody_test_.Wave_14b =
           case_when(resp.coronavirus_antibody_test_.Wave_14b == "Yes" |
                      resp.coronavirus_antibody_test_.Wave_14b_dup == "Yes" ~ "Yes",
                     
                   resp.coronavirus_antibody_test_.Wave_14b== "No" |
                 resp.coronavirus_antibody_test_.Wave_14b_dup == "No" ~ "No"
                     
                     )
         )


dat <- dat %>%
  mutate(resp.coronavirus_antibody_test_.Wave_15a =
           case_when(resp.coronavirus_antibody_test_.Wave_15a == "Yes" |
                      resp.coronavirus_antibody_test_.Wave_15a_dup == "Yes" ~ "Yes",
                     
                   resp.coronavirus_antibody_test_.Wave_15a== "No" |
                 resp.coronavirus_antibody_test_.Wave_15a_dup == "No" ~ "No"
                     
                     )
         )

dat <- dat %>%
  mutate(resp.coronavirus_antibody_test_.Wave_16b =
           case_when(resp.coronavirus_antibody_test_.Wave_16b == "Yes" |
                      resp.coronavirus_antibody_test_.Wave_16b_dup == "Yes" ~ "Yes",
                     
                   resp.coronavirus_antibody_test_.Wave_16b== "No" |
                resp.coronavirus_antibody_test_.Wave_16b_dup == "No" ~ "No"
                     
                     )
         )
```
      
```{r results antibody covid test self single variables from duplicated IDs}
# Result covid test (antibody)
dat <- dat %>%
  mutate(resp.results_antibody_test_.Wave_1a =
           case_when(resp.results_antibody_test_.Wave_1a == "Positive" |
                      resp.results_antibody_test_.Wave_1a_dup == "Positive" ~ "Positive",
                     
                   resp.results_antibody_test_.Wave_1a == "Negative" |
                   resp.results_antibody_test_.Wave_1a_dup == "Negative" ~ "Negative",
                   
                   resp.results_antibody_test_.Wave_1a == "Result awaited" |
                   resp.results_antibody_test_.Wave_1a_dup == "Result awaited" ~ "Result awaited",
                     
                     
                     )
         )

dat <- dat %>%
  mutate(resp.results_antibody_test_.Wave_1b =
           case_when(resp.results_antibody_test_.Wave_1b == "Positive" |
                      resp.results_antibody_test_.Wave_1b_dup == "Positive" ~ "Positive",
                     
                   resp.results_antibody_test_.Wave_1b == "Negative" |
                   resp.results_antibody_test_.Wave_1b_dup == "Negative" ~ "Negative",
                   
                     resp.results_antibody_test_.Wave_1b == "Result awaited" |
                   resp.results_antibody_test_.Wave_1b_dup == "Result awaited" ~ "Result awaited",
                     
                     )
         )

dat <- dat %>%
  mutate(resp.results_antibody_test_.Wave_2a =
           case_when(resp.results_antibody_test_.Wave_2a == "Positive" |
                      resp.results_antibody_test_.Wave_2a_dup == "Positive" ~ "Positive",
                     
                   resp.results_antibody_test_.Wave_2a == "Negative" |
                   resp.results_antibody_test_.Wave_2a_dup == "Negative" ~ "Negative",
                   
                     resp.results_antibody_test_.Wave_2a == "Result awaited" |
                   resp.results_antibody_test_.Wave_2a_dup == "Result awaited" ~ "Result awaited",
                     
                     )
         )


dat <- dat %>%
  mutate(resp.results_antibody_test_.Wave_2b =
           case_when(resp.results_antibody_test_.Wave_2b == "Positive" |
                      resp.results_antibody_test_.Wave_2b_dup == "Positive" ~ "Positive",
                     
                    resp.results_antibody_test_.Wave_2b == "Negative" |
                   resp.results_antibody_test_.Wave_2b_dup == "Negative" ~ "Negative",
                   
                     resp.results_antibody_test_.Wave_2b == "Result awaited" |
                   resp.results_antibody_test_.Wave_2b_dup == "Result awaited" ~ "Result awaited",
                     
                     )
         )

dat <- dat %>%
  mutate(resp.results_antibody_test_.Wave_3a =
           case_when(resp.results_antibody_test_.Wave_3a == "Positive" |
                      resp.results_antibody_test_.Wave_3a_dup == "Positive" ~ "Positive",
                     
                    resp.results_antibody_test_.Wave_3a == "Negative" |
                   resp.results_antibody_test_.Wave_3a_dup == "Negative" ~ "Negative",
                   
                     resp.results_antibody_test_.Wave_3a == "Result awaited" |
                   resp.results_antibody_test_.Wave_3a_dup == "Result awaited" ~ "Result awaited",
                     
                     )
         )


dat <- dat %>%
  mutate(resp.results_antibody_test_.Wave_3b =
           case_when(resp.results_antibody_test_.Wave_3b == "Positive" |
                      resp.results_antibody_test_.Wave_3b_dup == "Positive" ~ "Positive",
                   
                     resp.results_antibody_test_.Wave_3b == "Negative" |
                   resp.results_antibody_test_.Wave_3b_dup == "Negative" ~ "Negative",
                   
                     resp.results_antibody_test_.Wave_3b == "Result awaited" |
                   resp.results_antibody_test_.Wave_3b_dup == "Result awaited" ~ "Result awaited",
                     
                     )
         )

dat <- dat %>%
  mutate(resp.results_antibody_test_.Wave_4a =
           case_when(resp.results_antibody_test_.Wave_4a == "Positive" |
                      resp.results_antibody_test_.Wave_4a_dup == "Positive" ~ "Positive",
                      
                   resp.results_antibody_test_.Wave_4a == "Negative" |
                   resp.results_antibody_test_.Wave_4a_dup == "Negative" ~ "Negative",
                   
                     resp.results_antibody_test_.Wave_4a == "Result awaited" |
                   resp.results_antibody_test_.Wave_4a_dup == "Result awaited" ~ "Result awaited",
                     
                     )
         )

dat <- dat %>%
  mutate(resp.results_antibody_test_.Wave_4b =
           case_when(resp.results_antibody_test_.Wave_4b == "Positive" |
                      resp.results_antibody_test_.Wave_4b_dup == "Positive" ~ "Positive",
                     
                     resp.results_antibody_test_.Wave_4b == "Negative" |
                   resp.results_antibody_test_.Wave_4b_dup == "Negative" ~ "Negative",
                   
                     resp.results_antibody_test_.Wave_4b == "Result awaited" |
                   resp.results_antibody_test_.Wave_4b_dup == "Result awaited" ~ "Result awaited",
                     
                     )
         )

dat <- dat %>%
  mutate(resp.results_antibody_test_.Wave_5a =
           case_when(resp.results_antibody_test_.Wave_5a == "Positive" |
                      resp.results_antibody_test_.Wave_5a_dup == "Positive" ~ "Positive",
                     
                   resp.results_antibody_test_.Wave_5a == "Negative" |
                   resp.results_antibody_test_.Wave_5a_dup == "Negative" ~ "Negative",
                   
                     resp.results_antibody_test_.Wave_5a == "Result awaited" |
                   resp.results_antibody_test_.Wave_5a_dup == "Result awaited" ~ "Result awaited",
                     
                     )
         )


dat <- dat %>%
  mutate(resp.results_antibody_test_.Wave_6b =
           case_when(resp.results_antibody_test_.Wave_6b== "Positive" |
                      resp.results_antibody_test_.Wave_6b_dup == "Positive" ~ "Positive",
                     
                   resp.results_antibody_test_.Wave_6b == "Negative" |
                   resp.results_antibody_test_.Wave_6b_dup == "Negative" ~ "Negative",
                   
                     resp.results_antibody_test_.Wave_6b == "Result awaited" |
                   resp.results_antibody_test_.Wave_6b_dup == "Result awaited" ~ "Result awaited",
                     
                     )
         )

dat <- dat %>%
  mutate(resp.results_antibody_test_.Wave_7a =
           case_when(resp.results_antibody_test_.Wave_7a == "Positive" |
                      resp.results_antibody_test_.Wave_7a_dup == "Positive" ~ "Positive",
                     
                    resp.results_antibody_test_.Wave_7a == "Negative" |
                   resp.results_antibody_test_.Wave_7a_dup == "Negative" ~ "Negative",
                   
                     resp.results_antibody_test_.Wave_7a == "Result awaited" |
                   resp.results_antibody_test_.Wave_7a_dup == "Result awaited" ~ "Result awaited",
                     
                     )
         )

dat <- dat %>%
  mutate(resp.results_antibody_test_.Wave_8b =
           case_when(resp.results_antibody_test_.Wave_8b == "Positive" |
                      resp.results_antibody_test_.Wave_8b_dup == "Positive" ~ "Positive",
                     
                     resp.results_antibody_test_.Wave_8b == "Negative" |
                   resp.results_antibody_test_.Wave_8b_dup == "Negative" ~ "Negative",
                   
                     resp.results_antibody_test_.Wave_8b == "Result awaited" |
                   resp.results_antibody_test_.Wave_8b_dup == "Result awaited" ~ "Result awaited",
                     
                     )
         )


dat <- dat %>%
  mutate(resp.results_antibody_test_.Wave_9a =
           case_when(resp.results_antibody_test_.Wave_9a == "Positive" |
                      resp.results_antibody_test_.Wave_9a_dup == "Positive" ~ "Positive",
                     
                   resp.results_antibody_test_.Wave_9a == "Negative" |
                   resp.results_antibody_test_.Wave_9a_dup == "Negative" ~ "Negative",
                   
                     resp.results_antibody_test_.Wave_9a == "Result awaited" |
                   resp.results_antibody_test_.Wave_9a_dup == "Result awaited" ~ "Result awaited",
                     
                     )
         )


dat <- dat %>%
  mutate(resp.results_antibody_test_.Wave_10b =
           case_when(resp.results_antibody_test_.Wave_10b == "Positive" |
                      resp.results_antibody_test_.Wave_10b_dup == "Positive" ~ "Positive",
                     
                   resp.results_antibody_test_.Wave_10b == "Negative" |
                   resp.results_antibody_test_.Wave_10b_dup == "Negative" ~ "Negative",
                   
                     resp.results_antibody_test_.Wave_10b == "Result awaited" |
                   resp.results_antibody_test_.Wave_10b_dup == "Result awaited" ~ "Result awaited",
                     
                     )
         )

dat <- dat %>%
  mutate(resp.results_antibody_test_.Wave_11a =
           case_when(resp.results_antibody_test_.Wave_11a == "Positive" |
                      resp.results_antibody_test_.Wave_11a_dup == "Positive" ~ "Positive",
                     
                   resp.results_antibody_test_.Wave_11a== "Negative" |
                   resp.results_antibody_test_.Wave_11a_dup == "Negative" ~ "Negative",
                   
                     resp.results_antibody_test_.Wave_11a == "Result awaited" |
                   resp.results_antibody_test_.Wave_11a_dup == "Result awaited" ~ "Result awaited",
                     
                     )
         )

dat <- dat %>%
  mutate(resp.results_antibody_test_.Wave_12b =
           case_when(resp.results_antibody_test_.Wave_12b == "Positive" |
                      resp.results_antibody_test_.Wave_12b_dup == "Positive" ~ "Positive",
                     
                   resp.results_antibody_test_.Wave_12b== "Negative" |
                   resp.results_antibody_test_.Wave_12b_dup == "Negative" ~ "Negative",
                   
                     resp.results_antibody_test_.Wave_12b == "Result awaited" |
                   resp.results_antibody_test_.Wave_12b_dup == "Result awaited" ~ "Result awaited",
                     
                     )
         )

dat <- dat %>%
  mutate(resp.results_antibody_test_.Wave_13a =
           case_when(resp.results_antibody_test_.Wave_13a == "Positive" |
                      resp.results_antibody_test_.Wave_13a_dup == "Positive" ~ "Positive",
                     
                   resp.results_antibody_test_.Wave_13a== "Negative" |
                  resp.results_antibody_test_.Wave_13a_dup == "Negative" ~ "Negative",
                  
                    resp.results_antibody_test_.Wave_13a == "Result awaited" |
                   resp.results_antibody_test_.Wave_13a_dup == "Result awaited" ~ "Result awaited",
                     
                     )
         )


dat <- dat %>%
  mutate(resp.results_antibody_test_.Wave_14b =
           case_when(resp.results_antibody_test_.Wave_14b == "Positive" |
                      resp.results_antibody_test_.Wave_14b_dup == "Positive" ~ "Positive",
                     
                   resp.results_antibody_test_.Wave_14b== "Negative" |
                 resp.results_antibody_test_.Wave_14b_dup == "Negative" ~ "Negative",
                 
                   resp.results_antibody_test_.Wave_14b == "Result awaited" |
                   resp.results_antibody_test_.Wave_14b_dup == "Result awaited" ~ "Result awaited",
                     
                     )
         )


dat <- dat %>%
  mutate(resp.results_antibody_test_.Wave_15a =
           case_when(resp.results_antibody_test_.Wave_15a == "Positive" |
                      resp.results_antibody_test_.Wave_15a_dup == "Positive" ~ "Positive",
                     
                   resp.results_antibody_test_.Wave_15a== "Negative" |
                 resp.results_antibody_test_.Wave_15a_dup == "Negative" ~ "Negative",
                 
                   resp.results_antibody_test_.Wave_15a == "Result awaited" |
                   resp.results_antibody_test_.Wave_15a_dup == "Result awaited" ~ "Result awaited",
                     
                     )
         )

dat <- dat %>%
  mutate(resp.results_antibody_test_.Wave_16b =
           case_when(resp.results_antibody_test_.Wave_16b == "Positive" |
                      resp.results_antibody_test_.Wave_16b_dup == "Positive" ~ "Positive",
                     
                   resp.results_antibody_test_.Wave_16b== "Negative" |
                resp.results_antibody_test_.Wave_16b_dup == "Negative" ~ "Negative",
                
                  resp.results_antibody_test_.Wave_16b == "Result awaited" |
                   resp.results_antibody_test_.Wave_16b_dup == "Result awaited" ~ "Result awaited",
                     
                     )
         )
```


## Virus questionnaire 
NB: First three waves are empty because this survey/questions got added at a later date. 
```{r ever positive covid test self single variables from duplicated IDs}
# Any tests back and positive for COVID or antibodies
#dat <- dat %>%
#  mutate(virus.back_positive_antibodies_tests_.Wave_1b =
#           case_when(virus.back_positive_antibodies_tests_.Wave_1b == "Yes" |
#                      virus.back_positive_antibodies_tests_.Wave_1b_dup == "Yes" ~ "Yes",
#                     
#                   virus.back_positive_antibodies_tests_.Wave_1b == "No" |
#                   virus.back_positive_antibodies_tests_.Wave_1b_dup == "No" ~ "No",
#                   
#                   virus.back_positive_antibodies_tests_.Wave_1b == "Unsure/inconclusive" |
#                   virus.back_positive_antibodies_tests_.Wave_1b_dup == "Unsure/inconclusive" ~ "Unsure/inconclusive"
#                     
#                     )
#         )
#
dat <- dat %>%
  mutate(virus.back_positive_antibodies_tests_.Wave_2b =
           case_when(virus.back_positive_antibodies_tests_.Wave_2b == "Yes" |
                      virus.back_positive_antibodies_tests_.Wave_2b_dup == "Yes" ~ "Yes",
                     
                    virus.back_positive_antibodies_tests_.Wave_2b == "No" |
                   virus.back_positive_antibodies_tests_.Wave_2b_dup == "No" ~ "No",
                   
                    virus.back_positive_antibodies_tests_.Wave_2b == "Unsure/inconclusive" |
                   virus.back_positive_antibodies_tests_.Wave_2b_dup == "Unsure/inconclusive" ~ "Unsure/inconclusive"
                     
                     )
         )


dat <- dat %>%
  mutate(virus.back_positive_antibodies_tests_.Wave_3b =
           case_when(virus.back_positive_antibodies_tests_.Wave_3b == "Yes" |
                      virus.back_positive_antibodies_tests_.Wave_3b_dup == "Yes" ~ "Yes",
                   
                     virus.back_positive_antibodies_tests_.Wave_3b == "No" |
                   virus.back_positive_antibodies_tests_.Wave_3b_dup == "No" ~ "No",
                   
                    virus.back_positive_antibodies_tests_.Wave_3b == "Unsure/inconclusive" |
                   virus.back_positive_antibodies_tests_.Wave_3b_dup == "Unsure/inconclusive" ~ "Unsure/inconclusive"
                     
                     )
         )

dat <- dat %>%
  mutate(virus.back_positive_antibodies_tests_.Wave_4b =
           case_when(virus.back_positive_antibodies_tests_.Wave_4b == "Yes" |
                      virus.back_positive_antibodies_tests_.Wave_4b_dup == "Yes" ~ "Yes",
                     
                     virus.back_positive_antibodies_tests_.Wave_4b == "No" |
                   virus.back_positive_antibodies_tests_.Wave_4b_dup == "No" ~ "No",
                   
                    virus.back_positive_antibodies_tests_.Wave_4b == "Unsure/inconclusive" |
                   virus.back_positive_antibodies_tests_.Wave_4b_dup == "Unsure/inconclusive" ~ "Unsure/inconclusive"
                     
                     )
         )

dat <- dat %>%
  mutate(virus.back_positive_antibodies_tests_.Wave_6b =
           case_when(virus.back_positive_antibodies_tests_.Wave_6b== "Yes" |
                      virus.back_positive_antibodies_tests_.Wave_6b_dup == "Yes" ~ "Yes",
                     
                   virus.back_positive_antibodies_tests_.Wave_6b == "No" |
                   virus.back_positive_antibodies_tests_.Wave_6b_dup == "No" ~ "No",
                   
                    virus.back_positive_antibodies_tests_.Wave_6b == "Unsure/inconclusive" |
                   virus.back_positive_antibodies_tests_.Wave_6b_dup == "Unsure/inconclusive" ~ "Unsure/inconclusive"
                     
                     )
         )


dat <- dat %>%
  mutate(virus.back_positive_antibodies_tests_.Wave_8b =
           case_when(virus.back_positive_antibodies_tests_.Wave_8b == "Yes" |
                      virus.back_positive_antibodies_tests_.Wave_8b_dup == "Yes" ~ "Yes",
                     
                     virus.back_positive_antibodies_tests_.Wave_8b == "No" |
                   virus.back_positive_antibodies_tests_.Wave_8b_dup == "No" ~ "No",
                   
                    virus.back_positive_antibodies_tests_.Wave_8b == "Unsure/inconclusive" |
                   virus.back_positive_antibodies_tests_.Wave_8b_dup == "Unsure/inconclusive" ~ "Unsure/inconclusive"
                     
                     )
         )


dat <- dat %>%
  mutate(virus.back_positive_antibodies_tests_.Wave_10b =
           case_when(virus.back_positive_antibodies_tests_.Wave_10b == "Yes" |
                      virus.back_positive_antibodies_tests_.Wave_10b_dup == "Yes" ~ "Yes",
                     
                   virus.back_positive_antibodies_tests_.Wave_10b == "No" |
                   virus.back_positive_antibodies_tests_.Wave_10b_dup == "No" ~ "No",
                   
                    virus.back_positive_antibodies_tests_.Wave_10b == "Unsure/inconclusive" |
                   virus.back_positive_antibodies_tests_.Wave_10b_dup == "Unsure/inconclusive" ~ "Unsure/inconclusive"
                     
                     )
         )

dat <- dat %>%
  mutate(virus.back_positive_antibodies_tests_.Wave_12b =
           case_when(virus.back_positive_antibodies_tests_.Wave_12b == "Yes" |
                      virus.back_positive_antibodies_tests_.Wave_12b_dup == "Yes" ~ "Yes",
                     
                   virus.back_positive_antibodies_tests_.Wave_12b== "No" |
                   virus.back_positive_antibodies_tests_.Wave_12b_dup == "No" ~ "No",
                     
                    virus.back_positive_antibodies_tests_.Wave_12b == "Unsure/inconclusive" |
                   virus.back_positive_antibodies_tests_.Wave_12b_dup == "Unsure/inconclusive" ~ "Unsure/inconclusive"
                     )
         )


dat <- dat %>%
  mutate(virus.back_positive_antibodies_tests_.Wave_14b =
           case_when(virus.back_positive_antibodies_tests_.Wave_14b == "Yes" |
                      virus.back_positive_antibodies_tests_.Wave_14b_dup == "Yes" ~ "Yes",
                     
                   virus.back_positive_antibodies_tests_.Wave_14b== "No" |
                 virus.back_positive_antibodies_tests_.Wave_14b_dup == "No" ~ "No",
                 
                 virus.back_positive_antibodies_tests_.Wave_14b == "Unsure/inconclusive" |
                   virus.back_positive_antibodies_tests_.Wave_14b_dup == "Unsure/inconclusive" ~ "Unsure/inconclusive"
                     
                     )
         )


dat <- dat %>%
  mutate(virus.back_positive_antibodies_tests_.Wave_16b =
           case_when(virus.back_positive_antibodies_tests_.Wave_16b == "Yes" |
                      virus.back_positive_antibodies_tests_.Wave_16b_dup == "Yes" ~ "Yes",
                     
                   virus.back_positive_antibodies_tests_.Wave_16b== "No" |
                virus.back_positive_antibodies_tests_.Wave_16b_dup == "No" ~ "No",
                
                 virus.back_positive_antibodies_tests_.Wave_16b == "Unsure/inconclusive" |
                   virus.back_positive_antibodies_tests_.Wave_16b_dup == "Unsure/inconclusive" ~ "Unsure/inconclusive"
                     
                     )
         )
```
  
```{r ever taken COVID test self single variables from duplicated IDs}
# Ever taken COVID test
# dat <- dat %>%
#   mutate(virus.past_surveys_include_covid19_.Wave_1b =
#            case_when(virus.past_surveys_include_covid19_.Wave_1b == "Yes" |
#                       virus.past_surveys_include_covid19_.Wave_1b_dup == "Yes" ~ "Yes",
#                      
#                    virus.past_surveys_include_covid19_.Wave_1b == "No" |
#                    virus.past_surveys_include_covid19_.Wave_1b_dup == "No" ~ "No",
#                      
#                      )
#          )

dat <- dat %>%
  mutate(virus.past_surveys_include_covid19_.Wave_2b =
           case_when(virus.past_surveys_include_covid19_.Wave_2b == "Yes" |
                      virus.past_surveys_include_covid19_.Wave_2b_dup == "Yes" ~ "Yes",
                     
                    virus.past_surveys_include_covid19_.Wave_2b == "No" |
                   virus.past_surveys_include_covid19_.Wave_2b_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(virus.past_surveys_include_covid19_.Wave_3b =
           case_when(virus.past_surveys_include_covid19_.Wave_3b == "Yes" |
                      virus.past_surveys_include_covid19_.Wave_3b_dup == "Yes" ~ "Yes",
                   
                     virus.past_surveys_include_covid19_.Wave_3b == "No" |
                   virus.past_surveys_include_covid19_.Wave_3b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(virus.past_surveys_include_covid19_.Wave_4b =
           case_when(virus.past_surveys_include_covid19_.Wave_4b == "Yes" |
                      virus.past_surveys_include_covid19_.Wave_4b_dup == "Yes" ~ "Yes",
                     
                     virus.past_surveys_include_covid19_.Wave_4b == "No" |
                   virus.past_surveys_include_covid19_.Wave_4b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(virus.past_surveys_include_covid19_.Wave_6b =
           case_when(virus.past_surveys_include_covid19_.Wave_6b== "Yes" |
                      virus.past_surveys_include_covid19_.Wave_6b_dup == "Yes" ~ "Yes",
                     
                   virus.past_surveys_include_covid19_.Wave_6b == "No" |
                   virus.past_surveys_include_covid19_.Wave_6b_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(virus.past_surveys_include_covid19_.Wave_8b =
           case_when(virus.past_surveys_include_covid19_.Wave_8b == "Yes" |
                      virus.past_surveys_include_covid19_.Wave_8b_dup == "Yes" ~ "Yes",
                     
                     virus.past_surveys_include_covid19_.Wave_8b == "No" |
                   virus.past_surveys_include_covid19_.Wave_8b_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(virus.past_surveys_include_covid19_.Wave_10b =
           case_when(virus.past_surveys_include_covid19_.Wave_10b == "Yes" |
                      virus.past_surveys_include_covid19_.Wave_10b_dup == "Yes" ~ "Yes",
                     
                   virus.past_surveys_include_covid19_.Wave_10b == "No" |
                   virus.past_surveys_include_covid19_.Wave_10b_dup == "No" ~ "No",
                     
                     )
         )

dat <- dat %>%
  mutate(virus.past_surveys_include_covid19_.Wave_12b =
           case_when(virus.past_surveys_include_covid19_.Wave_12b == "Yes" |
                      virus.past_surveys_include_covid19_.Wave_12b_dup == "Yes" ~ "Yes",
                     
                   virus.past_surveys_include_covid19_.Wave_12b== "No" |
                   virus.past_surveys_include_covid19_.Wave_12b_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(virus.past_surveys_include_covid19_.Wave_14b =
           case_when(virus.past_surveys_include_covid19_.Wave_14b == "Yes" |
                      virus.past_surveys_include_covid19_.Wave_14b_dup == "Yes" ~ "Yes",
                     
                   virus.past_surveys_include_covid19_.Wave_14b== "No" |
                 virus.past_surveys_include_covid19_.Wave_14b_dup == "No" ~ "No",
                     
                     )
         )


dat <- dat %>%
  mutate(virus.past_surveys_include_covid19_.Wave_16b =
           case_when(virus.past_surveys_include_covid19_.Wave_16b == "Yes" |
                      virus.past_surveys_include_covid19_.Wave_16b_dup == "Yes" ~ "Yes",
                     
                   virus.past_surveys_include_covid19_.Wave_16b== "No" |
                virus.past_surveys_include_covid19_.Wave_16b_dup == "No" ~ "No",
                     
                     )
         )

```

# Save dataset
```{r save dataset}
saveRDS(object = dat,
       file = paste0("/Users/helenadavies/werk/EDBEHSELFHARM2/gitEDBEHSELFHARM/data_cleaned/final_dat_no_dup_entries", date, ".rds"))

```
